<!-- Academic Blog Template
MIT License - Copyright (c) 2025 Su Jiayi <sujiayi2003@gmail.com>
-->

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        
        <!-- Primary Meta Tags -->
        <title>ShuYuMo&#39;s Blog | Jiayi Su</title>
        <meta name="description" content="‰∏Ä‰∫õÂ•áÂ•áÊÄ™ÊÄ™ÁöÑ INFP ÈöèÁ¢éÁ¢éÂøµ„ÄÇ">
        <meta name="keywords" content="nb1, nb2, nb3">
        <meta name="author" content="Su Jiayi">
        
        <!-- Open Graph Meta Tags -->
        <meta property="og:type" content="website">
        <meta property="og:title" content="ShuYuMo&#39;s Blog | Jiayi Su">
        <meta property="og:description" content="‰∏Ä‰∫õÂ•áÂ•áÊÄ™ÊÄ™ÁöÑ INFP ÈöèÁ¢éÁ¢éÂøµ„ÄÇ">
        <meta property="og:image" content="../static/images/header.jpg">
        
        <!-- Stylesheets -->
        <link rel="stylesheet" type="text/css" href="../static/css/default.css">
        <link rel="stylesheet" type="text/css" href="../static/css/syntax.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
        
        <!-- Google Analytics -->
        
    </head>
    <body>
        <!-- Skip to main content for accessibility -->
        <a href="#main-content" class="skip-link">Skip to main content</a>
        
        <div id="main">
            <div class="main-container">
                <!-- Header -->
                <header id="header">
                    <div class="header-content">
                        <h1 class="header-title">
                            <a href="./">ShuYuMo&#39;s Blog</a>
                        </h1>
                        <p class="header-subtitle">‰∏Ä‰∫õÂ•áÂ•áÊÄ™ÊÄ™ÁöÑ INFP ÈöèÁ¢éÁ¢éÂøµ„ÄÇ</p>
                        <div class="header-accent"></div>
                    </div>
                </header>
                
                <!-- Content Layout -->
                <div class="content-wrapper">
                    <!-- Sidebar -->
                    <nav id="sidebar">
                        <div class="profile-section">
                            <a href="./" class="profile-avatar-link">
                                <img src="../static/images/header.jpg" alt="ShuYuMo&#39;s header" class="profile-avatar" loading="lazy" />
                            </a>
                            <div class="profile-info">
                                <h3 class="profile-name">Jiayi Su (ShuYuMo)</h3>
            </div>
            </div>

                        <div class="nav-header">
                            <h2>üß≠ Navigation</h2>
                            <span class="nav-subtitle">Explore the site</span>
                        </div>
                        <nav class="nav-menu">
                            
                            
                            <a href="./_post.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">Posts</span>
                                
                            </a>
                            
                            
                            <a href="./_archive.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">Archive</span>
                                
                            </a>
                            
                            
                            <a href="./_category.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">Category</span>
                                
                            </a>
                            
                            
                            <a href="./_about.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">About</span>
                                
                            </a>
                            
                        </nav>
                    </nav>

                    <!-- Main Content -->
                    <main id="content">
                        <div id="main-content">
                            
                                <article>
                                    <!-- Article Header with Title and Actions -->
                                    <div class="article-header">
                                        <div class="article-title-section">
                                            
                                                <h1 class="article-title">„ÄåÈ¢òÂçï„ÄçIOI2020ÂõΩÂÆ∂ÈõÜËÆ≠Èòü‰Ωú‰∏ö Part 1</h1>
                                            
                                            
                                            <!-- Article Meta Information -->
                                            <div class="article-meta">
                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">üìÖ</span>
                                                        <span class="meta-label">Last Updated: </span>
                                                        <span class="meta-value">2020-10-19</span>
                                                    </div>
                                                
                                                
                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">üìä</span>
                                                        <span class="meta-label">Word Count: </span>
                                                        <span class="meta-value">836</span>
                                                    </div>
                    

                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">‚è±Ô∏è</span>
                                                        <span class="meta-label">Estimated Reading Time: </span>
                                                        <span class="meta-value">6 minutes</span>
                                                    </div>
                                                
                                            </div>
                                        </div>
                                        
                                        <div class="article-actions">
                    
                                                <a href="../pdf/oi-blog_„ÄåÊùÇÈ¢òËÆ∞ÂΩï„ÄçIOI2020ÂõΩÂÆ∂ÈõÜËÆ≠Èòü‰Ωú‰∏ö-Part-1.pdf" 
                                                   target="_blank" 
                                                   rel="noopener"
                                                   class="action-btn pdf-btn">
                                                    üìÑ PDF
                                                </a>
                                            
                                            
                                            
                                                <a href="../src/oi-blog/„ÄåÊùÇÈ¢òËÆ∞ÂΩï„ÄçIOI2020ÂõΩÂÆ∂ÈõÜËÆ≠Èòü‰Ωú‰∏ö-Part-1.md" 
                                                   target="_blank" 
                                                   rel="noopener"
                                                   class="action-btn source-btn">
                                                    üìù Source
                                                </a>
                                            
                                        </div>
                                    </div>

                                    <!-- Article Content -->
                                    <div class="article-content">
                                        <h1 id="cf505e-mr.-kitayuta-vs.-bamboos">CF505E Mr.¬†Kitayuta
vs.¬†Bamboos</h1>
<ul>
<li>ÁªôÂÆö
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
‰∏™Êï∞ÔºàÁ´πÂ≠êÁöÑÈ´òÂ∫¶Ôºâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mrow><mn>1</mn><mo>‚Ä¶</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{1 \dots n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="minner mtight">‚Ä¶</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>„ÄÇ</li>
<li>‰Ω†ÈúÄË¶ÅËøõË°å
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>
ËΩÆÊìç‰ΩúÔºåÊØèËΩÆÊìç‰Ωú‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
Ê¨°‰øÆÊîπÔºåÊØèÊ¨°‰øÆÊîπÂèØ‰ª•ÈÄâÊã©‰∏Ä‰∏™Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
‰øÆÊîπ‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>h</mi><mi>i</mi></msub><mo>‚àí</mo><mi>p</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\max(h_i - p, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>ÔºàÁ†∏Âà∞Âú∞‰∏ãÔºâ„ÄÇ</li>
<li>ÊØèËΩÆÊìç‰ΩúÂêéÊØè‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
Â∞Ü‰ºöË¢´‰øÆÊîπ‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub><mo>+</mo><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i + a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ÔºàÊØèÂ§©Á´πÂ≠ê‰ºöÁîüÈïøÔºâ„ÄÇ</li>
<li>‰Ω†ÈúÄË¶ÅÊúÄÂ∞èÂåñÊúÄÁªà
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mrow><mn>1</mn><mo>‚Ä¶</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{1 \dots n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="minner mtight">‚Ä¶</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
‰∏≠ÁöÑÊúÄÂ§ßÂÄº„ÄÇ</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">n \le 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span>Ôºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>‚â§</mo><mn>5</mn><mo>√ó</mo><mn>1</mn><msup><mn>0</mn><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">m \le 5 \times 10^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span>Ôºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>‚â§</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">k \le 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span>
<!-- more -->
Ë¶ÅÊ±ÇÊúÄÂ∞èÂåñÊúÄÂ§ßÂÄºÔºåËÄÉËôë‰∫åÂàÜ‰∏Ä‰∏™ÊúÄÂ§ßÁöÑÈ´òÂ∫¶ÔºåÂ∞ÜÈóÆÈ¢òËΩ¨ÂåñÊàêÂèØË°åÊÄßÈóÆÈ¢òÔºåÂç≥ÔºåÁªôÂá∫‰∏Ä‰∏™È´òÂ∫¶ÔºåÈóÆËÉΩÂê¶‰ΩøËøô‰∫õÁ´πÂ≠êÊúÄÁªà‰∏çË∂ÖËøáËøô‰∏™È´òÂ∫¶„ÄÇ</li>
</ul>
<p>ËÄÉËôëÈôêÂà∂Ëøô‰∏™ÈóÆÈ¢ò‰∏çÂπ≥Âá°ÁöÑÂõ†Á¥†ÔºöÂõ†‰∏∫ÊØèÊ¨°Èôç‰ΩéÁ´πÂ≠êÈ´òÂ∫¶ÁöÑÊó∂ÂÄô‰∏çËÉΩ‰øùËØÅÁ´πÂ≠ê‰∏ÄÂÆöÈôç‰Ωé
p
Ôºå‰πüÂ∞±ÊòØËØ¥Ôºå‚ÄúÁ†∏Á´πÂ≠ê‚ÄùËøô‰∏ÄÂä®‰ΩúÂ≠òÂú®Êµ™Ë¥π„ÄÇÊàë‰ª¨ËÄÉËôëÂ∞ΩÂèØËÉΩÁöÑËÆ©‚ÄúÁ†∏Á´πÂ≠ê‚ÄùËøô‰∏ÄÂä®‰ΩúÊõ¥Â∞ëÁöÑÊµ™Ë¥πÔºåÂç≥ÔºöÂ∞ΩÂèØËÉΩÂú®ÂêéÈù¢ÁöÑÊó∂Èó¥ÁÇπÁ†∏Á´πÂ≠êÔºå‰ΩÜÊòØÊó†Ê≥ï‰øùËØÅÂà∞Â∫ïÊòØÂú®Âì™‰∏ÄÊ¨°Á†∏Á´πÂ≠êÔºåÊúâÂèØËÉΩÂ∑≤ÁªèÁªìÊùü‰∫ÜÔºåÊ≤°ÊúâÂΩ¢ÂºèÂåñÁöÑËÆ°ÁÆóÊµÅÁ®ã„ÄÇ</p>
<p>ÂèØ‰ª•ËÄÉËôëÂèçÂêëÊÄùËÄÉÔºåÂç≥ÔºöÂÅáËÆæÂ∑≤ÁªèÈïøÂà∞
‰∫åÂàÜÁöÑÈ´òÂ∫¶„ÄÇÊØèÊ¨°ÁîüÈïøÊìç‰ΩúÁõ∏ÂΩì‰∫éÊØèÊ¨°‰ºö‰∏ãËêΩ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ÔºåËÄåÊØèÊ¨°Á†∏ÁöÑÊìç‰ΩúÁõ∏ÂΩì‰∫éÊèêÂçá‰∫Ü
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>
ÁöÑÈ´òÂ∫¶„ÄÇ</p>
<p>ÂºÄÂßãÊó∂ÔºåÂØπÊØè‰∏Ä‰∏™Á´πÂ≠êËÆ°ÁÆóÂá∫ÂÖ∂ÈúÄË¶ÅÂ§öÂ∞ëÊ¨°‰ºö‰∏ãËêΩÂà∞Ë¥üÈ´òÂ∫¶ÔºåÁî®Â†ÜÁª¥Êä§ÔºåÊØèÊ¨°ÂèñÂá∫ÊúÄÂø´ÁöÑÂèØËÉΩ‰∏ãËêΩÂà∞Ë¥üÈ´òÂ∫¶ÁöÑ
k ‰∏™Á´πÂ≠êÔºåËøõË°å ‚ÄúÊãîÈ´ò‚Äù
Êìç‰Ωú„ÄÇÁÑ∂ÂêéÂà§Êñ≠ÊúÄÂêéÁöÑÈ´òÂ∫¶ÊòØÂê¶Â§ß‰∫éÁ≠â‰∫é<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>„ÄÇ</p>
<p>ÂÖ∂ÂÆû‰∫åÂàÜÁöÑÊú¨Ë¥®ÊòØ‰∏∫‰∫ÜÁ°ÆÂÆö‚ÄúÂ∞ΩÂèØËÉΩÁöÑÈù†ÂêéÁ†∏Á´πÂ≠ê‚ÄùÁöÑÊ†áÂáÜ„ÄÇÂèçÂêëÊÄùËÄÉÊòØ‰∏∫‰∫Ü‰æø‰∫éË¥™ÂøÉÂ§ÑÁêÜÁ≠ñÁï•„ÄÇ
## code</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> m<span class="op">,</span> k<span class="op">,</span> p<span class="op">;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> H<span class="op">[</span>_<span class="op">],</span> A<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#define mp </span>make_pair</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define fi </span>first</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define se </span>second</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> height<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> check<span class="op">(</span><span class="dt">int</span> MaxH<span class="op">){</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    fill<span class="op">(</span>height <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> height <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> n<span class="op">,</span> MaxH<span class="op">);</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    priority_queue<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;,</span> vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">,</span> greater<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span> Q<span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(!</span>Q<span class="op">.</span>empty<span class="op">())</span> Q<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="cf">if</span><span class="op">(</span>MaxH <span class="op">-</span> m <span class="op">*</span> A<span class="op">[</span>i<span class="op">]</span> <span class="op">&lt;</span> H<span class="op">[</span>i<span class="op">])</span> Q<span class="op">.</span>push<span class="op">(</span>mp<span class="op">(</span> MaxH <span class="op">/</span> A<span class="op">[</span>i<span class="op">],</span> i <span class="op">));</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> m<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> k<span class="op">;</span> j<span class="op">++){</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>Q<span class="op">.</span>empty<span class="op">())</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>            pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> now <span class="op">=</span> Q<span class="op">.</span>top<span class="op">();</span> Q<span class="op">.</span>pop<span class="op">();</span> </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>now<span class="op">.</span>fi <span class="op">&lt;</span> i<span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            height<span class="op">[</span>now<span class="op">.</span>se<span class="op">]</span> <span class="op">+=</span> p<span class="op">;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>            now<span class="op">.</span>fi <span class="op">=</span> height<span class="op">[</span>now<span class="op">.</span>se<span class="op">]</span> <span class="op">/</span> A<span class="op">[</span>now<span class="op">.</span>se<span class="op">];</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>height<span class="op">[</span>now<span class="op">.</span>se<span class="op">]</span> <span class="op">-</span> m <span class="op">*</span> A<span class="op">[</span>now<span class="op">.</span>se<span class="op">]</span> <span class="op">&lt;</span> H<span class="op">[</span>now<span class="op">.</span>se<span class="op">])</span> Q<span class="op">.</span>push<span class="op">(</span>now<span class="op">);</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Q<span class="op">.</span>empty<span class="op">();</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="dt">signed</span> main<span class="op">(){</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> read<span class="op">(),</span> m <span class="op">=</span> read<span class="op">(),</span> k <span class="op">=</span> read<span class="op">(),</span> p <span class="op">=</span> read<span class="op">();</span> <span class="co">// Á´πÂ≠êÊï∞ Â§©Êï∞ ‰øÆÊîπÊ¨°Êï∞ ÊúÄÂ§ßÈôç‰ΩéÈ´òÂ∫¶ </span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> H<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> read<span class="op">(),</span> A<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> L <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> R <span class="op">=</span> <span class="dv">1</span><span class="bu">LL</span> <span class="op">&lt;&lt;</span> <span class="dv">60</span><span class="op">;</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> L <span class="op">=</span> min<span class="op">(</span>L<span class="op">,</span> A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>L <span class="op">&lt;</span> R<span class="op">){</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>check<span class="op">(</span>mid<span class="op">))</span> ans <span class="op">=</span> mid<span class="op">,</span> R <span class="op">=</span> mid<span class="op">;</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> L <span class="op">=</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="cf521d-shop">CF521D Shop</h1>
<ul>
<li>Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
‰∏™Ê≠£Êï¥Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mn>1</mn><mo>‚Ä¶</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a_{1\dots k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="minner mtight">‚Ä¶</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>„ÄÇ</li>
<li>Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
‰∏™Êìç‰ΩúÔºåÊØè‰∏™Êìç‰ΩúÁªôÂÆöÊ≠£Êï¥Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>ÔºåÊúâ‰∏âÁßçÂèØËÉΩÔºöÂ∞Ü
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ËµãÂÄº‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>ÔºåÂ∞Ü
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
Âä†‰∏ä
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>ÔºåÂ∞Ü
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
‰πò‰ª•
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>„ÄÇ</li>
<li>‰Ω†ÂèØ‰ª•‰ªé
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
‰∏™Êìç‰Ωú‰∏≠ÈÄâÊã©ÊúÄÂ§ö
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>
‰∏™Êìç‰ΩúÔºåÂπ∂ÊåâÁÖß‰∏ÄÂÆöÈ°∫Â∫èÊâßË°å„ÄÇ</li>
<li>‰Ω†ÁöÑÁõÆÊ†áÊòØÊúÄÂ§ßÂåñ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>‚àè</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\prod_{i=1}^k a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2887em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">‚àè</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ÁöÑÂÄº„ÄÇ</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo separator="true">,</mo><mi>n</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">k,n \le 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span>„ÄÇ</li>
</ul>
<p>ÂåñÂΩíÊÄùÊÉ≥ÔºåËÄÉËôëÂ¶ÇÊûúÂè™Êúâ‰πòÊ≥ïÔºåÈÇ£‰∏ÄÂÆöÊòØÊääÊìç‰ΩúÊï∞Â≠ó‰ªéÂ§ßÂà∞Â∞èÊéíÂ∫èÔºåÁÑ∂Âêé‰ª•Ê≠§Êìç‰Ωú„ÄÇ</p>
<p>ËÄÉËôëÊìç‰ΩúÈ°∫Â∫èÔºåÊúÄ‰ºòÁöÑÊìç‰Ωú‰∏ÄÂÆöÊòØÂÖàËµãÂÄºÔºåÂÜçÂä†Ê≥ïÔºåÊúÄÂêé‰πòÊ≥ï„ÄÇÂÖ∂‰∏≠ËµãÂÄºÂè™ÂèØËÉΩÈÄâÁõ∏Â∫î‰ΩçÁΩÆÊúÄÂ§ßÁöÑËµãÂÄºÔºåÂä†Ê≥ï‰πüÊòØ‰ªéÂ§ßÂà∞Â∞èËÄÉËôë„ÄÇ</p>
<p>ÊòæÁÑ∂ËµãÂÄºÂèØ‰ª•Áõ¥Êé•ËΩ¨ÂåñÊàêÂä†Ê≥ïÔºåËÄåÂä†Ê≥ïÂ¶ÇÊûú‰ªéÂ§ßÂà∞Â∞èËÄÉËôë‰πüÂèØ‰ª•Áõ¥Êé•ËΩ¨ÂåñÊàê‰πòÊ≥ïÔºà‰πò‰∏Ä‰∏™ÂÆûÊï∞Ôºâ„ÄÇ</p>
<p>ËøôÊ†∑Â∞±ÊääÊâÄÊúâÊìç‰ΩúËΩ¨ÂåñÊàê‰∫Ü‰πòÊ≥ï„ÄÇ Ë¥™ÂøÉËÄÉËôëÂç≥ÂèØ„ÄÇ</p>
<p>ÊúÄÂêéËæìÂá∫ÊúâÈ°∫Â∫èÔºåÂ∫îÊåâÁÖß‰∏äÈù¢ÁöÑÁ≠ñÁï•ÔºàÂÖàËµãÂÄºÔºåÂÜçÂä†Ê≥ïÔºåÊúÄÂêé‰πòÊ≥ïÔºâ‰ª•Ê≠§ËæìÂá∫ÔºàÊìç‰ΩúÈ°∫Â∫èÔºâ„ÄÇ</p>
<h2 id="code">code</h2>
<div class="sourceCode" id="cb2"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;climits&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cmath&gt;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">1e5</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#define LL </span><span class="dt">long</span><span class="pp"> </span><span class="dt">long</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> read<span class="op">()</span> <span class="op">{</span> <span class="dt">int</span> x<span class="op">;</span> scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>x<span class="op">);</span> <span class="cf">return</span> x<span class="op">;</span> <span class="op">}</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> m<span class="op">,</span> k<span class="op">;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> v<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> Give<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> <span class="op">&gt;</span> add<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">double</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> <span class="op">&gt;</span> mul<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">double</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> <span class="op">&gt;</span> All<span class="op">;</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> T<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> id<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="pp">#define double </span><span class="dt">long</span><span class="pp"> </span><span class="dt">double</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> ICMP  <span class="op">(</span><span class="at">const</span> pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> <span class="op">&amp;</span> x<span class="op">,</span> <span class="at">const</span> pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> <span class="op">&amp;</span> y<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">(</span>x <span class="op">&gt;</span> y<span class="op">);</span> <span class="op">}</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> ICMP_D<span class="op">(</span><span class="at">const</span> pair<span class="op">&lt;</span><span class="dt">double</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> <span class="op">&amp;</span> x<span class="op">,</span> <span class="at">const</span> pair<span class="op">&lt;</span><span class="dt">double</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> <span class="op">&amp;</span> y<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">(</span>x <span class="op">&gt;</span> y<span class="op">);</span> <span class="op">}</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> MAGIC<span class="op">(</span><span class="at">const</span> <span class="dt">int</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="at">const</span> <span class="dt">int</span> <span class="op">&amp;</span>y<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> T<span class="op">[</span>x<span class="op">]</span> <span class="op">&lt;</span> T<span class="op">[</span>y<span class="op">];</span> <span class="op">}</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> read<span class="op">(),</span> n <span class="op">=</span> read<span class="op">(),</span> m <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> k<span class="op">;</span> i<span class="op">++)</span> v<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> type <span class="op">=</span> read<span class="op">();</span> T<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> type<span class="op">;</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a <span class="op">=</span> read<span class="op">(),</span> b <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>type <span class="op">==</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>            Give<span class="op">[</span>a<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>Give<span class="op">[</span>a<span class="op">],</span> make_pair<span class="op">(</span>b<span class="op">,</span> i<span class="op">));</span> </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>type <span class="op">==</span> <span class="dv">2</span><span class="op">){</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>            add<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(</span>make_pair<span class="op">(</span>b<span class="op">,</span> i<span class="op">));</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>            mul<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(</span>make_pair<span class="op">((</span><span class="dt">double</span><span class="op">)(</span>b<span class="op">),</span> i<span class="op">));</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> k<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>Give<span class="op">[</span>i<span class="op">].</span>first<span class="op">)</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>            add<span class="op">[</span>i<span class="op">].</span>push_back<span class="op">(</span>make_pair<span class="op">(</span>Give<span class="op">[</span>i<span class="op">].</span>first <span class="op">-</span> v<span class="op">[</span>i<span class="op">],</span> Give<span class="op">[</span>i<span class="op">].</span>second<span class="op">));</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> k<span class="op">;</span> i<span class="op">++)</span> sort<span class="op">(</span>add<span class="op">[</span>i<span class="op">].</span>begin<span class="op">(),</span> add<span class="op">[</span>i<span class="op">].</span>end<span class="op">(),</span> ICMP<span class="op">);</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> k<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>        LL now <span class="op">=</span> v<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> add<span class="op">[</span>i<span class="op">].</span>size<span class="op">();</span> j<span class="op">++){</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>            mul<span class="op">[</span>i<span class="op">].</span>push_back<span class="op">(</span> </span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>                make_pair<span class="op">(</span> </span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>                    <span class="op">(</span><span class="dt">double</span><span class="op">)(</span>now <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> add<span class="op">[</span>i<span class="op">][</span>j<span class="op">].</span>first<span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="dt">double</span><span class="op">)(</span>now<span class="op">),</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>                    add<span class="op">[</span>i<span class="op">][</span>j<span class="op">].</span>second</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>                <span class="op">)</span> </span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>            <span class="op">);</span> now <span class="op">+=</span> add<span class="op">[</span>i<span class="op">][</span>j<span class="op">].</span>first<span class="op">;</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> k<span class="op">;</span> i<span class="op">++)</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> mul<span class="op">[</span>i<span class="op">].</span>size<span class="op">();</span> j<span class="op">++)</span> All<span class="op">.</span>push_back<span class="op">(</span>mul<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>All<span class="op">.</span>begin<span class="op">(),</span> All<span class="op">.</span>end<span class="op">(),</span> ICMP_D<span class="op">);</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> All<span class="op">.</span>size<span class="op">();</span> i<span class="op">++)</span> <span class="cf">if</span><span class="op">(</span>All<span class="op">[</span>i<span class="op">].</span>first <span class="op">&gt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> tot<span class="op">++;</span> <span class="op">}</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    tot <span class="op">=</span> min<span class="op">(</span>tot<span class="op">,</span> m<span class="op">);</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> tot<span class="op">;</span> i<span class="op">++)</span> id<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> All<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>second<span class="op">;</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>id <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> id <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> tot<span class="op">,</span> MAGIC<span class="op">);</span>  printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> tot<span class="op">);</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> tot<span class="op">;</span> i<span class="op">++)</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%c</span><span class="st">&quot;</span><span class="op">,</span> id<span class="op">[</span>i<span class="op">],</span> <span class="st">&quot; </span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">[</span>i <span class="op">==</span> n<span class="op">]);</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="cf526f-pudding-monsters">CF526F Pudding Monsters</h1>
<ul>
<li>ÁªôÂÆö‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>√ó</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÊ£ãÁõòÔºåÂÖ∂‰∏≠Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
‰∏™Ê£ãÂ≠êÔºåÊØèË°åÊØèÂàóÊÅ∞Â•ΩÊúâ‰∏Ä‰∏™Ê£ãÂ≠ê„ÄÇ</li>
<li>Ê±ÇÊúâÂ§öÂ∞ë‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>√ó</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">k \times k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÁöÑÂ≠êÊ£ãÁõò‰∏≠ÊÅ∞Â•ΩÊúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
‰∏™Ê£ãÂ≠ê„ÄÇ</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚â§</mo><mn>3</mn><mo>√ó</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">n \le 3 \times 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span>„ÄÇ</li>
</ul>
<p>ÊØèË°åÊØèÂàó<strong>ÊÅ∞Â•ΩÊúâ‰∏Ä‰∏™</strong>Ê£ãÂ≠êÁöÑÊ£ãÁõòÔºåÂèØ‰ª•ÊäΩË±°Êàê‰∏Ä‰∏™ÊéíÂàó„ÄÇ
ËÄåÊìç‰Ωú‰πüÊòØÂØπ‰∫é‰∏Ä‰∏™ÊéíÂàóÁöÑ‰∏ÄÊÆµËøõË°åÊìç‰ΩúÁöÑ„ÄÇ</p>
<p>È¢òÊÑèÂèØ‰ª•ËΩ¨Âåñ‰∏∫Ôºö - ÁªôÂá∫‰∏Ä‰∏™ÊéíÂàó -
Ê±ÇËøûÁª≠ÊÆµÊï∞ÈáèÔºåÂç≥ËøûÁª≠ÁöÑ‰∏ÄÊÆµÔºå‰∏îÊÆµ‰∏≠ÁöÑÂÖÉÁ¥†ÊéíÂ•ΩÂ∫è‰πãÂêéÂøÖÈ°ªÊòØÂÖ¨Â∑Æ‰∏∫<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ÁöÑÁ≠âÂ∑ÆÊï∞Âàó.</p>
<p><strong>ËøûÁª≠ÊÆµËÆ°Êï∞</strong></p>
<p>ËÄÉËôëÂ¶Ç‰ΩïÂàªÁîª‚Äú<strong>ËøûÁª≠ÁöÑ‰∏ÄÊÆµÔºå‰∏îÊÆµ‰∏≠ÁöÑÂÖÉÁ¥†ÊéíÂ•ΩÂ∫è‰πãÂêéÂøÖÈ°ªÊòØÂÖ¨Â∑Æ‰∏∫<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ÁöÑÁ≠âÂ∑ÆÊï∞Âàó</strong>‚ÄùËøô‰∏™Êù°‰ª∂ÔºåÂèØ‰ª•ÂΩ¢ÂºèÂåñÁöÑÂÆö‰πâÔºö</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">MaxVal</mi><mo>‚Å°</mo><mo>‚àí</mo><mi mathvariant="normal">MinVal</mi><mo>‚Å°</mo><mo>=</mo><mo stretchy="false">(</mo><mi>R</mi><mo>‚àí</mo><mi>L</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{MaxVal} - \operatorname{MinVal} = (R - L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mop"><span class="mord mathrm">MaxVal</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">‚àí</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm">MinVal</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span></span></p>
<p>Âç≥</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">MaxVal</mi><mo>‚Å°</mo><mo>‚àí</mo><mi mathvariant="normal">MinVal</mi><mo>‚Å°</mo><mo>‚àí</mo><mo stretchy="false">(</mo><mi>R</mi><mo>‚àí</mo><mi>L</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f_{R}(L) = \operatorname{MaxVal} - \operatorname{MinVal} - (R - L) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">MaxVal</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">‚àí</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm">MinVal</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">‚àí</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p>
<p>Ëøô‰∏™Êù°‰ª∂ÊàêÁ´ãÁöÑÂü∫Á°ÄÂú®‰∫éÔºåÊâÄÊ±ÇÊï∞Âàó‰∏çËÉΩÊúâÈáçÂ§çÂÖÉÁ¥†ÔºåËÄå‰∏î‰πü‰øùËØÅ‰∫ÜÂáΩÊï∞<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo><mo>‚â•</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f_x(L) \ge 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â•</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>,
Êü•ËØ¢Êó∂Âè™ÈúÄË¶ÅÁª¥Êä§<strong>ÊúÄÂ∞èÂÄº</strong>‰ª•ÂèäÊúÄÂ∞èÂÄºÁöÑ<strong>Êï∞Èáè</strong>Âç≥ÂèØ„ÄÇ</p>
<p>ÂèØ‰ª•ËÄÉËôëÊûö‰∏æ‰∏Ä‰∏™Á´ØÁÇπÔºåÊØîÂ¶ÇÂè≥Á´ØÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>ÔºåÁÑ∂ÂêéÊü•ÊâæÊúâÂ§öÂ∞ëÁ¨¶ÂêàÊù°‰ª∂ÁöÑÂ∑¶Á´ØÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span>
ÔºåÁî®Á∫øÊÆµÊ†ëÁª¥Êä§<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_R(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>Âú®ÊØè‰∏™ÁÇπÂ§ÑÁöÑÂáΩÊï∞ÂÄº„ÄÇ</p>
<p>ËÄÉËôëÂΩì<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_x(L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span>
ÁßªÂä®Âà∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_{x + 1}(L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span>
Êó∂Ôºå ÂÄºÁöÑÂèòÂåñ„ÄÇÂèòÂåñÁöÑÂÄºÊúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>
,
ÂèØËÉΩÂèòÂåñÁöÑÊúâ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>V</mi><mi>a</mi><mi>l</mi><mo separator="true">,</mo><mi>M</mi><mi>i</mi><mi>n</mi><mi>V</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">MaxVal, MinVal</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">inVa</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>„ÄÇÁî®ÂçïË∞ÉÊ†àÂÆûÊó∂Áª¥Êä§Êõ¥Êñ∞Âêé‰ºöÊ≥¢ÂèäÂì™‰∫õÂÖÉÁ¥†ÁöÑÊúÄÂ∞èÂÄº„ÄÇ‰∫ãÂÆû‰∏äÔºåÂçïË∞ÉÊ†àÂ§ÑÁêÜÁöÑËøáÁ®ãÂ∞±ÊòØÂú®Âä®ÊÄÅÁª¥Êä§‰∏Ä‰∏™ÂêéÁºÄÊúÄÂ∞è/Â§ßÂÄºÊï∞ÁªÑ„ÄÇ</p>
<p>ËøôÈáåÊúâÂá†‰∏™‰∏éÂÖ∂ÊúâÁõ∏‰ºº‰πãÂ§ÑÁöÑÈ¢òÁõÆÔºå‰ΩÜÊòØÂèØËÉΩÂÅöÊ≥ïÂπ∂‰∏ç‰∏ÄÊ†∑ÔºåÈÅáÂà∞‰∏çË¶ÅÊÉ≥Êàê‰∏ÄÊ†∑ÁöÑÈ¢òÁõÆÔºö
- <a
href="https://www.luogu.com.cn/problem/P5278">ÁÆóÊúØÂ§©Êâç‚ë®‰∏éÁ≠âÂ∑ÆÊï∞Âàó</a>
(‰∏ç‰øùËØÅÂ∫èÂàó‰∏≠‰∏ÄÂÆöÂÖÉÁ¥†‰∏çÈáçÂ§ç) - ËÄÉËôëÂà§Êñ≠‰∏Ä‰∏™Â∫èÂàóÊéíÂ•ΩÂ∫èÂêéÊòØÂê¶‰∏∫Á≠âÂ∑ÆÊï∞Âàó -
ÂáÜÁ°ÆÂÅöÊ≥ï -
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>‚Å°</mo><mo>‚àí</mo><mi>min</mi><mo>‚Å°</mo><mo>=</mo><mo stretchy="false">(</mo><mi>r</mi><mo>‚àí</mo><mi>l</mi><mo stretchy="false">)</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">\max‚àí\min=(r‚àíl)k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7512em;vertical-align:-0.0833em;"></span><span class="mop">max</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">‚àí</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
- Áõ∏ÈÇª‰∏§Êï∞Â∑ÆÁöÑÁªùÂØπÂÄºÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">gcd</mi><mo>‚Å°</mo></mrow><annotation encoding="application/x-tex">\operatorname{gcd}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mop"><span class="mord mathrm">gcd</span></span></span></span></span>ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
- Âå∫Èó¥
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>
ÂÜÖÁöÑÊï∞‰∏çÈáçÂ§ç - Ê¶ÇÁéáÊÄßÂÅöÊ≥ï - hashÊÄùÊÉ≥ÔºåÁª¥Êä§
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
Ê¨°ÊñπÂíå - <a
href="http://www.zhengruioi.com/contest/718/problem/1615">Ê†ë‰∏äÊéíÂàó(ZROI)</a>
(ÂêåÊ†∑‰∏ç‰øùËØÅÂÖÉÁ¥†‰∏ÄÂÆö‰∏çÈáçÂ§ç) - ÁªôÂÆö‰∏ÄÈ¢ó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
‰∏™ÁÇπÁöÑÊ†ë„ÄÇÊØè‰∏™ÁÇπÈÉΩ‰∏Ä‰∏™Ê≠£Êï¥Êï∞ÁÇπÊùÉ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
Ôºå‰Ω†ÈúÄË¶ÅÊîØÊåÅ‰ª•‰∏ã‰∏§ÁßçÊìç‰ΩúÔºö - 1„ÄÅËØ¢ÈóÆÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
ÂíåÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>
‰πãÈó¥ÁöÑË∑ØÂæÑ‰∏äÁöÑÊâÄÊúâÁÇπÔºàÂåÖÊã¨ÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
ÂíåÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>
ÔºâÁöÑÁÇπÊùÉÊòØÂê¶ÊûÑÊàê‰∏Ä‰∏™‰ªé
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>
ÂºÄÂßãÁöÑÊéíÂàóÔºàÂç≥Ëã•ËøôÊù°ÈìæÈïøÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">len</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span></span></span></span>
ÔºåÈÇ£‰πàÈóÆÁÇπÊùÉÈõÜÂêà‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>‚ãØ</mo><mo separator="true">,</mo><mi>l</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">{1,2,‚ãØ,len}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">‚ãØ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span></span></span></span></span>
Ôºâ„ÄÇ - 2„ÄÅÂ∞Ü
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">A_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
‰øÆÊîπ‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>
„ÄÇ - Áî±‰∫éÂú®Ê†ë‰∏äÈöæ‰ª•Âà§Êñ≠ÊüêÂå∫Èó¥ÂÜÖÁöÑÊï∞Â≠ó‰∏çÈáçÂ§çÔºåHashÁª¥Êä§nÊ¨°ÊñπÂíå„ÄÇ -
ÁªôÂá∫‰∏Ä‰∏™Ê≤°ÊúâÈáçÂ§çÂÖÉÁ¥†ÁöÑÂ∫èÂàóÔºåËØ¢ÈóÆÊüêÂå∫Èó¥‰∏≠ÁöÑÂÖÉÁ¥†ÊòØÂê¶ËÉΩÂä†ÂÖ•Â∞è‰∫é<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>‰∏™ÂÖÉÁ¥†‰ΩøÂÖ∂ÊãçÂ•ΩÂ∫èÂêéÊûÑÊàê‰∏Ä‰∏™Á≠âÂ∑ÆÊï∞Âàó„ÄÇ
- Êù°‰ª∂ÂèòÊàê‰∫Ü
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">MaxVal</mi><mo>‚Å°</mo><mo>‚àí</mo><mi mathvariant="normal">MinVal</mi><mo>‚Å°</mo><mo>‚àí</mo><mo stretchy="false">(</mo><mi>R</mi><mo>‚àí</mo><mi>L</mi><mo stretchy="false">)</mo><mo>‚â•</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">f_{R}(L) = \operatorname{MaxVal} - \operatorname{MinVal} - (R - L) \ge k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">MaxVal</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">‚àí</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm">MinVal</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">‚àí</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â•</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span>
- <a
href="http://www.zhengruioi.com/problem/1532">count(ZROI)</a>Â∑≤Áü•‰∏Ä‰∏™ÈõÜÂêà<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>‰∏≠ÁöÑÊúÄÂ§ßÂÖÉÁ¥†‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>Ôºå
‰∏îËøô‰∏™ÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†ÂèØ‰ª•ÊûÑÊàê‰∏Ä‰∏™Á≠âÂ∑ÆÊï∞ÂàóÔºåÁªôÂá∫‰∏Ä‰∫õÂΩ¢Â¶Ç<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>‚àà</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">x \in S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>„ÄÅ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo mathvariant="normal">‚àâ</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">x \notin S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord"><span class="mrel">‚àà</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:0.0556em;"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>ÁöÑÈôêÂà∂„ÄÇÊ±ÇÊúÄÁªàÁöÑÈõÜÂêàÊúâÂ§öÂ∞ëÁßçÊÉÖÂÜµ„ÄÇ
-
ËÄÉËôëÂàªÁîª‰∏Ä‰∏™Á≠âÂ∑ÆÊï∞ÂàóÈúÄË¶Å‰ªÄ‰πàÂèÇÊï∞ÔºöÂÖ¨Â∑ÆÔºåÂíåÊØè‰∏™ÂÖÉÁ¥†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>‚Ää</mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext>‚Ää</mtext></mrow><annotation encoding="application/x-tex">\bmod</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span></span></span></span>
ÂÖ¨Â∑ÆÁöÑÂÄº„ÄÇÊûö‰∏æËøô‰∏§‰∏™ÂèÇÊï∞Ôºå‰æùÊ¨°ËÆ°Êï∞Âç≥ÂèØ„ÄÇ</p>
<p>ÔºàÂºïÁî®Ê≠£ÁùøÁöÑ‰∏§ÈÅìÈ¢òÁõÆÔºå‰∏çÁü•ÈÅìÊòØ‰∏çÊòØÊúâÁâàÊùÉÈóÆÈ¢òÔºåÂ¶ÇÊûúÊúâÔºå‰ºöÁ´ãÂç≥Âà†Èô§Ôºà<del>È°∫‰æøÁªôÊ≠£ÁùøOIÊâì‰∏™ÂπøÂëä</del>ÔºâÔºâ„ÄÇ</p>
<h2 id="code-1">code</h2>
<div class="sourceCode" id="cb3"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> A<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#define fir </span>first</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define sec </span>second</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> SegmentTree<span class="op">{</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">3e6</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Node<span class="op">{</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> MIN<span class="op">;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> sMIN<span class="op">;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> tar<span class="op">;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        Node <span class="kw">operator</span> <span class="op">+</span> <span class="op">(</span><span class="at">const</span> Node <span class="op">&amp;</span> rhs<span class="op">)</span> <span class="at">const</span> <span class="op">{</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            Node res<span class="op">;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>            res<span class="op">.</span>MIN  <span class="op">=</span> min<span class="op">(</span>MIN<span class="op">,</span> rhs<span class="op">.</span>MIN<span class="op">);</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>            res<span class="op">.</span>sMIN <span class="op">=</span> MIN <span class="op">==</span> rhs<span class="op">.</span>MIN <span class="op">?</span> <span class="op">(</span> sMIN <span class="op">+</span> rhs<span class="op">.</span>sMIN<span class="op">)</span> <span class="op">:</span> <span class="op">(</span>MIN <span class="op">&lt;</span> rhs<span class="op">.</span>MIN <span class="op">?</span> sMIN <span class="op">:</span> rhs<span class="op">.</span>sMIN<span class="op">)</span> <span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>v<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ch<span class="op">[</span>_<span class="op">][</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define ls</span><span class="op">(</span>o<span class="op">)</span><span class="pp"> </span><span class="op">(</span>ch<span class="op">[</span>o<span class="op">][</span><span class="dv">0</span><span class="op">])</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define rs</span><span class="op">(</span>o<span class="op">)</span><span class="pp"> </span><span class="op">(</span>ch<span class="op">[</span>o<span class="op">][</span><span class="dv">1</span><span class="op">])</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define make </span><span class="op">(</span>tot<span class="op">++,</span><span class="pp"> </span>ch<span class="op">[</span>tot<span class="op">][</span><span class="dv">0</span><span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span>ch<span class="op">[</span>tot<span class="op">][</span><span class="dv">1</span><span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span>v<span class="op">[</span>tot<span class="op">].</span>MIN<span class="pp"> </span><span class="op">=</span><span class="pp"> </span>v<span class="op">[</span>tot<span class="op">].</span>sMIN<span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="dv">0</span><span class="op">,</span><span class="pp"> </span>tot<span class="op">)</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> Groot<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> make<span class="op">;</span> <span class="op">}</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> maintain<span class="op">(</span><span class="dt">int</span> o<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        v<span class="op">[</span>o<span class="op">].</span>MIN  <span class="op">=</span> min<span class="op">(</span>v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>MIN<span class="op">,</span> v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>MIN<span class="op">);</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        v<span class="op">[</span>o<span class="op">].</span>sMIN <span class="op">=</span> v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>MIN <span class="op">==</span> v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>MIN <span class="op">?</span> v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>sMIN <span class="op">+</span> v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>sMIN <span class="op">:</span> <span class="op">(</span> v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>MIN <span class="op">&lt;</span> v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>MIN <span class="op">?</span> v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>sMIN <span class="op">:</span> v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>sMIN <span class="op">);</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> tar<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span> v<span class="op">[</span>o<span class="op">].</span>MIN <span class="op">+=</span> x<span class="op">;</span> v<span class="op">[</span>o<span class="op">].</span>tar <span class="op">+=</span> x<span class="op">;</span> <span class="op">}</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> pushdown<span class="op">(</span><span class="dt">int</span> o<span class="op">){</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>v<span class="op">[</span>o<span class="op">].</span>tar<span class="op">){</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>            tar<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> v<span class="op">[</span>o<span class="op">].</span>tar<span class="op">);</span> tar<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> v<span class="op">[</span>o<span class="op">].</span>tar<span class="op">);</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>            v<span class="op">[</span>o<span class="op">].</span>tar <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> build<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">==</span> R<span class="op">)</span> <span class="op">{</span> v<span class="op">[</span>o<span class="op">].</span>MIN <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> v<span class="op">[</span>o<span class="op">].</span>sMIN <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        ls<span class="op">(</span>o<span class="op">)</span> <span class="op">=</span> make<span class="op">;</span> rs<span class="op">(</span>o<span class="op">)</span> <span class="op">=</span> make<span class="op">;</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        build<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> L<span class="op">,</span> mid<span class="op">);</span> build<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        maintain<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> update<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">,</span> <span class="dt">int</span> x<span class="op">){</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&gt;</span> R<span class="op">)</span> <span class="cf">return</span> <span class="op">;</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> nowl <span class="op">&amp;&amp;</span> nowr <span class="op">&lt;=</span> R<span class="op">)</span> <span class="cf">return</span> tar<span class="op">(</span>o<span class="op">,</span> x<span class="op">);</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span>  pushdown<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> mid<span class="op">)</span> update<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> x<span class="op">);</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>R  <span class="op">&gt;</span> mid<span class="op">)</span> update<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> x<span class="op">);</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        maintain<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    Node query<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> nowl <span class="op">&amp;&amp;</span> nowr <span class="op">&lt;=</span> R<span class="op">)</span> <span class="cf">return</span> v<span class="op">[</span>o<span class="op">];</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span> pushdown<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        Node Ans<span class="op">;</span> Ans<span class="op">.</span>MIN <span class="op">=</span> INT_MAX<span class="op">;</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> mid<span class="op">)</span> Ans <span class="op">=</span> Ans <span class="op">+</span> query<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> L<span class="op">,</span> R<span class="op">);</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>R  <span class="op">&gt;</span> mid<span class="op">)</span> Ans <span class="op">=</span> Ans <span class="op">+</span> query<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> L<span class="op">,</span> R<span class="op">);</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Ans<span class="op">;</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> query<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>        Node res <span class="op">=</span> query<span class="op">(</span>o<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> L<span class="op">,</span> R<span class="op">);</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> res<span class="op">.</span>MIN <span class="op">==</span> <span class="dv">0</span> <span class="op">?</span> res<span class="op">.</span>sMIN <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>  <span class="kw">using</span> SegmentTree<span class="op">::</span>Groot<span class="op">;</span> <span class="kw">using</span> SegmentTree<span class="op">::</span>build<span class="op">;</span> <span class="kw">using</span> SegmentTree<span class="op">::</span>query<span class="op">;</span> <span class="kw">using</span> SegmentTree<span class="op">::</span>update<span class="op">;</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> Mon_Stack<span class="op">{</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> t0t <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> t1t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> S0<span class="op">[</span>_<span class="op">],</span> S1<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> work<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>A<span class="op">,</span> <span class="dt">int</span> n<span class="op">){</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> Ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> root <span class="op">=</span> Groot<span class="op">();</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>        build<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>        S0<span class="op">[</span><span class="dv">0</span><span class="op">].</span>fir <span class="op">=</span> S1<span class="op">[</span><span class="dv">0</span><span class="op">].</span>fir <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>            update<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span><span class="op">(</span>t0t <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> S0<span class="op">[</span>t0t<span class="op">].</span>sec <span class="op">&gt;=</span> A<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span> update<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> S0<span class="op">[</span>t0t <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>fir <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> S0<span class="op">[</span>t0t<span class="op">].</span>fir<span class="op">,</span>  S0<span class="op">[</span>t0t<span class="op">].</span>sec<span class="op">);</span> t0t<span class="op">--;</span> <span class="op">}</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span><span class="op">(</span>t1t <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> S1<span class="op">[</span>t1t<span class="op">].</span>sec <span class="op">&lt;=</span> A<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span> update<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> S1<span class="op">[</span>t1t <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>fir <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> S1<span class="op">[</span>t1t<span class="op">].</span>fir<span class="op">,</span> <span class="op">-</span>S1<span class="op">[</span>t1t<span class="op">].</span>sec<span class="op">);</span> t1t<span class="op">--;</span> <span class="op">}</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>            update<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> S0<span class="op">[</span>t0t<span class="op">].</span>fir <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> i<span class="op">,</span> <span class="op">-</span>A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>            update<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> S1<span class="op">[</span>t1t<span class="op">].</span>fir <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> i<span class="op">,</span> A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> t <span class="op">=</span> query<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> i<span class="op">);</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>            Ans <span class="op">+=</span> t<span class="op">;</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>            S0<span class="op">[++</span>t0t<span class="op">]</span> <span class="op">=</span> make_pair<span class="op">(</span>i<span class="op">,</span> A<span class="op">[</span>i<span class="op">]);</span> S1<span class="op">[++</span>t1t<span class="op">]</span> <span class="op">=</span> make_pair<span class="op">(</span>i<span class="op">,</span> A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Ans<span class="op">;</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="kw">using</span> Mon_Stack<span class="op">::</span>work<span class="op">;</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a><span class="dt">signed</span> main<span class="op">(){</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> read<span class="op">();</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span> <span class="dt">int</span> x <span class="op">=</span> read<span class="op">(),</span> y <span class="op">=</span> read<span class="op">();</span> A<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> y<span class="op">;</span> <span class="op">}</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> work<span class="op">(</span>A<span class="op">,</span> n<span class="op">));</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;climits&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cmath&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#define int </span><span class="dt">long</span><span class="pp"> </span><span class="dt">long</span><span class="pp"> </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MOD <span class="op">=</span> <span class="fl">1e9</span> <span class="op">+</span> <span class="dv">7</span><span class="op">;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _M <span class="op">=</span> <span class="fl">2e5</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">int</span> read<span class="op">()</span> <span class="op">{</span> <span class="dt">char</span> c <span class="op">=</span> getchar<span class="op">();</span> <span class="dt">int</span> sign <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="dt">int</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span><span class="op">(</span>c <span class="op">&gt;</span> <span class="ch">&#39;9&#39;</span> <span class="op">||</span> c <span class="op">&lt;</span> <span class="ch">&#39;0&#39;</span><span class="op">)</span> <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>c<span class="op">==</span><span class="ch">&#39;-&#39;</span><span class="op">)</span>sign <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span> c <span class="op">=</span> getchar<span class="op">();</span> <span class="op">}</span> <span class="cf">while</span><span class="op">(</span>c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span><span class="op">)</span> <span class="op">{</span> x <span class="op">*=</span> <span class="dv">10</span><span class="op">;</span> x <span class="op">+=</span> c <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">;</span> c <span class="op">=</span> getchar<span class="op">();</span> <span class="op">}</span> <span class="cf">return</span> x <span class="op">*</span> sign<span class="op">;</span> <span class="op">}</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> MAX<span class="op">,</span> m<span class="op">;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> have<span class="op">[</span>_M<span class="op">],</span> tht <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> none<span class="op">[</span>_M<span class="op">],</span> tnt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> d<span class="op">[</span>_M<span class="op">],</span> tdt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> c<span class="op">[</span>_M<span class="op">];</span><span class="co">//tct = tdt</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> CanBe<span class="op">[</span>_M<span class="op">];</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ToL<span class="op">[</span>_M<span class="op">];</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ToR<span class="op">[</span>_M<span class="op">];</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> divide<span class="op">(</span><span class="dt">int</span> s<span class="op">,</span> <span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">*</span> i <span class="op">&lt;=</span> x<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>x <span class="op">%</span> i <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> d<span class="op">[++</span>tdt<span class="op">]</span> <span class="op">=</span> i<span class="op">,</span> c<span class="op">[</span>tdt<span class="op">]</span> <span class="op">=</span> s <span class="op">%</span> i<span class="op">;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>i <span class="op">*</span> i <span class="op">!=</span> x<span class="op">)</span> d<span class="op">[++</span>tdt<span class="op">]</span> <span class="op">=</span> x <span class="op">/</span> i<span class="op">,</span> c<span class="op">[</span>tdt<span class="op">]</span> <span class="op">=</span> s <span class="op">%</span> d<span class="op">[</span>tdt<span class="op">];</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> tdt<span class="op">;</span> i<span class="op">++)</span> CanBe<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="dt">signed</span> main<span class="op">(){</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> t<span class="op">;</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    MAX <span class="op">=</span> read<span class="op">(),</span> m <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> m<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> type <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>type <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> have<span class="op">[++</span>tht<span class="op">]</span> <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>          none<span class="op">[++</span>tnt<span class="op">]</span> <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>have <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> have <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> tht<span class="op">);</span> sort<span class="op">(</span>none <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> none <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> tnt<span class="op">);</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> maxd <span class="op">=</span> INT_MAX<span class="op">,</span> Sta<span class="op">;</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> tht<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>maxd <span class="op">&gt;</span> have<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> have<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]){</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>            maxd <span class="op">=</span> have<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> have<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>            Sta <span class="op">=</span> have<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    divide<span class="op">(</span>Sta<span class="op">,</span> maxd<span class="op">);</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* ÂÖ¨Â∑Æ Âèä ÁâπÂæÅ Ê£ÄÊü•   */</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> tht<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> tdt<span class="op">;</span> j<span class="op">++){</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(!</span>CanBe<span class="op">[</span>j<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>have<span class="op">[</span>i<span class="op">]</span> <span class="op">%</span> d<span class="op">[</span>j<span class="op">]</span> <span class="op">!=</span> c<span class="op">[</span>j<span class="op">])</span> CanBe<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> tht<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> D <span class="op">=</span> have<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> have<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> tdt<span class="op">;</span> j<span class="op">++){</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(!</span>CanBe<span class="op">[</span>j<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>D <span class="op">%</span> d<span class="op">[</span>j<span class="op">]</span> <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> CanBe<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> tdt<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>CanBe<span class="op">[</span>i<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>        d<span class="op">[++</span>t<span class="op">]</span> <span class="op">=</span> d<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>        c<span class="op">[</span>  t<span class="op">]</span> <span class="op">=</span> c<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>        CanBe<span class="op">[</span>t<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> tdt <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* ÂÖ¨Â∑Æ Âèä ÁâπÂæÅ Ê£ÄÊü•   ÂÆåÊàê*/</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> tdt<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span> </span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>CanBe<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>            ToL<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>c<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">?</span> d<span class="op">[</span>i<span class="op">]</span> <span class="op">:</span> c<span class="op">[</span>i<span class="op">])</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> t <span class="op">=</span> MAX <span class="op">%</span> d<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>t <span class="op">==</span> c<span class="op">[</span>i<span class="op">])</span> ToR<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> MAX <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>t  <span class="op">&gt;</span> c<span class="op">[</span>i<span class="op">])</span> ToR<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> MAX <span class="op">-</span> <span class="op">(</span>t <span class="op">-</span> c<span class="op">[</span>i<span class="op">])</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>t  <span class="op">&lt;</span> c<span class="op">[</span>i<span class="op">])</span> ToR<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> MAX <span class="op">-</span> d<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> <span class="op">(</span>c<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> t<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> tdt<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>CanBe<span class="op">[</span>i<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>        d<span class="op">[++</span>t<span class="op">]</span> <span class="op">=</span> d<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>        c<span class="op">[</span>  t<span class="op">]</span> <span class="op">=</span> c<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>        CanBe<span class="op">[</span>t<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> tdt <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> MINS <span class="op">=</span> have<span class="op">[</span><span class="dv">1</span><span class="op">],</span> MAXE <span class="op">=</span> have<span class="op">[</span>tht<span class="op">];</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> tnt<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> now <span class="op">=</span> none<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> tdt<span class="op">;</span> j<span class="op">++){</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(!</span>CanBe<span class="op">[</span>j<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>now <span class="op">%</span> d<span class="op">[</span>j<span class="op">]</span> <span class="op">==</span> c<span class="op">[</span>j<span class="op">]){</span></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span><span class="op">(</span>now <span class="op">&lt;</span> MINS<span class="op">)</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>                    ToL<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>ToL<span class="op">[</span>j<span class="op">],</span> now<span class="op">);</span></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>now <span class="op">&gt;</span> MAXE<span class="op">)</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>                    ToR<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>ToR<span class="op">[</span>j<span class="op">],</span> now<span class="op">);</span></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> CanBe<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> tdt<span class="op">;</span> i<span class="op">++)</span> <span class="cf">if</span><span class="op">(</span>ToL<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> MINS <span class="op">||</span> ToR<span class="op">[</span>i<span class="op">]</span> <span class="op">&lt;</span> MAXE<span class="op">)</span> CanBe<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span> <span class="cf">else</span> ToL<span class="op">[</span>i<span class="op">]++,</span> ToR<span class="op">[</span>i<span class="op">]</span> <span class="op">--;</span></span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* ÈùûÊ≥ïÊï∞Â≠óÂ≠òÂú®ÊÄßÊ£ÄÊü• */</span></span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> tdt<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>CanBe<span class="op">[</span>i<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> k <span class="op">=</span> <span class="op">(</span>  <span class="op">(</span>MINS <span class="op">-</span> ToL<span class="op">[</span>i<span class="op">])</span> <span class="op">/</span> d<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span> <span class="op">(</span>ToR<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> MAXE<span class="op">)</span> <span class="op">/</span> d<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span> <span class="co">// </span><span class="al">TODO</span><span class="co">;</span></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span> k<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;climits&gt;</span><span class="pp"> </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cmath&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">int</span> read<span class="op">()</span> <span class="op">{</span> <span class="dt">char</span> c <span class="op">=</span> getchar<span class="op">();</span> <span class="dt">int</span> sign <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="dt">int</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span><span class="op">(</span>c <span class="op">&gt;</span> <span class="ch">&#39;9&#39;</span> <span class="op">||</span> c <span class="op">&lt;</span> <span class="ch">&#39;0&#39;</span><span class="op">)</span> <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>c<span class="op">==</span><span class="ch">&#39;-&#39;</span><span class="op">)</span>sign <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span> c <span class="op">=</span> getchar<span class="op">();</span> <span class="op">}</span> <span class="cf">while</span><span class="op">(</span>c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span><span class="op">)</span> <span class="op">{</span> x <span class="op">*=</span> <span class="dv">10</span><span class="op">;</span> x <span class="op">+=</span> c <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">;</span> c <span class="op">=</span> getchar<span class="op">();</span> <span class="op">}</span> <span class="cf">return</span> x <span class="op">*</span> sign<span class="op">;</span> <span class="op">}</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">6e5</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> base <span class="op">=</span> <span class="dv">15</span><span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MOD <span class="op">=</span> <span class="dv">1020031005</span><span class="op">;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> SS<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> pow<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b <span class="op">=</span> base<span class="op">){</span> <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">while</span><span class="op">(</span>b<span class="op">){</span> <span class="cf">if</span><span class="op">(</span>b <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> a<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span> a <span class="op">=</span> <span class="op">(</span>a <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> a<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span> b <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span> <span class="cf">return</span> ans<span class="op">;</span> <span class="op">}</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> head<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> NodeVal<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> edges<span class="op">{</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> node<span class="op">;</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> nxt<span class="op">;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>edge<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> add<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> v<span class="op">){</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    tot<span class="op">++;</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    edge<span class="op">[</span>tot<span class="op">].</span>node <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    edge<span class="op">[</span>tot<span class="op">].</span>nxt  <span class="op">=</span> head<span class="op">[</span>u<span class="op">];</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    head<span class="op">[</span>u<span class="op">]</span>        <span class="op">=</span> tot<span class="op">;</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> q<span class="op">;</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dep<span class="op">[</span>_<span class="op">],</span> fa<span class="op">[</span>_<span class="op">],</span> dfn<span class="op">[</span>_<span class="op">],</span> rnk<span class="op">[</span>_<span class="op">],</span> top<span class="op">[</span>_<span class="op">],</span> son<span class="op">[</span>_<span class="op">],</span> si<span class="op">[</span>_<span class="op">],</span> dfc <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs0<span class="op">(</span><span class="dt">int</span> now<span class="op">,</span> <span class="dt">int</span> f<span class="op">,</span> <span class="dt">int</span> dp<span class="op">){</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">&amp;</span>S <span class="op">=</span> si<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="dt">int</span> <span class="op">&amp;</span>Mid <span class="op">=</span> son<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> fa<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> f<span class="op">;</span> dep<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> dp<span class="op">;</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span> i <span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span> <span class="cf">if</span><span class="op">(</span>ex <span class="op">==</span> f<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>        dfs0<span class="op">(</span>ex<span class="op">,</span> now<span class="op">,</span> dp <span class="op">+</span> <span class="dv">1</span><span class="op">);</span> S <span class="op">+=</span> si<span class="op">[</span>ex<span class="op">];</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>si<span class="op">[</span>ex<span class="op">]</span> <span class="op">&gt;</span> si<span class="op">[</span>Mid<span class="op">])</span> Mid <span class="op">=</span> ex<span class="op">;</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">if</span><span class="op">(!</span>Mid<span class="op">)</span> Mid <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs1<span class="op">(</span><span class="dt">int</span> now<span class="op">,</span> <span class="dt">int</span> f<span class="op">,</span> <span class="dt">int</span> tp<span class="op">){</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    dfn<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> <span class="op">++</span>dfc<span class="op">;</span> rnk<span class="op">[</span>dfc<span class="op">]</span> <span class="op">=</span> now<span class="op">;</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    top<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> tp<span class="op">;</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>son<span class="op">[</span>now<span class="op">])</span> dfs1<span class="op">(</span>son<span class="op">[</span>now<span class="op">],</span> now<span class="op">,</span> tp<span class="op">);</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span> i <span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span> <span class="cf">if</span><span class="op">(</span>ex <span class="op">==</span> f <span class="op">||</span> ex <span class="op">==</span> son<span class="op">[</span>now<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>        dfs1<span class="op">(</span>ex<span class="op">,</span> now<span class="op">,</span> ex<span class="op">);</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> clear<span class="op">(){</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    memset<span class="op">(</span>head<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>head<span class="op">));</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    dfn<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> rnk<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> si<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> top<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> fa<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> son<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>    dfc <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> </span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> SegmentTree<span class="op">{</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">3e6</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ch<span class="op">[</span>_<span class="op">][</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> v<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define make </span><span class="op">(</span>tot<span class="op">++,</span><span class="pp"> </span>ch<span class="op">[</span>tot<span class="op">][</span><span class="dv">0</span><span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span>ch<span class="op">[</span>tot<span class="op">][</span><span class="dv">1</span><span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span>v<span class="op">[</span>tot<span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="dv">0</span><span class="op">,</span><span class="pp"> </span>tot<span class="op">);</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define ls</span><span class="op">(</span>x<span class="op">)</span><span class="pp"> </span><span class="op">(</span>ch<span class="op">[</span>x<span class="op">][</span><span class="dv">0</span><span class="op">])</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define rs</span><span class="op">(</span>x<span class="op">)</span><span class="pp"> </span><span class="op">(</span>ch<span class="op">[</span>x<span class="op">][</span><span class="dv">1</span><span class="op">])</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define maintain</span><span class="op">(</span>o<span class="op">)</span><span class="pp"> </span><span class="op">(</span>v<span class="op">[</span>o<span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="op">(</span>v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)]</span><span class="pp"> </span><span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span><span class="pp"> </span>v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)])</span><span class="pp"> </span><span class="op">%</span><span class="pp"> </span>MOD<span class="pp"> </span><span class="op">)</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> init_s<span class="op">()</span> <span class="op">{</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span>  Groot<span class="op">(){</span> <span class="cf">return</span> make<span class="op">;</span> <span class="op">}</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> build<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">==</span> R<span class="op">)</span> <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">)(</span>v<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> pow<span class="op">(</span>NodeVal<span class="op">[</span>rnk<span class="op">[</span>L<span class="op">]]));</span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>        ls<span class="op">(</span>o<span class="op">)</span> <span class="op">=</span> make<span class="op">;</span> rs<span class="op">(</span>o<span class="op">)</span> <span class="op">=</span> make<span class="op">;</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>        build<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> L<span class="op">,</span> mid<span class="op">);</span> build<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>        maintain<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> update<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> p<span class="op">,</span> <span class="dt">int</span> x<span class="op">){</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>nowl <span class="op">==</span> nowr<span class="op">)</span> <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">)(</span>v<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> pow<span class="op">(</span>x<span class="op">));</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>p <span class="op">&lt;=</span> mid<span class="op">)</span> update<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> p<span class="op">,</span> x<span class="op">);</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>p  <span class="op">&gt;</span> mid<span class="op">)</span> update<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> p<span class="op">,</span> x<span class="op">);</span></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>        maintain<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> query<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&gt;</span> R<span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> nowl <span class="op">&amp;&amp;</span> nowr <span class="op">&lt;=</span> R<span class="op">)</span> <span class="cf">return</span> v<span class="op">[</span>o<span class="op">];</span></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> mid<span class="op">)</span> ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> query<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> L<span class="op">,</span> R<span class="op">))</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>R  <span class="op">&gt;</span> mid<span class="op">)</span> ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> query<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> L<span class="op">,</span> R<span class="op">))</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="kw">using</span> SegmentTree<span class="op">::</span>Groot<span class="op">;</span> <span class="kw">using</span> SegmentTree<span class="op">::</span>init_s<span class="op">;</span> <span class="kw">using</span> SegmentTree<span class="op">::</span>build<span class="op">;</span> <span class="kw">using</span> SegmentTree<span class="op">::</span>update<span class="op">;</span> <span class="kw">using</span> SegmentTree<span class="op">::</span>query<span class="op">;</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> root <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> LCA<span class="op">;</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> QueryOnPath<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">){</span></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>top<span class="op">[</span>x<span class="op">]</span> <span class="op">!=</span> top<span class="op">[</span>y<span class="op">]){</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>dep<span class="op">[</span>top<span class="op">[</span>x<span class="op">]]</span> <span class="op">&gt;</span> dep<span class="op">[</span>top<span class="op">[</span>y<span class="op">]])</span> swap<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> query<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> dfn<span class="op">[</span>top<span class="op">[</span>y<span class="op">]],</span> dfn<span class="op">[</span>y<span class="op">]))</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> fa<span class="op">[</span>top<span class="op">[</span>y<span class="op">]];</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>dep<span class="op">[</span>x<span class="op">]</span> <span class="op">&lt;</span> dep<span class="op">[</span>y<span class="op">])</span> swap<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> LCA <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> query<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> dfn<span class="op">[</span>y<span class="op">],</span> dfn<span class="op">[</span>x<span class="op">]))</span> <span class="op">%</span> MOD<span class="op">;</span> </span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> doit<span class="op">(){</span></span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>    clear<span class="op">();</span></span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> read<span class="op">(),</span> q <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> NodeVal<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span>  n<span class="op">;</span> i<span class="op">++){</span> <span class="dt">int</span> u <span class="op">=</span> read<span class="op">(),</span> v <span class="op">=</span> read<span class="op">();</span> add<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span> add<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span> <span class="op">}</span></span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>    dfs0<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>    dfs1<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>    init_s<span class="op">();</span> root <span class="op">=</span> Groot<span class="op">();</span></span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>    build<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>q<span class="op">--){</span></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> opt <span class="op">=</span> read<span class="op">(),</span> x <span class="op">=</span> read<span class="op">(),</span> y <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>opt <span class="op">==</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> r <span class="op">=</span> QueryOnPath<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> Len <span class="op">=</span> dep<span class="op">[</span>x<span class="op">]</span> <span class="op">+</span> dep<span class="op">[</span>y<span class="op">]</span> <span class="op">-</span> <span class="op">(</span>dep<span class="op">[</span>LCA<span class="op">]</span> <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>            puts<span class="op">(</span>SS<span class="op">[</span>Len<span class="op">]</span> <span class="op">==</span> r <span class="op">?</span> <span class="st">&quot;Yes&quot;</span> <span class="op">:</span> <span class="st">&quot;No&quot;</span><span class="op">);</span></span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span><span class="op">{</span></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>            update<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> dfn<span class="op">[</span>x<span class="op">],</span> y<span class="op">);</span></span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="fl">3e5</span><span class="op">;</span> i<span class="op">++)</span> SS<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span> SS<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> pow<span class="op">(</span>i<span class="op">)</span> <span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> T <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>T<span class="op">--)</span> doit<span class="op">();</span></span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="cf521e-cycling-city">CF521E Cycling City</h1>
<ul>
<li>ÁªôÂÆö‰∏ÄÂº†
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
‰∏™ÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>
Êù°ËæπÁöÑÊó†ÂêëÁÆÄÂçïÂõæ„ÄÇ</li>
<li>ÈóÆÂõæ‰∏≠ËÉΩÂê¶ÊâæÂà∞‰∏§‰∏™ÁÇπÔºåÊª°Ë∂≥Ëøô‰∏§‰∏™ÁÇπ‰πãÈó¥ÊúâËá≥Â∞ë‰∏âÊù°ÂÆåÂÖ®‰∏çÁõ∏‰∫§ÁöÑÁÆÄÂçïË∑ØÂæÑ„ÄÇ</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo>‚â§</mo><mn>2</mn><mo>√ó</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">n,m \le 2 \times 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span>ÔºåÂõæ‰∏ç‰øùËØÅËøûÈÄö</li>
</ul>
<p>ËÄÉËôëÁîüÊàêÊ†ëÔºåÂØπÂéüÂõæÂÅö‰∏Ä‰∏™ÁîüÊàêÊ†ëÔºåËÄÉËôëÊØè‰∏™Âú®ÁîüÊàêÊ†ëÂ§ñÁöÑËæπÔºåË¶ÜÁõñÂú®Ê†ë‰∏äÔºåÊ†ë‰∏äËæπË¢´Ë¶ÜÁõñ‰∏§Ê¨°ÁöÑÔºåÂç≥‰∏∫‰∏ÄÁßçÊñπÊ°à</p>
<p>Áî±‰∫éÊ†ëÁöÑÊãìÊâëÁªìÊûÑÊØîÂõæË¶ÅÁÆÄÂçïÂæàÂ§öÔºåÁõ¥Êé•ÊÄùËÄÉÂõæÁöÑÁîüÊàêÊ†ëËß£ÂÜ≥ÂõæÂÜÖÈóÆÈ¢òÊòØ‰∏Ä‰∏™Â∏∏ËßÅÊÄùË∑Ø„ÄÇ</p>
<h1 id="cf547d-mike-and-fish">CF547D Mike and Fish</h1>
<p><strong>ÂæÖÂ°´</strong></p>
                                    </div>

                                    <!-- Article Footer -->
                                    <div class="article-footer">
                                                                            
                                        <section class="post-history">
                                            <div class="history-header">
                                                <h2>üìö Version History</h2>
                                                <span class="history-desc">Source Code Change History</span>
                                            </div>
                                            <div class="version-list">
                                                
                                                    <div class="version-item">
                                                        <div class="version-header">
                                                            <span class="version-badge">v1</span>
                                                            <time class="version-time" datetime="2020-10-19 17:05:04">
                                                                üìÖ 2020-10-19 17:05:04
                                                            </time>
                                                        </div>
                                                        <div class="version-hash-container">
                                                            <span class="hash-label">üîó Source Hash:</span>
                                                            <code class="version-hash" title="Source Code Hash (8a8fc399df311c0620a45f107a1a0bca6e37f6b130ecdc0287d077e9ba302c69)">8a8fc399df311c0620a45f107a1a0bca6e37f6b130ecdc0287d077e9ba302c69</code>
                                                        </div>
                                                    </div>
                                                
                                            </div>
                                        </section>
                    

                    
                                            <details class="build-logs">
                                                <summary>Build Logs</summary>
                                                <pre class="logs-content">Build Log - Filtered
================================================

üìã Information:
‚Ä¢ Path information has been filtered for privacy protection
‚Ä¢ File names are preserved for debugging purposes  
‚Ä¢ All build status and error messages are kept intact

üîç Filter Rules:
‚Ä¢ /absolute/path/file.ext ‚Üí .../file.ext
‚Ä¢ /home/username ‚Üí .../[user]
‚Ä¢ /tmp/files ‚Üí .../[temp]
‚Ä¢ /usr/share/packages ‚Üí .../[system]

================================================

html log:
CMD: ['pandoc', '-s', 'cache/oi-blog_„ÄåÊùÇÈ¢òËÆ∞ÂΩï„ÄçIOI2020ÂõΩÂÆ∂ÈõÜËÆ≠Èòü‰Ωú‰∏ö-Part-1.md', '--filter', 'pandoc-crossref', '--filter', 'pandoc-katex', '--template=cache/pandoc_html_template.html', '-o', 'cache.../oi-blog_„ÄåÊùÇÈ¢òËÆ∞ÂΩï„ÄçIOI2020ÂõΩÂÆ∂ÈõÜËÆ≠Èòü‰Ωú‰∏ö-Part-1.md.html', '--metadata', '--verbose', '--highlight-style=tango']
STDOUT: 
STDERR: WARNING: pandoc-crossref was compiled with pandoc 3.6.2 but is being run through 3.6.4. This is not supported. Strange things may (and likely will) happen silently.

====================================================================================================
pdf log:
CMD: ['pandoc', '-s', 'cache.../581f3e7c80.pdf.md', '-o', 'cache/581f3e7c80.pdf', '-H', 'static/pandoc.header.tex', '--pdf-engine=xelatex', '--verbose']
STDOUT: 
STDERR: [INFO] Loaded static.../pandoc.header.tex from static.../pandoc.header.tex
[INFO] Not rendering RawInline (Format "html") "<!-- more -->"
[INFO] [makePDF] Temp dir:
  .../[temp]
[INFO] [makePDF] Command line:
  xelatex "-halt-on-error" "-interaction" "nonstopmode" "-output-directory" ".../[temp] ".../[temp]
[INFO] [makePDF] Relevant environment variables:
  ("TEXINPUTS",".../[temp]
  ("TEXMFOUTPUT",".../[temp]
  ("SHELL","/bin/bash")
  ("PWD",".../[user]/projects/blog")
  ("HOME",".../[user]
  ("LANG","zh_CN.UTF-8")
  ("PATH",".../[user]/.local/bin:.../[user]/.cargo/bin:.../[user]/miniconda3/envs/myblog/bin:.../[user]/miniconda3/condabin:.../[temp]
[INFO] [makePDF] Source:
  % Options for packages loaded elsewhere
  \PassOptionsToPackage{unicode}{hyperref}
  \PassOptionsToPackage{hyphens}{url}
  \PassOptionsToPackage{space}{xeCJK}
  \documentclass[
  ]{article}
  \usepackage{xcolor}
  \usepackage[a4paper,margin=2cm]{geometry}
  \usepackage{amsmath,amssymb}
  \setcounter{secnumdepth}{-\maxdimen} % remove section numbering
  \usepackage{iftex}
  \ifPDFTeX
    \usepackage[T1]{fontenc}
    \usepackage[utf8]{inputenc}
    \usepackage{textcomp} % provide euro and other symbols
  \else % if luatex or xetex
    \usepackage{unicode-math} % this also loads fontspec
    \defaultfontfeatures{Scale=MatchLowercase}
    \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
  \fi
  \usepackage{lmodern}
  \ifPDFTeX\else
    % xetex/luatex font selection
    \setmainfont[]{Latin Modern Roman}
    \ifXeTeX
      \usepackage{xeCJK}
      \setCJKmainfont[]{AR PL UKai CN}
    \fi
    \ifLuaTeX
      \usepackage[]{luatexja-fontspec}
      \setmainjfont[]{AR PL UKai CN}
    \fi
  \fi
  % Use upquote if available, for straight quotes in verbatim environments
  \IfFileExists{upquote.sty}{\usepackage{upquote}}{}
  \IfFileExists{microtype.sty}{% use microtype if available
    \usepackage[]{microtype}
    \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
  }{}
  \usepackage{setspace}
  \makeatletter
  \@ifundefined{KOMAClassName}{% if non-KOMA class
    \IfFileExists{parskip.sty}{%
      \usepackage{parskip}
    }{% else
      \setlength{\parindent}{0pt}
      \setlength{\parskip}{6pt plus 2pt minus 1pt}}
  }{% if KOMA class
    \KOMAoptions{parskip=half}}
  \makeatother
  \usepackage{color}
  \usepackage{fancyvrb}
  \newcommand{\VerbBar}{|}
  \newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
  \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
  % Add ',fontsize=\small' for more characters per line
  \newenvironment{Shaded}{}{}
  \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
  \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
  \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.50,0.00}{#1}}
  \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{#1}}}
  \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
  \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
  \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{#1}}
  \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
  \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
  \newcommand{\ExtensionTok}[1]{#1}
  \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{#1}}
  \newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.50,0.00}{\textbf{#1}}}
  \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
  \newcommand{\NormalTok}[1]{#1}
  \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
  \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{#1}}
  \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
  \newcommand{\RegionMarkerTok}[1]{#1}
  \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
  \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
  \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \ifLuaTeX
    \usepackage{luacolor}
    \usepackage[soul]{lua-ul}
  \else
    \usepackage{soul}
    \ifXeTeX
      % soul's \st doesn't work for CJK:
      \usepackage{xeCJKfntef}
      \renewcommand{\st}[1]{\sout{#1}}
    \fi
  \fi
  \setlength{\emergencystretch}{3em} % prevent overfull lines
  \providecommand{\tightlist}{%
    \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
  % \usepackage{xeCJK}
  % \setCJKmainfont{AR PL UKai CN}
  % \usepackage{unicode-math}
  
  \setmathfont{Latin Modern Math}
  \usepackage{bookmark}
  \IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
  \urlstyle{same}
  \hypersetup{
    pdftitle={„ÄåÈ¢òÂçï„ÄçIOI2020ÂõΩÂÆ∂ÈõÜËÆ≠Èòü‰Ωú‰∏ö Part 1},
    pdfauthor={Jiayi Su (ShuYuMo)},
    hidelinks,
    pdfcreator={LaTeX via pandoc}}
  
  \title{„ÄåÈ¢òÂçï„ÄçIOI2020ÂõΩÂÆ∂ÈõÜËÆ≠Èòü‰Ωú‰∏ö Part 1}
  \author{Jiayi Su (ShuYuMo)}
  \date{2020-10-19 17:05:04}
  
  \begin{document}
  \maketitle
  
  \setstretch{1.3}
  \section{CF505E Mr.~Kitayuta
  vs.~Bamboos}\label{cf505e-mr.-kitayuta-vs.-bamboos}
  
  \begin{itemize}
  \tightlist
  \item
    ÁªôÂÆö \(n\) ‰∏™Êï∞ÔºàÁ´πÂ≠êÁöÑÈ´òÂ∫¶Ôºâ \(h_{1 \dots n}\)„ÄÇ
  \item
    ‰Ω†ÈúÄË¶ÅËøõË°å \(m\) ËΩÆÊìç‰ΩúÔºåÊØèËΩÆÊìç‰Ωú‰∏∫ \(k\)
    Ê¨°‰øÆÊîπÔºåÊØèÊ¨°‰øÆÊîπÂèØ‰ª•ÈÄâÊã©‰∏Ä‰∏™Êï∞ \(h_i\) ‰øÆÊîπ‰∏∫
    \(\max(h_i - p, 0)\)ÔºàÁ†∏Âà∞Âú∞‰∏ãÔºâ„ÄÇ
  \item
    ÊØèËΩÆÊìç‰ΩúÂêéÊØè‰∏™ \(h_i\) Â∞Ü‰ºöË¢´‰øÆÊîπ‰∏∫ \(h_i + a_i\)ÔºàÊØèÂ§©Á´πÂ≠ê‰ºöÁîüÈïøÔºâ„ÄÇ
  \item
    ‰Ω†ÈúÄË¶ÅÊúÄÂ∞èÂåñÊúÄÁªà \(h_{1 \dots n}\) ‰∏≠ÁöÑÊúÄÂ§ßÂÄº„ÄÇ
  \item
    \(n \le 10^5\)Ôºå\(m \le 5 \times 10^3\)Ôºå\(k \le 10\)
    Ë¶ÅÊ±ÇÊúÄÂ∞èÂåñÊúÄÂ§ßÂÄºÔºåËÄÉËôë‰∫åÂàÜ‰∏Ä‰∏™ÊúÄÂ§ßÁöÑÈ´òÂ∫¶ÔºåÂ∞ÜÈóÆÈ¢òËΩ¨ÂåñÊàêÂèØË°åÊÄßÈóÆÈ¢òÔºåÂç≥ÔºåÁªôÂá∫‰∏Ä‰∏™È´òÂ∫¶ÔºåÈóÆËÉΩÂê¶‰ΩøËøô‰∫õÁ´πÂ≠êÊúÄÁªà‰∏çË∂ÖËøáËøô‰∏™È´òÂ∫¶„ÄÇ
  \end{itemize}
  
  ËÄÉËôëÈôêÂà∂Ëøô‰∏™ÈóÆÈ¢ò‰∏çÂπ≥Âá°ÁöÑÂõ†Á¥†ÔºöÂõ†‰∏∫ÊØèÊ¨°Èôç‰ΩéÁ´πÂ≠êÈ´òÂ∫¶ÁöÑÊó∂ÂÄô‰∏çËÉΩ‰øùËØÅÁ´πÂ≠ê‰∏ÄÂÆöÈôç‰Ωé
  p
  Ôºå‰πüÂ∞±ÊòØËØ¥Ôºå‚ÄúÁ†∏Á´πÂ≠ê‚ÄùËøô‰∏ÄÂä®‰ΩúÂ≠òÂú®Êµ™Ë¥π„ÄÇÊàë‰ª¨ËÄÉËôëÂ∞ΩÂèØËÉΩÁöÑËÆ©‚ÄúÁ†∏Á´πÂ≠ê‚ÄùËøô‰∏ÄÂä®‰ΩúÊõ¥Â∞ëÁöÑÊµ™Ë¥πÔºåÂç≥ÔºöÂ∞ΩÂèØËÉΩÂú®ÂêéÈù¢ÁöÑÊó∂Èó¥ÁÇπÁ†∏Á´πÂ≠êÔºå‰ΩÜÊòØÊó†Ê≥ï‰øùËØÅÂà∞Â∫ïÊòØÂú®Âì™‰∏ÄÊ¨°Á†∏Á´πÂ≠êÔºåÊúâÂèØËÉΩÂ∑≤ÁªèÁªìÊùü‰∫ÜÔºåÊ≤°ÊúâÂΩ¢ÂºèÂåñÁöÑËÆ°ÁÆóÊµÅÁ®ã„ÄÇ
  
  ÂèØ‰ª•ËÄÉËôëÂèçÂêëÊÄùËÄÉÔºåÂç≥ÔºöÂÅáËÆæÂ∑≤ÁªèÈïøÂà∞
  ‰∫åÂàÜÁöÑÈ´òÂ∫¶„ÄÇÊØèÊ¨°ÁîüÈïøÊìç‰ΩúÁõ∏ÂΩì‰∫éÊØèÊ¨°‰ºö‰∏ãËêΩ
  \(a_i\)ÔºåËÄåÊØèÊ¨°Á†∏ÁöÑÊìç‰ΩúÁõ∏ÂΩì‰∫éÊèêÂçá‰∫Ü \(p\) ÁöÑÈ´òÂ∫¶„ÄÇ
  
  ÂºÄÂßãÊó∂ÔºåÂØπÊØè‰∏Ä‰∏™Á´πÂ≠êËÆ°ÁÆóÂá∫ÂÖ∂ÈúÄË¶ÅÂ§öÂ∞ëÊ¨°‰ºö‰∏ãËêΩÂà∞Ë¥üÈ´òÂ∫¶ÔºåÁî®Â†ÜÁª¥Êä§ÔºåÊØèÊ¨°ÂèñÂá∫ÊúÄÂø´ÁöÑÂèØËÉΩ‰∏ãËêΩÂà∞Ë¥üÈ´òÂ∫¶ÁöÑ
  k ‰∏™Á´πÂ≠êÔºåËøõË°å ‚ÄúÊãîÈ´ò‚Äù Êìç‰Ωú„ÄÇÁÑ∂ÂêéÂà§Êñ≠ÊúÄÂêéÁöÑÈ´òÂ∫¶ÊòØÂê¶Â§ß‰∫éÁ≠â‰∫é\(h_i\)„ÄÇ
  
  ÂÖ∂ÂÆû‰∫åÂàÜÁöÑÊú¨Ë¥®ÊòØ‰∏∫‰∫ÜÁ°ÆÂÆö‚ÄúÂ∞ΩÂèØËÉΩÁöÑÈù†ÂêéÁ†∏Á´πÂ≠ê‚ÄùÁöÑÊ†áÂáÜ„ÄÇÂèçÂêëÊÄùËÄÉÊòØ‰∏∫‰∫Ü‰æø‰∫éË¥™ÂøÉÂ§ÑÁêÜÁ≠ñÁï•„ÄÇ
  \#\# code
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ m}\OperatorTok{,}\NormalTok{ k}\OperatorTok{,}\NormalTok{ p}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ H}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ A}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \PreprocessorTok{\#define mp }\NormalTok{make\_pair}
  \PreprocessorTok{\#define fi }\NormalTok{first}
  \PreprocessorTok{\#define se }\NormalTok{second}
  \DataTypeTok{int}\NormalTok{ height}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{bool}\NormalTok{ check}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ MaxH}\OperatorTok{)\{}
  \NormalTok{    fill}\OperatorTok{(}\NormalTok{height }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ height }\OperatorTok{+} \DecValTok{1} \OperatorTok{+}\NormalTok{ n}\OperatorTok{,}\NormalTok{ MaxH}\OperatorTok{);}
  \NormalTok{    priority\_queue}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{},}\NormalTok{ vector}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}} \OperatorTok{,}\NormalTok{ greater}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}}\NormalTok{ Q}\OperatorTok{;}
      \ControlFlowTok{while}\OperatorTok{(!}\NormalTok{Q}\OperatorTok{.}\NormalTok{empty}\OperatorTok{())}\NormalTok{ Q}\OperatorTok{.}\NormalTok{pop}\OperatorTok{();}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{MaxH }\OperatorTok{{-}}\NormalTok{ m }\OperatorTok{*}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{\textless{}}\NormalTok{ H}\OperatorTok{[}\NormalTok{i}\OperatorTok{])}\NormalTok{ Q}\OperatorTok{.}\NormalTok{push}\OperatorTok{(}\NormalTok{mp}\OperatorTok{(}\NormalTok{ MaxH }\OperatorTok{/}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{],}\NormalTok{ i }\OperatorTok{));}
  
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ m}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)} \OperatorTok{\{}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ j }\OperatorTok{\textless{}=}\NormalTok{ k}\OperatorTok{;}\NormalTok{ j}\OperatorTok{++)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{Q}\OperatorTok{.}\NormalTok{empty}\OperatorTok{())} \ControlFlowTok{return} \KeywordTok{true}\OperatorTok{;}
  \NormalTok{            pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ now }\OperatorTok{=}\NormalTok{ Q}\OperatorTok{.}\NormalTok{top}\OperatorTok{();}\NormalTok{ Q}\OperatorTok{.}\NormalTok{pop}\OperatorTok{();} 
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{now}\OperatorTok{.}\NormalTok{fi }\OperatorTok{\textless{}}\NormalTok{ i}\OperatorTok{)} \ControlFlowTok{return} \KeywordTok{false}\OperatorTok{;}
  \NormalTok{            height}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{se}\OperatorTok{]} \OperatorTok{+=}\NormalTok{ p}\OperatorTok{;}
  \NormalTok{            now}\OperatorTok{.}\NormalTok{fi }\OperatorTok{=}\NormalTok{ height}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{se}\OperatorTok{]} \OperatorTok{/}\NormalTok{ A}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{se}\OperatorTok{];}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{height}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{se}\OperatorTok{]} \OperatorTok{{-}}\NormalTok{ m }\OperatorTok{*}\NormalTok{ A}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{se}\OperatorTok{]} \OperatorTok{\textless{}}\NormalTok{ H}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{se}\OperatorTok{])}\NormalTok{ Q}\OperatorTok{.}\NormalTok{push}\OperatorTok{(}\NormalTok{now}\OperatorTok{);}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \ControlFlowTok{return}\NormalTok{ Q}\OperatorTok{.}\NormalTok{empty}\OperatorTok{();}
  \OperatorTok{\}}
  \DataTypeTok{signed}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    n }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ m }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ k }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ p }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();} \CommentTok{// Á´πÂ≠êÊï∞ Â§©Êï∞ ‰øÆÊîπÊ¨°Êï∞ ÊúÄÂ§ßÈôç‰ΩéÈ´òÂ∫¶ }
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ H}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
  
      \DataTypeTok{int}\NormalTok{ L }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ R }\OperatorTok{=} \DecValTok{1}\BuiltInTok{LL} \OperatorTok{\textless{}\textless{}} \DecValTok{60}\OperatorTok{;} \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ L }\OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{L}\OperatorTok{,}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}}\NormalTok{ R}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{L }\OperatorTok{+}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{check}\OperatorTok{(}\NormalTok{mid}\OperatorTok{))}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ R }\OperatorTok{=}\NormalTok{ mid}\OperatorTok{;}
          \ControlFlowTok{else}\NormalTok{ L }\OperatorTok{=}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{;}
      \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \section{CF521D Shop}\label{cf521d-shop}
  
  \begin{itemize}
  \tightlist
  \item
    Êúâ \(k\) ‰∏™Ê≠£Êï¥Êï∞ \(a_{1\dots k}\)„ÄÇ
  \item
    Êúâ \(n\) ‰∏™Êìç‰ΩúÔºåÊØè‰∏™Êìç‰ΩúÁªôÂÆöÊ≠£Êï¥Êï∞ \(b\)ÔºåÊúâ‰∏âÁßçÂèØËÉΩÔºöÂ∞Ü \(a_i\)
    ËµãÂÄº‰∏∫ \(b\)ÔºåÂ∞Ü \(a_i\) Âä†‰∏ä \(b\)ÔºåÂ∞Ü \(a_i\) ‰πò‰ª• \(b\)„ÄÇ
  \item
    ‰Ω†ÂèØ‰ª•‰ªé \(n\) ‰∏™Êìç‰Ωú‰∏≠ÈÄâÊã©ÊúÄÂ§ö \(m\) ‰∏™Êìç‰ΩúÔºåÂπ∂ÊåâÁÖß‰∏ÄÂÆöÈ°∫Â∫èÊâßË°å„ÄÇ
  \item
    ‰Ω†ÁöÑÁõÆÊ†áÊòØÊúÄÂ§ßÂåñ \(\prod_{i=1}^k a_i\) ÁöÑÂÄº„ÄÇ
  \item
    \(k,n \le 10^5\)„ÄÇ
  \end{itemize}
  
  ÂåñÂΩíÊÄùÊÉ≥ÔºåËÄÉËôëÂ¶ÇÊûúÂè™Êúâ‰πòÊ≥ïÔºåÈÇ£‰∏ÄÂÆöÊòØÊääÊìç‰ΩúÊï∞Â≠ó‰ªéÂ§ßÂà∞Â∞èÊéíÂ∫èÔºåÁÑ∂Âêé‰ª•Ê≠§Êìç‰Ωú„ÄÇ
  
  ËÄÉËôëÊìç‰ΩúÈ°∫Â∫èÔºåÊúÄ‰ºòÁöÑÊìç‰Ωú‰∏ÄÂÆöÊòØÂÖàËµãÂÄºÔºåÂÜçÂä†Ê≥ïÔºåÊúÄÂêé‰πòÊ≥ï„ÄÇÂÖ∂‰∏≠ËµãÂÄºÂè™ÂèØËÉΩÈÄâÁõ∏Â∫î‰ΩçÁΩÆÊúÄÂ§ßÁöÑËµãÂÄºÔºåÂä†Ê≥ï‰πüÊòØ‰ªéÂ§ßÂà∞Â∞èËÄÉËôë„ÄÇ
  
  ÊòæÁÑ∂ËµãÂÄºÂèØ‰ª•Áõ¥Êé•ËΩ¨ÂåñÊàêÂä†Ê≥ïÔºåËÄåÂä†Ê≥ïÂ¶ÇÊûú‰ªéÂ§ßÂà∞Â∞èËÄÉËôë‰πüÂèØ‰ª•Áõ¥Êé•ËΩ¨ÂåñÊàê‰πòÊ≥ïÔºà‰πò‰∏Ä‰∏™ÂÆûÊï∞Ôºâ„ÄÇ
  
  ËøôÊ†∑Â∞±ÊääÊâÄÊúâÊìç‰ΩúËΩ¨ÂåñÊàê‰∫Ü‰πòÊ≥ï„ÄÇ Ë¥™ÂøÉËÄÉËôëÂç≥ÂèØ„ÄÇ
  
  ÊúÄÂêéËæìÂá∫ÊúâÈ°∫Â∫èÔºåÂ∫îÊåâÁÖß‰∏äÈù¢ÁöÑÁ≠ñÁï•ÔºàÂÖàËµãÂÄºÔºåÂÜçÂä†Ê≥ïÔºåÊúÄÂêé‰πòÊ≥ïÔºâ‰ª•Ê≠§ËæìÂá∫ÔºàÊìç‰ΩúÈ°∫Â∫èÔºâ„ÄÇ
  
  \subsection{code}\label{code}
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \PreprocessorTok{\#include }\ImportTok{\textless{}climits\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}cstring\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}cstdio\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}cmath\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}iostream\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}algorithm\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}vector\textgreater{}}
  \KeywordTok{using} \KeywordTok{namespace}\NormalTok{ std}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{1e5} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
  \PreprocessorTok{\#define LL }\DataTypeTok{long}\PreprocessorTok{ }\DataTypeTok{long}
  \DataTypeTok{int}\NormalTok{ read}\OperatorTok{()} \OperatorTok{\{} \DataTypeTok{int}\NormalTok{ x}\OperatorTok{;}\NormalTok{ scanf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,} \OperatorTok{\&}\NormalTok{x}\OperatorTok{);} \ControlFlowTok{return}\NormalTok{ x}\OperatorTok{;} \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ m}\OperatorTok{,}\NormalTok{ k}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ v}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ Give}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \NormalTok{vector}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}}\NormalTok{ add}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \NormalTok{vector}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{double}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}}\NormalTok{ mul}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \NormalTok{vector}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{double}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}}\NormalTok{ All}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ T}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ id}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \PreprocessorTok{\#define double }\DataTypeTok{long}\PreprocessorTok{ }\DataTypeTok{double}
  \DataTypeTok{bool}\NormalTok{ ICMP  }\OperatorTok{(}\AttributeTok{const}\NormalTok{ pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}} \OperatorTok{\&}\NormalTok{ x}\OperatorTok{,} \AttributeTok{const}\NormalTok{ pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}} \OperatorTok{\&}\NormalTok{ y}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return} \OperatorTok{(}\NormalTok{x }\OperatorTok{\textgreater{}}\NormalTok{ y}\OperatorTok{);} \OperatorTok{\}}
  \DataTypeTok{bool}\NormalTok{ ICMP\_D}\OperatorTok{(}\AttributeTok{const}\NormalTok{ pair}\OperatorTok{\textless{}}\DataTypeTok{double}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}} \OperatorTok{\&}\NormalTok{ x}\OperatorTok{,} \AttributeTok{const}\NormalTok{ pair}\OperatorTok{\textless{}}\DataTypeTok{double}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}} \OperatorTok{\&}\NormalTok{ y}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return} \OperatorTok{(}\NormalTok{x }\OperatorTok{\textgreater{}}\NormalTok{ y}\OperatorTok{);} \OperatorTok{\}}
  \DataTypeTok{bool}\NormalTok{ MAGIC}\OperatorTok{(}\AttributeTok{const} \DataTypeTok{int} \OperatorTok{\&}\NormalTok{x}\OperatorTok{,} \AttributeTok{const} \DataTypeTok{int} \OperatorTok{\&}\NormalTok{y}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return}\NormalTok{ T}\OperatorTok{[}\NormalTok{x}\OperatorTok{]} \OperatorTok{\textless{}}\NormalTok{ T}\OperatorTok{[}\NormalTok{y}\OperatorTok{];} \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    k }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ n }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ m }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ k}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ v}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
  
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
          \DataTypeTok{int}\NormalTok{ type }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}\NormalTok{ T}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ type}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ a }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ b }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{type }\OperatorTok{==} \DecValTok{1}\OperatorTok{)\{}
  \NormalTok{            Give}\OperatorTok{[}\NormalTok{a}\OperatorTok{]} \OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{Give}\OperatorTok{[}\NormalTok{a}\OperatorTok{],}\NormalTok{ make\_pair}\OperatorTok{(}\NormalTok{b}\OperatorTok{,}\NormalTok{ i}\OperatorTok{));} 
          \OperatorTok{\}} \ControlFlowTok{else} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{type }\OperatorTok{==} \DecValTok{2}\OperatorTok{)\{}
  \NormalTok{            add}\OperatorTok{[}\NormalTok{a}\OperatorTok{].}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{make\_pair}\OperatorTok{(}\NormalTok{b}\OperatorTok{,}\NormalTok{ i}\OperatorTok{));}
          \OperatorTok{\}} \ControlFlowTok{else} \OperatorTok{\{}
  \NormalTok{            mul}\OperatorTok{[}\NormalTok{a}\OperatorTok{].}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{make\_pair}\OperatorTok{((}\DataTypeTok{double}\OperatorTok{)(}\NormalTok{b}\OperatorTok{),}\NormalTok{ i}\OperatorTok{));}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ k}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{Give}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{first}\OperatorTok{)}
  \NormalTok{            add}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{make\_pair}\OperatorTok{(}\NormalTok{Give}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{first }\OperatorTok{{-}}\NormalTok{ v}\OperatorTok{[}\NormalTok{i}\OperatorTok{],}\NormalTok{ Give}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{second}\OperatorTok{));}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ k}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ sort}\OperatorTok{(}\NormalTok{add}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{begin}\OperatorTok{(),}\NormalTok{ add}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{end}\OperatorTok{(),}\NormalTok{ ICMP}\OperatorTok{);}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ k}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
  \NormalTok{        LL now }\OperatorTok{=}\NormalTok{ v}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ j }\OperatorTok{\textless{}}\NormalTok{ add}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{size}\OperatorTok{();}\NormalTok{ j}\OperatorTok{++)\{}
  \NormalTok{            mul}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{push\_back}\OperatorTok{(} 
  \NormalTok{                make\_pair}\OperatorTok{(} 
                      \OperatorTok{(}\DataTypeTok{double}\OperatorTok{)(}\NormalTok{now }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ add}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{].}\NormalTok{first}\OperatorTok{)} \OperatorTok{/} \OperatorTok{(}\DataTypeTok{double}\OperatorTok{)(}\NormalTok{now}\OperatorTok{),}
  \NormalTok{                    add}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{].}\NormalTok{second}
                  \OperatorTok{)} 
              \OperatorTok{);}\NormalTok{ now }\OperatorTok{+=}\NormalTok{ add}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{].}\NormalTok{first}\OperatorTok{;}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ k}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)} \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ j }\OperatorTok{\textless{}}\NormalTok{ mul}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{size}\OperatorTok{();}\NormalTok{ j}\OperatorTok{++)}\NormalTok{ All}\OperatorTok{.}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{mul}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]);}
  \NormalTok{    sort}\OperatorTok{(}\NormalTok{All}\OperatorTok{.}\NormalTok{begin}\OperatorTok{(),}\NormalTok{ All}\OperatorTok{.}\NormalTok{end}\OperatorTok{(),}\NormalTok{ ICMP\_D}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}}\NormalTok{ All}\OperatorTok{.}\NormalTok{size}\OperatorTok{();}\NormalTok{ i}\OperatorTok{++)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{All}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{first }\OperatorTok{\textgreater{}} \DecValTok{1}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ tot}\OperatorTok{++;} \OperatorTok{\}}
  \NormalTok{    tot }\OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{tot}\OperatorTok{,}\NormalTok{ m}\OperatorTok{);}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ tot}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ id}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ All}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{].}\NormalTok{second}\OperatorTok{;}
  \NormalTok{    sort}\OperatorTok{(}\NormalTok{id }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ id }\OperatorTok{+} \DecValTok{1} \OperatorTok{+}\NormalTok{ tot}\OperatorTok{,}\NormalTok{ MAGIC}\OperatorTok{);}\NormalTok{  printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ tot}\OperatorTok{);}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ tot}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d\%c}\StringTok{"}\OperatorTok{,}\NormalTok{ id}\OperatorTok{[}\NormalTok{i}\OperatorTok{],} \StringTok{" }\SpecialCharTok{\textbackslash{}n}\StringTok{"}\OperatorTok{[}\NormalTok{i }\OperatorTok{==}\NormalTok{ n}\OperatorTok{]);}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \section{CF526F Pudding Monsters}\label{cf526f-pudding-monsters}
  
  \begin{itemize}
  \tightlist
  \item
    ÁªôÂÆö‰∏Ä‰∏™ \(n \times n\) ÁöÑÊ£ãÁõòÔºåÂÖ∂‰∏≠Êúâ \(n\)
    ‰∏™Ê£ãÂ≠êÔºåÊØèË°åÊØèÂàóÊÅ∞Â•ΩÊúâ‰∏Ä‰∏™Ê£ãÂ≠ê„ÄÇ
  \item
    Ê±ÇÊúâÂ§öÂ∞ë‰∏™ \(k \times k\) ÁöÑÂ≠êÊ£ãÁõò‰∏≠ÊÅ∞Â•ΩÊúâ \(k\) ‰∏™Ê£ãÂ≠ê„ÄÇ
  \item
    \(n \le 3 \times 10^5\)„ÄÇ
  \end{itemize}
  
  ÊØèË°åÊØèÂàó\textbf{ÊÅ∞Â•ΩÊúâ‰∏Ä‰∏™}Ê£ãÂ≠êÁöÑÊ£ãÁõòÔºåÂèØ‰ª•ÊäΩË±°Êàê‰∏Ä‰∏™ÊéíÂàó„ÄÇ
  ËÄåÊìç‰Ωú‰πüÊòØÂØπ‰∫é‰∏Ä‰∏™ÊéíÂàóÁöÑ‰∏ÄÊÆµËøõË°åÊìç‰ΩúÁöÑ„ÄÇ
  
  È¢òÊÑèÂèØ‰ª•ËΩ¨Âåñ‰∏∫Ôºö - ÁªôÂá∫‰∏Ä‰∏™ÊéíÂàó -
  Ê±ÇËøûÁª≠ÊÆµÊï∞ÈáèÔºåÂç≥ËøûÁª≠ÁöÑ‰∏ÄÊÆµÔºå‰∏îÊÆµ‰∏≠ÁöÑÂÖÉÁ¥†ÊéíÂ•ΩÂ∫è‰πãÂêéÂøÖÈ°ªÊòØÂÖ¨Â∑Æ‰∏∫\(1\)ÁöÑÁ≠âÂ∑ÆÊï∞Âàó.
  
  \textbf{ËøûÁª≠ÊÆµËÆ°Êï∞}
  
  ËÄÉËôëÂ¶Ç‰ΩïÂàªÁîª‚Äú\textbf{ËøûÁª≠ÁöÑ‰∏ÄÊÆµÔºå‰∏îÊÆµ‰∏≠ÁöÑÂÖÉÁ¥†ÊéíÂ•ΩÂ∫è‰πãÂêéÂøÖÈ°ªÊòØÂÖ¨Â∑Æ‰∏∫\(1\)ÁöÑÁ≠âÂ∑ÆÊï∞Âàó}‚ÄùËøô‰∏™Êù°‰ª∂ÔºåÂèØ‰ª•ÂΩ¢ÂºèÂåñÁöÑÂÆö‰πâÔºö
  
  \[\operatorname{MaxVal} - \operatorname{MinVal} = (R - L)\]
  
  Âç≥
  
  \[f_{R}(L) = \operatorname{MaxVal} - \operatorname{MinVal} - (R - L) = 0\]
  
  Ëøô‰∏™Êù°‰ª∂ÊàêÁ´ãÁöÑÂü∫Á°ÄÂú®‰∫éÔºåÊâÄÊ±ÇÊï∞Âàó‰∏çËÉΩÊúâÈáçÂ§çÂÖÉÁ¥†ÔºåËÄå‰∏î‰πü‰øùËØÅ‰∫ÜÂáΩÊï∞\(f_x(L) \ge 0\),
  Êü•ËØ¢Êó∂Âè™ÈúÄË¶ÅÁª¥Êä§\textbf{ÊúÄÂ∞èÂÄº}‰ª•ÂèäÊúÄÂ∞èÂÄºÁöÑ\textbf{Êï∞Èáè}Âç≥ÂèØ„ÄÇ
  
  ÂèØ‰ª•ËÄÉËôëÊûö‰∏æ‰∏Ä‰∏™Á´ØÁÇπÔºåÊØîÂ¶ÇÂè≥Á´ØÁÇπ \(R\)ÔºåÁÑ∂ÂêéÊü•ÊâæÊúâÂ§öÂ∞ëÁ¨¶ÂêàÊù°‰ª∂ÁöÑÂ∑¶Á´ØÁÇπ
  \(L\) ÔºåÁî®Á∫øÊÆµÊ†ëÁª¥Êä§\(f_R(x)\)Âú®ÊØè‰∏™ÁÇπÂ§ÑÁöÑÂáΩÊï∞ÂÄº„ÄÇ
  
  ËÄÉËôëÂΩì\(f_x(L)\) ÁßªÂä®Âà∞ \(f_{x + 1}(L)\) Êó∂Ôºå ÂÄºÁöÑÂèòÂåñ„ÄÇÂèòÂåñÁöÑÂÄºÊúâ \(R\)
  ,
  ÂèØËÉΩÂèòÂåñÁöÑÊúâ\(MaxVal, MinVal\)„ÄÇÁî®ÂçïË∞ÉÊ†àÂÆûÊó∂Áª¥Êä§Êõ¥Êñ∞Âêé‰ºöÊ≥¢ÂèäÂì™‰∫õÂÖÉÁ¥†ÁöÑÊúÄÂ∞èÂÄº„ÄÇ‰∫ãÂÆû‰∏äÔºåÂçïË∞ÉÊ†àÂ§ÑÁêÜÁöÑËøáÁ®ãÂ∞±ÊòØÂú®Âä®ÊÄÅÁª¥Êä§‰∏Ä‰∏™ÂêéÁºÄÊúÄÂ∞è/Â§ßÂÄºÊï∞ÁªÑ„ÄÇ
  
  ËøôÈáåÊúâÂá†‰∏™‰∏éÂÖ∂ÊúâÁõ∏‰ºº‰πãÂ§ÑÁöÑÈ¢òÁõÆÔºå‰ΩÜÊòØÂèØËÉΩÂÅöÊ≥ïÂπ∂‰∏ç‰∏ÄÊ†∑ÔºåÈÅáÂà∞‰∏çË¶ÅÊÉ≥Êàê‰∏ÄÊ†∑ÁöÑÈ¢òÁõÆÔºö
  - \href{https://www.luogu.com.cn/problem/P5278}{ÁÆóÊúØÂ§©Êâç‚ë®‰∏éÁ≠âÂ∑ÆÊï∞Âàó}
  (‰∏ç‰øùËØÅÂ∫èÂàó‰∏≠‰∏ÄÂÆöÂÖÉÁ¥†‰∏çÈáçÂ§ç) - ËÄÉËôëÂà§Êñ≠‰∏Ä‰∏™Â∫èÂàóÊéíÂ•ΩÂ∫èÂêéÊòØÂê¶‰∏∫Á≠âÂ∑ÆÊï∞Âàó -
  ÂáÜÁ°ÆÂÅöÊ≥ï - \(\max‚àí\min=(r‚àíl)k\) - Áõ∏ÈÇª‰∏§Êï∞Â∑ÆÁöÑÁªùÂØπÂÄºÁöÑ
  \(\operatorname{gcd}\)ÊòØ \(k\) - Âå∫Èó¥ \([l,r]\) ÂÜÖÁöÑÊï∞‰∏çÈáçÂ§ç -
  Ê¶ÇÁéáÊÄßÂÅöÊ≥ï - hashÊÄùÊÉ≥ÔºåÁª¥Êä§ \(n\) Ê¨°ÊñπÂíå -
  \href{http://www.zhengruioi.com/contest/718/problem/1615}{Ê†ë‰∏äÊéíÂàó(ZROI)}
  (ÂêåÊ†∑‰∏ç‰øùËØÅÂÖÉÁ¥†‰∏ÄÂÆö‰∏çÈáçÂ§ç) - ÁªôÂÆö‰∏ÄÈ¢ó \(n\)
  ‰∏™ÁÇπÁöÑÊ†ë„ÄÇÊØè‰∏™ÁÇπÈÉΩ‰∏Ä‰∏™Ê≠£Êï¥Êï∞ÁÇπÊùÉ \(A_i\) Ôºå‰Ω†ÈúÄË¶ÅÊîØÊåÅ‰ª•‰∏ã‰∏§ÁßçÊìç‰ΩúÔºö -
  1„ÄÅËØ¢ÈóÆÁÇπ \(x\) ÂíåÁÇπ \(y\) ‰πãÈó¥ÁöÑË∑ØÂæÑ‰∏äÁöÑÊâÄÊúâÁÇπÔºàÂåÖÊã¨ÁÇπ \(x\) ÂíåÁÇπ \(y\)
  ÔºâÁöÑÁÇπÊùÉÊòØÂê¶ÊûÑÊàê‰∏Ä‰∏™‰ªé \(1\) ÂºÄÂßãÁöÑÊéíÂàóÔºàÂç≥Ëã•ËøôÊù°ÈìæÈïøÂ∫¶‰∏∫ \(len\)
  ÔºåÈÇ£‰πàÈóÆÁÇπÊùÉÈõÜÂêà‰∏∫ \({1,2,‚ãØ,len}\) Ôºâ„ÄÇ - 2„ÄÅÂ∞Ü \(A_x\) ‰øÆÊîπ‰∏∫ \(y\) „ÄÇ
  - Áî±‰∫éÂú®Ê†ë‰∏äÈöæ‰ª•Âà§Êñ≠ÊüêÂå∫Èó¥ÂÜÖÁöÑÊï∞Â≠ó‰∏çÈáçÂ§çÔºåHashÁª¥Êä§nÊ¨°ÊñπÂíå„ÄÇ -
  ÁªôÂá∫‰∏Ä‰∏™Ê≤°ÊúâÈáçÂ§çÂÖÉÁ¥†ÁöÑÂ∫èÂàóÔºåËØ¢ÈóÆÊüêÂå∫Èó¥‰∏≠ÁöÑÂÖÉÁ¥†ÊòØÂê¶ËÉΩÂä†ÂÖ•Â∞è‰∫é\(k\)‰∏™ÂÖÉÁ¥†‰ΩøÂÖ∂ÊãçÂ•ΩÂ∫èÂêéÊûÑÊàê‰∏Ä‰∏™Á≠âÂ∑ÆÊï∞Âàó„ÄÇ
  - Êù°‰ª∂ÂèòÊàê‰∫Ü
  \[f_{R}(L) = \operatorname{MaxVal} - \operatorname{MinVal} - (R - L) \ge k\]
  -
  \href{http://www.zhengruioi.com/problem/1532}{count(ZROI)}Â∑≤Áü•‰∏Ä‰∏™ÈõÜÂêà\(S\)‰∏≠ÁöÑÊúÄÂ§ßÂÖÉÁ¥†‰∏∫
  \(N\)Ôºå
  ‰∏îËøô‰∏™ÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†ÂèØ‰ª•ÊûÑÊàê‰∏Ä‰∏™Á≠âÂ∑ÆÊï∞ÂàóÔºåÁªôÂá∫‰∏Ä‰∫õÂΩ¢Â¶Ç\(x \in S\)„ÄÅ\(x \notin S\)ÁöÑÈôêÂà∂„ÄÇÊ±ÇÊúÄÁªàÁöÑÈõÜÂêàÊúâÂ§öÂ∞ëÁßçÊÉÖÂÜµ„ÄÇ
  - ËÄÉËôëÂàªÁîª‰∏Ä‰∏™Á≠âÂ∑ÆÊï∞ÂàóÈúÄË¶Å‰ªÄ‰πàÂèÇÊï∞ÔºöÂÖ¨Â∑ÆÔºåÂíåÊØè‰∏™ÂÖÉÁ¥†\(\bmod\)
  ÂÖ¨Â∑ÆÁöÑÂÄº„ÄÇÊûö‰∏æËøô‰∏§‰∏™ÂèÇÊï∞Ôºå‰æùÊ¨°ËÆ°Êï∞Âç≥ÂèØ„ÄÇ
  
  ÔºàÂºïÁî®Ê≠£ÁùøÁöÑ‰∏§ÈÅìÈ¢òÁõÆÔºå‰∏çÁü•ÈÅìÊòØ‰∏çÊòØÊúâÁâàÊùÉÈóÆÈ¢òÔºåÂ¶ÇÊûúÊúâÔºå‰ºöÁ´ãÂç≥Âà†Èô§Ôºà\st{È°∫‰æøÁªôÊ≠£ÁùøOIÊâì‰∏™ÂπøÂëä}ÔºâÔºâ„ÄÇ
  
  \subsection{code}\label{code-1}
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ A}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \PreprocessorTok{\#define fir }\NormalTok{first}
  \PreprocessorTok{\#define sec }\NormalTok{second}
  \KeywordTok{namespace}\NormalTok{ SegmentTree}\OperatorTok{\{}
      \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{3e6} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
      \KeywordTok{struct}\NormalTok{ Node}\OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ MIN}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ sMIN}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ tar}\OperatorTok{;}
  \NormalTok{        Node }\KeywordTok{operator} \OperatorTok{+} \OperatorTok{(}\AttributeTok{const}\NormalTok{ Node }\OperatorTok{\&}\NormalTok{ rhs}\OperatorTok{)} \AttributeTok{const} \OperatorTok{\{}
  \NormalTok{            Node res}\OperatorTok{;}
  \NormalTok{            res}\OperatorTok{.}\NormalTok{MIN  }\OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{MIN}\OperatorTok{,}\NormalTok{ rhs}\OperatorTok{.}\NormalTok{MIN}\OperatorTok{);}
  \NormalTok{            res}\OperatorTok{.}\NormalTok{sMIN }\OperatorTok{=}\NormalTok{ MIN }\OperatorTok{==}\NormalTok{ rhs}\OperatorTok{.}\NormalTok{MIN }\OperatorTok{?} \OperatorTok{(}\NormalTok{ sMIN }\OperatorTok{+}\NormalTok{ rhs}\OperatorTok{.}\NormalTok{sMIN}\OperatorTok{)} \OperatorTok{:} \OperatorTok{(}\NormalTok{MIN }\OperatorTok{\textless{}}\NormalTok{ rhs}\OperatorTok{.}\NormalTok{MIN }\OperatorTok{?}\NormalTok{ sMIN }\OperatorTok{:}\NormalTok{ rhs}\OperatorTok{.}\NormalTok{sMIN}\OperatorTok{)} \OperatorTok{;}
              \ControlFlowTok{return}\NormalTok{ res}\OperatorTok{;}
          \OperatorTok{\}}
      \OperatorTok{\}}\NormalTok{v}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
      \DataTypeTok{int}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ ch}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\DecValTok{2}\OperatorTok{];}
      \PreprocessorTok{\#define ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{ch}\OperatorTok{[}\NormalTok{o}\OperatorTok{][}\DecValTok{0}\OperatorTok{])}
      \PreprocessorTok{\#define rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{ch}\OperatorTok{[}\NormalTok{o}\OperatorTok{][}\DecValTok{1}\OperatorTok{])}
      \PreprocessorTok{\#define make }\OperatorTok{(}\NormalTok{tot}\OperatorTok{++,}\PreprocessorTok{ }\NormalTok{ch}\OperatorTok{[}\NormalTok{tot}\OperatorTok{][}\DecValTok{0}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{ch}\OperatorTok{[}\NormalTok{tot}\OperatorTok{][}\DecValTok{1}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{v}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{MIN}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{v}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{sMIN}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\DecValTok{0}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{tot}\OperatorTok{)}
      \DataTypeTok{int}\NormalTok{ Groot}\OperatorTok{()} \OperatorTok{\{} \ControlFlowTok{return}\NormalTok{ make}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ maintain}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{        v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{MIN  }\OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{MIN}\OperatorTok{,}\NormalTok{ v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{MIN}\OperatorTok{);}
  \NormalTok{        v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{sMIN }\OperatorTok{=}\NormalTok{ v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{MIN }\OperatorTok{==}\NormalTok{ v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{MIN }\OperatorTok{?}\NormalTok{ v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{sMIN }\OperatorTok{+}\NormalTok{ v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{sMIN }\OperatorTok{:} \OperatorTok{(}\NormalTok{ v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{MIN }\OperatorTok{\textless{}}\NormalTok{ v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{MIN }\OperatorTok{?}\NormalTok{ v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{sMIN }\OperatorTok{:}\NormalTok{ v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{sMIN }\OperatorTok{);}
      \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ tar}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ x}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{MIN }\OperatorTok{+=}\NormalTok{ x}\OperatorTok{;}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{tar }\OperatorTok{+=}\NormalTok{ x}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ pushdown}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{tar}\OperatorTok{)\{}
  \NormalTok{            tar}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{tar}\OperatorTok{);}\NormalTok{ tar}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{tar}\OperatorTok{);}
  \NormalTok{            v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{tar }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ build}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{==}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{MIN }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{sMIN }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} \ControlFlowTok{return}\OperatorTok{;} \OperatorTok{\}}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{L }\OperatorTok{+}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{        ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)} \OperatorTok{=}\NormalTok{ make}\OperatorTok{;}\NormalTok{ rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)} \OperatorTok{=}\NormalTok{ make}\OperatorTok{;}
  \NormalTok{        build}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}\NormalTok{ build}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
  \NormalTok{        maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
      \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ update}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ x}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textgreater{}}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ nowl }\OperatorTok{\&\&}\NormalTok{ nowr }\OperatorTok{\textless{}=}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ tar}\OperatorTok{(}\NormalTok{o}\OperatorTok{,}\NormalTok{ x}\OperatorTok{);}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}\NormalTok{  pushdown}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ x}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R  }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ x}\OperatorTok{);}
  \NormalTok{        maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
      \OperatorTok{\}}
  \NormalTok{    Node query}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ nowl }\OperatorTok{\&\&}\NormalTok{ nowr }\OperatorTok{\textless{}=}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}\NormalTok{ pushdown}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
  \NormalTok{        Node Ans}\OperatorTok{;}\NormalTok{ Ans}\OperatorTok{.}\NormalTok{MIN }\OperatorTok{=}\NormalTok{ INT\_MAX}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ Ans }\OperatorTok{=}\NormalTok{ Ans }\OperatorTok{+}\NormalTok{ query}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R  }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ Ans }\OperatorTok{=}\NormalTok{ Ans }\OperatorTok{+}\NormalTok{ query}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
          \ControlFlowTok{return}\NormalTok{ Ans}\OperatorTok{;}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ query}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
  \NormalTok{        Node res }\OperatorTok{=}\NormalTok{ query}\OperatorTok{(}\NormalTok{o}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
          \ControlFlowTok{return}\NormalTok{ res}\OperatorTok{.}\NormalTok{MIN }\OperatorTok{==} \DecValTok{0} \OperatorTok{?}\NormalTok{ res}\OperatorTok{.}\NormalTok{sMIN }\OperatorTok{:} \DecValTok{0}\OperatorTok{;}
      \OperatorTok{\}}
  \OperatorTok{\}}  \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{Groot}\OperatorTok{;} \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{build}\OperatorTok{;} \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{query}\OperatorTok{;} \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{update}\OperatorTok{;}
  \KeywordTok{namespace}\NormalTok{ Mon\_Stack}\OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ t0t }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ t1t }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ S0}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ S1}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
      \DataTypeTok{int}\NormalTok{ work}\OperatorTok{(}\DataTypeTok{int} \OperatorTok{*}\NormalTok{A}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ n}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ Ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ root }\OperatorTok{=}\NormalTok{ Groot}\OperatorTok{();}
  \NormalTok{        build}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{);}
  \NormalTok{        S0}\OperatorTok{[}\DecValTok{0}\OperatorTok{].}\NormalTok{fir }\OperatorTok{=}\NormalTok{ S1}\OperatorTok{[}\DecValTok{0}\OperatorTok{].}\NormalTok{fir }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)} \OperatorTok{\{}
  \NormalTok{            update}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{,} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{);}
              \ControlFlowTok{while}\OperatorTok{(}\NormalTok{t0t }\OperatorTok{!=} \DecValTok{0} \OperatorTok{\&\&}\NormalTok{ S0}\OperatorTok{[}\NormalTok{t0t}\OperatorTok{].}\NormalTok{sec }\OperatorTok{\textgreater{}=}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \OperatorTok{\{}\NormalTok{ update}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ S0}\OperatorTok{[}\NormalTok{t0t }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{].}\NormalTok{fir }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ S0}\OperatorTok{[}\NormalTok{t0t}\OperatorTok{].}\NormalTok{fir}\OperatorTok{,}\NormalTok{  S0}\OperatorTok{[}\NormalTok{t0t}\OperatorTok{].}\NormalTok{sec}\OperatorTok{);}\NormalTok{ t0t}\OperatorTok{{-}{-};} \OperatorTok{\}}
              \ControlFlowTok{while}\OperatorTok{(}\NormalTok{t1t }\OperatorTok{!=} \DecValTok{0} \OperatorTok{\&\&}\NormalTok{ S1}\OperatorTok{[}\NormalTok{t1t}\OperatorTok{].}\NormalTok{sec }\OperatorTok{\textless{}=}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \OperatorTok{\{}\NormalTok{ update}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ S1}\OperatorTok{[}\NormalTok{t1t }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{].}\NormalTok{fir }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ S1}\OperatorTok{[}\NormalTok{t1t}\OperatorTok{].}\NormalTok{fir}\OperatorTok{,} \OperatorTok{{-}}\NormalTok{S1}\OperatorTok{[}\NormalTok{t1t}\OperatorTok{].}\NormalTok{sec}\OperatorTok{);}\NormalTok{ t1t}\OperatorTok{{-}{-};} \OperatorTok{\}}
  \NormalTok{            update}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ S0}\OperatorTok{[}\NormalTok{t0t}\OperatorTok{].}\NormalTok{fir }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ i}\OperatorTok{,} \OperatorTok{{-}}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
  \NormalTok{            update}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ S1}\OperatorTok{[}\NormalTok{t1t}\OperatorTok{].}\NormalTok{fir }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ i}\OperatorTok{,}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
              \DataTypeTok{int}\NormalTok{ t }\OperatorTok{=}\NormalTok{ query}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ i}\OperatorTok{);}
  \NormalTok{            Ans }\OperatorTok{+=}\NormalTok{ t}\OperatorTok{;}
  \NormalTok{            S0}\OperatorTok{[++}\NormalTok{t0t}\OperatorTok{]} \OperatorTok{=}\NormalTok{ make\_pair}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}\NormalTok{ S1}\OperatorTok{[++}\NormalTok{t1t}\OperatorTok{]} \OperatorTok{=}\NormalTok{ make\_pair}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
          \OperatorTok{\}}
          \ControlFlowTok{return}\NormalTok{ Ans}\OperatorTok{;}
      \OperatorTok{\}}
  \OperatorTok{\}} \KeywordTok{using}\NormalTok{ Mon\_Stack}\OperatorTok{::}\NormalTok{work}\OperatorTok{;}
  \DataTypeTok{signed}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    n }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();} \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)} \OperatorTok{\{} \DataTypeTok{int}\NormalTok{ x }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ y }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}\NormalTok{ A}\OperatorTok{[}\NormalTok{x}\OperatorTok{]} \OperatorTok{=}\NormalTok{ y}\OperatorTok{;} \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ work}\OperatorTok{(}\NormalTok{A}\OperatorTok{,}\NormalTok{ n}\OperatorTok{));}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \PreprocessorTok{\#include }\ImportTok{\textless{}climits\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}cmath\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}cstring\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}iostream\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}cstdio\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}algorithm\textgreater{}}
  \KeywordTok{using} \KeywordTok{namespace}\NormalTok{ std}\OperatorTok{;}
  \PreprocessorTok{\#define int }\DataTypeTok{long}\PreprocessorTok{ }\DataTypeTok{long}\PreprocessorTok{ }
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ MOD }\OperatorTok{=} \FloatTok{1e9} \OperatorTok{+} \DecValTok{7}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_M }\OperatorTok{=} \FloatTok{2e5} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
  \KeywordTok{inline} \DataTypeTok{int}\NormalTok{ read}\OperatorTok{()} \OperatorTok{\{} \DataTypeTok{char}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();} \DataTypeTok{int}\NormalTok{ sign }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} \DataTypeTok{int}\NormalTok{ x }\OperatorTok{=} \DecValTok{0}\OperatorTok{;} \ControlFlowTok{while}\OperatorTok{(}\NormalTok{c }\OperatorTok{\textgreater{}} \CharTok{\textquotesingle{}9\textquotesingle{}} \OperatorTok{||}\NormalTok{ c }\OperatorTok{\textless{}} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{c}\OperatorTok{==}\CharTok{\textquotesingle{}{-}\textquotesingle{}}\OperatorTok{)}\NormalTok{sign }\OperatorTok{=} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{;}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();} \OperatorTok{\}} \ControlFlowTok{while}\OperatorTok{(}\NormalTok{c }\OperatorTok{\textless{}=} \CharTok{\textquotesingle{}9\textquotesingle{}} \OperatorTok{\&\&}\NormalTok{ c }\OperatorTok{\textgreater{}=} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ x }\OperatorTok{*=} \DecValTok{10}\OperatorTok{;}\NormalTok{ x }\OperatorTok{+=}\NormalTok{ c }\OperatorTok{{-}} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{;}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();} \OperatorTok{\}} \ControlFlowTok{return}\NormalTok{ x }\OperatorTok{*}\NormalTok{ sign}\OperatorTok{;} \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ MAX}\OperatorTok{,}\NormalTok{ m}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ have}\OperatorTok{[}\NormalTok{\_M}\OperatorTok{],}\NormalTok{ tht }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ none}\OperatorTok{[}\NormalTok{\_M}\OperatorTok{],}\NormalTok{ tnt }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ d}\OperatorTok{[}\NormalTok{\_M}\OperatorTok{],}\NormalTok{ tdt }\OperatorTok{=} \DecValTok{0}\OperatorTok{;} 
  \DataTypeTok{int}\NormalTok{ c}\OperatorTok{[}\NormalTok{\_M}\OperatorTok{];}\CommentTok{//tct = tdt}
  \DataTypeTok{bool}\NormalTok{ CanBe}\OperatorTok{[}\NormalTok{\_M}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ ToL}\OperatorTok{[}\NormalTok{\_M}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ ToR}\OperatorTok{[}\NormalTok{\_M}\OperatorTok{];}
  \DataTypeTok{void}\NormalTok{ divide}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ s}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ x}\OperatorTok{)} \OperatorTok{\{}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{*}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ x}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{x }\OperatorTok{\%}\NormalTok{ i }\OperatorTok{==} \DecValTok{0}\OperatorTok{)}\NormalTok{ d}\OperatorTok{[++}\NormalTok{tdt}\OperatorTok{]} \OperatorTok{=}\NormalTok{ i}\OperatorTok{,}\NormalTok{ c}\OperatorTok{[}\NormalTok{tdt}\OperatorTok{]} \OperatorTok{=}\NormalTok{ s }\OperatorTok{\%}\NormalTok{ i}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{i }\OperatorTok{*}\NormalTok{ i }\OperatorTok{!=}\NormalTok{ x}\OperatorTok{)}\NormalTok{ d}\OperatorTok{[++}\NormalTok{tdt}\OperatorTok{]} \OperatorTok{=}\NormalTok{ x }\OperatorTok{/}\NormalTok{ i}\OperatorTok{,}\NormalTok{ c}\OperatorTok{[}\NormalTok{tdt}\OperatorTok{]} \OperatorTok{=}\NormalTok{ s }\OperatorTok{\%}\NormalTok{ d}\OperatorTok{[}\NormalTok{tdt}\OperatorTok{];}
      \OperatorTok{\}}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ tdt}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ CanBe}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \KeywordTok{true}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{signed}\NormalTok{ main}\OperatorTok{()\{}
      \DataTypeTok{int}\NormalTok{ t}\OperatorTok{;}
  \NormalTok{    MAX }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ m }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ m}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
          \DataTypeTok{int}\NormalTok{ type }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{type }\OperatorTok{==} \DecValTok{1}\OperatorTok{)}\NormalTok{ have}\OperatorTok{[++}\NormalTok{tht}\OperatorTok{]} \OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
          \ControlFlowTok{else}\NormalTok{          none}\OperatorTok{[++}\NormalTok{tnt}\OperatorTok{]} \OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
      \OperatorTok{\}}
  \NormalTok{    sort}\OperatorTok{(}\NormalTok{have }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ have }\OperatorTok{+} \DecValTok{1} \OperatorTok{+}\NormalTok{ tht}\OperatorTok{);}\NormalTok{ sort}\OperatorTok{(}\NormalTok{none }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ none }\OperatorTok{+} \DecValTok{1} \OperatorTok{+}\NormalTok{ tnt}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ maxd }\OperatorTok{=}\NormalTok{ INT\_MAX}\OperatorTok{,}\NormalTok{ Sta}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{2}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ tht}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)} \OperatorTok{\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{maxd }\OperatorTok{\textgreater{}}\NormalTok{ have}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{{-}}\NormalTok{ have}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{])\{}
  \NormalTok{            maxd }\OperatorTok{=}\NormalTok{ have}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{{-}}\NormalTok{ have}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{];}
  \NormalTok{            Sta }\OperatorTok{=}\NormalTok{ have}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{];}
          \OperatorTok{\}}
      \OperatorTok{\}}
  \NormalTok{    divide}\OperatorTok{(}\NormalTok{Sta}\OperatorTok{,}\NormalTok{ maxd}\OperatorTok{);}
  
      \CommentTok{/* ÂÖ¨Â∑Æ Âèä ÁâπÂæÅ Ê£ÄÊü•   */}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ tht}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ j }\OperatorTok{\textless{}=}\NormalTok{ tdt}\OperatorTok{;}\NormalTok{ j}\OperatorTok{++)\{}
              \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{CanBe}\OperatorTok{[}\NormalTok{j}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{have}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{\%}\NormalTok{ d}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{!=}\NormalTok{ c}\OperatorTok{[}\NormalTok{j}\OperatorTok{])}\NormalTok{ CanBe}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{=} \KeywordTok{false}\OperatorTok{;}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{2}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ tht}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
          \DataTypeTok{int}\NormalTok{ D }\OperatorTok{=}\NormalTok{ have}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{{-}}\NormalTok{ have}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{];}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ j }\OperatorTok{\textless{}=}\NormalTok{ tdt}\OperatorTok{;}\NormalTok{ j}\OperatorTok{++)\{}
              \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{CanBe}\OperatorTok{[}\NormalTok{j}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{D }\OperatorTok{\%}\NormalTok{ d}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{!=} \DecValTok{0}\OperatorTok{)}\NormalTok{ CanBe}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{=} \KeywordTok{false}\OperatorTok{;}
          \OperatorTok{\}}
      \OperatorTok{\}}
  \NormalTok{    t }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ tdt}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{CanBe}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        d}\OperatorTok{[++}\NormalTok{t}\OperatorTok{]} \OperatorTok{=}\NormalTok{ d}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
  \NormalTok{        c}\OperatorTok{[}\NormalTok{  t}\OperatorTok{]} \OperatorTok{=}\NormalTok{ c}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
  \NormalTok{        CanBe}\OperatorTok{[}\NormalTok{t}\OperatorTok{]} \OperatorTok{=} \KeywordTok{true}\OperatorTok{;}
      \OperatorTok{\}}\NormalTok{ tdt }\OperatorTok{=}\NormalTok{ t}\OperatorTok{;}
      \CommentTok{/* ÂÖ¨Â∑Æ Âèä ÁâπÂæÅ Ê£ÄÊü•   ÂÆåÊàê*/}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ tdt}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)} \OperatorTok{\{} 
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{CanBe}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \OperatorTok{\{}
  \NormalTok{            ToL}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{c}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{==} \DecValTok{0} \OperatorTok{?}\NormalTok{ d}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{:}\NormalTok{ c}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{;}
              \DataTypeTok{int}\NormalTok{ t }\OperatorTok{=}\NormalTok{ MAX }\OperatorTok{\%}\NormalTok{ d}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{t }\OperatorTok{==}\NormalTok{ c}\OperatorTok{[}\NormalTok{i}\OperatorTok{])}\NormalTok{ ToR}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ MAX }\OperatorTok{+} \DecValTok{1}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{t  }\OperatorTok{\textgreater{}}\NormalTok{ c}\OperatorTok{[}\NormalTok{i}\OperatorTok{])}\NormalTok{ ToR}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ MAX }\OperatorTok{{-}} \OperatorTok{(}\NormalTok{t }\OperatorTok{{-}}\NormalTok{ c}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \OperatorTok{+} \DecValTok{1}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{t  }\OperatorTok{\textless{}}\NormalTok{ c}\OperatorTok{[}\NormalTok{i}\OperatorTok{])}\NormalTok{ ToR}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ MAX }\OperatorTok{{-}}\NormalTok{ d}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{+} \OperatorTok{(}\NormalTok{c}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{{-}}\NormalTok{ t}\OperatorTok{)} \OperatorTok{+} \DecValTok{1}\OperatorTok{;}
          \OperatorTok{\}}
      \OperatorTok{\}}
  \NormalTok{    t }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ tdt}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{CanBe}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        d}\OperatorTok{[++}\NormalTok{t}\OperatorTok{]} \OperatorTok{=}\NormalTok{ d}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
  \NormalTok{        c}\OperatorTok{[}\NormalTok{  t}\OperatorTok{]} \OperatorTok{=}\NormalTok{ c}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
  \NormalTok{        CanBe}\OperatorTok{[}\NormalTok{t}\OperatorTok{]} \OperatorTok{=} \KeywordTok{true}\OperatorTok{;}
      \OperatorTok{\}}\NormalTok{ tdt }\OperatorTok{=}\NormalTok{ t}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ MINS }\OperatorTok{=}\NormalTok{ have}\OperatorTok{[}\DecValTok{1}\OperatorTok{],}\NormalTok{ MAXE }\OperatorTok{=}\NormalTok{ have}\OperatorTok{[}\NormalTok{tht}\OperatorTok{];}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ tnt}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
          \DataTypeTok{int}\NormalTok{ now }\OperatorTok{=}\NormalTok{ none}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ j }\OperatorTok{\textless{}=}\NormalTok{ tdt}\OperatorTok{;}\NormalTok{ j}\OperatorTok{++)\{}
              \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{CanBe}\OperatorTok{[}\NormalTok{j}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{now }\OperatorTok{\%}\NormalTok{ d}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{==}\NormalTok{ c}\OperatorTok{[}\NormalTok{j}\OperatorTok{])\{}
                  \ControlFlowTok{if}\OperatorTok{(}\NormalTok{now }\OperatorTok{\textless{}}\NormalTok{ MINS}\OperatorTok{)}
  \NormalTok{                    ToL}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{ToL}\OperatorTok{[}\NormalTok{j}\OperatorTok{],}\NormalTok{ now}\OperatorTok{);}
                  \ControlFlowTok{else} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{now }\OperatorTok{\textgreater{}}\NormalTok{ MAXE}\OperatorTok{)}
  \NormalTok{                    ToR}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{ToR}\OperatorTok{[}\NormalTok{j}\OperatorTok{],}\NormalTok{ now}\OperatorTok{);}
                  \ControlFlowTok{else}\NormalTok{ CanBe}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{=} \KeywordTok{false}\OperatorTok{;}
              \OperatorTok{\}}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ tdt}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{ToL}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{\textgreater{}}\NormalTok{ MINS }\OperatorTok{||}\NormalTok{ ToR}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{\textless{}}\NormalTok{ MAXE}\OperatorTok{)}\NormalTok{ CanBe}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \KeywordTok{false}\OperatorTok{;} \ControlFlowTok{else}\NormalTok{ ToL}\OperatorTok{[}\NormalTok{i}\OperatorTok{]++,}\NormalTok{ ToR}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{{-}{-};}
      \CommentTok{/* ÈùûÊ≥ïÊï∞Â≠óÂ≠òÂú®ÊÄßÊ£ÄÊü• */}
      \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ tdt}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{CanBe}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ k }\OperatorTok{=} \OperatorTok{(}  \OperatorTok{(}\NormalTok{MINS }\OperatorTok{{-}}\NormalTok{ ToL}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \OperatorTok{/}\NormalTok{ d}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{+} \DecValTok{1}\OperatorTok{)} \OperatorTok{*} \OperatorTok{(} \OperatorTok{(}\NormalTok{ToR}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{{-}}\NormalTok{ MAXE}\OperatorTok{)} \OperatorTok{/}\NormalTok{ d}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{+} \DecValTok{1}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;} \CommentTok{// }\AlertTok{TODO}\CommentTok{;}
  \NormalTok{        ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\NormalTok{ k}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
      \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \PreprocessorTok{\#include }\ImportTok{\textless{}climits\textgreater{}}\PreprocessorTok{ }
  \PreprocessorTok{\#include }\ImportTok{\textless{}cstring\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}cmath\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}iostream\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}algorithm\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}vector\textgreater{}}
  \KeywordTok{inline} \DataTypeTok{int}\NormalTok{ read}\OperatorTok{()} \OperatorTok{\{} \DataTypeTok{char}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();} \DataTypeTok{int}\NormalTok{ sign }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} \DataTypeTok{int}\NormalTok{ x }\OperatorTok{=} \DecValTok{0}\OperatorTok{;} \ControlFlowTok{while}\OperatorTok{(}\NormalTok{c }\OperatorTok{\textgreater{}} \CharTok{\textquotesingle{}9\textquotesingle{}} \OperatorTok{||}\NormalTok{ c }\OperatorTok{\textless{}} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{c}\OperatorTok{==}\CharTok{\textquotesingle{}{-}\textquotesingle{}}\OperatorTok{)}\NormalTok{sign }\OperatorTok{=} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{;}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();} \OperatorTok{\}} \ControlFlowTok{while}\OperatorTok{(}\NormalTok{c }\OperatorTok{\textless{}=} \CharTok{\textquotesingle{}9\textquotesingle{}} \OperatorTok{\&\&}\NormalTok{ c }\OperatorTok{\textgreater{}=} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ x }\OperatorTok{*=} \DecValTok{10}\OperatorTok{;}\NormalTok{ x }\OperatorTok{+=}\NormalTok{ c }\OperatorTok{{-}} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{;}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();} \OperatorTok{\}} \ControlFlowTok{return}\NormalTok{ x }\OperatorTok{*}\NormalTok{ sign}\OperatorTok{;} \OperatorTok{\}}
  \KeywordTok{using} \KeywordTok{namespace}\NormalTok{ std}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{6e5} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ base }\OperatorTok{=} \DecValTok{15}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ MOD }\OperatorTok{=} \DecValTok{1020031005}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ SS}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ pow}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ a}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ b }\OperatorTok{=}\NormalTok{ base}\OperatorTok{)\{} \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} \ControlFlowTok{while}\OperatorTok{(}\NormalTok{b}\OperatorTok{)\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{b }\OperatorTok{\&} \DecValTok{1}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ a}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}\NormalTok{ a }\OperatorTok{=} \OperatorTok{(}\NormalTok{a }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ a}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}\NormalTok{ b }\OperatorTok{\textgreater{}\textgreater{}=} \DecValTok{1}\OperatorTok{;} \OperatorTok{\}} \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;} \OperatorTok{\}}
  
  \DataTypeTok{int}\NormalTok{ head}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ NodeVal}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \KeywordTok{struct}\NormalTok{ edges}\OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ node}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ nxt}\OperatorTok{;}
  \OperatorTok{\}}\NormalTok{edge}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{void}\NormalTok{ add}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ u}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ v}\OperatorTok{)\{}
  \NormalTok{    tot}\OperatorTok{++;}
  \NormalTok{    edge}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{node }\OperatorTok{=}\NormalTok{ v}\OperatorTok{;}
  \NormalTok{    edge}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{nxt  }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{u}\OperatorTok{];}
  \NormalTok{    head}\OperatorTok{[}\NormalTok{u}\OperatorTok{]}        \OperatorTok{=}\NormalTok{ tot}\OperatorTok{;}
  \OperatorTok{\}}
  
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ q}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ dep}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ fa}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ rnk}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ top}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ son}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ si}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ dfc }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{void}\NormalTok{ dfs0}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ now}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ f}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ dp}\OperatorTok{)\{}
      \DataTypeTok{int} \OperatorTok{\&}\NormalTok{S }\OperatorTok{=}\NormalTok{ si}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;} \DataTypeTok{int} \OperatorTok{\&}\NormalTok{Mid }\OperatorTok{=}\NormalTok{ son}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ fa}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=}\NormalTok{ f}\OperatorTok{;}\NormalTok{ dep}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=}\NormalTok{ dp}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{ i }\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{ex }\OperatorTok{==}\NormalTok{ f}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        dfs0}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ now}\OperatorTok{,}\NormalTok{ dp }\OperatorTok{+} \DecValTok{1}\OperatorTok{);}\NormalTok{ S }\OperatorTok{+=}\NormalTok{ si}\OperatorTok{[}\NormalTok{ex}\OperatorTok{];}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{si}\OperatorTok{[}\NormalTok{ex}\OperatorTok{]} \OperatorTok{\textgreater{}}\NormalTok{ si}\OperatorTok{[}\NormalTok{Mid}\OperatorTok{])}\NormalTok{ Mid }\OperatorTok{=}\NormalTok{ ex}\OperatorTok{;}
      \OperatorTok{\}} \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{Mid}\OperatorTok{)}\NormalTok{ Mid }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{void}\NormalTok{ dfs1}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ now}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ f}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ tp}\OperatorTok{)\{}
  \NormalTok{    dfn}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=} \OperatorTok{++}\NormalTok{dfc}\OperatorTok{;}\NormalTok{ rnk}\OperatorTok{[}\NormalTok{dfc}\OperatorTok{]} \OperatorTok{=}\NormalTok{ now}\OperatorTok{;}
  \NormalTok{    top}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=}\NormalTok{ tp}\OperatorTok{;}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{son}\OperatorTok{[}\NormalTok{now}\OperatorTok{])}\NormalTok{ dfs1}\OperatorTok{(}\NormalTok{son}\OperatorTok{[}\NormalTok{now}\OperatorTok{],}\NormalTok{ now}\OperatorTok{,}\NormalTok{ tp}\OperatorTok{);}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{ i }\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{ex }\OperatorTok{==}\NormalTok{ f }\OperatorTok{||}\NormalTok{ ex }\OperatorTok{==}\NormalTok{ son}\OperatorTok{[}\NormalTok{now}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        dfs1}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ now}\OperatorTok{,}\NormalTok{ ex}\OperatorTok{);}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \DataTypeTok{void}\NormalTok{ clear}\OperatorTok{()\{}
  \NormalTok{    memset}\OperatorTok{(}\NormalTok{head}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{head}\OperatorTok{));}
  \NormalTok{    dfn}\OperatorTok{[}\DecValTok{0}\OperatorTok{]} \OperatorTok{=}\NormalTok{ rnk}\OperatorTok{[}\DecValTok{0}\OperatorTok{]} \OperatorTok{=}\NormalTok{ si}\OperatorTok{[}\DecValTok{0}\OperatorTok{]} \OperatorTok{=}\NormalTok{ top}\OperatorTok{[}\DecValTok{0}\OperatorTok{]} \OperatorTok{=}\NormalTok{ fa}\OperatorTok{[}\DecValTok{0}\OperatorTok{]} \OperatorTok{=}\NormalTok{ son}\OperatorTok{[}\DecValTok{0}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    dfc }\OperatorTok{=} \DecValTok{0}\OperatorTok{;} 
  \OperatorTok{\}}
  \KeywordTok{namespace}\NormalTok{ SegmentTree}\OperatorTok{\{}
      \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{3e6} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ ch}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\DecValTok{2}\OperatorTok{];}
      \DataTypeTok{int}\NormalTok{ v}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
      \PreprocessorTok{\#define make }\OperatorTok{(}\NormalTok{tot}\OperatorTok{++,}\PreprocessorTok{ }\NormalTok{ch}\OperatorTok{[}\NormalTok{tot}\OperatorTok{][}\DecValTok{0}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{ch}\OperatorTok{[}\NormalTok{tot}\OperatorTok{][}\DecValTok{1}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{v}\OperatorTok{[}\NormalTok{tot}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\DecValTok{0}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{tot}\OperatorTok{);}
      \PreprocessorTok{\#define ls}\OperatorTok{(}\NormalTok{x}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{ch}\OperatorTok{[}\NormalTok{x}\OperatorTok{][}\DecValTok{0}\OperatorTok{])}
      \PreprocessorTok{\#define rs}\OperatorTok{(}\NormalTok{x}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{ch}\OperatorTok{[}\NormalTok{x}\OperatorTok{][}\DecValTok{1}\OperatorTok{])}
      \PreprocessorTok{\#define maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)]}\PreprocessorTok{ }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\PreprocessorTok{ }\NormalTok{v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)])}\PreprocessorTok{ }\OperatorTok{\%}\PreprocessorTok{ }\NormalTok{MOD}\PreprocessorTok{ }\OperatorTok{)}
      \DataTypeTok{void}\NormalTok{ init\_s}\OperatorTok{()} \OperatorTok{\{}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{  Groot}\OperatorTok{()\{} \ControlFlowTok{return}\NormalTok{ make}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ build}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{==}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{(}\DataTypeTok{void}\OperatorTok{)(}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=}\NormalTok{ pow}\OperatorTok{(}\NormalTok{NodeVal}\OperatorTok{[}\NormalTok{rnk}\OperatorTok{[}\NormalTok{L}\OperatorTok{]]));}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{L }\OperatorTok{+}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{        ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)} \OperatorTok{=}\NormalTok{ make}\OperatorTok{;}\NormalTok{ rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)} \OperatorTok{=}\NormalTok{ make}\OperatorTok{;}
  \NormalTok{        build}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}\NormalTok{ build}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
  \NormalTok{        maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
      \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ update}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ p}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ x}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{nowl }\OperatorTok{==}\NormalTok{ nowr}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{(}\DataTypeTok{void}\OperatorTok{)(}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=}\NormalTok{ pow}\OperatorTok{(}\NormalTok{x}\OperatorTok{));}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{p }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ p}\OperatorTok{,}\NormalTok{ x}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{p  }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ p}\OperatorTok{,}\NormalTok{ x}\OperatorTok{);}
  \NormalTok{        maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ query}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textgreater{}}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ nowl }\OperatorTok{\&\&}\NormalTok{ nowr }\OperatorTok{\textless{}=}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ query}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{))} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R  }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ query}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{))} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
          \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;}
      \OperatorTok{\}}
  \OperatorTok{\}} \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{Groot}\OperatorTok{;} \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{init\_s}\OperatorTok{;} \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{build}\OperatorTok{;} \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{update}\OperatorTok{;} \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{query}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ root }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ LCA}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ QueryOnPath}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ x}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ y}\OperatorTok{)\{}
      \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{top}\OperatorTok{[}\NormalTok{x}\OperatorTok{]} \OperatorTok{!=}\NormalTok{ top}\OperatorTok{[}\NormalTok{y}\OperatorTok{])\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{dep}\OperatorTok{[}\NormalTok{top}\OperatorTok{[}\NormalTok{x}\OperatorTok{]]} \OperatorTok{\textgreater{}}\NormalTok{ dep}\OperatorTok{[}\NormalTok{top}\OperatorTok{[}\NormalTok{y}\OperatorTok{]])}\NormalTok{ swap}\OperatorTok{(}\NormalTok{x}\OperatorTok{,}\NormalTok{ y}\OperatorTok{);}
  \NormalTok{        ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ query}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{top}\OperatorTok{[}\NormalTok{y}\OperatorTok{]],}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{y}\OperatorTok{]))} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
  \NormalTok{        y }\OperatorTok{=}\NormalTok{ fa}\OperatorTok{[}\NormalTok{top}\OperatorTok{[}\NormalTok{y}\OperatorTok{]];}
      \OperatorTok{\}}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{dep}\OperatorTok{[}\NormalTok{x}\OperatorTok{]} \OperatorTok{\textless{}}\NormalTok{ dep}\OperatorTok{[}\NormalTok{y}\OperatorTok{])}\NormalTok{ swap}\OperatorTok{(}\NormalTok{x}\OperatorTok{,}\NormalTok{ y}\OperatorTok{);}\NormalTok{ LCA }\OperatorTok{=}\NormalTok{ y}\OperatorTok{;}
  \NormalTok{    ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ query}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{y}\OperatorTok{],}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{x}\OperatorTok{]))} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;} 
      \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{void}\NormalTok{ doit}\OperatorTok{()\{}
  \NormalTok{    clear}\OperatorTok{();}
  \NormalTok{    n }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ q }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ NodeVal}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}}\NormalTok{  n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{} \DataTypeTok{int}\NormalTok{ u }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ v }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}\NormalTok{ add}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{);}\NormalTok{ add}\OperatorTok{(}\NormalTok{v}\OperatorTok{,}\NormalTok{ u}\OperatorTok{);} \OperatorTok{\}}
  \NormalTok{    dfs0}\OperatorTok{(}\DecValTok{1}\OperatorTok{,} \DecValTok{1}\OperatorTok{,} \DecValTok{1}\OperatorTok{);}
  \NormalTok{    dfs1}\OperatorTok{(}\DecValTok{1}\OperatorTok{,} \DecValTok{1}\OperatorTok{,} \DecValTok{1}\OperatorTok{);}
  \NormalTok{    init\_s}\OperatorTok{();}\NormalTok{ root }\OperatorTok{=}\NormalTok{ Groot}\OperatorTok{();}
  \NormalTok{    build}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{);}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{q}\OperatorTok{{-}{-})\{}
          \DataTypeTok{int}\NormalTok{ opt }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ x }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ y }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{opt }\OperatorTok{==} \DecValTok{1}\OperatorTok{)\{}
              \DataTypeTok{int}\NormalTok{ r }\OperatorTok{=}\NormalTok{ QueryOnPath}\OperatorTok{(}\NormalTok{x}\OperatorTok{,}\NormalTok{ y}\OperatorTok{);}
              \DataTypeTok{int}\NormalTok{ Len }\OperatorTok{=}\NormalTok{ dep}\OperatorTok{[}\NormalTok{x}\OperatorTok{]} \OperatorTok{+}\NormalTok{ dep}\OperatorTok{[}\NormalTok{y}\OperatorTok{]} \OperatorTok{{-}} \OperatorTok{(}\NormalTok{dep}\OperatorTok{[}\NormalTok{LCA}\OperatorTok{]} \OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{)} \OperatorTok{+} \DecValTok{1}\OperatorTok{;}
  \NormalTok{            puts}\OperatorTok{(}\NormalTok{SS}\OperatorTok{[}\NormalTok{Len}\OperatorTok{]} \OperatorTok{==}\NormalTok{ r }\OperatorTok{?} \StringTok{"Yes"} \OperatorTok{:} \StringTok{"No"}\OperatorTok{);}
          \OperatorTok{\}} \ControlFlowTok{else}\OperatorTok{\{}
  \NormalTok{            update}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{x}\OperatorTok{],}\NormalTok{ y}\OperatorTok{);}
          \OperatorTok{\}}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=} \FloatTok{3e5}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ SS}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{ SS}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ pow}\OperatorTok{(}\NormalTok{i}\OperatorTok{)} \OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ T }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{T}\OperatorTok{{-}{-})}\NormalTok{ doit}\OperatorTok{();}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \section{CF521E Cycling City}\label{cf521e-cycling-city}
  
  \begin{itemize}
  \tightlist
  \item
    ÁªôÂÆö‰∏ÄÂº† \(n\) ‰∏™ÁÇπ \(m\) Êù°ËæπÁöÑÊó†ÂêëÁÆÄÂçïÂõæ„ÄÇ
  \item
    ÈóÆÂõæ‰∏≠ËÉΩÂê¶ÊâæÂà∞‰∏§‰∏™ÁÇπÔºåÊª°Ë∂≥Ëøô‰∏§‰∏™ÁÇπ‰πãÈó¥ÊúâËá≥Â∞ë‰∏âÊù°ÂÆåÂÖ®‰∏çÁõ∏‰∫§ÁöÑÁÆÄÂçïË∑ØÂæÑ„ÄÇ
  \item
    \(n,m \le 2 \times 10^5\)ÔºåÂõæ‰∏ç‰øùËØÅËøûÈÄö
  \end{itemize}
  
  ËÄÉËôëÁîüÊàêÊ†ëÔºåÂØπÂéüÂõæÂÅö‰∏Ä‰∏™ÁîüÊàêÊ†ëÔºåËÄÉËôëÊØè‰∏™Âú®ÁîüÊàêÊ†ëÂ§ñÁöÑËæπÔºåË¶ÜÁõñÂú®Ê†ë‰∏äÔºåÊ†ë‰∏äËæπË¢´Ë¶ÜÁõñ‰∏§Ê¨°ÁöÑÔºåÂç≥‰∏∫‰∏ÄÁßçÊñπÊ°à
  
  Áî±‰∫éÊ†ëÁöÑÊãìÊâëÁªìÊûÑÊØîÂõæË¶ÅÁÆÄÂçïÂæàÂ§öÔºåÁõ¥Êé•ÊÄùËÄÉÂõæÁöÑÁîüÊàêÊ†ëËß£ÂÜ≥ÂõæÂÜÖÈóÆÈ¢òÊòØ‰∏Ä‰∏™Â∏∏ËßÅÊÄùË∑Ø„ÄÇ
  
  \section{CF547D Mike and Fish}\label{cf547d-mike-and-fish}
  
  \textbf{ÂæÖÂ°´}
  
  \end{document}
[INFO] [makePDF] LaTeX run number 1
[INFO] [makePDF] LaTeX output
  This is XeTeX, Version 3.141592653-2.6-0.999995 (TeX Live 2023/Debian) (preloaded format=xelatex)
   restricted \write18 enabled.
  entering extended mode
  (.../input.tex
  LaTeX2e <2023-11-01> patch level 1
  L3 programming layer <2024-01-22>
  (.../article.cls
  Document Class: article 2023/05/17 v1.4n Standard LaTeX document class
  (.../[system]
  (.../xcolor.sty
  (.../color.cfg)
  (.../xetex.def)
  (.../[system]
  (.../geometry.sty
  (.../keyval.sty)
  (.../ifvtex.sty
  (.../iftex.sty)))
  (.../amsmath.sty
  For additional information on amsmath, use the `?' option.
  (.../amstext.sty
  (.../amsgen.sty))
  (.../amsbsy.sty)
  (.../amsopn.sty))
  (.../amssymb.sty
  (.../amsfonts.sty))
  (.../unicode-math.sty
  (.../expl3.sty
  (.../l3backend-xetex.def))
  (.../unicode-math-xetex.sty
  (.../xparse.sty)
  (.../l3keys2e.sty)
  (.../fontspec.sty
  (.../fontspec-xetex.sty
  (.../fontenc.sty)
  (.../fontspec.cfg)))
  (.../fix-cm.sty
  (.../ts1enc.def))
  (.../unicode-math-table.tex)))
  (.../lmodern.sty)
  (.../xeCJK.sty
  (.../ctexhook.sty)
  (.../xtemplate.sty)
  (.../xeCJK.cfg))
  (.../upquote.sty
  (.../textcomp.sty))
  (.../microtype.sty
  (.../etoolbox.sty)
  (.../microtype-xetex.def)
  (.../microtype.cfg))
  (.../setspace.sty)
  (.../parskip.sty
  (.../kvoptions.sty
  (.../ltxcmds.sty)
  (.../kvsetkeys.sty)))
  (.../fancyvrb.sty)
  (.../soul.sty
  (.../soul-ori.sty)
  (.../infwarerr.sty)
  (.../etexcmds.sty))
  (.../xeCJKfntef.sty
  (.../ulem.sty))
  (.../bookmark.sty
  (.../hyperref.sty
  (.../kvdefinekeys.sty)
  (.../pdfescape.sty
  (.../pdftexcmds.sty))
  (.../hycolor.sty)
  (.../auxhook.sty)
  (.../nameref.sty
  (.../refcount.sty)
  (.../gettitlestring.sty))
  (.../pd1enc.def)
  (.../intcalc.sty)
  (.../puenc.def)
  (.../url.sty)
  (.../bitset.sty
  (.../bigintcalc.sty))
  (.../atbegshi-ltx.sty))
  (.../hxetex.def
  (.../stringenc.sty)
  (.../rerunfilecheck.sty
  (.../atveryend-ltx.sty)
  (.../uniquecounter.sty)))
  (.../bkm-dvipdfm.def))
  (.../xurl.sty)
  No file input.aux.
  *geometry* driver: auto-detecting
  *geometry* detected driver: xetex
  (.../mt-LatinModernRoman.cfg)
  
  Package hyperref Warning: Rerun to get /PageLabels entry.
  
  (.../omllmm.fd)
  (.../umsa.fd)
  (.../mt-msa.cfg)
  (.../umsb.fd)
  (.../mt-msb.cfg)
  
  Package xeCJK Warning: Unknown CJK family `\CJKttdefault' is being ignored.
  (xeCJK)                
  (xeCJK)                Try to use `\setCJKmonofont[<...>]{<...>}' to define
  (xeCJK)                it.
  
  [1]
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/m/it' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 186.
  
  [2] [3]
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/b/n' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 311.
  
  Missing character: There is no ‚ë® (U+2468) in font Latin Modern Roman 10 Regular
  /OT:script=latn;language=dflt;mapping=tex-text;!
  [4] [5] [6] [7] [8] [9] [10] [11] [12]
  (.../input.aux)
  
  LaTeX Font Warning: Some font shapes were not available, defaults substituted.
  
  
  LaTeX Warning: Label(s) may have changed. Rerun to get cross-references right.
  
   )
  Output written on .../input.pdf (12 pages).
  Transcript written on .../input.log.
[INFO] [makePDF] Rerun needed
  Package hyperref Warning: Rerun to get /PageLabels entry.
  LaTeX Warning: Label(s) may have changed. Rerun to get cross-references right.
[INFO] [makePDF] LaTeX run number 2
[INFO] [makePDF] LaTeX output
  This is XeTeX, Version 3.141592653-2.6-0.999995 (TeX Live 2023/Debian) (preloaded format=xelatex)
   restricted \write18 enabled.
  entering extended mode
  (.../input.tex
  LaTeX2e <2023-11-01> patch level 1
  L3 programming layer <2024-01-22>
  (.../article.cls
  Document Class: article 2023/05/17 v1.4n Standard LaTeX document class
  (.../[system]
  (.../xcolor.sty
  (.../color.cfg)
  (.../xetex.def)
  (.../[system]
  (.../geometry.sty
  (.../keyval.sty)
  (.../ifvtex.sty
  (.../iftex.sty)))
  (.../amsmath.sty
  For additional information on amsmath, use the `?' option.
  (.../amstext.sty
  (.../amsgen.sty))
  (.../amsbsy.sty)
  (.../amsopn.sty))
  (.../amssymb.sty
  (.../amsfonts.sty))
  (.../unicode-math.sty
  (.../expl3.sty
  (.../l3backend-xetex.def))
  (.../unicode-math-xetex.sty
  (.../xparse.sty)
  (.../l3keys2e.sty)
  (.../fontspec.sty
  (.../fontspec-xetex.sty
  (.../fontenc.sty)
  (.../fontspec.cfg)))
  (.../fix-cm.sty
  (.../ts1enc.def))
  (.../unicode-math-table.tex)))
  (.../lmodern.sty)
  (.../xeCJK.sty
  (.../ctexhook.sty)
  (.../xtemplate.sty)
  (.../xeCJK.cfg))
  (.../upquote.sty
  (.../textcomp.sty))
  (.../microtype.sty
  (.../etoolbox.sty)
  (.../microtype-xetex.def)
  (.../microtype.cfg))
  (.../setspace.sty)
  (.../parskip.sty
  (.../kvoptions.sty
  (.../ltxcmds.sty)
  (.../kvsetkeys.sty)))
  (.../fancyvrb.sty)
  (.../soul.sty
  (.../soul-ori.sty)
  (.../infwarerr.sty)
  (.../etexcmds.sty))
  (.../xeCJKfntef.sty
  (.../ulem.sty))
  (.../bookmark.sty
  (.../hyperref.sty
  (.../kvdefinekeys.sty)
  (.../pdfescape.sty
  (.../pdftexcmds.sty))
  (.../hycolor.sty)
  (.../auxhook.sty)
  (.../nameref.sty
  (.../refcount.sty)
  (.../gettitlestring.sty))
  (.../pd1enc.def)
  (.../intcalc.sty)
  (.../puenc.def)
  (.../url.sty)
  (.../bitset.sty
  (.../bigintcalc.sty))
  (.../atbegshi-ltx.sty))
  (.../hxetex.def
  (.../stringenc.sty)
  (.../rerunfilecheck.sty
  (.../atveryend-ltx.sty)
  (.../uniquecounter.sty)))
  (.../bkm-dvipdfm.def))
  (.../xurl.sty)
  (.../input.aux)
  *geometry* driver: auto-detecting
  *geometry* detected driver: xetex
  (.../mt-LatinModernRoman.cfg)
  (.../omllmm.fd)
  (.../umsa.fd)
  (.../mt-msa.cfg)
  (.../umsb.fd)
  (.../mt-msb.cfg)
  
  Package xeCJK Warning: Unknown CJK family `\CJKttdefault' is being ignored.
  (xeCJK)                
  (xeCJK)                Try to use `\setCJKmonofont[<...>]{<...>}' to define
  (xeCJK)                it.
  
  [1]
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/m/it' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 186.
  
  [2] [3]
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/b/n' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 311.
  
  Missing character: There is no ‚ë® (U+2468) in font Latin Modern Roman 10 Regular
  /OT:script=latn;language=dflt;mapping=tex-text;!
  [4] [5] [6] [7] [8] [9] [10] [11] [12]
  (.../input.aux)
  
  LaTeX Font Warning: Some font shapes were not available, defaults substituted.
  
   )
  Output written on .../input.pdf (12 pages).
  Transcript written on .../input.log.
[WARNING] Missing character: There is no ‚ë® (U+2468) (U+2468) in font Latin Modern Roman 10 Regular
</pre>
                                            </details>
                    
                                    </div>
                                </article>
                

                

                

                

            

                
                        </div>
                    </main>
            </div>

                <!-- Footer -->
                <footer id="footer">
                    <p>¬© 2025 ShuYuMo's Blog by Jiayi Su. All rights reserved.</p>  Powered by <b>MonoPy</b> - Single-Script Blog Generator in Python.
                </footer>
            </div>
        </div>
        
        <!-- Back to top button -->
        <button id="back-to-top" 
                aria-label="Back to top" 
                title="Back to top"
                style="display: none;">
            ‚Üë
        </button>
        
        <!-- JavaScript -->
        <script>
            // Back to top functionality
            (function() {
                const backToTopButton = document.getElementById('back-to-top');
                const scrollThreshold = 300;
                
                function toggleBackToTop() {
                    if (window.scrollY > scrollThreshold) {
                        backToTopButton.style.display = 'block';
                    } else {
                        backToTopButton.style.display = 'none';
                    }
                }
                
                function scrollToTop() {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                }
                
                window.addEventListener('scroll', toggleBackToTop);
                backToTopButton.addEventListener('click', scrollToTop);
            })();
            
            // Clean up redundant spans in code blocks
            document.querySelectorAll('pre code').forEach(codeBlock => {
                // Find all line spans
                const lineSpans = codeBlock.querySelectorAll('span[id^="cb"]');
                
                lineSpans.forEach(lineSpan => {
                    // Check if this line has nested spans that can be simplified
                    const children = Array.from(lineSpan.childNodes);
                    
                    // Skip the anchor link (first child is usually the line number anchor)
                    let contentStart = 0;
                    if (children[0] && children[0].tagName === 'A') {
                        contentStart = 1;
                    }
                    
                    // If there's only one span child after the anchor, unwrap it
                    const contentChildren = children.slice(contentStart);
                    if (contentChildren.length === 1 && contentChildren[0].tagName === 'SPAN') {
                        const spanChild = contentChildren[0];
                        // Move the span's contents directly to the line span
                        while (spanChild.firstChild) {
                            lineSpan.insertBefore(spanChild.firstChild, spanChild);
                        }
                        // Remove the now-empty span
                        spanChild.remove();
                    }
                });
            });
            
            // Code copy functionality
            document.querySelectorAll('pre code').forEach(block => {
                const button = document.createElement('button');
                button.className = 'copy-button';
                button.textContent = 'Copy';
                button.setAttribute('aria-label', 'Copy code to clipboard');
                
                button.addEventListener('click', function() {
                    navigator.clipboard.writeText(block.textContent).then(() => {
                        button.textContent = 'Copied!';
                        setTimeout(() => button.textContent = 'Copy', 2000);
                    }).catch(() => {
                        // Fallback for older browsers
                        const textArea = document.createElement('textarea');
                        textArea.value = block.textContent;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        button.textContent = 'Copied!';
                        setTimeout(() => button.textContent = 'Copy', 2000);
                    });
                });
                
                const pre = block.parentNode;
                pre.style.position = 'relative';
                pre.appendChild(button);
            });
        </script>
    </body>
</html>