<!-- Academic Blog Template
MIT License - Copyright (c) 2025 Su Jiayi <sujiayi2003@gmail.com>
-->

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        
        <!-- Primary Meta Tags -->
        <title>ShuYuMo&#39;s Blog | Jiayi Su</title>
        <meta name="description" content="‰∏Ä‰∫õÂ•áÂ•áÊÄ™ÊÄ™ÁöÑ INFP ÈöèÁ¢éÁ¢éÂøµ„ÄÇ">
        <meta name="keywords" content="nb1, nb2, nb3">
        <meta name="author" content="Su Jiayi">
        
        <!-- Open Graph Meta Tags -->
        <meta property="og:type" content="website">
        <meta property="og:title" content="ShuYuMo&#39;s Blog | Jiayi Su">
        <meta property="og:description" content="‰∏Ä‰∫õÂ•áÂ•áÊÄ™ÊÄ™ÁöÑ INFP ÈöèÁ¢éÁ¢éÂøµ„ÄÇ">
        <meta property="og:image" content="../static/images/header.jpg">
        
        <!-- Stylesheets -->
        <link rel="stylesheet" type="text/css" href="../static/css/default.css">
        <link rel="stylesheet" type="text/css" href="../static/css/syntax.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
        
        <!-- Google Analytics -->
        
    </head>
    <body>
        <!-- Skip to main content for accessibility -->
        <a href="#main-content" class="skip-link">Skip to main content</a>
        
        <div id="main">
            <div class="main-container">
                <!-- Header -->
                <header id="header">
                    <div class="header-content">
                        <h1 class="header-title">
                            <a href="./">ShuYuMo&#39;s Blog</a>
                        </h1>
                        <p class="header-subtitle">‰∏Ä‰∫õÂ•áÂ•áÊÄ™ÊÄ™ÁöÑ INFP ÈöèÁ¢éÁ¢éÂøµ„ÄÇ</p>
                        <div class="header-accent"></div>
                    </div>
                </header>
                
                <!-- Content Layout -->
                <div class="content-wrapper">
                    <!-- Sidebar -->
                    <nav id="sidebar">
                        <div class="profile-section">
                            <a href="./" class="profile-avatar-link">
                                <img src="../static/images/header.jpg" alt="ShuYuMo&#39;s header" class="profile-avatar" loading="lazy" />
                            </a>
                            <div class="profile-info">
                                <h3 class="profile-name">Jiayi Su (ShuYuMo)</h3>
            </div>
            </div>

                        <div class="nav-header">
                            <h2>üß≠ Navigation</h2>
                            <span class="nav-subtitle">Explore the site</span>
                        </div>
                        <nav class="nav-menu">
                            
                            
                            <a href="./_post.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">Posts</span>
                                
                            </a>
                            
                            
                            <a href="./_archive.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">Archive</span>
                                
                            </a>
                            
                            
                            <a href="./_category.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">Category</span>
                                
                            </a>
                            
                            
                            <a href="./_about.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">About</span>
                                
                            </a>
                            
                        </nav>
                    </nav>

                    <!-- Main Content -->
                    <main id="content">
                        <div id="main-content">
                            
                                <article>
                                    <!-- Article Header with Title and Actions -->
                                    <div class="article-header">
                                        <div class="article-title-section">
                                            
                                                <h1 class="article-title">„ÄåÂ≠¶‰π†ÊÄªÁªì„ÄçÊï∞ËÆ∫</h1>
                                            
                                            
                                            <!-- Article Meta Information -->
                                            <div class="article-meta">
                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">üìÖ</span>
                                                        <span class="meta-label">Last Updated: </span>
                                                        <span class="meta-value">2020-12-20</span>
                                                    </div>
                                                
                                                
                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">üìä</span>
                                                        <span class="meta-label">Word Count: </span>
                                                        <span class="meta-value">1930</span>
                                                    </div>
                    

                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">‚è±Ô∏è</span>
                                                        <span class="meta-label">Estimated Reading Time: </span>
                                                        <span class="meta-value">13 minutes</span>
                                                    </div>
                                                
                                            </div>
                                        </div>
                                        
                                        <div class="article-actions">
                    
                                                <a href="../pdf/oi-blog_„ÄåÂ≠¶‰π†ÊÄªÁªì„ÄçÊï∞ËÆ∫.pdf" 
                                                   target="_blank" 
                                                   rel="noopener"
                                                   class="action-btn pdf-btn">
                                                    üìÑ PDF
                                                </a>
                                            
                                            
                                            
                                                <a href="../src/oi-blog/„ÄåÂ≠¶‰π†ÊÄªÁªì„ÄçÊï∞ËÆ∫.md" 
                                                   target="_blank" 
                                                   rel="noopener"
                                                   class="action-btn source-btn">
                                                    üìù Source
                                                </a>
                                            
                                        </div>
                                    </div>

                                    <!-- Article Content -->
                                    <div class="article-content">
                                        <p>ÂÖ≥‰∫é <code>Lucas</code>
ÂÆöÁêÜÂèäÂÖ∂Êâ©Â±ïÔºå<code>BSGS</code>ÂèäÂÖ∂Êâ©Â±ïÔºåÂø´ÈÄüË¥®Âõ†Êï∞ÂàÜËß£
<code>Pollard-Rho</code>ÔºåÁ¥†ÊÄßÊµãËØï‰ª•ÂèäÂéüÊ†πÂíåÈò∂ÁöÑ‰∏Ä‰∫õÂèØÁà±Áü•ËØÜ„ÄÇ
<!-- more --></p>
<h1 id="Êï∞ËÆ∫">Êï∞ËÆ∫</h1>
<h2 id="lucas-ÂÆöÁêÜ">Lucas ÂÆöÁêÜ</h2>
<p>Ëß£ÂÜ≥Ê®°Êï∞‰∏∫Â∞èË¥®Êï∞ÁöÑÁªÑÂêàÊï∞ÂèñÊ®°ÈóÆÈ¢ò„ÄÇ</p>
<p>ËÆæÊ®°Êï∞‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>ÔºåËÆæ
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>n</mi><mo>=</mo><munder><mo>‚àë</mo><mrow><mi>i</mi><mo>‚â•</mo><mn>0</mn></mrow></munder><mrow><msub><mi>a</mi><mi>i</mi></msub><msup><mi>P</mi><mi>i</mi></msup></mrow><mo separator="true">,</mo><mi>m</mi><mo>=</mo><munder><mo>‚àë</mo><mrow><mi>i</mi><mo>‚â•</mo><mn>0</mn></mrow></munder><mrow><msub><mi>b</mi><mi>i</mi></msub><msup><mi>P</mi><mi>i</mi></msup></mrow></mrow><annotation encoding="application/x-tex">n = \sum_{i \ge 0}\limits{a_i P^i}, m = \sum_{i \ge 0}\limits{b_i P^i}\notag</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4229em;vertical-align:-1.3728em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">‚â•</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">‚àë</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.3728em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4229em;vertical-align:-1.3728em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">‚â•</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">‚àë</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.3728em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></span></span>
<span
id="eq:Lucas"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mi>n</mi><mi>m</mi></mfrac><mo fence="true">)</mo></mrow><mo>‚â°</mo><munder><mo>‚àè</mo><mrow><mi>i</mi><mo>‚â•</mo><mn>0</mn></mrow></munder><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><msub><mi>a</mi><mi>i</mi></msub><msub><mi>b</mi><mi>i</mi></msub></mfrac><mo fence="true">)</mo></mrow><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>¬†</mtext><mi>P</mi><mo stretchy="false">)</mo><mspace width="2em"/><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\dbinom{n}{m} \equiv \prod_{i \ge 0}\limits{\dbinom{a_i}{b_i}} ( mod\ P)
\qquad{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.8228em;vertical-align:-1.3728em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">‚â•</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">‚àè</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.3728em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace">¬†</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">)</span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></span></span></p>
<p>ÂêåÊó∂ (eq.~eq.¬†1) ËøòÊúâ‰∏ÄÁßçÂΩ¢ÂºèÂåñÁöÑÂÜôÊ≥ïÔºö</p>
<p><span
id="eq:Luacs_ex"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mi>n</mi><mi>m</mi></mfrac><mo fence="true">)</mo></mrow><mo>‚â°</mo><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><mo stretchy="false">‚åä</mo><mi>n</mi><mi mathvariant="normal">/</mi><mi>P</mi><mo stretchy="false">‚åã</mo></mrow><mrow><mo stretchy="false">‚åä</mo><mi>m</mi><mi mathvariant="normal">/</mi><mi>P</mi><mo stretchy="false">‚åã</mo></mrow></mfrac><mo fence="true">)</mo></mrow><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><mi>n</mi><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>‚Äâ</mtext><mtext>‚Äâ</mtext><mi>P</mi></mrow><mrow><mi>m</mi><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>‚Äâ</mtext><mtext>‚Äâ</mtext><mi>P</mi></mrow></mfrac><mo fence="true">)</mo></mrow><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>¬†</mtext><mi>P</mi><mo stretchy="false">)</mo><mspace width="2em"/><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\dbinom{n}{m} \equiv \dbinom{\lfloor n/P\rfloor}{\lfloor m/P\rfloor}\dbinom{n \mod P}{m \mod P}(mod\ P)
\qquad{(2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">‚åä</span><span class="mord mathnormal">m</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">‚åã</span></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">‚åä</span><span class="mord mathnormal">n</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">‚åã</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6667em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6667em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace">¬†</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">)</span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span></span></span></p>
<p>Ëã•Â∞èÁªÑÂêàÊï∞ÂèØ‰ª•
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>
Êü•ËØ¢Ôºå<code>Luacs</code> ÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msub><mrow><mi>log</mi><mo>‚Å°</mo></mrow><mi>p</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\log_p(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1302em;vertical-align:-0.3802em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>
„ÄÇ</p>
<p>ÂèñÊ®°Âêé‰∏çËÉΩ‰øùËØÅ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚â•</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \ge m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â•</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>
ÔºåÊü•ËØ¢ÁªÑÂêàÊï∞Ë¶ÅÂÜôÁöÑÁªÜËá¥‰∏ÄÁÇπ„ÄÇ</p>
<p>ÁâπÊÆäÂú∞ÔºåÂ¶ÇÊûúÊ®°Êï∞ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>
ÔºåÊ†πÊçÆ (eq.~eq.¬†1) ËÄÉËôëÂ¶ÇÊûúÊääÊï∞Â≠óËøõË°å‰∫åËøõÂà∂ÊãÜÂàÜÊ±ÇÁªÑÂêàÊï∞Ôºå‰∏çÈöæÂèëÁé∞ÂÖ∂Âú®Ê®°
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>
ÊÑè‰πâ‰∏ãÁöÑÂÄº‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">[</mo><mo stretchy="false">(</mo><mi>n</mi><mtext>¬†</mtext><mo>&amp;</mo><mtext>¬†</mtext><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left[(n\ \And\ m) = m\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace">¬†</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&amp;</span><span class="mspace">¬†</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">m</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span>
ÂÖ∂‰∏≠
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n, m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span></span></span></span>
ÁöÑÊÑè‰πâÂêå (eq.~eq.¬†1)„ÄÇ</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> _C_<span class="op">(</span><span class="dt">int</span> m<span class="op">,</span> <span class="dt">int</span> n<span class="op">){</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>m <span class="op">&lt;</span> n<span class="op">)</span>  <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> frac<span class="op">[</span>m<span class="op">]</span> <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> ifrac<span class="op">[</span>n<span class="op">]</span> <span class="op">%</span> MOD <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> ifrac<span class="op">[</span>m <span class="op">-</span> n<span class="op">]</span> <span class="op">%</span> MOD<span class="op">;</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> C<span class="op">(</span><span class="dt">int</span> m<span class="op">,</span> <span class="dt">int</span> n<span class="op">){</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>MOD <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="cf">return</span> <span class="op">((</span>n <span class="op">&amp;</span> m<span class="op">)</span> <span class="op">==</span> n<span class="op">);</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>m <span class="op">&lt;</span> n<span class="op">)</span>  <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">if</span><span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> C<span class="op">(</span>m <span class="op">/</span> MOD<span class="op">,</span> n <span class="op">/</span> MOD<span class="op">)</span> <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> _C_<span class="op">(</span>m <span class="op">%</span> MOD<span class="op">,</span> n <span class="op">%</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="Êâ©Â±ï-lucas-ÂÆöÁêÜ">Êâ©Â±ï Lucas ÂÆöÁêÜ</h2>
<p>Ëß£ÂÜ≥Ê®°Êï∞‰∏∫ÂèØËÉΩ‰∏ç‰∏∫Ë¥®Êï∞Ôºå‰∏îÊØè‰∏™Ë¥®Êï∞ÂπÇËæÉÂ∞èÁöÑÁªÑÂêàÊï∞ÂèñÊ®°ÈóÆÈ¢ò„ÄÇ
<del>Êâ©Â±ïÂç¢Âç°ÊñØÂÆöÁêÜÂíåÂç¢Âç°ÊñØÂÆöÁêÜÊ≤°ÊúâÂÖ≥Á≥ª</del> Âπ∂Ê≤°ÊúâÁî®Âà∞
<code>Luacs</code> ÁöÑÂü∫Êú¨ÊÄùÊÉ≥ (eq.~eq.¬†1) ÔºåÊâ©Â±ï <code>Lucas</code> ÂÆöÁêÜ
Êú¨Ë¥®‰∏äÊòØËß£ÂÜ≥‰∫ÜÈò∂‰πòÈÄÜÂÖÉ‰∏çÂ≠òÂú®ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂΩ¢Â¶Ç</p>
<p><span
id="eq:exl"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mo lspace="0em" rspace="0em">‚àó</mo><mrow><mi>n</mi><mo stretchy="false">!</mo></mrow></mfrac><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>‚Äâ</mtext><mtext>‚Äâ</mtext><mi>P</mi><mspace width="2em"/><mrow><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\frac{*}{n!}\mod P
\qquad{(3)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8283em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1423em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mclose">!</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">‚àó</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">3</span><span class="mclose">)</span></span></span></span></span></span></span></p>
<p>ÂºèÂ≠êÁöÑÊ±ÇÂÄº„ÄÇ ËÄÉËôëÁªÑÂêàÊï∞ÈÄöÈ°πÂÖ¨ÂºèÔºö</p>
<p><span
id="eq:exC"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mi>n</mi><mi>m</mi></mfrac><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>n</mi><mo stretchy="false">!</mo></mrow><mrow><mi>m</mi><mo stretchy="false">!</mo><mo stretchy="false">(</mo><mi>n</mi><mo>‚àí</mo><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">!</mo></mrow></mfrac><mspace width="2em"/><mrow><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\dbinom{n}{m} = \frac{n!}{m! (n-m)!}
\qquad{(4)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3074em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="mclose">!</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">m</span><span class="mclose">)!</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mclose">!</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">4</span><span class="mclose">)</span></span></span></span></span></span></span></p>
<p>ÈôêÂà∂Êàë‰ª¨‰∏çËÉΩÁõ¥Êé•Ê±Ç (eq.~eq.¬†4)
ÁöÑÂéüÂõ†‚Äî‚ÄîÊ®°Êï∞‰∏ç‰∏∫Ë¥®Êï∞ÔºåÊó†Ê≥ï‰øùËØÅÈÄÜÂÖÉÂ≠òÂú®„ÄÇËÄÉËôëÂ¶ÇÊûúËÆ©ÂàÜÊØçÂíåÊ®°Êï∞‰∫íË¥®Â∞±ÂèØ‰ª•Ê±ÇÂá∫Ëøô‰∏™ÂºèÂ≠êÁöÑÂÄº‰∫Ü„ÄÇ</p>
<p>È¶ñÂÖàÂèØ‰ª•ÂØπÊ®°Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>
ËøõË°åË¥®Âõ†Êï∞ÂàÜËß£ÔºåÂàÜËß£ÊàêÂΩ¢Â¶Ç
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><munder><mo>‚àè</mo><mrow><mi>i</mi><mo>‚â•</mo><mn>0</mn></mrow></munder><msubsup><mi>P</mi><mi>i</mi><msub><mi>e</mi><mi>i</mi></msub></msubsup></mrow><annotation encoding="application/x-tex">p = \prod_{i\ge 0}\limits{P_i^{e_i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8229em;vertical-align:-1.0728em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">‚â•</span><span class="mord mtight">0</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">‚àè</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.0728em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span></span></span></span></span>
ÔºåÂÖàÂàÜÂà´Ê±ÇÊ®°Êï∞‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mi>i</mi><msub><mi>e</mi><mi>i</mi></msub></msubsup></mrow><annotation encoding="application/x-tex">P_i^{e_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0232em;vertical-align:-0.2769em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span></span></span></span>
ÂºèÂ≠êÁöÑÂÄºÔºåÁÑ∂Âêé <code>CRT</code> ÂêàÂπ∂Á≠îÊ°à„ÄÇ</p>
<p>ËÄÉËôëÂ¶Ç‰ΩïÊ±ÇÂá∫Ê®°Êï∞‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mi>i</mi><msub><mi>e</mi><mi>i</mi></msub></msubsup></mrow><annotation encoding="application/x-tex">P_i^{e_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0232em;vertical-align:-0.2769em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span></span></span></span>
ÁöÑÂÄº„ÄÇ ËÆæÂáΩÊï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g_p(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>
‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">n!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">n</span><span class="mclose">!</span></span></span></span>
‰∏≠Ë¥®Âõ†Â≠ê
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>
ÁöÑÂπÇÊ¨°„ÄÇ ËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><msub><mi>g</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>b</mi><mo>=</mo><msub><mi>g</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>c</mi><mo>=</mo><msub><mi>g</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo>‚àí</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a = g_p(n), b=g_p(m), c=g_p(n-m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>
ÊòìÁü•Ôºö</p>
<p><span
id="eq:exLucas"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi>e</mi><mi>q</mi><mi mathvariant="normal">.</mi><mtext>¬†</mtext><mi mathvariant="normal">@</mi><mi>e</mi><mi>q</mi><mo>:</mo><mi>e</mi><mi>x</mi><mi>C</mi><mo stretchy="false">)</mo><mo>‚â°</mo><mfrac><mfrac><mrow><mi>n</mi><mo stretchy="false">!</mo></mrow><msup><mi>p</mi><mi>a</mi></msup></mfrac><mrow><mfrac><mrow><mi>m</mi><mo stretchy="false">!</mo></mrow><msup><mi>p</mi><mi>b</mi></msup></mfrac><mfrac><mrow><mo stretchy="false">(</mo><mi>n</mi><mo>‚àí</mo><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">!</mo></mrow><msup><mi>p</mi><mi>c</mi></msup></mfrac></mrow></mfrac><mtext>¬†</mtext><msup><mi>p</mi><mrow><mi>a</mi><mo>‚àí</mo><mi>b</mi><mo>‚àí</mo><mi>c</mi></mrow></msup><mtext>¬†</mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>¬†</mtext><msubsup><mi>P</mi><mi>i</mi><msub><mi>e</mi><mi>i</mi></msub></msubsup><mo stretchy="false">)</mo><mspace width="2em"/><mrow><mo stretchy="false">(</mo><mn>5</mn><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">
(eq.~@eq:exC) \equiv \frac{\frac{n!}{p^{a}}}{\frac{m!}{p^{b}} \frac{(n-m)!}{p^{c}}}\ p^{a-b-c}\  (mod \ P_i^{e_i})
\qquad{(5)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord">.</span><span class="mspace nobreak">¬†</span><span class="mord">@</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1447em;vertical-align:-1.3935em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7512em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.6426em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mclose mtight">!</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4935em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5935em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">‚àí</span><span class="mord mathnormal mtight">m</span><span class="mclose mtight">)!</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.24em;"><span class="pstrut" style="height:3.01em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.8811em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5935em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mclose mtight">!</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.3935em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace">¬†</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mbin mtight">‚àí</span><span class="mord mathnormal mtight">b</span><span class="mbin mtight">‚àí</span><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span></span><span class="mspace">¬†</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace">¬†</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></span></span></span></p>
<p>ËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><msubsup><mi>P</mi><mi>i</mi><msub><mi>e</mi><mi>i</mi></msub></msubsup></mrow><annotation encoding="application/x-tex">k=P_i^{e_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0232em;vertical-align:-0.2769em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span></span></span></span>
ÔºåÂ¶ÇÊûúÊâÄÊ±Ç‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>n</mi><mo stretchy="false">!</mo></mrow><msubsup><mi>p</mi><mi>i</mi><mi>a</mi></msubsup></mfrac></mrow><annotation encoding="application/x-tex">\frac{n!}{p_i^{a}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4507em;vertical-align:-0.5706em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6523em;"><span style="top:-2.1777em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-2.8448em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.3223em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mclose mtight">!</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.5706em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>
ÂØπ‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">n!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">n</span><span class="mclose">!</span></span></span></span>
ÁöÑÊØè‰∏ÄÈ°π
(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>√ó</mo><mn>2</mn><mo>√ó</mo><mn>3</mn><mo>√ó</mo><mn>4</mn><mo>√ó</mo><mn>5</mn><mo>√ó</mo><mo>‚ãØ</mo><mo>√ó</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1\times 2\times 3\times 4\times 5\times \dots \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">‚ãØ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>)ÔºåÂÖ∂ÊØè‰∏ÄÈ°πÂú®Ê®°
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÊÑè‰πâ‰∏ãÁöÑÂèñÂÄº‰∏ÄÂÆöÊòØÊØè
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
‰∏™‰∏ÄÊ¨°Âæ™ÁéØÁöÑ„ÄÇ</p>
<p>ÂêåÊó∂ÊØè‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ÁöÑÂÄçÊï∞ÈÉΩÂèØ‰ª•ÊèêÂá∫‰∏Ä‰∏™Âõ†Â≠ê
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
‰πüÂèØ‰ª•ËΩªÊùæÁü•ÈÅìÔºåËøô‰∏™ÊèêÂá∫Êù•ÁöÑÂõ†Â≠êÊúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">‚åä</mo><mfrac><mi>n</mi><msub><mi>P</mi><mi>i</mi></msub></mfrac><mo stretchy="false">‚åã</mo></mrow><annotation encoding="application/x-tex">\lfloor\frac{n}{P_i}\rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1951em;vertical-align:-0.4451em;"></span><span class="mopen">‚åä</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">‚åã</span></span></span></span>
‰∏™Ôºå Âç≥
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>P</mi><mrow><mo stretchy="false">‚åä</mo><mfrac><mi>n</mi><msub><mi>P</mi><mi>i</mi></msub></mfrac><mo stretchy="false">‚åã</mo></mrow></msup></mrow><annotation encoding="application/x-tex">P^{\lfloor\frac{n}{P_i}\rfloor}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0309em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0309em;"><span style="top:-3.5059em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">‚åä</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6915em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.1389em;margin-right:0.1em;"><span class="pstrut" style="height:2.6595em;"></span><span class="mord mathnormal mtight">i</span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.5688em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mclose mtight">‚åã</span></span></span></span></span></span></span></span></span></span></span></span>
Ëøô‰∏™ÂºèÂ≠ê‰∏çËÆ°ÂÖ•Á≠îÊ°à„ÄÇ</p>
<p>Ëøô‰∫õÂÄçÊï∞ÊèêÂá∫‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ÁöÑÂõ†Â≠ê‰πãÂêé‰∏ÄÂÆö‰ºöÂΩ¢ÊàêÂè¶‰∏Ä‰∏™Èò∂‰πòÁöÑÂΩ¢ÂºèÔºåËøôÊòØ‰∏Ä‰∏™Â≠êÈóÆÈ¢òÔºåÂèØ‰ª•ÈÄíÂΩíËÆ°ÁÆó„ÄÇÂâ©‰∏ãÁöÑÊï∞Â≠óÂèØ‰ª•Êö¥ÂäõËÆ°ÁÆó‰∏Ä‰∏™Âë®ÊúüÔºåÁÑ∂ÂêéÊ†πÊçÆÂë®ÊúüÁöÑÂá∫Áé∞Ê¨°Êï∞ÔºåÁõ¥Êé•ËÆ°ÁÆóÂºèÂ≠êÁöÑÂÄº„ÄÇ
ËøôÊ†∑Â∞±ÂèØ‰ª•ÁÆóÂá∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">n!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">n</span><span class="mclose">!</span></span></span></span>
ÂéªÊéâÊâÄÊúâË¥®Âõ†Â≠ê
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
Âú®Ê®°
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mi>i</mi><msub><mi>e</mi><mi>i</mi></msub></msubsup></mrow><annotation encoding="application/x-tex">P_i^{e_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0232em;vertical-align:-0.2769em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span></span></span></span>
ÊÑè‰πâ‰∏ãÁöÑÂÄº‰∫Ü„ÄÇ ‰øùËØÅ‰∫ÜËøô‰∏™ÂÄºÂíå
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
‰∫íË¥®ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•Ê±ÇÈÄÜÂÖÉ‰∫Ü„ÄÇ Ê†πÊçÆ (eq.~eq.¬†5) ËÆ°ÁÆóÂç≥ÂèØ„ÄÇ</p>
<p>ÂÖ≥‰∫éÂáΩÊï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g_p(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>
ÁöÑËÆ°ÁÆóÔºö</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>g</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>‚àè</mo><mrow><mi>i</mi><mo>‚â•</mo><mn>1</mn></mrow></munder><mrow><mo stretchy="false">‚åä</mo><mfrac><mi>n</mi><msup><mi>p</mi><mi>i</mi></msup></mfrac><mo stretchy="false">‚åã</mo></mrow><mo>=</mo><mfrac><mrow><mi>n</mi><mo>‚àí</mo><msub><mi>f</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><mrow><mi>p</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">
g_p(n) = \prod_{i\ge 1}\limits{\lfloor\frac{n}{p^i}\rfloor}= \frac{n - f_p(n)}{p - 1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4804em;vertical-align:-1.3728em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">‚â•</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">‚àè</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.3728em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">‚åä</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7507em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">‚åã</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3074em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>ÂÖ∂‰∏≠
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_p(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>
‰∏∫Êï∞Â≠ó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
Âú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>
ËøõÂà∂‰∏ãÁöÑÊï∞‰ΩçÂíå„ÄÇ</p>
<p>Ê≥®ÊÑèÈÄÜÂÖÉ‰∏çÊòØË¥®Êï∞ÔºåÂà´<del>ÂÇª‰∏çÊãâÂá†ÁöÑ</del>ÂÜ≤‰∏Ä‰∏™Ë¥πÈ©¨Â∞èÂÆöÁêÜ„ÄÇ</p>
<p>Â§çÊùÇÂ∫¶ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mrow><mo fence="true">(</mo><munder><mo>‚àë</mo><mrow><mi>i</mi><mo>‚â•</mo><mn>0</mn></mrow></munder><mrow><mo stretchy="false">(</mo><mi>log</mi><mo>‚Å°</mo><mi>P</mi><mo>+</mo><msubsup><mi>P</mi><mi>i</mi><msub><mi>e</mi><mi>i</mi></msub></msubsup><mo stretchy="false">)</mo><mi>log</mi><mo>‚Å°</mo><mi>n</mi></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{O}\left(\sum_{i\ge 0}\limits{(\log P + P_i^{e_i})\log n}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.5228em;vertical-align:-1.0728em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">‚â•</span><span class="mord mtight">0</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">‚àë</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.0728em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span>
Â§ßÊ¶ÇÂ∞±ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mrow><mo fence="true">(</mo><munder><mo>‚àë</mo><mrow><mi>i</mi><mo>‚â•</mo><mn>0</mn></mrow></munder><mrow><msubsup><mi>P</mi><mi>i</mi><msub><mi>e</mi><mi>i</mi></msub></msubsup><mi>log</mi><mo>‚Å°</mo><mi>n</mi></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{O}\left(\sum_{i \ge 0}\limits{P_i^{e_i}\log n}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.5228em;vertical-align:-1.0728em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">‚â•</span><span class="mord mtight">0</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">‚àë</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.0728em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span>
Âêß„ÄÇ</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> f<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> p<span class="op">){</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>n<span class="op">)</span> <span class="op">{</span> ans <span class="op">+=</span> n <span class="op">%</span> p<span class="op">;</span> n <span class="op">/=</span> p<span class="op">;</span> <span class="op">}</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> g<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> P<span class="op">){</span> <span class="cf">return</span> <span class="op">(</span>n <span class="op">-</span> f<span class="op">(</span>n<span class="op">,</span> P<span class="op">))</span> <span class="op">/</span> <span class="op">(</span>P <span class="op">-</span> <span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> pow<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> P<span class="op">){</span> <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">while</span><span class="op">(</span>b<span class="op">)</span> <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>b <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> ans <span class="op">=</span> ans <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> a <span class="op">%</span> P<span class="op">;</span> a <span class="op">=</span> a <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> a <span class="op">%</span> P<span class="op">;</span> b <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span> <span class="cf">return</span> ans<span class="op">;</span> <span class="op">}</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">//int inv(int x, int MOD) { return pow(x, MOD - 2, MOD); } // deleted: Fermat&#39;s Little Theorem is NOT correct when MOD is not a prime number.</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> exgcd<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="dt">int</span> <span class="op">&amp;</span>y<span class="op">){</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(!</span>b<span class="op">)</span> <span class="op">{</span> x <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">return</span> a<span class="op">;</span> <span class="op">}</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> g <span class="op">=</span> exgcd<span class="op">(</span>b<span class="op">,</span> a <span class="op">%</span> b<span class="op">,</span> y<span class="op">,</span> x<span class="op">);</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    y <span class="op">-=</span> <span class="op">(</span>a <span class="op">/</span> b<span class="op">)</span> <span class="op">*</span> x<span class="op">;</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g<span class="op">;</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> inv<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> P<span class="op">){</span> <span class="co">// add: Exgcd</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">,</span> y<span class="op">;</span> exgcd<span class="op">(</span>a<span class="op">,</span> P<span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>x <span class="op">%</span> P <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> P <span class="op">)</span> <span class="op">%</span> P<span class="op">;</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> calc<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> p<span class="op">,</span> <span class="dt">int</span> k<span class="op">){</span> <span class="co">// calc n!(without p) mod p^k</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> P <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> k<span class="op">)</span> P <span class="op">*=</span> p<span class="op">;</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> res <span class="op">=</span> n <span class="op">%</span> P<span class="op">,</span> prd0 <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> prd1 <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> P<span class="op">){</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>i <span class="op">%</span> p <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>i <span class="op">&lt;=</span> res<span class="op">)</span> prd0 <span class="op">=</span> prd0 <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> i <span class="op">%</span> P<span class="op">;</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        prd1 <span class="op">=</span> prd1 <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> i <span class="op">%</span> P<span class="op">;</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> calc<span class="op">(</span>n <span class="op">/</span> p<span class="op">,</span> p<span class="op">,</span> k<span class="op">);</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">=</span> ans <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> prd0 <span class="op">%</span> P<span class="op">;</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">=</span> ans <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> pow<span class="op">(</span>prd1<span class="op">,</span> n <span class="op">/</span> P<span class="op">,</span> P<span class="op">)</span> <span class="op">%</span> P<span class="op">;</span> <span class="co">// changed `pow(prd1, n / p, P)` to `pow(prd1, n / P, P) % P`.</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>LL n<span class="op">,</span> m<span class="op">;</span> <span class="dt">int</span> MOD<span class="op">;</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> <span class="op">&gt;</span> d<span class="op">;</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> Divide<span class="op">{</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">1e6</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> np<span class="op">[</span>_<span class="op">],</span> prime<span class="op">[</span>_<span class="op">],</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> Mid<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> init<span class="op">(</span><span class="dt">int</span> n<span class="op">){</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> n<span class="op">){</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(!</span>np<span class="op">[</span>i<span class="op">])</span> prime<span class="op">[++</span>tot<span class="op">]</span> <span class="op">=</span> i<span class="op">,</span> Mid<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> tot <span class="op">&amp;&amp;</span> prime<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> i <span class="op">&lt;=</span> n<span class="op">;</span> j<span class="op">++){</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> x <span class="op">=</span> prime<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> i<span class="op">;</span> Mid<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> prime<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>                np<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span><span class="op">(</span>i <span class="op">%</span> prime<span class="op">[</span>j<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> divide<span class="op">(</span>vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&amp;</span> res<span class="op">,</span> <span class="dt">int</span> MOD<span class="op">){</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> tot<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>MOD <span class="op">%</span> prime<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>            pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> ans<span class="op">;</span> ans<span class="op">.</span>fi <span class="op">=</span> prime<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>            ans<span class="op">.</span>se <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span><span class="op">(</span>MOD <span class="op">%</span> prime<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> MOD <span class="op">/=</span> prime<span class="op">[</span>i<span class="op">],</span> ans<span class="op">.</span>se<span class="op">++;</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>            res<span class="op">.</span>push_back<span class="op">(</span>ans<span class="op">);</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span><span class="co">// ËøôÈáåÂèØ‰ª•Áõ¥Êé• $\mathcal{O}(\sqrt{n})$ ËØïÈô§Âç≥ÂèØÔºåÊ≤°ÂøÖË¶ÅÂàÜËß£Ë¥®Âõ†Êï∞„ÄÇÂÜôÁöÑÊó∂ÂÄôÂ§™Âπ¥ËΩª‰∫Ü„ÄÇ</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> CRT<span class="op">(</span>vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&amp;</span> A<span class="op">){</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> W <span class="op">=</span> MOD<span class="op">;</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> A<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>        pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> now <span class="op">=</span> A<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> <span class="op">(</span> now<span class="op">.</span>fi <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> <span class="op">(</span>W <span class="op">/</span> now<span class="op">.</span>se<span class="op">)</span> <span class="op">%</span> MOD <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> inv<span class="op">(</span>W <span class="op">/</span> now<span class="op">.</span>se<span class="op">,</span> now<span class="op">.</span>se<span class="op">)</span> <span class="op">)</span> <span class="op">%</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> <span class="op">&gt;</span> Ans<span class="op">;</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="dt">signed</span> main<span class="op">(){</span> <span class="co">//freopen(&quot;.in&quot;, &quot;r&quot;, stdin);</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">)(</span>m<span class="op">)(</span>MOD<span class="op">);</span> Divide<span class="op">::</span>init<span class="op">(</span>MOD <span class="op">+</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>    Divide<span class="op">::</span>divide<span class="op">(</span>d<span class="op">,</span> MOD<span class="op">);</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> d<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>        pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> NowMod <span class="op">=</span> d<span class="op">[</span>i<span class="op">];</span> <span class="dt">int</span> P <span class="op">=</span> pow<span class="op">(</span>NowMod<span class="op">.</span>fi<span class="op">,</span> NowMod<span class="op">.</span>se<span class="op">);</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> rA <span class="op">=</span> calc<span class="op">(</span>n<span class="op">,</span> NowMod<span class="op">.</span>fi<span class="op">,</span> NowMod<span class="op">.</span>se<span class="op">);</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> rB <span class="op">=</span> calc<span class="op">(</span>n <span class="op">-</span> m<span class="op">,</span> NowMod<span class="op">.</span>fi<span class="op">,</span> NowMod<span class="op">.</span>se<span class="op">);</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> rC <span class="op">=</span> calc<span class="op">(</span>m<span class="op">,</span> NowMod<span class="op">.</span>fi<span class="op">,</span> NowMod<span class="op">.</span>se<span class="op">);</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> rA <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> inv<span class="op">(</span>rB<span class="op">,</span> P<span class="op">)</span> <span class="op">%</span> P <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> inv<span class="op">(</span>rC<span class="op">,</span> P<span class="op">)</span> <span class="op">%</span> P<span class="op">;</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> ans <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> pow<span class="op">(</span>NowMod<span class="op">.</span>fi<span class="op">,</span> g<span class="op">(</span>n<span class="op">,</span> NowMod<span class="op">.</span>fi<span class="op">)</span> <span class="op">-</span> g<span class="op">(</span>n <span class="op">-</span> m<span class="op">,</span> NowMod<span class="op">.</span>fi<span class="op">)</span> <span class="op">-</span> g<span class="op">(</span>m<span class="op">,</span> NowMod<span class="op">.</span>fi<span class="op">),</span> P<span class="op">)</span> <span class="op">%</span> P<span class="op">;</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>        Ans<span class="op">.</span>push_back<span class="op">(</span>mp<span class="op">(</span>ans<span class="op">,</span> P<span class="op">));</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> CRT<span class="op">(</span>Ans<span class="op">));</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="bsgs">BSGS</h2>
<p>Ê±ÇËß£Ê®°Êï∞‰∏∫Ë¥®Êï∞ÁöÑÊåáÊï∞ÊñπÁ®ã„ÄÇ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>x</mi></msup><mo>‚â°</mo><mi>b</mi><mtext>¬†</mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>¬†</mtext><mi>p</mi><mo stretchy="false">)</mo><mtext>¬†</mtext><mi>p</mi><mo>‚àà</mo><mi>P</mi></mrow><annotation encoding="application/x-tex">a^x \equiv b\ (mod\ p) \ p \in P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mspace">¬†</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace">¬†</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace">¬†</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>„ÄÇ
Áî±Ê¨ßÊãâÂÆöÁêÜÂèØÁü•ÔºåÊú¨Ë¥®‰∏çÂêåÁöÑËß£ ËåÉÂõ¥‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>p</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, p-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>
„ÄÇ Êú¥Á¥†ÂÅöÊ≥ïÂ∞±ÊòØÊûö‰∏æ‰∏Ä‰∏ã
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>p</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, p-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>
Âà§Êñ≠ÊòØ‰∏çÊòØËß£Ôºå‰ΩÜÊòØËøôÊ†∑ÊòæÁÑ∂Â§™ÊÖ¢‰∫Ü„ÄÇ ËÄÉËôëÈÄâ‰∏Ä‰∏™ÂèÇÊï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>ÔºåÂàô
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">‚àÄ</mi><mi>x</mi><mo>‚àà</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>p</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\forall x \in [0, p-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord">‚àÄ</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>
ÈÉΩÂèØ‰ª•Ë°®Á§∫Êàê
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>√ó</mo><mi>T</mi><mo>+</mo><mi>c</mi><mtext>¬†¬†</mtext><mo stretchy="false">(</mo><mi>b</mi><mo>&lt;</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r \times T + c\ \ (b &lt; T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mspace">¬†</span><span class="mspace">¬†</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span>
ÁöÑÂΩ¢ÂºèÔºåÊòìÁü•Ôºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mo stretchy="false">‚åä</mo><mfrac><mi>x</mi><mi>T</mi></mfrac><mo stretchy="false">‚åã</mo><mo separator="true">,</mo><mi>c</mi><mo>=</mo><mi>x</mi><mtext>¬†</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>¬†</mtext><mi>T</mi></mrow><annotation encoding="application/x-tex">r = \lfloor\frac{x}{T} \rfloor, c=x\ mod \ T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mopen">‚åä</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">‚åã</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">x</span><span class="mspace">¬†</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace">¬†</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></p>
<p>Â∏¶ÂÖ•ÂéüÂºèÔºö</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>a</mi><mrow><mi>r</mi><mi>T</mi><mo>+</mo><mi>c</mi></mrow></msup><mo>‚â°</mo><mi>b</mi><mtext>¬†</mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>¬†</mtext><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
a^{rT + c} \equiv b\ (mod\ p)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mspace">¬†</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace">¬†</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p>
<p><span
id="eq:BSGS0"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>a</mi><mi>c</mi></msup><mo>‚â°</mo><mi>b</mi><mo>√ó</mo><msup><mi>a</mi><mrow><mo>‚àí</mo><mi>r</mi><mi>T</mi></mrow></msup><mtext>¬†</mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>¬†</mtext><mi>p</mi><mo stretchy="false">)</mo><mspace width="2em"/><mrow><mo stretchy="false">(</mo><mn>6</mn><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">
a^{c} \equiv b\times a^{-rT}\ (mod\ p)
\qquad{(6)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7144em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àí</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mspace">¬†</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace">¬†</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">6</span><span class="mclose">)</span></span></span></span></span></span></span></p>
<p>ÂèØ‰ª•ËÄÉËôëÊûö‰∏æ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>
ÁÆóÂá∫ÊØè‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>c</mi></msup></mrow><annotation encoding="application/x-tex">a^{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span></span></span></span></span>
ÂéãÂÖ• <code>set</code> Êàñ <code>hash</code> Ë°®ÔºåÁÑ∂ÂêéÊûö‰∏æÊØè‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>
ÁÆóÂá∫ÊØè‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mo>‚àí</mo><mi>r</mi><mi>T</mi></mrow></msup><mo>√ó</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a^{-rT} \times b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9247em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àí</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>
Âú®‰πãÂâçÁÆóÂá∫ÁöÑÁ≠îÊ°à‰∏≠Êü•ÊâæÔºåÂ¶ÇÊûúËÉΩÊâæÂà∞Áõ∏ÂêåÁöÑÂèñÂÄºÔºàÂç≥ÔºöÊª°Ë∂≥(eq.~eq.¬†6)ÔºâÔºåÂ∞±ËØ¥ÊòéÂΩìÂâçËøô‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>
Â∞±ÊòØ‰∏Ä‰∏™Á≠îÊ°à„ÄÇ</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> inv<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> P<span class="op">){</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">,</span> y<span class="op">;</span> exgcd<span class="op">(</span>a<span class="op">,</span> P<span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>x <span class="op">%</span> P <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> P<span class="op">)</span> <span class="op">%</span> P<span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> BSGS<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> P<span class="op">)</span> <span class="op">{</span> <span class="co">// a^x = b (mod P) (a, p) = 1;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> set<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> S<span class="op">;</span> S<span class="op">.</span>clear<span class="op">();</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> T <span class="op">=</span> sqrt<span class="op">(</span>P<span class="op">);</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> x <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> T<span class="op">;</span> i<span class="op">++,</span> x <span class="op">=</span> x <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> a <span class="op">%</span> P<span class="op">)</span> <span class="cf">if</span><span class="op">(</span>x <span class="op">!=</span> b<span class="op">)</span> S<span class="op">.</span>insert<span class="op">(</span>x<span class="op">);</span> <span class="cf">else</span> <span class="cf">return</span> i<span class="op">;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> T<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> now <span class="op">=</span> b <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> inv<span class="op">(</span>pow<span class="op">(</span>a<span class="op">,</span> T <span class="op">*</span> i<span class="op">,</span> P<span class="op">),</span> P<span class="op">)</span> <span class="op">%</span> P<span class="op">;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>S<span class="op">.</span>count<span class="op">(</span>now<span class="op">))</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i <span class="op">*</span> T<span class="op">,</span> V <span class="op">=</span> pow<span class="op">(</span>a<span class="op">,</span> j<span class="op">,</span> P<span class="op">);</span> <span class="op">;</span> j<span class="op">++,</span> V <span class="op">=</span> V <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> a <span class="op">%</span> P<span class="op">)</span> <span class="cf">if</span><span class="op">(</span>V <span class="op">==</span> b<span class="op">)</span> <span class="cf">return</span> j<span class="op">;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="Êâ©Â±ï-bsgs">Êâ©Â±ï BSGS</h2>
<p>Áî®‰∫éÊ±ÇËß£Ê®°Êï∞‰∏ç‰∏ÄÂÆö‰∏∫Ë¥®Êï∞ÁöÑÊåáÊï∞ÊñπÁ®ã„ÄÇ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>x</mi></msup><mo>‚â°</mo><mi>b</mi><mtext>¬†</mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>¬†</mtext><mi>p</mi><mo stretchy="false">)</mo><mtext>¬†</mtext><mi>p</mi><mo>‚àà</mo><mi>P</mi></mrow><annotation encoding="application/x-tex">a^x \equiv b\ (mod\ p) \ p \in P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mspace">¬†</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace">¬†</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace">¬†</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>„ÄÇ
ÈôêÂà∂‰∏çËÉΩÁõ¥Êé•
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>S</mi><mi>G</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">BSGS</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">BSGS</span></span></span></span>
ÁöÑÂõ†Á¥†Â∞±ÊòØ‰∏çËÉΩ‰øùËØÅÈÄÜÂÖÉÂ≠òÂú®ÔºåÈÇ£Â∞±ËÄÉËôëÂ¶Ç‰ΩïËÆ©
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">(a, p) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>
„ÄÇ</p>
<p>ÂÖ∑‰ΩìÂú∞ÔºåËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub><mo>=</mo><mi>gcd</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d_1=\gcd(a,p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span style="margin-right:0.01389em;">g</span>cd</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span>
„ÄÇÂ¶ÇÊûú
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub><mo>‚à§</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">d_1\nmid b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9925em;vertical-align:-0.2514em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">‚à§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>
ÔºåÂàôÂéüÊñπÁ®ãÊó†Ëß£„ÄÇÂê¶ÂàôÊàë‰ª¨ÊääÊñπÁ®ãÂêåÊó∂Èô§‰ª•
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">d_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ÔºåÂæóÂà∞<br />
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi>a</mi><msub><mi>d</mi><mn>1</mn></msub></mfrac><mo>‚ãÖ</mo><msup><mi>a</mi><mrow><mi>x</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚â°</mo><mfrac><mi>b</mi><msub><mi>d</mi><mn>1</mn></msub></mfrac><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mfrac><mi>p</mi><msub><mi>d</mi><mn>1</mn></msub></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\frac{a}{d_1}\cdot a^{x-1}\equiv \frac{b}{d_1}\pmod{\frac{p}{d_1}}  
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.9436em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚ãÖ</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2074em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">b</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1.9436em;vertical-align:-0.836em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>Â¶ÇÊûú
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>
Âíå
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>p</mi><msub><mi>d</mi><mn>1</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{p}{d_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1926em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>
‰ªç‰∏ç‰∫íË¥®Â∞±ÂÜçÈô§ÔºåËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub><mo>=</mo><mi>gcd</mi><mo>‚Å°</mo><mrow><mo fence="true">(</mo><mi>a</mi><mo separator="true">,</mo><mfrac><mi>p</mi><msub><mi>d</mi><mn>1</mn></msub></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">d_2=\gcd\left(a,\frac{p}{d_1}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mop"><span style="margin-right:0.01389em;">g</span>cd</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span>
„ÄÇÂ¶ÇÊûú
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub><mo>‚à§</mo><mfrac><mi>b</mi><msub><mi>d</mi><mn>1</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">d_2\nmid \frac{b}{d_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9925em;vertical-align:-0.2514em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">‚à§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>
ÔºåÂàôÊñπÁ®ãÊó†Ëß£ÔºõÂê¶ÂàôÂêåÊó∂Èô§‰ª•
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">d_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ÂæóÂà∞.
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><msup><mi>a</mi><mn>2</mn></msup><mrow><msub><mi>d</mi><mn>1</mn></msub><msub><mi>d</mi><mn>2</mn></msub></mrow></mfrac><mo>‚ãÖ</mo><msup><mi>a</mi><mrow><mi>x</mi><mo>‚àí</mo><mn>2</mn></mrow></msup><mo>‚â°</mo><mfrac><mi>b</mi><mrow><msub><mi>d</mi><mn>1</mn></msub><msub><mi>d</mi><mn>2</mn></msub></mrow></mfrac><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mfrac><mi>p</mi><mrow><msub><mi>d</mi><mn>1</mn></msub><msub><mi>d</mi><mn>2</mn></msub></mrow></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\frac{a^2}{d_1d_2}\cdot a^{x-2}‚â°\frac{b}{d_1d_2} \pmod{\frac{p}{d_1d_2}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3271em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚ãÖ</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">‚àí</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2074em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">b</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1.9436em;vertical-align:-0.836em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span>
Áõ¥Âà∞Ê®°Êï∞Âíå
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>
‰∫íË¥®„ÄÇ ËÆ∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><mo>‚àè</mo><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">D = \prod\limits{d_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">‚àè</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>ÔºåÂàô</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><msup><mi>a</mi><mi>k</mi></msup><mi>D</mi></mfrac><mo>‚ãÖ</mo><msup><mi>a</mi><mrow><mi>x</mi><mo>‚àí</mo><mi>k</mi></mrow></msup><mo>‚â°</mo><mfrac><mi>b</mi><mi>D</mi></mfrac><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mfrac><mi>p</mi><mi>D</mi></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\frac{a^k}{D}\cdot a^{x-k}\equiv\frac{b}{D} \pmod{\frac{p}{D}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2121em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5261em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚ãÖ</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">‚àí</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">b</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1.7936em;vertical-align:-0.686em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span>
Â∞±ÂèØ‰ª•‰ΩøÁî® <code>BSGS</code> Ê±ÇËß£‰∫Ü„ÄÇ</p>
<p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºö</p>
<ul>
<li>Ëß£ÂèØËÉΩÂ∞è‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÔºåÂèØ‰ª•Êö¥ÂäõÊûö‰∏æ‰∏Ä‰∏ãÂ∞è‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÁöÑÂπÇÊ¨°ÔºåÂà§Êñ≠‰∏Ä‰∏ã</li>
<li>Â¶ÇÊûúÊúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
‰∏çÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>
ÁöÑÁ∫¶Êï∞ÔºåÁõ¥Êé•Âà§Êñ≠Êó†Ëß£Âç≥ÂèØ„ÄÇ</li>
</ul>
<pre><code>int exBSGS(int a, int b, int P){ 
    int D = 1, k = 0, tp = P;
    while(true) { int g = gcd(a, tp); if(g == 1) break; tp /= g; D *= g; k++;  }
    for(int i = 0, V = 1; i &lt;= k; i++, V = V *1ll* a % P) if(V == b) return i; // changed: It must be executed before `if(b % D != 0) return -1`).
    int S = pow(a, k, tp);
    if(b % D != 0) return -1; // added: It is necessary!
    int B = b *1ll* inv(S, tp) % tp;
    int r = BSGS(a, B, tp);
    return r == -1 ? -1 : r + k;
}</code></pre>
<p>Â∑≤ÈÄöËøá luogu Âíå SPOJ ÁöÑÊµãËØïÊï∞ÊçÆÔºå‰ΩÜÊòØ zhx (Orz) ÁöÑÊï∞ÊçÆÂè™Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>50</mn><mi>p</mi><mi>t</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">50pts</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">50</span><span class="mord mathnormal">pt</span><span class="mord mathnormal">s</span></span></span></span>
ÂæÖÂ°´„ÄÇ</p>
<h2 id="miller_rabin">Miller_Rabin</h2>
<p>Âø´ÈÄüÂà§Êñ≠Â§ßÊï∞Á¥†ÊÄß„ÄÇ</p>
<p>‰∏Ä‰∏™ÁªìËÆ∫Ôºö Â¶ÇÊûú
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
‰∏∫Ë¥®Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">‚àÄ</mi><mi>a</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\forall a &lt; n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord">‚àÄ</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚àí</mo><mn>1</mn><mo>=</mo><mi>d</mi><mo>√ó</mo><msup><mn>2</mn><mi>r</mi></msup><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>d</mi><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n - 1 = d \times 2^r, (d, 2) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ÔºåÂàô
<span
id="eq:MR0"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>a</mi><mi>d</mi></msup><mo>‚â°</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>n</mi><mo stretchy="false">)</mo><mspace width="2em"/><mrow><mo stretchy="false">(</mo><mn>7</mn><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">
a^d \equiv 1 \pmod n 
\qquad{(7)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">7</span><span class="mclose">)</span></span></span></span></span></span></span></p>
<p><span
id="eq:MR1"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">‚àÉ</mi><mtext>¬†</mtext><mn>0</mn><mo>‚â§</mo><mi>i</mi><mo>&lt;</mo><mi>r</mi><mo separator="true">,</mo><mi>s</mi><mi mathvariant="normal">.</mi><mi>t</mi><mi mathvariant="normal">.</mi><msup><mi>a</mi><mrow><mi>d</mi><mo>√ó</mo><msup><mi>i</mi><mi>i</mi></msup></mrow></msup><mo>‚â°</mo><mo>‚àí</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>n</mi><mo stretchy="false">)</mo><mspace width="2em"/><mrow><mo stretchy="false">(</mo><mn>8</mn><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\exists\ 0 \le i &lt; r, s.t. a^{d\times i^i} \equiv -1 \pmod n 
\qquad{(8)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord">‚àÉ</span><span class="mspace">¬†</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6986em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mord">.</span><span class="mord mathnormal">t</span><span class="mord">.</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0445em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mbin mtight">√ó</span><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9021em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">‚àí</span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">8</span><span class="mclose">)</span></span></span></span></span></span></span></p>
<p>(eq.~eq.¬†7) Âíå (eq.~eq.¬†8) Ëá≥Â∞ë‰∏Ä‰∏™Êª°Ë∂≥„ÄÇ ÊòØÂê¶‰∏∫ÂÖÖË¶ÅÊù°‰ª∂Â∏¶Êü•„ÄÇ</p>
<p>Êàë‰ª¨ÈúÄË¶ÅÂà§Êñ≠‰∏Ä‰∏™Êï∞ÊòØÂê¶‰∏∫Ë¥®Êï∞ÔºåÂè™ÈúÄË¶ÅÂà§Êñ≠ÊòØÂê¶Á¨¶Âêà‰∏äÈù¢ÁöÑÂÆöÁêÜÂç≥ÂèØÔºå‰ΩÜÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">‚àÄ</mi><mi>a</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\forall a &lt; n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord">‚àÄ</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÂØπÂ§çÊùÇÂ∫¶‰∏çÂèãÂ•Ω„ÄÇ</p>
<p>ÈÄöÂ∏∏ÁöÑÂÅöÊ≥ïÊòØÈÄâÊã©Ëã•Âπ≤Ë¥®Êï∞ÂΩì‰ΩúÂ∫ïÊï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>ÔºåËøõË°åÂà§Êñ≠„ÄÇ</p>
<p>ÂÖ≥‰∫éÂ∫ïÊï∞ÁöÑÈÄâÊã©Ôºö &gt;Â¶ÇÊûúÈÄâÁî®2, 3, 7,
61Âíå24251‰Ωú‰∏∫Â∫ïÊï∞ÔºåÈÇ£‰πà10^16ÂÜÖÂîØ‰∏ÄÁöÑÂº∫‰º™Á¥†Êï∞‰∏∫46 856 248 255 981
‚Äî‚Äîmatrix67ÂçöÂÆ¢ (Orz)</p>
<p>ÈÄâÊã© <code>int PrimeList[10] = {2, 3, 7, 61, 24251, 11, 29};</code>
Âç≥ÂèØÔºåÊàñËÄÖÂÜçÈöèÊÑèÂä†Âá†‰∏™Â∞èË¥®Êï∞„ÄÇ</p>
<p>ÈúÄË¶ÅÊ≥®ÊÑèÂø´ÈÄü‰πòÊ≥ïÁöÑÂÆûÁé∞„ÄÇ Â§çÊùÇÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>k</mi><mi>log</mi><mo>‚Å°</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(k \log x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define LL </span><span class="dt">long</span><span class="pp"> </span><span class="dt">long</span><span class="pp"> </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ULL </span><span class="dt">unsigned</span><span class="pp"> </span><span class="dt">long</span><span class="pp"> </span><span class="dt">long</span><span class="pp"> </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> ULL mul<span class="op">(</span>ULL a<span class="op">,</span> ULL b<span class="op">,</span> ULL MOD<span class="op">){</span> <span class="co">// unsigned long long  </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    LL R <span class="op">=</span> <span class="op">(</span>LL<span class="op">)</span>a<span class="op">*</span>b <span class="op">-</span> <span class="op">(</span>LL<span class="op">)((</span>ULL<span class="op">)((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">)</span>a <span class="op">*</span> b <span class="op">/</span> MOD<span class="op">)</span> <span class="op">*</span> MOD<span class="op">);</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Âè™ÂÖ≥ÂøÉ‰∏§‰∏™Á≠îÊ°àÁöÑÂ∑ÆÂÄºÔºåËøô‰∏™Â∑ÆÂÄº‰∏ÄÂÆöÂ∞è‰∫é unsigned long long ÁöÑÊúÄÂ§ßÂÄºÔºå</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ÊâÄ‰ª•Âú®Âì™‰∏™Ââ©‰ΩôÁ≥ª‰∏ãÈÉΩ‰∏çÈáçË¶ÅÔºå‰∏çÁÆ°Â∑ÆÂÄºÊòØ‰ªÄ‰πàÈÉΩËÉΩËøòÂéüÂá∫ÂéüÂßãÊï∞ÂÄº„ÄÇ </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>R <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> R <span class="op">+=</span> MOD<span class="op">;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>R <span class="op">&gt;</span> MOD<span class="op">)</span> R <span class="op">-=</span> MOD<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> R<span class="op">;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> LL pow<span class="op">(</span>LL a<span class="op">,</span> LL b<span class="op">,</span> LL P<span class="op">)</span> <span class="op">{</span> LL ans <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">while</span><span class="op">(</span>b<span class="op">){</span> <span class="cf">if</span><span class="op">(</span>b <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> ans <span class="op">=</span> mul<span class="op">(</span>ans<span class="op">,</span> a<span class="op">,</span> P<span class="op">);</span> a <span class="op">=</span> mul<span class="op">(</span>a<span class="op">,</span> a<span class="op">,</span> P<span class="op">);</span> b <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span> <span class="cf">return</span> ans<span class="op">;</span> <span class="op">}</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> PrimeList<span class="op">[</span><span class="dv">10</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">61</span><span class="op">,</span> <span class="dv">24251</span><span class="op">,</span> <span class="dv">11</span><span class="op">,</span> <span class="dv">17</span><span class="op">,</span> <span class="dv">19</span><span class="op">,</span> <span class="dv">29</span><span class="op">,</span> <span class="dv">27</span><span class="op">};</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> Miller_Rabin<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> LL n<span class="op">){</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    LL d <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> r <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> x<span class="op">;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(!(</span>d <span class="op">&amp;</span> <span class="dv">1</span><span class="op">))</span> d <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">,</span> r<span class="op">++;</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">((</span>x <span class="op">=</span> pow<span class="op">(</span>a<span class="op">,</span> d<span class="op">,</span> n<span class="op">))</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> t <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> t <span class="op">&lt;=</span> r<span class="op">;</span> t<span class="op">++,</span> x <span class="op">=</span> mul<span class="op">(</span>x<span class="op">,</span> x<span class="op">,</span> n<span class="op">))</span> <span class="cf">if</span><span class="op">(</span>x <span class="op">==</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> Prime<span class="op">(</span>LL x<span class="op">){</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>x <span class="op">&lt;=</span> <span class="dv">2</span><span class="op">)</span> <span class="cf">return</span> x <span class="op">==</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">7</span><span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>x <span class="op">==</span> PrimeList<span class="op">[</span>i<span class="op">])</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>Miller_Rabin<span class="op">(</span>PrimeList<span class="op">[</span>i<span class="op">],</span> x<span class="op">))</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="pollard-rho">Pollard-Rho</h2>
<p>Âø´ÈÄüÂàÜËß£Ë¥®Âõ†Êï∞ÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇ Â§çÊùÇÂ∫¶
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>A</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>p</mi><mi>t</mi><mi>e</mi><mi>d</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(Accepted)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal">cce</span><span class="mord mathnormal">pt</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mclose">)</span></span></span></span>„ÄÇÂ§ßÁ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>4</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n^{1/4})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1/4</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
ÔºåÁÆóÊ≥ïÂØºËÆ∫ÁªôÂá∫ÁöÑÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\sqrt{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0503em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8003em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal">n</span></span></span><span style="top:-2.7603em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2397em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span>Ôºå‰ΩÜÊòØÈöèÊú∫Êï∞ÊçÆ‰∏ãÔºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>s</mi></mrow><annotation encoding="application/x-tex">1s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mord mathnormal">s</span></span></span></span>
ÂàÜËß£
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10000</mn></mrow><annotation encoding="application/x-tex">10000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10000</span></span></span></span>
‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>18</mn></msup></mrow><annotation encoding="application/x-tex">10^{18}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">18</span></span></span></span></span></span></span></span></span></span></span></span>
ÈáèÁ∫ßÁöÑÊï∞Â≠óÈóÆÈ¢ò‰∏çÂ§ß‚Ä¶‚Ä¶</p>
<blockquote>
<p>‰ªª‰Ωï‰∏Ä‰∏™‰ºüÂ§ßÁöÑÁÆóÊ≥ïÈÉΩÊù•Ëá™‰∫é‰∏Ä‰∏™ÂæÆ‰∏çË∂≥ÈÅìÁöÑÁåúÊÉ≥„ÄÇ</p>
</blockquote>
<p>ËÄÉËôëÁªôÂá∫‰∏Ä‰∏™Êï∞Â≠ó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÔºåÂ¶ÇÊûúÂèØ‰ª•Âø´ÈÄüÊâæÂÖ∂‰∏≠‰∏Ä‰∏™Âõ†Â≠ê
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>
ÔºåÁÑ∂ÂêéÁªßÁª≠ÈÄíÂΩíÂàÜËß£
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">n / g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>
Âíå
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>
Âç≥ÂèØÂÆåÊàêË¥®Âõ†Êï∞ÂàÜËß£„ÄÇ</p>
<p>ËÄÉËôëÂ¶Ç‰ΩïÂø´ÈÄüÂØªÊâæ‰∏Ä‰∏™Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÂõ†Â≠ê
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>Ôºõ
Ôºà‰ª•‰∏ãÂ§çÊùÇÂ∫¶ÂàÜÊûêÈÉΩÊòØÂü∫‰∫éÊúÄÂùèÊÉÖÂÜµÔºåÂç≥Á¥†Êï∞Âπ≥ÊñπÁöÑÂΩ¢ÂºèÔºâ</p>
<ol type="1">
<li>Êûö‰∏æ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÂõ†Â≠ê
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>
ËØïÈô§ÔºåÂ§çÊùÇÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\sqrt{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0503em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8003em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal">n</span></span></span><span style="top:-2.7603em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2397em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li>ËÄÉËôëÈöèÊú∫Êûö‰∏æ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÂõ†Â≠êÔºåËØïÈô§ÔºåÊúüÊúõÂ§çÊùÇÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
<li>Ê≤°ÂøÖË¶ÅÈöèÊú∫Êûö‰∏æ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÂõ†Â≠êÔºåÂè™ÈúÄË¶ÅÈöèÊú∫‰∏Ä‰∏™Êï∞Â≠ó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>
ÈÇ£‰πà
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g = gcd(a, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>
Â∞±ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑ‰∏Ä‰∏™Âõ†Â≠êÔºåÈúÄË¶ÅÊâæÂà∞‰∏Ä‰∏™‰∏çÂπ≥Âá°ÁöÑÂõ†Â≠êÊâçÂèØ‰ª•ÔºåËøôÊ†∑
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>
ÁöÑÂêàÊ≥ïÂèñÂÄºÂèòÊàê‰∫Ü
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÂõ†Â≠êÊàñ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
Âõ†Â≠êÁöÑÂÄçÊï∞ÔºåÂêàÊ≥ïÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>
ÁöÑÂèñÂÄºÊúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\sqrt{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0503em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8003em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal">n</span></span></span><span style="top:-2.7603em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2397em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
‰∏™„ÄÇ</li>
</ol>
<p>ÁùÄÈáçËÄÉËôë‰∏ã‰∏ÄÁßç‰ºòÂåñÔºö</p>
<p>ËÄÉËôë‰∏ÄÊ¨°ÊÄßÈöèÊú∫Âá∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
‰∏™Êï∞Â≠ó ÂàÜÂà´ËÆ∞‰Ωú
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mn>1...</mn><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a_{1...k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1...</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ÔºåËÄÉËôëÂÖ∂‰∏≠‰∏§‰∏§ÁöÑÂ∑ÆÂÄºÔºåÂ∫îËØ•Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>k</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">k^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>
ÁßçÂ∑ÆÂÄº„ÄÇËØïÂõæËÆ©ÂÖ∂Â∑ÆÂÄº‰∏é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
Ê±ÇÊúÄÂ§ßÂÖ¨Á∫¶Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>ÔºåËã•
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>
‰∏ç‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>
Âàô
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>
Â∞±ÊòØ‰∏Ä‰∏™‰∏çÂπ≥Âá°Âõ†Â≠ê„ÄÇ Â∑ÆÂÄº‰∏é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>ÔºåÁ≠â‰ª∑‰∫é
Â∑ÆÂÄºÂú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>
ÁöÑÂâ©‰ΩôÁ≥ª‰∏ãÂêå‰Ωô
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>„ÄÇËÄÉËôëËøô
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>k</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">k^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>
‰∏™Â∑ÆÂÄºÈÉΩ‰∏çÁ≠â‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>
ÁöÑÊ¶ÇÁéá‰∏∫Â§öÂ∞ë„ÄÇÂõ†‰∏∫Ëøô
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
‰∏™Êï∞Â≠óÊòØÈöèÊú∫ÁöÑÔºåÈÇ£‰πà‰ªñ‰ª¨Â∑ÆÂÄºÁöÑÂèñÂÄºÂú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>
ÁöÑÂâ©‰ΩôÁ≥ª‰∏ã‰πüÊòØÂú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, c]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mclose">]</span></span></span></span>
Á≠âÊ¶ÇÁéáÂàÜÂ∏ÉÁöÑ„ÄÇÈÇ£‰πàÈÉΩ‰∏çÁ≠â‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>
ÁöÑÊ¶ÇÁéá‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo fence="true">(</mo><mfrac><mrow><mi>c</mi><mo>‚àí</mo><mn>1</mn></mrow><mi>c</mi></mfrac><mo fence="true">)</mo></mrow><msup><mi>k</mi><mn>2</mn></msup></msup></mrow><annotation encoding="application/x-tex">\left(\frac{c - 1}{c}\right)^{k^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5768em;vertical-align:-0.35em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2268em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>„ÄÇÊúÄÂùèÊÉÖÂÜµ‰∏ãÔºåÂêàÊ≥ïÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>
Âè™Êúâ‰∏Ä‰∏™Ôºå‰∏îÁ≠â‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mi>n</mi></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.2397em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8003em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal">n</span></span></span><span style="top:-2.7603em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2397em;"><span></span></span></span></span></span></span></span></span>
Ê†πÊçÆ</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mrow><mo fence="true">(</mo><mfrac><mrow><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow><mi>n</mi></mfrac><mo fence="true">)</mo></mrow><mi>n</mi></msup><mo>‚âà</mo><mfrac><mn>1</mn><mi>e</mi></mfrac></mrow><annotation encoding="application/x-tex">\left(\frac{n-1}{n}\right)^{n} \approx \frac{1}{e}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4543em;vertical-align:-0.95em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.5043em;"><span style="top:-3.9029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚âà</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>ÂΩì
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><msup><mi>n</mi><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">k = n^{1/4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1/4</span></span></span></span></span></span></span></span></span></span></span></span>
Êó∂ÔºåÂèñ‰∏çÂà∞ÂÄºÂæóÊ¶ÇÁéá‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>e</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{e}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>„ÄÇÁ®çÂæÆÂ¢ûÂ§ßÂá†ÂÄçÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÂèØ‰ª•Èôç‰ΩéÊâæ‰∏çÂà∞Ê¶ÇÁéá„ÄÇ Ê≥®ÊÑèËøôÊ†∑ÁöÑÂÅöÊ≥ïÈúÄË¶ÅÊûö‰∏æÊâÄÊúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>k</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">k^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>
ÂØπÂ∑ÆÂÄºÔºåÂÜçÂä†‰∏äÂà§Êñ≠ÂíåÂèñ‰∏çÂà∞Á∫¶Êï∞ÊÉÖÂÜµÁöÑÂá∫Áé∞ÔºåÂ§çÊùÇÂ∫¶Ë¶ÅÂä£‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\sqrt{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0503em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8003em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal">n</span></span></span><span style="top:-2.7603em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2397em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span>„ÄÇ
Êûö‰∏æ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>k</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">k^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>
ÂØπÂ∑ÆÂÄºÊòØ‰∏äÈù¢ÁÆóÊ≥ïÁöÑÁì∂È¢à„ÄÇÂºïÂÖ•‰º™ÈöèÊú∫ÂáΩÊï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>f</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>c</mi><mspace></mspace><mspace width="0.6667em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>‚Äâ</mtext><mtext>‚Äâ</mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">f(x) = f^2(x-1) + c \mod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6667em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span></span>„ÄÇ
Ëøô‰∏™ÂáΩÊï∞ÊúâÂá†ÁÇπÊØîËæÉ‰ºòËâØÊÄßË¥®Ôºö</p>
<ol type="1">
<li>‰ªçÁÑ∂ÂèØ‰ª•ÁúãÊàêÊòØ‰∏ÄÁßçÈöèÊú∫ÂáΩÊï∞Ôºå‰øùËØÅ‰∫Ü‰∏äÈù¢Êé®ÂØº‰∏≠ÂØπÈöèÊú∫ÁöÑ‰æùËµñÊÄß„ÄÇ<del>Ôºà‰∏™‰∫∫ÊÑüËßâ‰∏çËÉΩ‰øùËØÅÂÆåÂÖ®ÈöèÊú∫‚Ä¶‚Ä¶Ôºâ</del></li>
<li>ÁªèËøá‰∏ÄÊÆµÊ¨°Êï∞ÁöÑÈÄíÊé®‰πãÂêé‰ºöËøõÂÖ•‰∏Ä‰∏™Âæ™ÁéØÔºåÂõ†‰∏∫‰πãÂíåÂâç‰∏ÄÈ°πÁöÑÂÄºÊúâÂÖ≥ÔºåËÄå‰∏îÂèñÂÄºÂè™ËÉΩÂú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>n</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, n-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>
ÂÜÖÔºåÊâÄ‰ª•Ëá≥Â§ö
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>
Ê¨°ÈÄíÊé®Ôºå‰∏ÄÂÆö‰ºöËøõÂÖ•‰∏Ä‰∏™Âæ™ÁéØ„ÄÇ</li>
<li><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>g</mi><mo>‚à£</mo><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mi>f</mi><mo stretchy="false">(</mo><mi>j</mi><mo stretchy="false">)</mo><mtext>¬†¬†¬†</mtext><mo>‚áí</mo><mtext>¬†¬†¬†</mtext><mi>g</mi><mo>‚à£</mo><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>‚àí</mo><mi>f</mi><mo stretchy="false">(</mo><mi>j</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g \mid f(i) - f(j)\ \ \  \Rightarrow\ \ \ g \mid f(i + 1) - f(j - 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚à£</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace">¬†</span><span class="mspace">¬†</span><span class="mspace">¬†</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚áí</span><span class="mspace">¬†</span><span class="mspace">¬†</span><span class="mspace">¬†</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚à£</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>
ËØÅÊòéÔºö
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>‚àí</mo><mi>f</mi><mo stretchy="false">(</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msup><mi>f</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mo stretchy="false">(</mo><msup><mi>f</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>j</mi><mo stretchy="false">)</mo><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mi>f</mi><mo stretchy="false">(</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false">(</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(i + 1) - f(j + 1) = (f^2(i) + c) - (f^2(j) + c) = (f(i) - f(j))(f(i) + f(j))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">))</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">))</span></span></span></span></span>
‰πüÂ∞±ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>
ÊòØÂê¶‰∏∫Êüê‰∏§‰∏™Â∑ÆÂÄºÁöÑÁ∫¶Êï∞‰πãÂíå‰∏§‰∏™Â∑ÆÂÄº‰∏ãÊ†áÁöÑÂ∑ÆÊúâÂÖ≥„ÄÇ</li>
</ol>
<p>ËÄÉËôë‰∏§‰∏™ÊåáÈíàÔºåÂàÜÂà´‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo separator="true">,</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">L, R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>
ÔºåÊØèÊ¨°
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span>
ÈÄíÊé®‰∏Ä‰∏™Ôºå
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>
ÈÄíÊé®‰∏§‰∏™ÔºåÂõ†‰∏∫ÂáΩÊï∞Â≠òÂú®ÁéØÔºåËøô‰∏§‰∏™Â∑ÆÂÄºÊÄª‰ºöÂú®ÁéØ‰∏äÁõ∏ÈÅáÔºå‰ªéÂºÄÂßãÂà∞Áõ∏ÈÅá‰πãÈó¥ÁöÑÊó∂Èó¥ÔºåÊØèÊ¨°ÊâßË°åÂêéÔºåÂà§Êñ≠ÂÖ∂Â∑ÆÂÄº‰∏é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑ <code>gcd</code> ÊòØÂê¶‰∏çÁ≠â‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>
Âç≥ÂèØ„ÄÇÁõ∏ÈÅáÊâÄÈúÄÊó∂Èó¥ÔºåÂç≥ÁéØÁöÑÂ§ßÂ∞èÁ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mi>n</mi></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.2397em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8003em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal">n</span></span></span><span style="top:-2.7603em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2397em;"><span></span></span></span></span></span></span></span></span>
„ÄÇÁéØÁöÑÂ§ßÂ∞èÂÜ≥ÂÆöËøêË°åÊúÄÂùèÊó∂Èó¥„ÄÇ</p>
<p>ËøôÊ†∑ËøòÊòØ‰∏çÂ§üÂø´ÔºåÂÖ∂ÂÆû‰∏çÈúÄË¶ÅÊØèÊ¨°ÊâßË°åÈÉΩÁÆó‰∏Ä‰∏ã
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">gcd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span></span></span></span>
ÂèØ‰ª•ÊâßË°å‰∏Ä‰∫õÊ≠•Êï∞‰πãÂêéÔºåÂ∞ÜÂÖ∂Â∑ÆÂÄº‰πòÂà∞‰∏ÄËµ∑Ôºå‰∏ÄËµ∑Ê±Ç
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">gcd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span></span></span></span>
Âç≥ÂèØÔºåÂèØ‰ª•ËØÅÊòéÔºåËøôÊ†∑ÁöÑÂèòÂåñ‰øùËØÅÁ≠îÊ°à‰∏ç‰ºöÂèòÂä£„ÄÇ
ËÄÉËôëËÆ©‰∏§‰∏™ÊåáÈíàÂÄçÂ¢ûÁöÑÂæÄÂâçË∑≥ÔºåÂÄçÂ¢ûËã•Âπ≤Ê¨°ÂêéÔºåÊØèÊ¨°ËÆ°ÁÆó‰∏§‰∏™ÊåáÈíàË∑ùÁ¶ª‰πãÈó¥ÁöÑÊâÄÊúâÂ∑ÆÂÄºÂèñÂÄºÔºå‰πòÂú®‰∏ÄËµ∑ËÆ°ÁÆó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">gcd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span></span></span></span>„ÄÇ</p>
<del>
Ê†áÂáÜ‰ª£Á†Å‰∏≠ÔºöÂ∑ÆÂÄºÁõ∏ÂêåÁöÑËß£‰ºöËÆ°ÁÆóÂ§öÊ¨°„ÄÇ‰ΩÜÊòØÁ°ÆÂÆûÂ§ßÂ§ßÊèêÂçáËøêË°åÊïàÁéá„ÄÇËøôÈáåÂ∞±‰∏ç‰ºöÂàÜÊûê‰∫ÜÔºå‰ΩÜÊòØÁõ¥ËßÇÊÑüËßâÂ∞±ÊòØÔºåÂÖ∂ÂÆûÈÇ£‰∏™ÂáΩÊï∞ÂæÄÂêéÈÄíÊé®ÁöÑÊ¨°Êï∞Ë∂äÂ§ö‰ºöÂåÖÂê´Êõ¥Â§öÁöÑÂõ†Â≠ê„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂ¶ÇÊûú‰∏§ÂØπÂáΩÊï∞ÂÄºÂ∑ÆÂÄº‰∏ãÊ†áË∑ùÁ¶ª‰∏ÄÊ†∑ÔºåÂÖ∂ÂÆû‰∏ãÊ†áÂ§ßÁöÑÈÇ£‰∏ÄÂØπ‰ºöÊõ¥‰ºò„ÄÇ
</del>
<p>ÊÄªÁöÑÊù•ËØ¥ÔºåÂø´ÁöÑÁéÑÂ≠¶„ÄÇ</p>
<p>ÂèØ‰ª•ÂÜôÂá∫Â¶Ç‰∏ã‰ª£Á†ÅÔºö</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>LL Pollard_Rho<span class="op">(</span>LL n<span class="op">){</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    LL c <span class="op">=</span> rand<span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    LL L <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> s <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> t <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="op">;</span> s <span class="op">&lt;&lt;=</span> <span class="dv">1</span><span class="op">,</span> t <span class="op">&lt;&lt;=</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        LL R <span class="op">=</span> L<span class="op">,</span> M <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> s<span class="op">,</span> step <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> t<span class="op">;</span> i<span class="op">++,</span> step <span class="op">++){</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>            R <span class="op">=</span> f<span class="op">(</span>R<span class="op">,</span> c<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>            M <span class="op">=</span> mul<span class="op">(</span>M<span class="op">,</span> abs<span class="op">(</span>L <span class="op">-</span> R<span class="op">),</span> n<span class="op">);</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>step <span class="op">%</span> <span class="dv">1000</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> LL g <span class="op">=</span> gcd<span class="op">(</span>M<span class="op">,</span> n<span class="op">);</span> <span class="cf">if</span><span class="op">(</span>g <span class="op">&gt;</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> g<span class="op">;</span> <span class="op">}</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ‰∏ç‰∏ÄÂÆöÂøÖÈ°ªÁ≠âÂà∞‰∏ÄËΩÆËÆ°ÁÆóÁªìÊùü‰πãÂêéÂÜçËÆ°ÁÆó gcd ÂèØËÉΩ‰∏≠Èó¥Â∞±Â∑≤ÁªèÂá∫Áé∞Á≠îÊ°à‰∫ÜÔºå‰∏≠Èó¥ÊØèÈöî‰∏ÄÊÆµÊó∂Èó¥ÁÆóÂá†Ê¨°ÔºåÂèØ‰ª•Âú®Âá∫Áé∞Á≠îÊ°à‰πãÂêéÂø´ÈÄüËøîÂõûÁ≠îÊ°à„ÄÇ</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        LL g <span class="op">=</span> gcd<span class="op">(</span>M<span class="op">,</span> n<span class="op">);</span> <span class="cf">if</span><span class="op">(</span>g <span class="op">&gt;</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> g<span class="op">;</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        L <span class="op">=</span> R<span class="op">;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> factorize<span class="op">(</span>LL n<span class="op">){</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>Prime<span class="op">(</span>n<span class="op">))</span> <span class="op">{</span> ans <span class="op">=</span> max<span class="op">(</span>ans<span class="op">,</span> n<span class="op">);</span> <span class="cf">return</span> <span class="op">;</span> <span class="op">}</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    LL g <span class="op">=</span> n<span class="op">;</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>g <span class="op">==</span> n<span class="op">)</span> g <span class="op">=</span> Pollard_Rho<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    factorize<span class="op">(</span>g<span class="op">);</span> factorize<span class="op">(</span>n <span class="op">/</span> g<span class="op">);</span> </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="Èò∂">Èò∂</h2>
<p>Ëã•
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>‚ä•</mo><mi>P</mi></mrow><annotation encoding="application/x-tex">a \perp P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚ä•</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>ÔºåÂàô‰Ωø
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>k</mi></msup><mo>‚â°</mo><mn>1</mn><mspace></mspace><mspace width="0.4444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>P</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^k \equiv 1 \pmod P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">)</span></span></span></span>
ÊàêÁ´ãÁöÑÊúÄÂ∞èÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ÔºåÁß∞‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>
ÂÖ≥‰∫éÊ®°
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>
ÁöÑÈò∂ÔºåËÆ∞‰Ωú
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>ord</mtext><mi>m</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{ord}_m(a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">ord</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span>„ÄÇ</p>
<p>Ê±ÇÊ≥ïÔºö
Ê†πÊçÆÊ¨ßÊãâÂÆöÁêÜÔºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>ord</mtext><mi>m</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>‚à£</mo><mi>œÜ</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{ord}_m(a) \mid \varphi(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">ord</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚à£</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">œÜ</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>ÔºåÂÖàÊ±ÇÂá∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÜ</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\varphi(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">œÜ</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>ÔºåËÆ∞‰Ωú
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>„ÄÇ</p>
<ul>
<li>Êûö‰∏æ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>
ÁöÑÊØè‰∏Ä‰∏™Âõ†Â≠êÔºåÊ£ÄÊü•ÊòØÂê¶Êª°Ë∂≥Èò∂ÁöÑÊÄßË¥®„ÄÇ</li>
<li>ÂØπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>
Ë¥®Âõ†Êï∞ÊãÜÂàÜÔºå‰ª•Ê≠§ËÄÉËôëÊØè‰∏™Ë¥®Âõ†Â≠êÔºåËØïÂõæÂáèÂ∞ëË¥®Âõ†Â≠êÁöÑÂπÇÊ¨°‚Äî‚ÄîÂç≥Â¶ÇÊûúÂáèÂ∞ë‰∫ÜÊüê‰∏™Ë¥®Âõ†Â≠êÁöÑÂπÇÊ¨°Ôºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>t</mi></msup><mo>‚â°</mo><mn>1</mn><mspace></mspace><mspace width="0.4444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>P</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^t \equiv 1 \pmod P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7936em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">)</span></span></span></span>
‰æùÁÑ∂ÊàêÁ´ãÔºåÈÇ£‰πàÂ∞±Áõ¥Êé•ÂáèÂ∞ëÂç≥ÂèØ„ÄÇÊÑüÊÄßÁêÜËß£‰∏Ä‰∏ãËÇØÂÆöÊòØÂØπÁöÑ„ÄÇ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>‚Å°</mo><mi>œÜ</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\log \varphi(P))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">œÜ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">))</span></span></span></span></li>
</ul>
<h2 id="ÂéüÊ†π">ÂéüÊ†π</h2>
<p>Ëã•
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>ord</mtext><mi>m</mi></msub><mi>g</mi><mo>=</mo><mi>œÜ</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{ord}_mg = \varphi(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord text"><span class="mord">ord</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">œÜ</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>
ÂàôÁß∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>
‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>
ÁöÑÂéüÊ†π„ÄÇ</p>
<p>ÈÄö‰øóÁöÑËÆ≤ÔºöÁß∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>
‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>
ÁöÑÂéüÊ†πÔºåÂΩì‰∏î‰ªÖÂΩì
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msup><mi>g</mi><mn>0</mn></msup><mo separator="true">,</mo><msup><mi>g</mi><mn>1</mn></msup><mo separator="true">,</mo><msup><mi>g</mi><mn>2</mn></msup><mo separator="true">,</mo><mo>‚Ä¶</mo><mo separator="true">,</mo><msup><mi>g</mi><mrow><mi>œÜ</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{g^0, g^1, g^2, \dots, g^{\varphi(P) - 1}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">‚Ä¶</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">œÜ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mclose mtight">)</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>
Êï∞‰∏§‰∏§‰∏çÂêå„ÄÇ</p>
<p>Âç≥ÂØπ‰∫é‰ªªÊÑè‰∏Ä‰∏™Âíå
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>
‰∫íË¥®ÁöÑÊï∞Â≠óÔºåÂú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>
ÁöÑÂâ©‰ΩôÁ≥ª‰∏ãÔºåÈÉΩÂèØ‰ª•Ë°®Á§∫Êàê
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">g^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.988em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span>
ÁöÑÂΩ¢Âºè„ÄÇ</p>
<p>‰∏Ä‰∏™Ê®°Êï∞Â≠òÂú®ÂéüÊ†πÔºåÂΩì‰∏î‰ªÖÂΩìËøô‰∏™Ê®°Êï∞‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><msup><mi>p</mi><mi>s</mi></msup><mo separator="true">,</mo><mn>2</mn><msup><mi>p</mi><mi>s</mi></msup></mrow><annotation encoding="application/x-tex">2, 4, p^s, 2p^s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span></span></span>Ôºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>
‰∏∫Â•áÁ¥†Êï∞„ÄÇ</p>
<p>Âà§Êñ≠‰∏Ä‰∏™Êï∞ÊòØÂê¶‰∏∫ÂéüÊ†πÔºöÊ†πÊçÆÂÆö‰πâÂèØ‰ª•ËÄÉËôëÊûö‰∏æÊØè‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>‚àà</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>œÜ</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">t \in [1, \varphi(P) - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6542em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">œÜ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>
Âà§Êñ≠
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">g^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.988em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span>
ÊòØÂê¶ÈÉΩ‰∏çÁ≠â‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>„ÄÇ‰∫ãÂÆû‰∏äÔºåÊ†πÊçÆÊ¨ßÊãâÂÆöÁêÜÔºåÂèØËÉΩ‰Ωø
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mi>t</mi></msup><mo>‚â°</mo><mn>1</mn><mspace></mspace><mspace width="0.4444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>P</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g^t \equiv 1 \pmod P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.988em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â°</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">)</span></span></span></span>
ÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>
Âè™ÂèØËÉΩÊòØÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÜ</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\varphi(P)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">œÜ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">)</span></span></span></span>
ÁöÑÁ∫¶Êï∞„ÄÇÊûö‰∏æ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÜ</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\varphi(P)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">œÜ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">)</span></span></span></span>
ÁöÑÊØè‰∏™Á∫¶Êï∞ÔºåËøõË°åÂà§Êñ≠Âç≥ÂèØÔºåÂ§çÊùÇÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msqrt><mrow><mi>œÜ</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo></mrow></msqrt><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\sqrt{\varphi(P)})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.305em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.935em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord mathnormal">œÜ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">)</span></span></span><span style="top:-2.895em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.305em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>ÂéüÊ†πÁöÑÊ±ÇÊ≥ïÔºöËã•‰∏Ä‰∏™Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>
Â≠òÂú®ÂéüÊ†πÔºåÂÖ∂ÊúÄÂ∞èÂéüÊ†πÂ§ßÊ¶ÇÂú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">m^{1/4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1/4</span></span></span></span></span></span></span></span></span></span></span></span>
Á∫ßÂà´„ÄÇÊûö‰∏æÂéüÊ†πÂÜçÂà§Êñ≠‰∏ÄËà¨ÊòØÂèØ‰ª•Êé•ÂèóÁöÑ„ÄÇ</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> JudgePrimitiveRoot<span class="op">(</span><span class="dt">int</span> g<span class="op">,</span> <span class="dt">int</span> P<span class="op">){</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> phi <span class="op">=</span> P <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">*</span> i <span class="op">&lt;=</span> phi<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>phi <span class="op">%</span> i <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>pow<span class="op">(</span>g<span class="op">,</span> i<span class="op">,</span> P<span class="op">)</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>pow<span class="op">(</span>g<span class="op">,</span> P <span class="op">/</span> i<span class="op">,</span> P<span class="op">)</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> GetPrimitiveRoot<span class="op">(</span><span class="dt">int</span> P<span class="op">){</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> <span class="op">;</span> i<span class="op">++)</span> <span class="cf">if</span><span class="op">(</span>JudgePrimitiveRoot<span class="op">(</span>i<span class="op">,</span> P<span class="op">))</span> <span class="cf">return</span> i<span class="op">;</span> <span class="op">}</span></span></code></pre></div>
<p>Âú∞‰ΩçÁõ∏ÂΩì‰∫éËá™ÁÑ∂Êï∞Âüü‰∏ãÁöÑÂîØ‰∏ÄÂàÜËß£ÂÆöÁêÜ„ÄÇ</p>
                                    </div>

                                    <!-- Article Footer -->
                                    <div class="article-footer">
                                                                            
                                        <section class="post-history">
                                            <div class="history-header">
                                                <h2>üìö Version History</h2>
                                                <span class="history-desc">Source Code Change History</span>
                                            </div>
                                            <div class="version-list">
                                                
                                                    <div class="version-item">
                                                        <div class="version-header">
                                                            <span class="version-badge">v1</span>
                                                            <time class="version-time" datetime="2020-12-20 23:41:12">
                                                                üìÖ 2020-12-20 23:41:12
                                                            </time>
                                                        </div>
                                                        <div class="version-hash-container">
                                                            <span class="hash-label">üîó Source Hash:</span>
                                                            <code class="version-hash" title="Source Code Hash (e46293337faa0c5d78a46658192271a2daafdaa286cbd8726b639f3e069f4b0f)">e46293337faa0c5d78a46658192271a2daafdaa286cbd8726b639f3e069f4b0f</code>
                                                        </div>
                                                    </div>
                                                
                                            </div>
                                        </section>
                    

                    
                                            <details class="build-logs">
                                                <summary>Build Logs</summary>
                                                <pre class="logs-content">Build Log - Filtered
================================================

üìã Information:
‚Ä¢ Path information has been filtered for privacy protection
‚Ä¢ File names are preserved for debugging purposes  
‚Ä¢ All build status and error messages are kept intact

üîç Filter Rules:
‚Ä¢ /absolute/path/file.ext ‚Üí .../file.ext
‚Ä¢ /home/username ‚Üí .../[user]
‚Ä¢ /tmp/files ‚Üí .../[temp]
‚Ä¢ /usr/share/packages ‚Üí .../[system]

================================================

html log:
CMD: ['pandoc', '-s', 'cache/oi-blog_„ÄåÂ≠¶‰π†ÊÄªÁªì„ÄçÊï∞ËÆ∫.md', '--filter', 'pandoc-crossref', '--filter', 'pandoc-katex', '--template=cache/pandoc_html_template.html', '-o', 'cache.../oi-blog_„ÄåÂ≠¶‰π†ÊÄªÁªì„ÄçÊï∞ËÆ∫.md.html', '--metadata', '--verbose', '--highlight-style=tango']
STDOUT: 
STDERR: WARNING: pandoc-crossref was compiled with pandoc 3.6.2 but is being run through 3.6.4. This is not supported. Strange things may (and likely will) happen silently.

====================================================================================================
pdf log:
CMD: ['pandoc', '-s', 'cache.../eca76bfdcb.pdf.md', '-o', 'cache/eca76bfdcb.pdf', '-H', 'static/pandoc.header.tex', '--pdf-engine=xelatex', '--verbose']
STDOUT: 
STDERR: [INFO] Loaded static.../pandoc.header.tex from static.../pandoc.header.tex
[INFO] Not rendering RawInline (Format "html") "<!-- more -->"
[INFO] Not rendering RawInline (Format "html") "<del>"
[INFO] Not rendering RawInline (Format "html") "</del>"
[INFO] Not rendering RawInline (Format "html") "<del>"
[INFO] Not rendering RawInline (Format "html") "</del>"
[INFO] Not rendering RawBlock (Format "html") "<del>"
[INFO] Not rendering RawBlock (Format "html") "</del>"
[INFO] [makePDF] Temp dir:
  .../[temp]
[INFO] [makePDF] Command line:
  xelatex "-halt-on-error" "-interaction" "nonstopmode" "-output-directory" ".../[temp] ".../[temp]
[INFO] [makePDF] Relevant environment variables:
  ("TEXINPUTS",".../[temp]
  ("TEXMFOUTPUT",".../[temp]
  ("SHELL","/bin/bash")
  ("PWD",".../[user]/projects/blog")
  ("HOME",".../[user]
  ("LANG","zh_CN.UTF-8")
  ("PATH",".../[user]/.local/bin:.../[user]/.cargo/bin:.../[user]/miniconda3/envs/myblog/bin:.../[user]/miniconda3/condabin:.../[temp]
[INFO] [makePDF] Source:
  % Options for packages loaded elsewhere
  \PassOptionsToPackage{unicode}{hyperref}
  \PassOptionsToPackage{hyphens}{url}
  \PassOptionsToPackage{space}{xeCJK}
  \documentclass[
  ]{article}
  \usepackage{xcolor}
  \usepackage[a4paper,margin=2cm]{geometry}
  \usepackage{amsmath,amssymb}
  \setcounter{secnumdepth}{-\maxdimen} % remove section numbering
  \usepackage{iftex}
  \ifPDFTeX
    \usepackage[T1]{fontenc}
    \usepackage[utf8]{inputenc}
    \usepackage{textcomp} % provide euro and other symbols
  \else % if luatex or xetex
    \usepackage{unicode-math} % this also loads fontspec
    \defaultfontfeatures{Scale=MatchLowercase}
    \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
  \fi
  \usepackage{lmodern}
  \ifPDFTeX\else
    % xetex/luatex font selection
    \setmainfont[]{Latin Modern Roman}
    \ifXeTeX
      \usepackage{xeCJK}
      \setCJKmainfont[]{AR PL UKai CN}
    \fi
    \ifLuaTeX
      \usepackage[]{luatexja-fontspec}
      \setmainjfont[]{AR PL UKai CN}
    \fi
  \fi
  % Use upquote if available, for straight quotes in verbatim environments
  \IfFileExists{upquote.sty}{\usepackage{upquote}}{}
  \IfFileExists{microtype.sty}{% use microtype if available
    \usepackage[]{microtype}
    \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
  }{}
  \usepackage{setspace}
  \makeatletter
  \@ifundefined{KOMAClassName}{% if non-KOMA class
    \IfFileExists{parskip.sty}{%
      \usepackage{parskip}
    }{% else
      \setlength{\parindent}{0pt}
      \setlength{\parskip}{6pt plus 2pt minus 1pt}}
  }{% if KOMA class
    \KOMAoptions{parskip=half}}
  \makeatother
  \usepackage{color}
  \usepackage{fancyvrb}
  \newcommand{\VerbBar}{|}
  \newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
  \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
  % Add ',fontsize=\small' for more characters per line
  \newenvironment{Shaded}{}{}
  \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
  \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
  \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.50,0.00}{#1}}
  \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{#1}}}
  \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
  \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
  \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{#1}}
  \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
  \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
  \newcommand{\ExtensionTok}[1]{#1}
  \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{#1}}
  \newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.50,0.00}{\textbf{#1}}}
  \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
  \newcommand{\NormalTok}[1]{#1}
  \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
  \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{#1}}
  \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
  \newcommand{\RegionMarkerTok}[1]{#1}
  \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
  \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
  \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \ifLuaTeX
    \usepackage{luacolor}
    \usepackage[soul]{lua-ul}
  \else
    \usepackage{soul}
    \ifXeTeX
      % soul's \st doesn't work for CJK:
      \usepackage{xeCJKfntef}
      \renewcommand{\st}[1]{\sout{#1}}
    \fi
  \fi
  \setlength{\emergencystretch}{3em} % prevent overfull lines
  \providecommand{\tightlist}{%
    \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
  % \usepackage{xeCJK}
  % \setCJKmainfont{AR PL UKai CN}
  % \usepackage{unicode-math}
  
  \setmathfont{Latin Modern Math}
  \usepackage{bookmark}
  \IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
  \urlstyle{same}
  \hypersetup{
    pdftitle={„ÄåÂ≠¶‰π†ÊÄªÁªì„ÄçÊï∞ËÆ∫},
    pdfauthor={Jiayi Su (ShuYuMo)},
    hidelinks,
    pdfcreator={LaTeX via pandoc}}
  
  \title{„ÄåÂ≠¶‰π†ÊÄªÁªì„ÄçÊï∞ËÆ∫}
  \author{Jiayi Su (ShuYuMo)}
  \date{2020-12-20 23:41:12}
  
  \begin{document}
  \maketitle
  
  \setstretch{1.3}
  ÂÖ≥‰∫é \texttt{Lucas} ÂÆöÁêÜÂèäÂÖ∂Êâ©Â±ïÔºå\texttt{BSGS}ÂèäÂÖ∂Êâ©Â±ïÔºåÂø´ÈÄüË¥®Âõ†Êï∞ÂàÜËß£
  \texttt{Pollard-Rho}ÔºåÁ¥†ÊÄßÊµãËØï‰ª•ÂèäÂéüÊ†πÂíåÈò∂ÁöÑ‰∏Ä‰∫õÂèØÁà±Áü•ËØÜ„ÄÇ
  
  \section{Êï∞ËÆ∫}\label{ux6570ux8bba}
  
  \subsection{Lucas ÂÆöÁêÜ}\label{lucas-ux5b9aux7406}
  
  Ëß£ÂÜ≥Ê®°Êï∞‰∏∫Â∞èË¥®Êï∞ÁöÑÁªÑÂêàÊï∞ÂèñÊ®°ÈóÆÈ¢ò„ÄÇ
  
  ËÆæÊ®°Êï∞‰∏∫ \(P\)ÔºåËÆæ
  \[n = \sum_{i \ge 0}\limits{a_i P^i}, m = \sum_{i \ge 0}\limits{b_i P^i}\notag\]
  \[
  \dbinom{n}{m} \equiv \prod_{i \ge 0}\limits{\dbinom{a_i}{b_i}} ( mod\ P)
  \] \{\#eq:Lucas\}
  
  ÂêåÊó∂ (eq.\textasciitilde{}@eq:Lucas) ËøòÊúâ‰∏ÄÁßçÂΩ¢ÂºèÂåñÁöÑÂÜôÊ≥ïÔºö
  
  \[
  \dbinom{n}{m} \equiv \dbinom{\lfloor n/P\rfloor}{\lfloor m/P\rfloor}\dbinom{n \mod P}{m \mod P}(mod\ P)
  \] \{\#eq:Luacs\_ex\}
  
  Ëã•Â∞èÁªÑÂêàÊï∞ÂèØ‰ª• \(\mathcal{O}(1)\) Êü•ËØ¢Ôºå\texttt{Luacs} ÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫
  \(\mathcal{O}(\log_p(n))\) „ÄÇ
  
  ÂèñÊ®°Âêé‰∏çËÉΩ‰øùËØÅ \(n \ge m\) ÔºåÊü•ËØ¢ÁªÑÂêàÊï∞Ë¶ÅÂÜôÁöÑÁªÜËá¥‰∏ÄÁÇπ„ÄÇ
  
  ÁâπÊÆäÂú∞ÔºåÂ¶ÇÊûúÊ®°Êï∞ÊòØ \(2\) ÔºåÊ†πÊçÆ (eq.\textasciitilde{}@eq:Lucas)
  ËÄÉËôëÂ¶ÇÊûúÊääÊï∞Â≠óËøõË°å‰∫åËøõÂà∂ÊãÜÂàÜÊ±ÇÁªÑÂêàÊï∞Ôºå‰∏çÈöæÂèëÁé∞ÂÖ∂Âú®Ê®° \(2\) ÊÑè‰πâ‰∏ãÁöÑÂÄº‰∏∫
  \(\left[(n\ \And\ m) = m\right]\) ÂÖ∂‰∏≠ \(n, m\) ÁöÑÊÑè‰πâÂêå
  (eq.\textasciitilde{}@eq:Lucas)„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ \_C\_}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ m}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ n}\OperatorTok{)\{}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{m }\OperatorTok{\textless{}}\NormalTok{ n}\OperatorTok{)}  \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{return}\NormalTok{ frac}\OperatorTok{[}\NormalTok{m}\OperatorTok{]} \OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ ifrac}\OperatorTok{[}\NormalTok{n}\OperatorTok{]} \OperatorTok{\%}\NormalTok{ MOD }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ ifrac}\OperatorTok{[}\NormalTok{m }\OperatorTok{{-}}\NormalTok{ n}\OperatorTok{]} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;} 
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ C}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ m}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ n}\OperatorTok{)\{}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{MOD }\OperatorTok{==} \DecValTok{2}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{((}\NormalTok{n }\OperatorTok{\&}\NormalTok{ m}\OperatorTok{)} \OperatorTok{==}\NormalTok{ n}\OperatorTok{);}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{m }\OperatorTok{\textless{}}\NormalTok{ n}\OperatorTok{)}  \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{n }\OperatorTok{==} \DecValTok{0}\OperatorTok{)} \ControlFlowTok{return} \DecValTok{1}\OperatorTok{;}
      \ControlFlowTok{return}\NormalTok{ C}\OperatorTok{(}\NormalTok{m }\OperatorTok{/}\NormalTok{ MOD}\OperatorTok{,}\NormalTok{ n }\OperatorTok{/}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ \_C\_}\OperatorTok{(}\NormalTok{m }\OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{,}\NormalTok{ n }\OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsection{Êâ©Â±ï Lucas ÂÆöÁêÜ}\label{ux6269ux5c55-lucas-ux5b9aux7406}
  
  Ëß£ÂÜ≥Ê®°Êï∞‰∏∫ÂèØËÉΩ‰∏ç‰∏∫Ë¥®Êï∞Ôºå‰∏îÊØè‰∏™Ë¥®Êï∞ÂπÇËæÉÂ∞èÁöÑÁªÑÂêàÊï∞ÂèñÊ®°ÈóÆÈ¢ò„ÄÇ
  Êâ©Â±ïÂç¢Âç°ÊñØÂÆöÁêÜÂíåÂç¢Âç°ÊñØÂÆöÁêÜÊ≤°ÊúâÂÖ≥Á≥ª Âπ∂Ê≤°ÊúâÁî®Âà∞ \texttt{Luacs} ÁöÑÂü∫Êú¨ÊÄùÊÉ≥
  (eq.\textasciitilde{}@eq:Lucas) ÔºåÊâ©Â±ï \texttt{Lucas} ÂÆöÁêÜ
  Êú¨Ë¥®‰∏äÊòØËß£ÂÜ≥‰∫ÜÈò∂‰πòÈÄÜÂÖÉ‰∏çÂ≠òÂú®ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂΩ¢Â¶Ç
  
  \[
  \frac{*}{n!}\mod P
  \] \{\#eq:exl\}
  
  ÂºèÂ≠êÁöÑÊ±ÇÂÄº„ÄÇ ËÄÉËôëÁªÑÂêàÊï∞ÈÄöÈ°πÂÖ¨ÂºèÔºö
  
  \[
  \dbinom{n}{m} = \frac{n!}{m! (n-m)!}
  \] \{\#eq:exC\}
  
  ÈôêÂà∂Êàë‰ª¨‰∏çËÉΩÁõ¥Êé•Ê±Ç (eq.\textasciitilde{}@eq:exC)
  ÁöÑÂéüÂõ†‚Äî‚ÄîÊ®°Êï∞‰∏ç‰∏∫Ë¥®Êï∞ÔºåÊó†Ê≥ï‰øùËØÅÈÄÜÂÖÉÂ≠òÂú®„ÄÇËÄÉËôëÂ¶ÇÊûúËÆ©ÂàÜÊØçÂíåÊ®°Êï∞‰∫íË¥®Â∞±ÂèØ‰ª•Ê±ÇÂá∫Ëøô‰∏™ÂºèÂ≠êÁöÑÂÄº‰∫Ü„ÄÇ
  
  È¶ñÂÖàÂèØ‰ª•ÂØπÊ®°Êï∞ \(p\) ËøõË°åË¥®Âõ†Êï∞ÂàÜËß£ÔºåÂàÜËß£ÊàêÂΩ¢Â¶Ç
  \(p = \prod_{i\ge 0}\limits{P_i^{e_i}}\) ÔºåÂÖàÂàÜÂà´Ê±ÇÊ®°Êï∞‰∏∫ \(P_i^{e_i}\)
  ÂºèÂ≠êÁöÑÂÄºÔºåÁÑ∂Âêé \texttt{CRT} ÂêàÂπ∂Á≠îÊ°à„ÄÇ
  
  ËÄÉËôëÂ¶Ç‰ΩïÊ±ÇÂá∫Ê®°Êï∞‰∏∫ \(P_i^{e_i}\) ÁöÑÂÄº„ÄÇ ËÆæÂáΩÊï∞ \(g_p(n)\) ‰∏∫ \(n!\)
  ‰∏≠Ë¥®Âõ†Â≠ê \(p\) ÁöÑÂπÇÊ¨°„ÄÇ ËÆæ \(a = g_p(n), b=g_p(m), c=g_p(n-m)\) ÊòìÁü•Ôºö
  
  \[
  (eq.~@eq:exC) \equiv \frac{\frac{n!}{p^{a}}}{\frac{m!}{p^{b}} \frac{(n-m)!}{p^{c}}}\ p^{a-b-c}\  (mod \ P_i^{e_i})
  \] \{\#eq:exLucas\}
  
  ËÆæ \(k=P_i^{e_i}\) ÔºåÂ¶ÇÊûúÊâÄÊ±Ç‰∏∫ \(\frac{n!}{p_i^{a}}\) ÂØπ‰∫é \(n!\)
  ÁöÑÊØè‰∏ÄÈ°π
  (\(1\times 2\times 3\times 4\times 5\times \dots \times n\))ÔºåÂÖ∂ÊØè‰∏ÄÈ°πÂú®Ê®°
  \(k\) ÊÑè‰πâ‰∏ãÁöÑÂèñÂÄº‰∏ÄÂÆöÊòØÊØè \(k\) ‰∏™‰∏ÄÊ¨°Âæ™ÁéØÁöÑ„ÄÇ
  
  ÂêåÊó∂ÊØè‰∏Ä‰∏™ \(P_i\) ÁöÑÂÄçÊï∞ÈÉΩÂèØ‰ª•ÊèêÂá∫‰∏Ä‰∏™Âõ†Â≠ê \(P_i\)
  ‰πüÂèØ‰ª•ËΩªÊùæÁü•ÈÅìÔºåËøô‰∏™ÊèêÂá∫Êù•ÁöÑÂõ†Â≠êÊúâ \(\lfloor\frac{n}{P_i}\rfloor\) ‰∏™Ôºå
  Âç≥ \(P^{\lfloor\frac{n}{P_i}\rfloor}\) Ëøô‰∏™ÂºèÂ≠ê‰∏çËÆ°ÂÖ•Á≠îÊ°à„ÄÇ
  
  Ëøô‰∫õÂÄçÊï∞ÊèêÂá∫‰∏Ä‰∏™ \(P_i\)
  ÁöÑÂõ†Â≠ê‰πãÂêé‰∏ÄÂÆö‰ºöÂΩ¢ÊàêÂè¶‰∏Ä‰∏™Èò∂‰πòÁöÑÂΩ¢ÂºèÔºåËøôÊòØ‰∏Ä‰∏™Â≠êÈóÆÈ¢òÔºåÂèØ‰ª•ÈÄíÂΩíËÆ°ÁÆó„ÄÇÂâ©‰∏ãÁöÑÊï∞Â≠óÂèØ‰ª•Êö¥ÂäõËÆ°ÁÆó‰∏Ä‰∏™Âë®ÊúüÔºåÁÑ∂ÂêéÊ†πÊçÆÂë®ÊúüÁöÑÂá∫Áé∞Ê¨°Êï∞ÔºåÁõ¥Êé•ËÆ°ÁÆóÂºèÂ≠êÁöÑÂÄº„ÄÇ
  ËøôÊ†∑Â∞±ÂèØ‰ª•ÁÆóÂá∫ \(n!\) ÂéªÊéâÊâÄÊúâË¥®Âõ†Â≠ê \(P_i\) Âú®Ê®° \(P_i^{e_i}\)
  ÊÑè‰πâ‰∏ãÁöÑÂÄº‰∫Ü„ÄÇ ‰øùËØÅ‰∫ÜËøô‰∏™ÂÄºÂíå \(P_i\) ‰∫íË¥®ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•Ê±ÇÈÄÜÂÖÉ‰∫Ü„ÄÇ Ê†πÊçÆ
  (eq.\textasciitilde{}@eq:exLucas) ËÆ°ÁÆóÂç≥ÂèØ„ÄÇ
  
  ÂÖ≥‰∫éÂáΩÊï∞ \(g_p(n)\) ÁöÑËÆ°ÁÆóÔºö
  
  \[
  g_p(n) = \prod_{i\ge 1}\limits{\lfloor\frac{n}{p^i}\rfloor}= \frac{n - f_p(n)}{p - 1}
  \]
  
  ÂÖ∂‰∏≠ \(f_p(n)\) ‰∏∫Êï∞Â≠ó \(n\) Âú® \(p\) ËøõÂà∂‰∏ãÁöÑÊï∞‰ΩçÂíå„ÄÇ
  
  Ê≥®ÊÑèÈÄÜÂÖÉ‰∏çÊòØË¥®Êï∞ÔºåÂà´\st{ÂÇª‰∏çÊãâÂá†ÁöÑ}ÂÜ≤‰∏Ä‰∏™Ë¥πÈ©¨Â∞èÂÆöÁêÜ„ÄÇ
  
  Â§çÊùÇÂ∫¶ÊòØ
  \(\mathcal{O}\left(\sum_{i\ge 0}\limits{(\log P + P_i^{e_i})\log n}\right)\)
  Â§ßÊ¶ÇÂ∞±ÊòØ
  \(\mathcal{O}\left(\sum_{i \ge 0}\limits{P_i^{e_i}\log n}\right)\) Âêß„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ f}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ n}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ p}\OperatorTok{)\{}
      \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{n}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ ans }\OperatorTok{+=}\NormalTok{ n }\OperatorTok{\%}\NormalTok{ p}\OperatorTok{;}\NormalTok{ n }\OperatorTok{/=}\NormalTok{ p}\OperatorTok{;} \OperatorTok{\}}
      \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ g}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ n}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ P}\OperatorTok{)\{} \ControlFlowTok{return} \OperatorTok{(}\NormalTok{n }\OperatorTok{{-}}\NormalTok{ f}\OperatorTok{(}\NormalTok{n}\OperatorTok{,}\NormalTok{ P}\OperatorTok{))} \OperatorTok{/} \OperatorTok{(}\NormalTok{P }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{);} \OperatorTok{\}}
  
  \DataTypeTok{int}\NormalTok{ pow}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ a}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ b}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ P}\OperatorTok{)\{} \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} \ControlFlowTok{while}\OperatorTok{(}\NormalTok{b}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{b }\OperatorTok{\&} \DecValTok{1}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ ans }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ a }\OperatorTok{\%}\NormalTok{ P}\OperatorTok{;}\NormalTok{ a }\OperatorTok{=}\NormalTok{ a }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ a }\OperatorTok{\%}\NormalTok{ P}\OperatorTok{;}\NormalTok{ b }\OperatorTok{\textgreater{}\textgreater{}=} \DecValTok{1}\OperatorTok{;} \OperatorTok{\}} \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;} \OperatorTok{\}}
  \CommentTok{//int inv(int x, int MOD) \{ return pow(x, MOD {-} 2, MOD); \} // deleted: Fermat\textquotesingle{}s Little Theorem is NOT correct when MOD is not a prime number.}
  \DataTypeTok{int}\NormalTok{ exgcd}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ a}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ b}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\&}\NormalTok{x}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\&}\NormalTok{y}\OperatorTok{)\{}
      \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{b}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ x }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ y }\OperatorTok{=} \DecValTok{0}\OperatorTok{;} \ControlFlowTok{return}\NormalTok{ a}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ g }\OperatorTok{=}\NormalTok{ exgcd}\OperatorTok{(}\NormalTok{b}\OperatorTok{,}\NormalTok{ a }\OperatorTok{\%}\NormalTok{ b}\OperatorTok{,}\NormalTok{ y}\OperatorTok{,}\NormalTok{ x}\OperatorTok{);}
  \NormalTok{    y }\OperatorTok{{-}=} \OperatorTok{(}\NormalTok{a }\OperatorTok{/}\NormalTok{ b}\OperatorTok{)} \OperatorTok{*}\NormalTok{ x}\OperatorTok{;}
      \ControlFlowTok{return}\NormalTok{ g}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ inv}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ a}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ P}\OperatorTok{)\{} \CommentTok{// add: Exgcd}
      \DataTypeTok{int}\NormalTok{ x}\OperatorTok{,}\NormalTok{ y}\OperatorTok{;}\NormalTok{ exgcd}\OperatorTok{(}\NormalTok{a}\OperatorTok{,}\NormalTok{ P}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ y}\OperatorTok{);}
      \ControlFlowTok{return} \OperatorTok{(}\NormalTok{x }\OperatorTok{\%}\NormalTok{ P }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ P }\OperatorTok{)} \OperatorTok{\%}\NormalTok{ P}\OperatorTok{;}
  \OperatorTok{\}}
  
  \DataTypeTok{int}\NormalTok{ calc}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ n}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ p}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ k}\OperatorTok{)\{} \CommentTok{// calc n!(without p) mod p\^{}k}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{n }\OperatorTok{==} \DecValTok{0}\OperatorTok{)} \ControlFlowTok{return} \DecValTok{1}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ P }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ k}\OperatorTok{)}\NormalTok{ P }\OperatorTok{*=}\NormalTok{ p}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ res }\OperatorTok{=}\NormalTok{ n }\OperatorTok{\%}\NormalTok{ P}\OperatorTok{,}\NormalTok{ prd0 }\OperatorTok{=} \DecValTok{1}\OperatorTok{,}\NormalTok{ prd1 }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} 
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ P}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{i }\OperatorTok{\%}\NormalTok{ p }\OperatorTok{==} \DecValTok{0}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{i }\OperatorTok{\textless{}=}\NormalTok{ res}\OperatorTok{)}\NormalTok{ prd0 }\OperatorTok{=}\NormalTok{ prd0 }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ i }\OperatorTok{\%}\NormalTok{ P}\OperatorTok{;}
  \NormalTok{        prd1 }\OperatorTok{=}\NormalTok{ prd1 }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ i }\OperatorTok{\%}\NormalTok{ P}\OperatorTok{;}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ calc}\OperatorTok{(}\NormalTok{n }\OperatorTok{/}\NormalTok{ p}\OperatorTok{,}\NormalTok{ p}\OperatorTok{,}\NormalTok{ k}\OperatorTok{);}
  \NormalTok{    ans }\OperatorTok{=}\NormalTok{ ans }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ prd0 }\OperatorTok{\%}\NormalTok{ P}\OperatorTok{;}
  \NormalTok{    ans }\OperatorTok{=}\NormalTok{ ans }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ pow}\OperatorTok{(}\NormalTok{prd1}\OperatorTok{,}\NormalTok{ n }\OperatorTok{/}\NormalTok{ P}\OperatorTok{,}\NormalTok{ P}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ P}\OperatorTok{;} \CommentTok{// changed \textasciigrave{}pow(prd1, n / p, P)\textasciigrave{} to \textasciigrave{}pow(prd1, n / P, P) \% P\textasciigrave{}.}
      \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;}
  \OperatorTok{\}}
  \NormalTok{LL n}\OperatorTok{,}\NormalTok{ m}\OperatorTok{;} \DataTypeTok{int}\NormalTok{ MOD}\OperatorTok{;}
  \NormalTok{vector}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}}\NormalTok{ d}\OperatorTok{;}
  \KeywordTok{namespace}\NormalTok{ Divide}\OperatorTok{\{}
      \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{1e6} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ np}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ prime}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ Mid}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
      \DataTypeTok{void}\NormalTok{ init}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ n}\OperatorTok{)\{}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{2}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{np}\OperatorTok{[}\NormalTok{i}\OperatorTok{])}\NormalTok{ prime}\OperatorTok{[++}\NormalTok{tot}\OperatorTok{]} \OperatorTok{=}\NormalTok{ i}\OperatorTok{,}\NormalTok{ Mid}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ i}\OperatorTok{;}
              \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ j }\OperatorTok{\textless{}=}\NormalTok{ tot }\OperatorTok{\&\&}\NormalTok{ prime}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{*}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ j}\OperatorTok{++)\{}
                  \DataTypeTok{int}\NormalTok{ x }\OperatorTok{=}\NormalTok{ prime}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{*}\NormalTok{ i}\OperatorTok{;}\NormalTok{ Mid}\OperatorTok{[}\NormalTok{x}\OperatorTok{]} \OperatorTok{=}\NormalTok{ prime}\OperatorTok{[}\NormalTok{j}\OperatorTok{];}
  \NormalTok{                np}\OperatorTok{[}\NormalTok{x}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
                  \ControlFlowTok{if}\OperatorTok{(}\NormalTok{i }\OperatorTok{\%}\NormalTok{ prime}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{==} \DecValTok{0}\OperatorTok{)} \ControlFlowTok{break}\OperatorTok{;}
              \OperatorTok{\}}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ divide}\OperatorTok{(}\NormalTok{vector}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}} \OperatorTok{\&}\NormalTok{ res}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ MOD}\OperatorTok{)\{}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ tot}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{MOD }\OperatorTok{\%}\NormalTok{ prime}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{!=} \DecValTok{0}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{            pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}}\NormalTok{ ans}\OperatorTok{;}\NormalTok{ ans}\OperatorTok{.}\NormalTok{fi }\OperatorTok{=}\NormalTok{ prime}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
  \NormalTok{            ans}\OperatorTok{.}\NormalTok{se }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
              \ControlFlowTok{while}\OperatorTok{(}\NormalTok{MOD }\OperatorTok{\%}\NormalTok{ prime}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{==} \DecValTok{0}\OperatorTok{)}\NormalTok{ MOD }\OperatorTok{/=}\NormalTok{ prime}\OperatorTok{[}\NormalTok{i}\OperatorTok{],}\NormalTok{ ans}\OperatorTok{.}\NormalTok{se}\OperatorTok{++;}
  \NormalTok{            res}\OperatorTok{.}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{ans}\OperatorTok{);}
          \OperatorTok{\}}
      \OperatorTok{\}}\CommentTok{// ËøôÈáåÂèØ‰ª•Áõ¥Êé• $\textbackslash{}mathcal\{O\}(\textbackslash{}sqrt\{n\})$ ËØïÈô§Âç≥ÂèØÔºåÊ≤°ÂøÖË¶ÅÂàÜËß£Ë¥®Âõ†Êï∞„ÄÇÂÜôÁöÑÊó∂ÂÄôÂ§™Âπ¥ËΩª‰∫Ü„ÄÇ}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ CRT}\OperatorTok{(}\NormalTok{vector}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}} \OperatorTok{\&}\NormalTok{ A}\OperatorTok{)\{}
      \DataTypeTok{int}\NormalTok{ W }\OperatorTok{=}\NormalTok{ MOD}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ A}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{)\{}
  \NormalTok{        pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}}\NormalTok{ now }\OperatorTok{=}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
  \NormalTok{        ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+} \OperatorTok{(}\NormalTok{ now}\OperatorTok{.}\NormalTok{fi }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*} \OperatorTok{(}\NormalTok{W }\OperatorTok{/}\NormalTok{ now}\OperatorTok{.}\NormalTok{se}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ inv}\OperatorTok{(}\NormalTok{W }\OperatorTok{/}\NormalTok{ now}\OperatorTok{.}\NormalTok{se}\OperatorTok{,}\NormalTok{ now}\OperatorTok{.}\NormalTok{se}\OperatorTok{)} \OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
      \OperatorTok{\}}
      \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;}
  \OperatorTok{\}}
  
  \NormalTok{vector}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}}\NormalTok{ Ans}\OperatorTok{;}
  \DataTypeTok{signed}\NormalTok{ main}\OperatorTok{()\{} \CommentTok{//freopen(".in", "r", stdin);}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{m}\OperatorTok{)(}\NormalTok{MOD}\OperatorTok{);}\NormalTok{ Divide}\OperatorTok{::}\NormalTok{init}\OperatorTok{(}\NormalTok{MOD }\OperatorTok{+} \DecValTok{2}\OperatorTok{);}
  \NormalTok{    Divide}\OperatorTok{::}\NormalTok{divide}\OperatorTok{(}\NormalTok{d}\OperatorTok{,}\NormalTok{ MOD}\OperatorTok{);}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ d}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{)\{}
  \NormalTok{        pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ NowMod }\OperatorTok{=}\NormalTok{ d}\OperatorTok{[}\NormalTok{i}\OperatorTok{];} \DataTypeTok{int}\NormalTok{ P }\OperatorTok{=}\NormalTok{ pow}\OperatorTok{(}\NormalTok{NowMod}\OperatorTok{.}\NormalTok{fi}\OperatorTok{,}\NormalTok{ NowMod}\OperatorTok{.}\NormalTok{se}\OperatorTok{);}
          \DataTypeTok{int}\NormalTok{ rA }\OperatorTok{=}\NormalTok{ calc}\OperatorTok{(}\NormalTok{n}\OperatorTok{,}\NormalTok{ NowMod}\OperatorTok{.}\NormalTok{fi}\OperatorTok{,}\NormalTok{ NowMod}\OperatorTok{.}\NormalTok{se}\OperatorTok{);}
          \DataTypeTok{int}\NormalTok{ rB }\OperatorTok{=}\NormalTok{ calc}\OperatorTok{(}\NormalTok{n }\OperatorTok{{-}}\NormalTok{ m}\OperatorTok{,}\NormalTok{ NowMod}\OperatorTok{.}\NormalTok{fi}\OperatorTok{,}\NormalTok{ NowMod}\OperatorTok{.}\NormalTok{se}\OperatorTok{);}
          \DataTypeTok{int}\NormalTok{ rC }\OperatorTok{=}\NormalTok{ calc}\OperatorTok{(}\NormalTok{m}\OperatorTok{,}\NormalTok{ NowMod}\OperatorTok{.}\NormalTok{fi}\OperatorTok{,}\NormalTok{ NowMod}\OperatorTok{.}\NormalTok{se}\OperatorTok{);}
          \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{        ans }\OperatorTok{=}\NormalTok{ rA }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ inv}\OperatorTok{(}\NormalTok{rB}\OperatorTok{,}\NormalTok{ P}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ P }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ inv}\OperatorTok{(}\NormalTok{rC}\OperatorTok{,}\NormalTok{ P}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ P}\OperatorTok{;}
  \NormalTok{        ans }\OperatorTok{=}\NormalTok{ ans }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ pow}\OperatorTok{(}\NormalTok{NowMod}\OperatorTok{.}\NormalTok{fi}\OperatorTok{,}\NormalTok{ g}\OperatorTok{(}\NormalTok{n}\OperatorTok{,}\NormalTok{ NowMod}\OperatorTok{.}\NormalTok{fi}\OperatorTok{)} \OperatorTok{{-}}\NormalTok{ g}\OperatorTok{(}\NormalTok{n }\OperatorTok{{-}}\NormalTok{ m}\OperatorTok{,}\NormalTok{ NowMod}\OperatorTok{.}\NormalTok{fi}\OperatorTok{)} \OperatorTok{{-}}\NormalTok{ g}\OperatorTok{(}\NormalTok{m}\OperatorTok{,}\NormalTok{ NowMod}\OperatorTok{.}\NormalTok{fi}\OperatorTok{),}\NormalTok{ P}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ P}\OperatorTok{;}
  \NormalTok{        Ans}\OperatorTok{.}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{mp}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ P}\OperatorTok{));}
      \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ CRT}\OperatorTok{(}\NormalTok{Ans}\OperatorTok{));}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsection{BSGS}\label{bsgs}
  
  Ê±ÇËß£Ê®°Êï∞‰∏∫Ë¥®Êï∞ÁöÑÊåáÊï∞ÊñπÁ®ã„ÄÇ\(a^x \equiv b\ (mod\ p) \ p \in P\)„ÄÇ
  Áî±Ê¨ßÊãâÂÆöÁêÜÂèØÁü•ÔºåÊú¨Ë¥®‰∏çÂêåÁöÑËß£ ËåÉÂõ¥‰∏∫ \([0, p-1]\) „ÄÇ Êú¥Á¥†ÂÅöÊ≥ïÂ∞±ÊòØÊûö‰∏æ‰∏Ä‰∏ã
  \([0, p-1]\) Âà§Êñ≠ÊòØ‰∏çÊòØËß£Ôºå‰ΩÜÊòØËøôÊ†∑ÊòæÁÑ∂Â§™ÊÖ¢‰∫Ü„ÄÇ ËÄÉËôëÈÄâ‰∏Ä‰∏™ÂèÇÊï∞ \(T\)ÔºåÂàô
  \(\forall x \in [0, p-1]\) ÈÉΩÂèØ‰ª•Ë°®Á§∫Êàê \(r \times T + c\ \ (b < T)\)
  ÁöÑÂΩ¢ÂºèÔºåÊòìÁü•Ôºå\(r = \lfloor\frac{x}{T} \rfloor, c=x\ mod \ T\)
  
  Â∏¶ÂÖ•ÂéüÂºèÔºö
  
  \[
  a^{rT + c} \equiv b\ (mod\ p)
  \]
  
  \[
  a^{c} \equiv b\times a^{-rT}\ (mod\ p)
  \] \{\#eq:BSGS0\}
  
  ÂèØ‰ª•ËÄÉËôëÊûö‰∏æ \(c\) ÁÆóÂá∫ÊØè‰∏Ä‰∏™ \(a^{c}\) ÂéãÂÖ• \texttt{set} Êàñ
  \texttt{hash} Ë°®ÔºåÁÑ∂ÂêéÊûö‰∏æÊØè‰∏Ä‰∏™ \(r\) ÁÆóÂá∫ÊØè‰∏Ä‰∏™ \(a^{-rT} \times b\)
  Âú®‰πãÂâçÁÆóÂá∫ÁöÑÁ≠îÊ°à‰∏≠Êü•ÊâæÔºåÂ¶ÇÊûúËÉΩÊâæÂà∞Áõ∏ÂêåÁöÑÂèñÂÄºÔºàÂç≥ÔºöÊª°Ë∂≥(eq.\textasciitilde{}@eq:BSGS0)ÔºâÔºåÂ∞±ËØ¥ÊòéÂΩìÂâçËøô‰∏™
  \(r\) Â∞±ÊòØ‰∏Ä‰∏™Á≠îÊ°à„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ inv}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ a}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ P}\OperatorTok{)\{}
      \DataTypeTok{int}\NormalTok{ x}\OperatorTok{,}\NormalTok{ y}\OperatorTok{;}\NormalTok{ exgcd}\OperatorTok{(}\NormalTok{a}\OperatorTok{,}\NormalTok{ P}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ y}\OperatorTok{);}
      \ControlFlowTok{return} \OperatorTok{(}\NormalTok{x }\OperatorTok{\%}\NormalTok{ P }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ P}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ P}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ BSGS}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ a}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ b}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ P}\OperatorTok{)} \OperatorTok{\{} \CommentTok{// a\^{}x = b (mod P) (a, p) = 1;}
      \AttributeTok{static}\NormalTok{ set}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ S}\OperatorTok{;}\NormalTok{ S}\OperatorTok{.}\NormalTok{clear}\OperatorTok{();}
      \DataTypeTok{int}\NormalTok{ T }\OperatorTok{=}\NormalTok{ sqrt}\OperatorTok{(}\NormalTok{P}\OperatorTok{);}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ x }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}}\NormalTok{ T}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++,}\NormalTok{ x }\OperatorTok{=}\NormalTok{ x }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ a }\OperatorTok{\%}\NormalTok{ P}\OperatorTok{)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{x }\OperatorTok{!=}\NormalTok{ b}\OperatorTok{)}\NormalTok{ S}\OperatorTok{.}\NormalTok{insert}\OperatorTok{(}\NormalTok{x}\OperatorTok{);} \ControlFlowTok{else} \ControlFlowTok{return}\NormalTok{ i}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ T}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
          \DataTypeTok{int}\NormalTok{ now }\OperatorTok{=}\NormalTok{ b }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ inv}\OperatorTok{(}\NormalTok{pow}\OperatorTok{(}\NormalTok{a}\OperatorTok{,}\NormalTok{ T }\OperatorTok{*}\NormalTok{ i}\OperatorTok{,}\NormalTok{ P}\OperatorTok{),}\NormalTok{ P}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ P}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{S}\OperatorTok{.}\NormalTok{count}\OperatorTok{(}\NormalTok{now}\OperatorTok{))} \ControlFlowTok{continue}\OperatorTok{;}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=}\NormalTok{ i }\OperatorTok{*}\NormalTok{ T}\OperatorTok{,}\NormalTok{ V }\OperatorTok{=}\NormalTok{ pow}\OperatorTok{(}\NormalTok{a}\OperatorTok{,}\NormalTok{ j}\OperatorTok{,}\NormalTok{ P}\OperatorTok{);} \OperatorTok{;}\NormalTok{ j}\OperatorTok{++,}\NormalTok{ V }\OperatorTok{=}\NormalTok{ V }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ a }\OperatorTok{\%}\NormalTok{ P}\OperatorTok{)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{V }\OperatorTok{==}\NormalTok{ b}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ j}\OperatorTok{;}
      \OperatorTok{\}}
      \ControlFlowTok{return} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsection{Êâ©Â±ï BSGS}\label{ux6269ux5c55-bsgs}
  
  Áî®‰∫éÊ±ÇËß£Ê®°Êï∞‰∏ç‰∏ÄÂÆö‰∏∫Ë¥®Êï∞ÁöÑÊåáÊï∞ÊñπÁ®ã„ÄÇ\(a^x \equiv b\ (mod\ p) \ p \in P\)„ÄÇ
  ÈôêÂà∂‰∏çËÉΩÁõ¥Êé• \(BSGS\) ÁöÑÂõ†Á¥†Â∞±ÊòØ‰∏çËÉΩ‰øùËØÅÈÄÜÂÖÉÂ≠òÂú®ÔºåÈÇ£Â∞±ËÄÉËôëÂ¶Ç‰ΩïËÆ©
  \((a, p) = 1\) „ÄÇ
  
  ÂÖ∑‰ΩìÂú∞ÔºåËÆæ \(d_1=\gcd(a,p)\) „ÄÇÂ¶ÇÊûú \(d_1\nmid b\)
  ÔºåÂàôÂéüÊñπÁ®ãÊó†Ëß£„ÄÇÂê¶ÂàôÊàë‰ª¨ÊääÊñπÁ®ãÂêåÊó∂Èô§‰ª• \(d_1\) ÔºåÂæóÂà∞\\
  \[
  \frac{a}{d_1}\cdot a^{x-1}\equiv \frac{b}{d_1}\pmod{\frac{p}{d_1}}  
  \]
  
  Â¶ÇÊûú \(a\) Âíå \(\frac{p}{d_1}\) ‰ªç‰∏ç‰∫íË¥®Â∞±ÂÜçÈô§ÔºåËÆæ
  \(d_2=\gcd\left(a,\frac{p}{d_1}\right)\) „ÄÇÂ¶ÇÊûú
  \(d_2\nmid \frac{b}{d_1}\) ÔºåÂàôÊñπÁ®ãÊó†Ëß£ÔºõÂê¶ÂàôÂêåÊó∂Èô§‰ª• \(d_2\) ÂæóÂà∞. \[
  \frac{a^2}{d_1d_2}\cdot a^{x-2}‚â°\frac{b}{d_1d_2} \pmod{\frac{p}{d_1d_2}}
  \] Áõ¥Âà∞Ê®°Êï∞Âíå \(a\) ‰∫íË¥®„ÄÇ ËÆ∞ \(D = \prod\limits{d_i}\)ÔºåÂàô
  
  \[
  \frac{a^k}{D}\cdot a^{x-k}\equiv\frac{b}{D} \pmod{\frac{p}{D}}
  \] Â∞±ÂèØ‰ª•‰ΩøÁî® \texttt{BSGS} Ê±ÇËß£‰∫Ü„ÄÇ
  
  ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºö
  
  \begin{itemize}
  \tightlist
  \item
    Ëß£ÂèØËÉΩÂ∞è‰∫é \(k\) ÔºåÂèØ‰ª•Êö¥ÂäõÊûö‰∏æ‰∏Ä‰∏ãÂ∞è‰∫é \(k\) ÁöÑÂπÇÊ¨°ÔºåÂà§Êñ≠‰∏Ä‰∏ã
  \item
    Â¶ÇÊûúÊúâ \(d_i\) ‰∏çÊòØ \(b\) ÁöÑÁ∫¶Êï∞ÔºåÁõ¥Êé•Âà§Êñ≠Êó†Ëß£Âç≥ÂèØ„ÄÇ
  \end{itemize}
  
  \begin{verbatim}
  int exBSGS(int a, int b, int P){ 
      int D = 1, k = 0, tp = P;
      while(true) { int g = gcd(a, tp); if(g == 1) break; tp /= g; D *= g; k++;  }
      for(int i = 0, V = 1; i <= k; i++, V = V *1ll* a % P) if(V == b) return i; // changed: It must be executed before `if(b % D != 0) return -1`).
      int S = pow(a, k, tp);
      if(b % D != 0) return -1; // added: It is necessary!
      int B = b *1ll* inv(S, tp) % tp;
      int r = BSGS(a, B, tp);
      return r == -1 ? -1 : r + k;
  }
  \end{verbatim}
  
  Â∑≤ÈÄöËøá luogu Âíå SPOJ ÁöÑÊµãËØïÊï∞ÊçÆÔºå‰ΩÜÊòØ zhx (Orz) ÁöÑÊï∞ÊçÆÂè™Êúâ \(50pts\)
  ÂæÖÂ°´„ÄÇ
  
  \subsection{Miller\_Rabin}\label{miller_rabin}
  
  Âø´ÈÄüÂà§Êñ≠Â§ßÊï∞Á¥†ÊÄß„ÄÇ
  
  ‰∏Ä‰∏™ÁªìËÆ∫Ôºö Â¶ÇÊûú \(n\) ‰∏∫Ë¥®Êï∞ \(\forall a < n\) ËÆæ
  \(n - 1 = d \times 2^r, (d, 2) = 1\)ÔºåÂàô \[
  a^d \equiv 1 \pmod n 
  \] \{\#eq:MR0\}
  
  \[
  \exists\ 0 \le i < r, s.t. a^{d\times i^i} \equiv -1 \pmod n 
  \] \{\#eq:MR1\}
  
  (eq.\textasciitilde{}@eq:MR0) Âíå (eq.\textasciitilde{}@eq:MR1)
  Ëá≥Â∞ë‰∏Ä‰∏™Êª°Ë∂≥„ÄÇ ÊòØÂê¶‰∏∫ÂÖÖË¶ÅÊù°‰ª∂Â∏¶Êü•„ÄÇ
  
  Êàë‰ª¨ÈúÄË¶ÅÂà§Êñ≠‰∏Ä‰∏™Êï∞ÊòØÂê¶‰∏∫Ë¥®Êï∞ÔºåÂè™ÈúÄË¶ÅÂà§Êñ≠ÊòØÂê¶Á¨¶Âêà‰∏äÈù¢ÁöÑÂÆöÁêÜÂç≥ÂèØÔºå‰ΩÜÊòØ
  \(\forall a < n\) ÂØπÂ§çÊùÇÂ∫¶‰∏çÂèãÂ•Ω„ÄÇ
  
  ÈÄöÂ∏∏ÁöÑÂÅöÊ≥ïÊòØÈÄâÊã©Ëã•Âπ≤Ë¥®Êï∞ÂΩì‰ΩúÂ∫ïÊï∞ \(a\)ÔºåËøõË°åÂà§Êñ≠„ÄÇ
  
  ÂÖ≥‰∫éÂ∫ïÊï∞ÁöÑÈÄâÊã©Ôºö \textgreater Â¶ÇÊûúÈÄâÁî®2, 3, 7,
  61Âíå24251‰Ωú‰∏∫Â∫ïÊï∞ÔºåÈÇ£‰πà10\^{}16ÂÜÖÂîØ‰∏ÄÁöÑÂº∫‰º™Á¥†Êï∞‰∏∫46 856 248 255 981
  ‚Äî‚Äîmatrix67ÂçöÂÆ¢ (Orz)
  
  ÈÄâÊã©
  \texttt{int\ PrimeList{[}10{]}\ =\ \{2,\ 3,\ 7,\ 61,\ 24251,\ 11,\ 29\};}
  Âç≥ÂèØÔºåÊàñËÄÖÂÜçÈöèÊÑèÂä†Âá†‰∏™Â∞èË¥®Êï∞„ÄÇ
  
  ÈúÄË¶ÅÊ≥®ÊÑèÂø´ÈÄü‰πòÊ≥ïÁöÑÂÆûÁé∞„ÄÇ Â§çÊùÇÂ∫¶‰∏∫ \(\mathcal{O}(k \log x)\)
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \PreprocessorTok{\#define LL }\DataTypeTok{long}\PreprocessorTok{ }\DataTypeTok{long}\PreprocessorTok{ }
  \PreprocessorTok{\#define ULL }\DataTypeTok{unsigned}\PreprocessorTok{ }\DataTypeTok{long}\PreprocessorTok{ }\DataTypeTok{long}\PreprocessorTok{ }
  \KeywordTok{inline}\NormalTok{ ULL mul}\OperatorTok{(}\NormalTok{ULL a}\OperatorTok{,}\NormalTok{ ULL b}\OperatorTok{,}\NormalTok{ ULL MOD}\OperatorTok{)\{} \CommentTok{// unsigned long long  }
  \NormalTok{    LL R }\OperatorTok{=} \OperatorTok{(}\NormalTok{LL}\OperatorTok{)}\NormalTok{a}\OperatorTok{*}\NormalTok{b }\OperatorTok{{-}} \OperatorTok{(}\NormalTok{LL}\OperatorTok{)((}\NormalTok{ULL}\OperatorTok{)((}\DataTypeTok{long} \DataTypeTok{double}\OperatorTok{)}\NormalTok{a }\OperatorTok{*}\NormalTok{ b }\OperatorTok{/}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{*}\NormalTok{ MOD}\OperatorTok{);}
      \CommentTok{// Âè™ÂÖ≥ÂøÉ‰∏§‰∏™Á≠îÊ°àÁöÑÂ∑ÆÂÄºÔºåËøô‰∏™Â∑ÆÂÄº‰∏ÄÂÆöÂ∞è‰∫é unsigned long long ÁöÑÊúÄÂ§ßÂÄºÔºå}
      \CommentTok{// ÊâÄ‰ª•Âú®Âì™‰∏™Ââ©‰ΩôÁ≥ª‰∏ãÈÉΩ‰∏çÈáçË¶ÅÔºå‰∏çÁÆ°Â∑ÆÂÄºÊòØ‰ªÄ‰πàÈÉΩËÉΩËøòÂéüÂá∫ÂéüÂßãÊï∞ÂÄº„ÄÇ }
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R }\OperatorTok{\textless{}} \DecValTok{0}\OperatorTok{)}\NormalTok{ R }\OperatorTok{+=}\NormalTok{ MOD}\OperatorTok{;}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R }\OperatorTok{\textgreater{}}\NormalTok{ MOD}\OperatorTok{)}\NormalTok{ R }\OperatorTok{{-}=}\NormalTok{ MOD}\OperatorTok{;}
      \ControlFlowTok{return}\NormalTok{ R}\OperatorTok{;}
  \OperatorTok{\}}
  \KeywordTok{inline}\NormalTok{ LL pow}\OperatorTok{(}\NormalTok{LL a}\OperatorTok{,}\NormalTok{ LL b}\OperatorTok{,}\NormalTok{ LL P}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ LL ans }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} \ControlFlowTok{while}\OperatorTok{(}\NormalTok{b}\OperatorTok{)\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{b }\OperatorTok{\&} \DecValTok{1}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ mul}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ a}\OperatorTok{,}\NormalTok{ P}\OperatorTok{);}\NormalTok{ a }\OperatorTok{=}\NormalTok{ mul}\OperatorTok{(}\NormalTok{a}\OperatorTok{,}\NormalTok{ a}\OperatorTok{,}\NormalTok{ P}\OperatorTok{);}\NormalTok{ b }\OperatorTok{\textgreater{}\textgreater{}=} \DecValTok{1}\OperatorTok{;} \OperatorTok{\}} \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;} \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ PrimeList}\OperatorTok{[}\DecValTok{10}\OperatorTok{]} \OperatorTok{=} \OperatorTok{\{}\DecValTok{2}\OperatorTok{,} \DecValTok{3}\OperatorTok{,} \DecValTok{7}\OperatorTok{,} \DecValTok{61}\OperatorTok{,} \DecValTok{24251}\OperatorTok{,} \DecValTok{11}\OperatorTok{,} \DecValTok{17}\OperatorTok{,} \DecValTok{19}\OperatorTok{,} \DecValTok{29}\OperatorTok{,} \DecValTok{27}\OperatorTok{\};}
  \DataTypeTok{bool}\NormalTok{ Miller\_Rabin}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ a}\OperatorTok{,}\NormalTok{ LL n}\OperatorTok{)\{}
  \NormalTok{    LL d }\OperatorTok{=}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{,}\NormalTok{ r }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ x}\OperatorTok{;}
      \ControlFlowTok{while}\OperatorTok{(!(}\NormalTok{d }\OperatorTok{\&} \DecValTok{1}\OperatorTok{))}\NormalTok{ d }\OperatorTok{\textgreater{}\textgreater{}=} \DecValTok{1}\OperatorTok{,}\NormalTok{ r}\OperatorTok{++;}
      \ControlFlowTok{if}\OperatorTok{((}\NormalTok{x }\OperatorTok{=}\NormalTok{ pow}\OperatorTok{(}\NormalTok{a}\OperatorTok{,}\NormalTok{ d}\OperatorTok{,}\NormalTok{ n}\OperatorTok{))} \OperatorTok{==} \DecValTok{1}\OperatorTok{)} \ControlFlowTok{return} \KeywordTok{true}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ t }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ t }\OperatorTok{\textless{}=}\NormalTok{ r}\OperatorTok{;}\NormalTok{ t}\OperatorTok{++,}\NormalTok{ x }\OperatorTok{=}\NormalTok{ mul}\OperatorTok{(}\NormalTok{x}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ n}\OperatorTok{))} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{x }\OperatorTok{==}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)} \ControlFlowTok{return} \KeywordTok{true}\OperatorTok{;}
      \ControlFlowTok{return} \KeywordTok{false}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{bool}\NormalTok{ Prime}\OperatorTok{(}\NormalTok{LL x}\OperatorTok{)\{}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{x }\OperatorTok{\textless{}=} \DecValTok{2}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ x }\OperatorTok{==} \DecValTok{2}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}} \DecValTok{7}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{x }\OperatorTok{==}\NormalTok{ PrimeList}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \ControlFlowTok{return} \KeywordTok{true}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{Miller\_Rabin}\OperatorTok{(}\NormalTok{PrimeList}\OperatorTok{[}\NormalTok{i}\OperatorTok{],}\NormalTok{ x}\OperatorTok{))} \ControlFlowTok{return} \KeywordTok{false}\OperatorTok{;}
      \OperatorTok{\}}
      \ControlFlowTok{return} \KeywordTok{true}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsection{Pollard-Rho}\label{pollard-rho}
  
  Âø´ÈÄüÂàÜËß£Ë¥®Âõ†Êï∞ÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇ Â§çÊùÇÂ∫¶ \(\mathcal{O}(Accepted)\)„ÄÇÂ§ßÁ∫¶‰∏∫
  \(\mathcal{O}(n^{1/4})\) ÔºåÁÆóÊ≥ïÂØºËÆ∫ÁªôÂá∫ÁöÑÊòØ
  \(\mathcal{O}(\sqrt{n})\)Ôºå‰ΩÜÊòØÈöèÊú∫Êï∞ÊçÆ‰∏ãÔºå\(1s\) ÂàÜËß£ \(10000\) ‰∏™
  \(10^{18}\) ÈáèÁ∫ßÁöÑÊï∞Â≠óÈóÆÈ¢ò‰∏çÂ§ß‚Ä¶‚Ä¶
  
  \begin{quote}
  ‰ªª‰Ωï‰∏Ä‰∏™‰ºüÂ§ßÁöÑÁÆóÊ≥ïÈÉΩÊù•Ëá™‰∫é‰∏Ä‰∏™ÂæÆ‰∏çË∂≥ÈÅìÁöÑÁåúÊÉ≥„ÄÇ
  \end{quote}
  
  ËÄÉËôëÁªôÂá∫‰∏Ä‰∏™Êï∞Â≠ó \(n\) ÔºåÂ¶ÇÊûúÂèØ‰ª•Âø´ÈÄüÊâæÂÖ∂‰∏≠‰∏Ä‰∏™Âõ†Â≠ê \(g\)
  ÔºåÁÑ∂ÂêéÁªßÁª≠ÈÄíÂΩíÂàÜËß£ \(n / g\) Âíå \(g\) Âç≥ÂèØÂÆåÊàêË¥®Âõ†Êï∞ÂàÜËß£„ÄÇ
  
  ËÄÉËôëÂ¶Ç‰ΩïÂø´ÈÄüÂØªÊâæ‰∏Ä‰∏™Êï∞ \(n\) ÁöÑÂõ†Â≠ê \(g\)Ôºõ
  Ôºà‰ª•‰∏ãÂ§çÊùÇÂ∫¶ÂàÜÊûêÈÉΩÊòØÂü∫‰∫éÊúÄÂùèÊÉÖÂÜµÔºåÂç≥Á¥†Êï∞Âπ≥ÊñπÁöÑÂΩ¢ÂºèÔºâ
  
  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    Êûö‰∏æ \(n\) ÁöÑÂõ†Â≠ê \(g\) ËØïÈô§ÔºåÂ§çÊùÇÂ∫¶‰∏∫ \(\mathcal{O}(\sqrt{n})\)
  \item
    ËÄÉËôëÈöèÊú∫Êûö‰∏æ \(n\) ÁöÑÂõ†Â≠êÔºåËØïÈô§ÔºåÊúüÊúõÂ§çÊùÇÂ∫¶‰∏∫ \(\mathcal{O}(n)\)
  \item
    Ê≤°ÂøÖË¶ÅÈöèÊú∫Êûö‰∏æ \(n\) ÁöÑÂõ†Â≠êÔºåÂè™ÈúÄË¶ÅÈöèÊú∫‰∏Ä‰∏™Êï∞Â≠ó \(a\) ÈÇ£‰πà
    \(g = gcd(a, n)\) Â∞±ÊòØ \(n\)
    ÁöÑ‰∏Ä‰∏™Âõ†Â≠êÔºåÈúÄË¶ÅÊâæÂà∞‰∏Ä‰∏™‰∏çÂπ≥Âá°ÁöÑÂõ†Â≠êÊâçÂèØ‰ª•ÔºåËøôÊ†∑ \(a\)
    ÁöÑÂêàÊ≥ïÂèñÂÄºÂèòÊàê‰∫Ü \(n\) ÁöÑÂõ†Â≠êÊàñ \(n\) Âõ†Â≠êÁöÑÂÄçÊï∞ÔºåÂêàÊ≥ïÁöÑ \(a\)
    ÁöÑÂèñÂÄºÊúâ \(\mathcal{O}(\sqrt{n})\) ‰∏™„ÄÇ
  \end{enumerate}
  
  ÁùÄÈáçËÄÉËôë‰∏ã‰∏ÄÁßç‰ºòÂåñÔºö
  
  ËÄÉËôë‰∏ÄÊ¨°ÊÄßÈöèÊú∫Âá∫ \(k\) ‰∏™Êï∞Â≠ó ÂàÜÂà´ËÆ∞‰Ωú
  \(a_{1...k}\)ÔºåËÄÉËôëÂÖ∂‰∏≠‰∏§‰∏§ÁöÑÂ∑ÆÂÄºÔºåÂ∫îËØ•Êúâ \(k^2\) ÁßçÂ∑ÆÂÄº„ÄÇËØïÂõæËÆ©ÂÖ∂Â∑ÆÂÄº‰∏é
  \(n\) Ê±ÇÊúÄÂ§ßÂÖ¨Á∫¶Êï∞ \(c\)ÔºåËã• \(c\) ‰∏ç‰∏∫ \(1\) Âàô \(c\)
  Â∞±ÊòØ‰∏Ä‰∏™‰∏çÂπ≥Âá°Âõ†Â≠ê„ÄÇ Â∑ÆÂÄº‰∏é \(n\) ÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞‰∏∫ \(c\)ÔºåÁ≠â‰ª∑‰∫é Â∑ÆÂÄºÂú®
  \(c\) ÁöÑÂâ©‰ΩôÁ≥ª‰∏ãÂêå‰Ωô \(0\)„ÄÇËÄÉËôëËøô \(k^2\) ‰∏™Â∑ÆÂÄºÈÉΩ‰∏çÁ≠â‰∫é \(0\)
  ÁöÑÊ¶ÇÁéá‰∏∫Â§öÂ∞ë„ÄÇÂõ†‰∏∫Ëøô \(k\) ‰∏™Êï∞Â≠óÊòØÈöèÊú∫ÁöÑÔºåÈÇ£‰πà‰ªñ‰ª¨Â∑ÆÂÄºÁöÑÂèñÂÄºÂú® \(c\)
  ÁöÑÂâ©‰ΩôÁ≥ª‰∏ã‰πüÊòØÂú® \([0, c]\) Á≠âÊ¶ÇÁéáÂàÜÂ∏ÉÁöÑ„ÄÇÈÇ£‰πàÈÉΩ‰∏çÁ≠â‰∫é \(0\) ÁöÑÊ¶ÇÁéá‰∏∫
  \(\left(\frac{c - 1}{c}\right)^{k^2}\)„ÄÇÊúÄÂùèÊÉÖÂÜµ‰∏ãÔºåÂêàÊ≥ïÁöÑ \(c\)
  Âè™Êúâ‰∏Ä‰∏™Ôºå‰∏îÁ≠â‰∫é \(\sqrt{n}\) Ê†πÊçÆ
  
  \[\left(\frac{n-1}{n}\right)^{n} \approx \frac{1}{e}\]
  
  ÂΩì \(k = n^{1/4}\) Êó∂ÔºåÂèñ‰∏çÂà∞ÂÄºÂæóÊ¶ÇÁéá‰∏∫ \(\frac{1}{e}\)„ÄÇÁ®çÂæÆÂ¢ûÂ§ßÂá†ÂÄçÁöÑ
  \(k\) ÂèØ‰ª•Èôç‰ΩéÊâæ‰∏çÂà∞Ê¶ÇÁéá„ÄÇ Ê≥®ÊÑèËøôÊ†∑ÁöÑÂÅöÊ≥ïÈúÄË¶ÅÊûö‰∏æÊâÄÊúâ \(k^2\)
  ÂØπÂ∑ÆÂÄºÔºåÂÜçÂä†‰∏äÂà§Êñ≠ÂíåÂèñ‰∏çÂà∞Á∫¶Êï∞ÊÉÖÂÜµÁöÑÂá∫Áé∞ÔºåÂ§çÊùÇÂ∫¶Ë¶ÅÂä£‰∫é
  \(\mathcal{O}(\sqrt{n})\)„ÄÇ Êûö‰∏æ \(k^2\)
  ÂØπÂ∑ÆÂÄºÊòØ‰∏äÈù¢ÁÆóÊ≥ïÁöÑÁì∂È¢à„ÄÇÂºïÂÖ•‰º™ÈöèÊú∫ÂáΩÊï∞ \(f(x) = f^2(x-1) + c \mod n\)„ÄÇ
  Ëøô‰∏™ÂáΩÊï∞ÊúâÂá†ÁÇπÊØîËæÉ‰ºòËâØÊÄßË¥®Ôºö
  
  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    ‰ªçÁÑ∂ÂèØ‰ª•ÁúãÊàêÊòØ‰∏ÄÁßçÈöèÊú∫ÂáΩÊï∞Ôºå‰øùËØÅ‰∫Ü‰∏äÈù¢Êé®ÂØº‰∏≠ÂØπÈöèÊú∫ÁöÑ‰æùËµñÊÄß„ÄÇÔºà‰∏™‰∫∫ÊÑüËßâ‰∏çËÉΩ‰øùËØÅÂÆåÂÖ®ÈöèÊú∫‚Ä¶‚Ä¶Ôºâ
  \item
    ÁªèËøá‰∏ÄÊÆµÊ¨°Êï∞ÁöÑÈÄíÊé®‰πãÂêé‰ºöËøõÂÖ•‰∏Ä‰∏™Âæ™ÁéØÔºåÂõ†‰∏∫‰πãÂíåÂâç‰∏ÄÈ°πÁöÑÂÄºÊúâÂÖ≥ÔºåËÄå‰∏îÂèñÂÄºÂè™ËÉΩÂú®
    \([0, n-1]\) ÂÜÖÔºåÊâÄ‰ª•Ëá≥Â§ö \(\mathcal{O}(n)\)
    Ê¨°ÈÄíÊé®Ôºå‰∏ÄÂÆö‰ºöËøõÂÖ•‰∏Ä‰∏™Âæ™ÁéØ„ÄÇ
  \item
    \[g \mid f(i) - f(j)\ \ \  \Rightarrow\ \ \ g \mid f(i + 1) - f(j - 1)\]
    ËØÅÊòéÔºö
    \[f(i + 1) - f(j + 1) = (f^2(i) + c) - (f^2(j) + c) = (f(i) - f(j))(f(i) + f(j))\]
    ‰πüÂ∞±ÊòØ \(g\) ÊòØÂê¶‰∏∫Êüê‰∏§‰∏™Â∑ÆÂÄºÁöÑÁ∫¶Êï∞‰πãÂíå‰∏§‰∏™Â∑ÆÂÄº‰∏ãÊ†áÁöÑÂ∑ÆÊúâÂÖ≥„ÄÇ
  \end{enumerate}
  
  ËÄÉËôë‰∏§‰∏™ÊåáÈíàÔºåÂàÜÂà´‰∏∫ \(L, R\) ÔºåÊØèÊ¨° \(L\) ÈÄíÊé®‰∏Ä‰∏™Ôºå \(R\)
  ÈÄíÊé®‰∏§‰∏™ÔºåÂõ†‰∏∫ÂáΩÊï∞Â≠òÂú®ÁéØÔºåËøô‰∏§‰∏™Â∑ÆÂÄºÊÄª‰ºöÂú®ÁéØ‰∏äÁõ∏ÈÅáÔºå‰ªéÂºÄÂßãÂà∞Áõ∏ÈÅá‰πãÈó¥ÁöÑÊó∂Èó¥ÔºåÊØèÊ¨°ÊâßË°åÂêéÔºåÂà§Êñ≠ÂÖ∂Â∑ÆÂÄº‰∏é
  \(n\) ÁöÑ \texttt{gcd} ÊòØÂê¶‰∏çÁ≠â‰∫é \(1\)
  Âç≥ÂèØ„ÄÇÁõ∏ÈÅáÊâÄÈúÄÊó∂Èó¥ÔºåÂç≥ÁéØÁöÑÂ§ßÂ∞èÁ∫¶‰∏∫ \(\sqrt{n}\)
  „ÄÇÁéØÁöÑÂ§ßÂ∞èÂÜ≥ÂÆöËøêË°åÊúÄÂùèÊó∂Èó¥„ÄÇ
  
  ËøôÊ†∑ËøòÊòØ‰∏çÂ§üÂø´ÔºåÂÖ∂ÂÆû‰∏çÈúÄË¶ÅÊØèÊ¨°ÊâßË°åÈÉΩÁÆó‰∏Ä‰∏ã \(gcd\)
  ÂèØ‰ª•ÊâßË°å‰∏Ä‰∫õÊ≠•Êï∞‰πãÂêéÔºåÂ∞ÜÂÖ∂Â∑ÆÂÄº‰πòÂà∞‰∏ÄËµ∑Ôºå‰∏ÄËµ∑Ê±Ç \(gcd\)
  Âç≥ÂèØÔºåÂèØ‰ª•ËØÅÊòéÔºåËøôÊ†∑ÁöÑÂèòÂåñ‰øùËØÅÁ≠îÊ°à‰∏ç‰ºöÂèòÂä£„ÄÇ
  ËÄÉËôëËÆ©‰∏§‰∏™ÊåáÈíàÂÄçÂ¢ûÁöÑÂæÄÂâçË∑≥ÔºåÂÄçÂ¢ûËã•Âπ≤Ê¨°ÂêéÔºåÊØèÊ¨°ËÆ°ÁÆó‰∏§‰∏™ÊåáÈíàË∑ùÁ¶ª‰πãÈó¥ÁöÑÊâÄÊúâÂ∑ÆÂÄºÂèñÂÄºÔºå‰πòÂú®‰∏ÄËµ∑ËÆ°ÁÆó
  \(gcd\)„ÄÇ
  
  Ê†áÂáÜ‰ª£Á†Å‰∏≠ÔºöÂ∑ÆÂÄºÁõ∏ÂêåÁöÑËß£‰ºöËÆ°ÁÆóÂ§öÊ¨°„ÄÇ‰ΩÜÊòØÁ°ÆÂÆûÂ§ßÂ§ßÊèêÂçáËøêË°åÊïàÁéá„ÄÇËøôÈáåÂ∞±‰∏ç‰ºöÂàÜÊûê‰∫ÜÔºå‰ΩÜÊòØÁõ¥ËßÇÊÑüËßâÂ∞±ÊòØÔºåÂÖ∂ÂÆûÈÇ£‰∏™ÂáΩÊï∞ÂæÄÂêéÈÄíÊé®ÁöÑÊ¨°Êï∞Ë∂äÂ§ö‰ºöÂåÖÂê´Êõ¥Â§öÁöÑÂõ†Â≠ê„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂ¶ÇÊûú‰∏§ÂØπÂáΩÊï∞ÂÄºÂ∑ÆÂÄº‰∏ãÊ†áË∑ùÁ¶ª‰∏ÄÊ†∑ÔºåÂÖ∂ÂÆû‰∏ãÊ†áÂ§ßÁöÑÈÇ£‰∏ÄÂØπ‰ºöÊõ¥‰ºò„ÄÇ
  
  ÊÄªÁöÑÊù•ËØ¥ÔºåÂø´ÁöÑÁéÑÂ≠¶„ÄÇ
  
  ÂèØ‰ª•ÂÜôÂá∫Â¶Ç‰∏ã‰ª£Á†ÅÔºö
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \NormalTok{LL Pollard\_Rho}\OperatorTok{(}\NormalTok{LL n}\OperatorTok{)\{}
  \NormalTok{    LL c }\OperatorTok{=}\NormalTok{ rand}\OperatorTok{(}\NormalTok{n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)} \OperatorTok{+} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    LL L }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ s }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ t }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} \OperatorTok{;}\NormalTok{ s }\OperatorTok{\textless{}\textless{}=} \DecValTok{1}\OperatorTok{,}\NormalTok{ t }\OperatorTok{\textless{}\textless{}=} \DecValTok{1}\OperatorTok{)\{}
  \NormalTok{        LL R }\OperatorTok{=}\NormalTok{ L}\OperatorTok{,}\NormalTok{ M }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ s}\OperatorTok{,}\NormalTok{ step }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}}\NormalTok{ t}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++,}\NormalTok{ step }\OperatorTok{++)\{}
  \NormalTok{            R }\OperatorTok{=}\NormalTok{ f}\OperatorTok{(}\NormalTok{R}\OperatorTok{,}\NormalTok{ c}\OperatorTok{,}\NormalTok{ n}\OperatorTok{);}
  \NormalTok{            M }\OperatorTok{=}\NormalTok{ mul}\OperatorTok{(}\NormalTok{M}\OperatorTok{,}\NormalTok{ abs}\OperatorTok{(}\NormalTok{L }\OperatorTok{{-}}\NormalTok{ R}\OperatorTok{),}\NormalTok{ n}\OperatorTok{);}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{step }\OperatorTok{\%} \DecValTok{1000} \OperatorTok{==} \DecValTok{0}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ LL g }\OperatorTok{=}\NormalTok{ gcd}\OperatorTok{(}\NormalTok{M}\OperatorTok{,}\NormalTok{ n}\OperatorTok{);} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{g }\OperatorTok{\textgreater{}} \DecValTok{1}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ g}\OperatorTok{;} \OperatorTok{\}}
              \CommentTok{// ‰∏ç‰∏ÄÂÆöÂøÖÈ°ªÁ≠âÂà∞‰∏ÄËΩÆËÆ°ÁÆóÁªìÊùü‰πãÂêéÂÜçËÆ°ÁÆó gcd ÂèØËÉΩ‰∏≠Èó¥Â∞±Â∑≤ÁªèÂá∫Áé∞Á≠îÊ°à‰∫ÜÔºå‰∏≠Èó¥ÊØèÈöî‰∏ÄÊÆµÊó∂Èó¥ÁÆóÂá†Ê¨°ÔºåÂèØ‰ª•Âú®Âá∫Áé∞Á≠îÊ°à‰πãÂêéÂø´ÈÄüËøîÂõûÁ≠îÊ°à„ÄÇ}
          \OperatorTok{\}}
  \NormalTok{        LL g }\OperatorTok{=}\NormalTok{ gcd}\OperatorTok{(}\NormalTok{M}\OperatorTok{,}\NormalTok{ n}\OperatorTok{);} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{g }\OperatorTok{\textgreater{}} \DecValTok{1}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ g}\OperatorTok{;}
  \NormalTok{        L }\OperatorTok{=}\NormalTok{ R}\OperatorTok{;}
      \OperatorTok{\}}
  \OperatorTok{\}}
  
  \DataTypeTok{void}\NormalTok{ factorize}\OperatorTok{(}\NormalTok{LL n}\OperatorTok{)\{}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{Prime}\OperatorTok{(}\NormalTok{n}\OperatorTok{))} \OperatorTok{\{}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ n}\OperatorTok{);} \ControlFlowTok{return} \OperatorTok{;} \OperatorTok{\}}
  \NormalTok{    LL g }\OperatorTok{=}\NormalTok{ n}\OperatorTok{;}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{g }\OperatorTok{==}\NormalTok{ n}\OperatorTok{)}\NormalTok{ g }\OperatorTok{=}\NormalTok{ Pollard\_Rho}\OperatorTok{(}\NormalTok{n}\OperatorTok{);}
  \NormalTok{    factorize}\OperatorTok{(}\NormalTok{g}\OperatorTok{);}\NormalTok{ factorize}\OperatorTok{(}\NormalTok{n }\OperatorTok{/}\NormalTok{ g}\OperatorTok{);} 
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsection{Èò∂}\label{ux9636}
  
  Ëã• \(a \perp P\)ÔºåÂàô‰Ωø \(a^k \equiv 1 \pmod P\) ÊàêÁ´ãÁöÑÊúÄÂ∞èÁöÑ \(k\)ÔºåÁß∞‰∏∫
  \(a\) ÂÖ≥‰∫éÊ®° \(P\) ÁöÑÈò∂ÔºåËÆ∞‰Ωú \(\text{ord}_m(a)\)„ÄÇ
  
  Ê±ÇÊ≥ïÔºö Ê†πÊçÆÊ¨ßÊãâÂÆöÁêÜÔºå\(\text{ord}_m(a) \mid \varphi(m)\)ÔºåÂÖàÊ±ÇÂá∫
  \(\varphi(m)\)ÔºåËÆ∞‰Ωú \(t\)„ÄÇ
  
  \begin{itemize}
  \tightlist
  \item
    Êûö‰∏æ \(t\) ÁöÑÊØè‰∏Ä‰∏™Âõ†Â≠êÔºåÊ£ÄÊü•ÊòØÂê¶Êª°Ë∂≥Èò∂ÁöÑÊÄßË¥®„ÄÇ
  \item
    ÂØπ \(t\)
    Ë¥®Âõ†Êï∞ÊãÜÂàÜÔºå‰ª•Ê≠§ËÄÉËôëÊØè‰∏™Ë¥®Âõ†Â≠êÔºåËØïÂõæÂáèÂ∞ëË¥®Âõ†Â≠êÁöÑÂπÇÊ¨°‚Äî‚ÄîÂç≥Â¶ÇÊûúÂáèÂ∞ë‰∫ÜÊüê‰∏™Ë¥®Âõ†Â≠êÁöÑÂπÇÊ¨°Ôºå\(a^t \equiv 1 \pmod P\)
    ‰æùÁÑ∂ÊàêÁ´ãÔºåÈÇ£‰πàÂ∞±Áõ¥Êé•ÂáèÂ∞ëÂç≥ÂèØ„ÄÇÊÑüÊÄßÁêÜËß£‰∏Ä‰∏ãËÇØÂÆöÊòØÂØπÁöÑ„ÄÇ
    \(\mathcal{O}(\log \varphi(P))\)
  \end{itemize}
  
  \subsection{ÂéüÊ†π}\label{ux539fux6839}
  
  Ëã• \(\text{ord}_mg = \varphi(m)\) ÂàôÁß∞ \(g\) ‰∏∫ \(m\) ÁöÑÂéüÊ†π„ÄÇ
  
  ÈÄö‰øóÁöÑËÆ≤ÔºöÁß∞ \(g\) ‰∏∫ \(P\) ÁöÑÂéüÊ†πÔºåÂΩì‰∏î‰ªÖÂΩì
  \(\{g^0, g^1, g^2, \dots, g^{\varphi(P) - 1}\}\) Êï∞‰∏§‰∏§‰∏çÂêå„ÄÇ
  
  Âç≥ÂØπ‰∫é‰ªªÊÑè‰∏Ä‰∏™Âíå \(P\) ‰∫íË¥®ÁöÑÊï∞Â≠óÔºåÂú® \(P\) ÁöÑÂâ©‰ΩôÁ≥ª‰∏ãÔºåÈÉΩÂèØ‰ª•Ë°®Á§∫Êàê
  \(g^t\) ÁöÑÂΩ¢Âºè„ÄÇ
  
  ‰∏Ä‰∏™Ê®°Êï∞Â≠òÂú®ÂéüÊ†πÔºåÂΩì‰∏î‰ªÖÂΩìËøô‰∏™Ê®°Êï∞‰∏∫ \(2, 4, p^s, 2p^s\)Ôºå\(p\)
  ‰∏∫Â•áÁ¥†Êï∞„ÄÇ
  
  Âà§Êñ≠‰∏Ä‰∏™Êï∞ÊòØÂê¶‰∏∫ÂéüÊ†πÔºöÊ†πÊçÆÂÆö‰πâÂèØ‰ª•ËÄÉËôëÊûö‰∏æÊØè‰∏Ä‰∏™
  \(t \in [1, \varphi(P) - 1]\) Âà§Êñ≠ \(g^t\) ÊòØÂê¶ÈÉΩ‰∏çÁ≠â‰∫é
  \(1\)„ÄÇ‰∫ãÂÆû‰∏äÔºåÊ†πÊçÆÊ¨ßÊãâÂÆöÁêÜÔºåÂèØËÉΩ‰Ωø \(g^t \equiv 1 \pmod P\) ÁöÑ \(t\)
  Âè™ÂèØËÉΩÊòØÊòØ \(\varphi(P)\) ÁöÑÁ∫¶Êï∞„ÄÇÊûö‰∏æ \(\varphi(P)\)
  ÁöÑÊØè‰∏™Á∫¶Êï∞ÔºåËøõË°åÂà§Êñ≠Âç≥ÂèØÔºåÂ§çÊùÇÂ∫¶‰∏∫ \(\mathcal{O}(\sqrt{\varphi(P)})\)
  
  ÂéüÊ†πÁöÑÊ±ÇÊ≥ïÔºöËã•‰∏Ä‰∏™Êï∞ \(m\) Â≠òÂú®ÂéüÊ†πÔºåÂÖ∂ÊúÄÂ∞èÂéüÊ†πÂ§ßÊ¶ÇÂú® \(m^{1/4}\)
  Á∫ßÂà´„ÄÇÊûö‰∏æÂéüÊ†πÂÜçÂà§Êñ≠‰∏ÄËà¨ÊòØÂèØ‰ª•Êé•ÂèóÁöÑ„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{bool}\NormalTok{ JudgePrimitiveRoot}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ g}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ P}\OperatorTok{)\{}
      \DataTypeTok{int}\NormalTok{ phi }\OperatorTok{=}\NormalTok{ P }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{2}\OperatorTok{;}\NormalTok{ i }\OperatorTok{*}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ phi}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{phi }\OperatorTok{\%}\NormalTok{ i }\OperatorTok{!=} \DecValTok{0}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{pow}\OperatorTok{(}\NormalTok{g}\OperatorTok{,}\NormalTok{ i}\OperatorTok{,}\NormalTok{ P}\OperatorTok{)} \OperatorTok{==} \DecValTok{1}\OperatorTok{)} \ControlFlowTok{return} \KeywordTok{false}\OperatorTok{;} 
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{pow}\OperatorTok{(}\NormalTok{g}\OperatorTok{,}\NormalTok{ P }\OperatorTok{/}\NormalTok{ i}\OperatorTok{,}\NormalTok{ P}\OperatorTok{)} \OperatorTok{==} \DecValTok{1}\OperatorTok{)} \ControlFlowTok{return} \KeywordTok{false}\OperatorTok{;}
      \OperatorTok{\}}
      \ControlFlowTok{return} \KeywordTok{true}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ GetPrimitiveRoot}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ P}\OperatorTok{)\{} \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{2}\OperatorTok{;} \OperatorTok{;}\NormalTok{ i}\OperatorTok{++)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{JudgePrimitiveRoot}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\NormalTok{ P}\OperatorTok{))} \ControlFlowTok{return}\NormalTok{ i}\OperatorTok{;} \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  Âú∞‰ΩçÁõ∏ÂΩì‰∫éËá™ÁÑ∂Êï∞Âüü‰∏ãÁöÑÂîØ‰∏ÄÂàÜËß£ÂÆöÁêÜ„ÄÇ
  
  \end{document}
[INFO] [makePDF] LaTeX run number 1
[INFO] [makePDF] LaTeX output
  This is XeTeX, Version 3.141592653-2.6-0.999995 (TeX Live 2023/Debian) (preloaded format=xelatex)
   restricted \write18 enabled.
  entering extended mode
  (.../input.tex
  LaTeX2e <2023-11-01> patch level 1
  L3 programming layer <2024-01-22>
  (.../article.cls
  Document Class: article 2023/05/17 v1.4n Standard LaTeX document class
  (.../[system]
  (.../xcolor.sty
  (.../color.cfg)
  (.../xetex.def)
  (.../[system]
  (.../geometry.sty
  (.../keyval.sty)
  (.../ifvtex.sty
  (.../iftex.sty)))
  (.../amsmath.sty
  For additional information on amsmath, use the `?' option.
  (.../amstext.sty
  (.../amsgen.sty))
  (.../amsbsy.sty)
  (.../amsopn.sty))
  (.../amssymb.sty
  (.../amsfonts.sty))
  (.../unicode-math.sty
  (.../expl3.sty
  (.../l3backend-xetex.def))
  (.../unicode-math-xetex.sty
  (.../xparse.sty)
  (.../l3keys2e.sty)
  (.../fontspec.sty
  (.../fontspec-xetex.sty
  (.../fontenc.sty)
  (.../fontspec.cfg)))
  (.../fix-cm.sty
  (.../ts1enc.def))
  (.../unicode-math-table.tex)))
  (.../lmodern.sty)
  (.../xeCJK.sty
  (.../ctexhook.sty)
  (.../xtemplate.sty)
  (.../xeCJK.cfg))
  (.../upquote.sty
  (.../textcomp.sty))
  (.../microtype.sty
  (.../etoolbox.sty)
  (.../microtype-xetex.def)
  (.../microtype.cfg))
  (.../setspace.sty)
  (.../parskip.sty
  (.../kvoptions.sty
  (.../ltxcmds.sty)
  (.../kvsetkeys.sty)))
  (.../fancyvrb.sty)
  (.../soul.sty
  (.../soul-ori.sty)
  (.../infwarerr.sty)
  (.../etexcmds.sty))
  (.../xeCJKfntef.sty
  (.../ulem.sty))
  (.../bookmark.sty
  (.../hyperref.sty
  (.../kvdefinekeys.sty)
  (.../pdfescape.sty
  (.../pdftexcmds.sty))
  (.../hycolor.sty)
  (.../auxhook.sty)
  (.../nameref.sty
  (.../refcount.sty)
  (.../gettitlestring.sty))
  (.../pd1enc.def)
  (.../intcalc.sty)
  (.../puenc.def)
  (.../url.sty)
  (.../bitset.sty
  (.../bigintcalc.sty))
  (.../atbegshi-ltx.sty))
  (.../hxetex.def
  (.../stringenc.sty)
  (.../rerunfilecheck.sty
  (.../atveryend-ltx.sty)
  (.../uniquecounter.sty)))
  (.../bkm-dvipdfm.def))
  (.../xurl.sty)
  No file input.aux.
  *geometry* driver: auto-detecting
  *geometry* detected driver: xetex
  (.../mt-LatinModernRoman.cfg)
  
  Package hyperref Warning: Rerun to get /PageLabels entry.
  
  (.../omllmm.fd)
  (.../umsa.fd)
  (.../mt-msa.cfg)
  (.../umsb.fd)
  (.../mt-msb.cfg)
  
  Package xeCJK Warning: Unknown CJK family `\CJKttdefault' is being ignored.
  (xeCJK)                
  (xeCJK)                Try to use `\setCJKmonofont[<...>]{<...>}' to define
  (xeCJK)                it.
  
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/b/n' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 128.
  
  [1] [2]
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/m/it' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 290.
  
  [3] [4]
  Underfull \hbox (badness 10000) in paragraph at lines 371--373
  
  
  Overfull \hbox (282.80313pt too wide) in paragraph at lines 408--408
  []    \TU/lmtt/m/n/10 for(int i = 0, V = 1; i <= k; i++, V = V *1ll* a % P) if(
  V == b) return i; // changed: It must be executed before []if(b % D != 0) retur
  n -1[]).[] 
  [5] [6] [7] [8] [9] (.../input.aux)
  
  LaTeX Font Warning: Some font shapes were not available, defaults substituted.
  
  
  LaTeX Warning: Label(s) may have changed. Rerun to get cross-references right.
  
   )
  (see the transcript file for additional information)
  Output written on .../input.pdf (9 pages).
  Transcript written on .../input.log.
[INFO] [makePDF] Rerun needed
  Package hyperref Warning: Rerun to get /PageLabels entry.
  LaTeX Warning: Label(s) may have changed. Rerun to get cross-references right.
[INFO] [makePDF] LaTeX run number 2
[INFO] [makePDF] LaTeX output
  This is XeTeX, Version 3.141592653-2.6-0.999995 (TeX Live 2023/Debian) (preloaded format=xelatex)
   restricted \write18 enabled.
  entering extended mode
  (.../input.tex
  LaTeX2e <2023-11-01> patch level 1
  L3 programming layer <2024-01-22>
  (.../article.cls
  Document Class: article 2023/05/17 v1.4n Standard LaTeX document class
  (.../[system]
  (.../xcolor.sty
  (.../color.cfg)
  (.../xetex.def)
  (.../[system]
  (.../geometry.sty
  (.../keyval.sty)
  (.../ifvtex.sty
  (.../iftex.sty)))
  (.../amsmath.sty
  For additional information on amsmath, use the `?' option.
  (.../amstext.sty
  (.../amsgen.sty))
  (.../amsbsy.sty)
  (.../amsopn.sty))
  (.../amssymb.sty
  (.../amsfonts.sty))
  (.../unicode-math.sty
  (.../expl3.sty
  (.../l3backend-xetex.def))
  (.../unicode-math-xetex.sty
  (.../xparse.sty)
  (.../l3keys2e.sty)
  (.../fontspec.sty
  (.../fontspec-xetex.sty
  (.../fontenc.sty)
  (.../fontspec.cfg)))
  (.../fix-cm.sty
  (.../ts1enc.def))
  (.../unicode-math-table.tex)))
  (.../lmodern.sty)
  (.../xeCJK.sty
  (.../ctexhook.sty)
  (.../xtemplate.sty)
  (.../xeCJK.cfg))
  (.../upquote.sty
  (.../textcomp.sty))
  (.../microtype.sty
  (.../etoolbox.sty)
  (.../microtype-xetex.def)
  (.../microtype.cfg))
  (.../setspace.sty)
  (.../parskip.sty
  (.../kvoptions.sty
  (.../ltxcmds.sty)
  (.../kvsetkeys.sty)))
  (.../fancyvrb.sty)
  (.../soul.sty
  (.../soul-ori.sty)
  (.../infwarerr.sty)
  (.../etexcmds.sty))
  (.../xeCJKfntef.sty
  (.../ulem.sty))
  (.../bookmark.sty
  (.../hyperref.sty
  (.../kvdefinekeys.sty)
  (.../pdfescape.sty
  (.../pdftexcmds.sty))
  (.../hycolor.sty)
  (.../auxhook.sty)
  (.../nameref.sty
  (.../refcount.sty)
  (.../gettitlestring.sty))
  (.../pd1enc.def)
  (.../intcalc.sty)
  (.../puenc.def)
  (.../url.sty)
  (.../bitset.sty
  (.../bigintcalc.sty))
  (.../atbegshi-ltx.sty))
  (.../hxetex.def
  (.../stringenc.sty)
  (.../rerunfilecheck.sty
  (.../atveryend-ltx.sty)
  (.../uniquecounter.sty)))
  (.../bkm-dvipdfm.def))
  (.../xurl.sty)
  (.../input.aux)
  *geometry* driver: auto-detecting
  *geometry* detected driver: xetex
  (.../mt-LatinModernRoman.cfg)
  (.../omllmm.fd)
  (.../umsa.fd)
  (.../mt-msa.cfg)
  (.../umsb.fd)
  (.../mt-msb.cfg)
  
  Package xeCJK Warning: Unknown CJK family `\CJKttdefault' is being ignored.
  (xeCJK)                
  (xeCJK)                Try to use `\setCJKmonofont[<...>]{<...>}' to define
  (xeCJK)                it.
  
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/b/n' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 128.
  
  [1] [2]
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/m/it' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 290.
  
  [3] [4]
  Underfull \hbox (badness 10000) in paragraph at lines 371--373
  
  
  Overfull \hbox (282.80313pt too wide) in paragraph at lines 408--408
  []    \TU/lmtt/m/n/10 for(int i = 0, V = 1; i <= k; i++, V = V *1ll* a % P) if(
  V == b) return i; // changed: It must be executed before []if(b % D != 0) retur
  n -1[]).[] 
  [5] [6] [7] [8] [9] (.../input.aux)
  
  LaTeX Font Warning: Some font shapes were not available, defaults substituted.
  
   )
  (see the transcript file for additional information)
  Output written on .../input.pdf (9 pages).
  Transcript written on .../input.log.
</pre>
                                            </details>
                    
                                    </div>
                                </article>
                

                

                

                

            

                
                        </div>
                    </main>
            </div>

                <!-- Footer -->
                <footer id="footer">
                    <p>¬© 2025 ShuYuMo's Blog by Jiayi Su. All rights reserved.</p>  Powered by <b>MonoPy</b> - Single-Script Blog Generator in Python.
                </footer>
            </div>
        </div>
        
        <!-- Back to top button -->
        <button id="back-to-top" 
                aria-label="Back to top" 
                title="Back to top"
                style="display: none;">
            ‚Üë
        </button>
        
        <!-- JavaScript -->
        <script>
            // Back to top functionality
            (function() {
                const backToTopButton = document.getElementById('back-to-top');
                const scrollThreshold = 300;
                
                function toggleBackToTop() {
                    if (window.scrollY > scrollThreshold) {
                        backToTopButton.style.display = 'block';
                    } else {
                        backToTopButton.style.display = 'none';
                    }
                }
                
                function scrollToTop() {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                }
                
                window.addEventListener('scroll', toggleBackToTop);
                backToTopButton.addEventListener('click', scrollToTop);
            })();
            
            // Clean up redundant spans in code blocks
            document.querySelectorAll('pre code').forEach(codeBlock => {
                // Find all line spans
                const lineSpans = codeBlock.querySelectorAll('span[id^="cb"]');
                
                lineSpans.forEach(lineSpan => {
                    // Check if this line has nested spans that can be simplified
                    const children = Array.from(lineSpan.childNodes);
                    
                    // Skip the anchor link (first child is usually the line number anchor)
                    let contentStart = 0;
                    if (children[0] && children[0].tagName === 'A') {
                        contentStart = 1;
                    }
                    
                    // If there's only one span child after the anchor, unwrap it
                    const contentChildren = children.slice(contentStart);
                    if (contentChildren.length === 1 && contentChildren[0].tagName === 'SPAN') {
                        const spanChild = contentChildren[0];
                        // Move the span's contents directly to the line span
                        while (spanChild.firstChild) {
                            lineSpan.insertBefore(spanChild.firstChild, spanChild);
                        }
                        // Remove the now-empty span
                        spanChild.remove();
                    }
                });
            });
            
            // Code copy functionality
            document.querySelectorAll('pre code').forEach(block => {
                const button = document.createElement('button');
                button.className = 'copy-button';
                button.textContent = 'Copy';
                button.setAttribute('aria-label', 'Copy code to clipboard');
                
                button.addEventListener('click', function() {
                    navigator.clipboard.writeText(block.textContent).then(() => {
                        button.textContent = 'Copied!';
                        setTimeout(() => button.textContent = 'Copy', 2000);
                    }).catch(() => {
                        // Fallback for older browsers
                        const textArea = document.createElement('textarea');
                        textArea.value = block.textContent;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        button.textContent = 'Copied!';
                        setTimeout(() => button.textContent = 'Copy', 2000);
                    });
                });
                
                const pre = block.parentNode;
                pre.style.position = 'relative';
                pre.appendChild(button);
            });
        </script>
    </body>
</html>