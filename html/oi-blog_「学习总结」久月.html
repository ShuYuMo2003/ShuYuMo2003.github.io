<!-- Academic Blog Template
MIT License - Copyright (c) 2025 Su Jiayi <sujiayi2003@gmail.com>
-->

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        
        <!-- Primary Meta Tags -->
        <title>ShuYuMo&#39;s Blog | Jiayi Su</title>
        <meta name="description" content="ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„ INFP éšç¢ç¢å¿µã€‚">
        <meta name="keywords" content="nb1, nb2, nb3">
        <meta name="author" content="Su Jiayi">
        
        <!-- Open Graph Meta Tags -->
        <meta property="og:type" content="website">
        <meta property="og:title" content="ShuYuMo&#39;s Blog | Jiayi Su">
        <meta property="og:description" content="ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„ INFP éšç¢ç¢å¿µã€‚">
        <meta property="og:image" content="../static/images/header.jpg">
        
        <!-- Stylesheets -->
        <link rel="stylesheet" type="text/css" href="../static/css/default.css">
        <link rel="stylesheet" type="text/css" href="../static/css/syntax.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
        
        <!-- Google Analytics -->
        
    </head>
    <body>
        <!-- Skip to main content for accessibility -->
        <a href="#main-content" class="skip-link">Skip to main content</a>
        
        <div id="main">
            <div class="main-container">
                <!-- Header -->
                <header id="header">
                    <div class="header-content">
                        <h1 class="header-title">
                            <a href="./">ShuYuMo&#39;s Blog</a>
                        </h1>
                        <p class="header-subtitle">ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„ INFP éšç¢ç¢å¿µã€‚</p>
                        <div class="header-accent"></div>
                    </div>
                </header>
                
                <!-- Content Layout -->
                <div class="content-wrapper">
                    <!-- Sidebar -->
                    <nav id="sidebar">
                        <div class="profile-section">
                            <a href="./" class="profile-avatar-link">
                                <img src="../static/images/header.jpg" alt="ShuYuMo&#39;s header" class="profile-avatar" loading="lazy" />
                            </a>
                            <div class="profile-info">
                                <h3 class="profile-name">Jiayi Su (ShuYuMo)</h3>
            </div>
            </div>

                        <div class="nav-header">
                            <h2>ğŸ§­ Navigation</h2>
                            <span class="nav-subtitle">Explore the site</span>
                        </div>
                        <nav class="nav-menu">
                            
                            
                            <a href="./_post.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">ğŸ“„</span>
                                <span class="nav-text">Posts</span>
                                
                            </a>
                            
                            
                            <a href="./_archive.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">ğŸ“„</span>
                                <span class="nav-text">Archive</span>
                                
                            </a>
                            
                            
                            <a href="./_category.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">ğŸ“„</span>
                                <span class="nav-text">Category</span>
                                
                            </a>
                            
                            
                            <a href="./_about.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">ğŸ“„</span>
                                <span class="nav-text">About</span>
                                
                            </a>
                            
                        </nav>
                    </nav>

                    <!-- Main Content -->
                    <main id="content">
                        <div id="main-content">
                            
                                <article>
                                    <!-- Article Header with Title and Actions -->
                                    <div class="article-header">
                                        <div class="article-title-section">
                                            
                                                <h1 class="article-title">ã€Œå­¦ä¹ æ€»ç»“ã€ä¹…æœˆ</h1>
                                            
                                            
                                            <!-- Article Meta Information -->
                                            <div class="article-meta">
                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">ğŸ“…</span>
                                                        <span class="meta-label">Last Updated: </span>
                                                        <span class="meta-value">2020-09-06</span>
                                                    </div>
                                                
                                                
                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">ğŸ“Š</span>
                                                        <span class="meta-label">Word Count: </span>
                                                        <span class="meta-value">252</span>
                                                    </div>
                    

                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">â±ï¸</span>
                                                        <span class="meta-label">Estimated Reading Time: </span>
                                                        <span class="meta-value">2 minutes</span>
                                                    </div>
                                                
                                            </div>
                                        </div>
                                        
                                        <div class="article-actions">
                    
                                                <a href="../pdf/oi-blog_ã€Œå­¦ä¹ æ€»ç»“ã€ä¹…æœˆ.pdf" 
                                                   target="_blank" 
                                                   rel="noopener"
                                                   class="action-btn pdf-btn">
                                                    ğŸ“„ PDF
                                                </a>
                                            
                                            
                                            
                                                <a href="../src/oi-blog/ã€Œå­¦ä¹ æ€»ç»“ã€ä¹…æœˆ.md" 
                                                   target="_blank" 
                                                   rel="noopener"
                                                   class="action-btn source-btn">
                                                    ğŸ“ Source
                                                </a>
                                            
                                        </div>
                                    </div>

                                    <!-- Article Content -->
                                    <div class="article-content">
                                        <p>ä¹…æœˆä¹Ÿæ˜¯ä¸ªå¯çˆ±çš„æœˆä»½å‘¢ QAQ~</p>
<!-- more -->
<h2 id="ç‚¹åˆ†æ²»">ç‚¹åˆ†æ²»</h2>
<p>ç‚¹åˆ†æ²»ä¸‰è¿ï¼š - Grt( o ): æ‰¾åˆ°ç»“ç‚¹ o æ‰€åœ¨å­æ ‘çš„ ã€‚ - solve( o ):
åœ¨ä»¥ç»“ç‚¹ o ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œå¤„ç†ç»è¿‡ çš„ ã€‚ - divide( o ):
ç‚¹åˆ†æ²»ä¸»å‡½æ•°ï¼Œè°ƒç”¨ <code>solve(o)</code> å¤„ç†ä»¥ o ä¸ºæ ¹ ç»è¿‡ç‚¹ o
çš„ä¿¡æ¯ï¼Œç„¶ååˆ é™¤ç‚¹ o ï¼Œé€’å½’å¤„ç†å…¶å„¿å­ï¼ˆ<code>divide(ex)</code>ï¼‰</p>
<h4 id="æ³¨æ„">æ³¨æ„</h4>
<ul>
<li>åº”ä¿è¯ <code>solve(o)</code> åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸¥æ ¼
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msub><mtext>size</mtext><mi>o</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\text{size}_o)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">size</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
å¦åˆ™ä¼šå¯¼è‡´æ€»æ—¶é—´å¤æ‚åº¦ä¸æ­£ç¡®ã€‚</li>
<li>åº”ä¿è¯ ä¸¤æ¬¡æ‰§è¡Œ <code>Grt()</code>
ç¬¬äºŒæ¬¡è°ƒç”¨åªæ˜¯ä¸ºäº†ç¡®å®šä»¥é‡å¿ƒä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘å¤§å°ã€‚</li>
<li><code>solve(o)</code>ä¸­å¾€å¾€æ˜¯åœ¨è€ƒè™‘æ‰€æœ‰ä¹‹å‰è®¿é—®è¿‡çš„å­æ ‘ç»“ç‚¹ åˆ°
å½“å‰åˆšåˆšè®¿é—®çš„ç»“ç‚¹ ä¹‹é—´ç»Ÿè®¡ç­”æ¡ˆã€‚</li>
</ul>
<h3 id="ä¾‹é¢˜-1">ä¾‹é¢˜ 1</h3>
<p>ç»™å®šä¸€æ£µæœ‰
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ä¸ªç‚¹çš„æ ‘ï¼Œè¯¢é—®æ ‘ä¸Šè·ç¦»ä¸º
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
çš„ç‚¹å¯¹æ˜¯å¦å­˜åœ¨ã€‚</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum<span class="op">;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> si<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> vis<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> judge<span class="op">[</span><span class="dt">int</span><span class="op">(</span><span class="fl">1e7</span> <span class="op">+</span> <span class="dv">100</span><span class="op">)];</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> qer<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> MX<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ans<span class="op">[</span><span class="dt">int</span><span class="op">(</span><span class="fl">1e7</span> <span class="op">+</span> <span class="dv">100</span><span class="op">)];</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> rt<span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> grt<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> f<span class="op">)</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    si<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    MX<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> MAX <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>o<span class="op">];</span> i<span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>ex <span class="op">==</span> f <span class="op">||</span> vis<span class="op">[</span>ex<span class="op">])</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        grt<span class="op">(</span>ex<span class="op">,</span> o<span class="op">);</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        si<span class="op">[</span>o<span class="op">]</span> <span class="op">+=</span> si<span class="op">[</span>ex<span class="op">];</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        MAX <span class="op">=</span> max<span class="op">(</span>si<span class="op">[</span>ex<span class="op">],</span> MAX<span class="op">);</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    MAX <span class="op">=</span> max<span class="op">(</span>MAX<span class="op">,</span> sum <span class="op">-</span> si<span class="op">[</span>o<span class="op">]);</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    MX<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> MAX<span class="op">;</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>MAX <span class="op">&lt;</span> MX<span class="op">[</span>rt<span class="op">])</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        rt <span class="op">=</span> o<span class="op">;</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cnt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> tmp<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> GetAllDis<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> f<span class="op">,</span> <span class="dt">int</span> dis<span class="op">)</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>dis <span class="op">&gt;</span> <span class="fl">1e7</span><span class="op">)</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    tmp<span class="op">[++</span>cnt<span class="op">]</span> <span class="op">=</span> dis<span class="op">;</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>o<span class="op">];</span> i<span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">)</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>ex <span class="op">==</span> f <span class="op">||</span> vis<span class="op">[</span>ex<span class="op">])</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>        GetAllDis<span class="op">(</span>ex<span class="op">,</span> o<span class="op">,</span> dis <span class="op">+</span> edge<span class="op">[</span>i<span class="op">].</span>w<span class="op">);</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>queue<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> Q<span class="op">;</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> solve<span class="op">(</span><span class="dt">int</span> o<span class="op">)</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    judge<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>o<span class="op">];</span> i<span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">)</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>vis<span class="op">[</span>ex<span class="op">])</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>        cnt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>        GetAllDis<span class="op">(</span>ex<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> edge<span class="op">[</span>i<span class="op">].</span>w<span class="op">);</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> cnt<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> k <span class="op">&lt;=</span> m<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>qer<span class="op">[</span>k<span class="op">]</span> <span class="op">&gt;=</span> tmp<span class="op">[</span>j<span class="op">])</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>                    ans<span class="op">[</span>k<span class="op">]</span> <span class="op">|=</span> judge<span class="op">[</span>qer<span class="op">[</span>k<span class="op">]</span> <span class="op">-</span> tmp<span class="op">[</span>j<span class="op">]];</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> cnt<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>            judge<span class="op">[</span>tmp<span class="op">[</span>j<span class="op">]]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>            Q<span class="op">.</span>push<span class="op">(</span>tmp<span class="op">[</span>j<span class="op">]);</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>Q<span class="op">.</span>empty<span class="op">())</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>        judge<span class="op">[</span>Q<span class="op">.</span>front<span class="op">()]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>        Q<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> divide<span class="op">(</span><span class="dt">int</span> o<span class="op">)</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    vis<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    solve<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>o<span class="op">];</span> i<span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">)</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>vis<span class="op">[</span>ex<span class="op">])</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>        sum <span class="op">=</span> si<span class="op">[</span>ex<span class="op">];</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>        MX<span class="op">[</span>rt <span class="op">=</span> <span class="dv">0</span><span class="op">]</span> <span class="op">=</span> INT_MAX<span class="op">;</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>        grt<span class="op">(</span>ex<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>        grt<span class="op">(</span>rt<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>        divide<span class="op">(</span>rt<span class="op">);</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> read<span class="op">(),</span> m <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> read<span class="op">(),</span> v <span class="op">=</span> read<span class="op">(),</span> w <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>        add<span class="op">(</span>u<span class="op">,</span> v<span class="op">,</span> w<span class="op">);</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>        add<span class="op">(</span>v<span class="op">,</span> u<span class="op">,</span> w<span class="op">);</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> m<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>        qer<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    sum <span class="op">=</span> n<span class="op">;</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    MX<span class="op">[</span>rt <span class="op">=</span> <span class="dv">0</span><span class="op">]</span> <span class="op">=</span> INT_MAX<span class="op">;</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    grt<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    grt<span class="op">(</span>rt<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    divide<span class="op">(</span>rt<span class="op">);</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> m<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>ans<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>            puts<span class="op">(</span><span class="st">&quot;AYE&quot;</span><span class="op">);</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>            puts<span class="op">(</span><span class="st">&quot;NAY&quot;</span><span class="op">);</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="ä¾‹é¢˜-2">ä¾‹é¢˜ 2</h3>
<h4
id="luogu-p2634å›½å®¶é›†è®­é˜Ÿèªèªå¯å¯">ã€Œluogu-P2634ã€ã€Œå›½å®¶é›†è®­é˜Ÿã€èªèªå¯å¯</h4>
<p>ç»™å‡ºä¸€ä¸ªå¸¦æƒæ ‘ï¼Œæ±‚å‡ºæ‰€æœ‰æ»¡è¶³é•¿åº¦ä¸º
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span>
çš„å€æ•°çš„ç®€å•è·¯å¾„æ•°é‡ã€‚</p>
<p>ç»Ÿè®¡æ—¶ï¼Œç»Ÿè®¡æ¯ä¸ªå­æ ‘å†…ï¼Œåˆ†åˆ«ç»Ÿè®¡ æ ¹åˆ°å­æ ‘ä¸­ç»“ç‚¹çš„è·¯å¾„é•¿åº¦
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>modÂ </mtext><mn>3</mn></mrow><annotation encoding="application/x-tex">\text{mod}\ 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">mod</span></span><span class="mspace">Â </span><span class="mord">3</span></span></span></span>
åï¼Œä¸åŒå€¼çš„æ•°é‡ã€‚ åœ¨æ ¹èŠ‚ç‚¹æ‹¼æ¥å³å¯ã€‚</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> vis<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> GetCenter</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum<span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> si<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> MX<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> rt<span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> f<span class="op">)</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        si<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        MX<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> MAX <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>o<span class="op">];</span> i<span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">)</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>ex <span class="op">==</span> f <span class="op">||</span> vis<span class="op">[</span>ex<span class="op">])</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>            dfs<span class="op">(</span>ex<span class="op">,</span> o<span class="op">);</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>            si<span class="op">[</span>o<span class="op">]</span> <span class="op">+=</span> si<span class="op">[</span>ex<span class="op">];</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            MAX <span class="op">=</span> max<span class="op">(</span>MAX<span class="op">,</span> si<span class="op">[</span>ex<span class="op">]);</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        MAX <span class="op">=</span> max<span class="op">(</span>MAX<span class="op">,</span> sum <span class="op">-</span> si<span class="op">[</span>o<span class="op">]);</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        MX<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> MAX<span class="op">;</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>MX<span class="op">[</span>rt<span class="op">]</span> <span class="op">&gt;</span> MX<span class="op">[</span>o<span class="op">])</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>            rt <span class="op">=</span> o<span class="op">;</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> grt<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> _sum<span class="op">)</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        MX<span class="op">[</span>rt <span class="op">=</span> <span class="dv">0</span><span class="op">]</span> <span class="op">=</span> INT_MAX<span class="op">;</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        sum <span class="op">=</span> _sum<span class="op">;</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>o<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>rt<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> rt<span class="op">;</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="co">// namespace GetCenter</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> GetCenter<span class="op">::</span>grt<span class="op">;</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> GetCenter<span class="op">::</span>si<span class="op">;</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cnt<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> GetDis<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> f<span class="op">,</span> <span class="dt">int</span> dis<span class="op">)</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    cnt<span class="op">[</span>dis <span class="op">%</span> <span class="dv">3</span><span class="op">]++;</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>o<span class="op">];</span> i<span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">)</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>ex <span class="op">==</span> f <span class="op">||</span> vis<span class="op">[</span>ex<span class="op">])</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>        GetDis<span class="op">(</span>ex<span class="op">,</span> o<span class="op">,</span> dis <span class="op">+</span> edge<span class="op">[</span>i<span class="op">].</span>w<span class="op">);</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> Bef<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> solve<span class="op">(</span><span class="dt">int</span> o<span class="op">)</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    Bef<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>o<span class="op">];</span> i<span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">)</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>vis<span class="op">[</span>ex<span class="op">])</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>        memset<span class="op">(</span>cnt<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>cnt<span class="op">));</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>        GetDis<span class="op">(</span>ex<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> edge<span class="op">[</span>i<span class="op">].</span>w<span class="op">);</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>            ans <span class="op">+=</span> Bef<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> cnt<span class="op">[(</span><span class="dv">3</span> <span class="op">-</span> i<span class="op">)</span> <span class="op">%</span> <span class="dv">3</span><span class="op">]</span> <span class="op">*</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>            Bef<span class="op">[</span>i<span class="op">]</span> <span class="op">+=</span> cnt<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>    memset<span class="op">(</span>Bef<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>Bef<span class="op">));</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> divide<span class="op">(</span><span class="dt">int</span> o<span class="op">)</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    vis<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    solve<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>o<span class="op">];</span> i<span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">)</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>vis<span class="op">[</span>ex<span class="op">])</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> rt <span class="op">=</span> grt<span class="op">(</span>ex<span class="op">,</span> si<span class="op">[</span>ex<span class="op">]);</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>        divide<span class="op">(</span>rt<span class="op">);</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> read<span class="op">(),</span> v <span class="op">=</span> read<span class="op">(),</span> w <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>        add<span class="op">(</span>u<span class="op">,</span> v<span class="op">,</span> w<span class="op">);</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>        add<span class="op">(</span>v<span class="op">,</span> u<span class="op">,</span> w<span class="op">);</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> rt <span class="op">=</span> grt<span class="op">(</span><span class="dv">1</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>    divide<span class="op">(</span>rt<span class="op">);</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">+=</span> n<span class="op">;</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> A <span class="op">=</span> ans<span class="op">,</span> B <span class="op">=</span> n <span class="op">*</span> n<span class="op">;</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> g <span class="op">=</span> gcd<span class="op">(</span>A<span class="op">,</span> B<span class="op">);</span></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">/</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> A <span class="op">/</span> g<span class="op">,</span> B <span class="op">/</span> g<span class="op">);</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="æ —é¢˜-3">æ —é¢˜ 3</h4>
<h4 id="luogu-p4178èªèªå¯å¯">ã€Œluogu-P4178ã€èªèªå¯å¯</h4>
<p>ç»™å®šä¸€æ£µ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ¯æ¡è¾¹æœ‰è¾¹æƒï¼Œæ±‚å‡ºæ ‘ä¸Šä¸¤ç‚¹è·ç¦»å°äºç­‰äº
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
çš„ç‚¹å¯¹æ•°é‡</p>
<p>å¯¹æ¯ä¸ªå„¿å­ç»Ÿè®¡æ‰€æœ‰å¯èƒ½çš„é•¿åº¦ï¼Œä¹˜æ³•åŸç†ä»¥æ­¤åŒ¹é…å³å¯ã€‚</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> vis<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> GetCenter</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> si<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> MX<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> rt<span class="op">;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum<span class="op">;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> f<span class="op">)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        si<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> MAX <span class="op">=</span> INT_MIN<span class="op">;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>o<span class="op">];</span> i<span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">)</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>ex <span class="op">==</span> f <span class="op">||</span> vis<span class="op">[</span>ex<span class="op">])</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>            dfs<span class="op">(</span>ex<span class="op">,</span> o<span class="op">);</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>            si<span class="op">[</span>o<span class="op">]</span> <span class="op">+=</span> si<span class="op">[</span>ex<span class="op">];</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>            MAX <span class="op">=</span> max<span class="op">(</span>si<span class="op">[</span>ex<span class="op">],</span> MAX<span class="op">);</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        MAX <span class="op">=</span> max<span class="op">(</span>MAX<span class="op">,</span> sum <span class="op">-</span> si<span class="op">[</span>o<span class="op">]);</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        MX<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> MAX<span class="op">;</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>MAX <span class="op">&lt;</span> MX<span class="op">[</span>rt<span class="op">])</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>            rt <span class="op">=</span> o<span class="op">;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> grt<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> _sum<span class="op">)</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        MX<span class="op">[</span>rt <span class="op">=</span> <span class="dv">0</span><span class="op">]</span> <span class="op">=</span> INT_MAX<span class="op">;</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        sum <span class="op">=</span> _sum<span class="op">;</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>o<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>rt<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> rt<span class="op">;</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="co">// namespace GetCenter</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> GetCenter<span class="op">::</span>grt<span class="op">;</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> GetCenter<span class="op">::</span>si<span class="op">;</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> judge<span class="op">[</span>_N<span class="op">],</span> tjt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> tmp<span class="op">[</span>_N<span class="op">],</span> ttt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> GetDis<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> f<span class="op">,</span> <span class="dt">int</span> w<span class="op">)</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>w <span class="op">&gt;</span> k<span class="op">)</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    tmp<span class="op">[++</span>ttt<span class="op">]</span> <span class="op">=</span> w<span class="op">;</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>o<span class="op">];</span> i<span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">)</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>ex <span class="op">==</span> f <span class="op">||</span> vis<span class="op">[</span>ex<span class="op">])</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>        GetDis<span class="op">(</span>ex<span class="op">,</span> o<span class="op">,</span> w <span class="op">+</span> edge<span class="op">[</span>i<span class="op">].</span>w<span class="op">);</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> solve<span class="op">(</span><span class="dt">int</span> o<span class="op">)</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>o<span class="op">];</span> i<span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">)</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>vis<span class="op">[</span>ex<span class="op">])</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>        ttt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>        GetDis<span class="op">(</span>ex<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> edge<span class="op">[</span>i<span class="op">].</span>w<span class="op">);</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> ttt<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> now <span class="op">=</span> k <span class="op">-</span> tmp<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> Q <span class="op">=</span> <span class="op">(</span>upper_bound<span class="op">(</span>judge <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> judge <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> tjt<span class="op">,</span> now<span class="op">)</span> <span class="op">-</span> judge <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>            ans <span class="op">+=</span> Q<span class="op">;</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> ttt<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>            judge<span class="op">[++</span>tjt<span class="op">]</span> <span class="op">=</span> tmp<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>        sort<span class="op">(</span>judge <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> judge <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> tjt<span class="op">);</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">+=</span> <span class="op">(</span>upper_bound<span class="op">(</span>judge <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> judge <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> tjt<span class="op">,</span> k<span class="op">)</span> <span class="op">-</span> judge <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>    tjt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> divide<span class="op">(</span><span class="dt">int</span> o<span class="op">)</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>    vis<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    solve<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>o<span class="op">];</span> i<span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">)</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>vis<span class="op">[</span>ex<span class="op">])</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> rt <span class="op">=</span> grt<span class="op">(</span>ex<span class="op">,</span> si<span class="op">[</span>ex<span class="op">]);</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>        divide<span class="op">(</span>rt<span class="op">);</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> read<span class="op">(),</span> v <span class="op">=</span> read<span class="op">(),</span> w <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>        add<span class="op">(</span>u<span class="op">,</span> v<span class="op">,</span> w<span class="op">);</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>        add<span class="op">(</span>v<span class="op">,</span> u<span class="op">,</span> w<span class="op">);</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> rt <span class="op">=</span> grt<span class="op">(</span><span class="dv">1</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>    divide<span class="op">(</span>rt<span class="op">);</span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="çº¿æ®µæ ‘åˆå¹¶">çº¿æ®µæ ‘åˆå¹¶</h2>
<h3 id="æ —é¢˜">æ —é¢˜</h3>
<h4
id="luogu-p4556vaniæœ‰çº¦ä¼šé›¨å¤©çš„å°¾å·´">ã€Œluogu-P4556ã€ã€ŒVaniæœ‰çº¦ä¼šã€é›¨å¤©çš„å°¾å·´</h4>
<p>é¦–å…ˆæ‘è½é‡Œçš„ä¸€å…±æœ‰
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
åº§æˆ¿å±‹ï¼Œå¹¶å½¢æˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ã€‚ç„¶åæ•‘æµç²®åˆ†
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>
æ¬¡å‘æ”¾ï¼Œæ¯æ¬¡é€‰æ‹©ä¸¤ä¸ªæˆ¿å±‹
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x , y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>ï¼Œç„¶åå¯¹äº
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
åˆ°
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>
çš„è·¯å¾„ä¸Š(å«
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
å’Œ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>)æ¯åº§æˆ¿å­é‡Œå‘æ”¾ä¸€è¢‹
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>
ç±»å‹çš„æ•‘æµç²®ã€‚</p>
<p>ç„¶åæ·±ç»˜é‡Œæƒ³çŸ¥é“ï¼Œå½“æ‰€æœ‰çš„æ•‘æµç²®å‘æ”¾å®Œæ¯•åï¼Œæ¯åº§æˆ¿å­é‡Œå­˜æ”¾çš„æœ€å¤šçš„æ˜¯å“ªç§æ•‘æµç²®ã€‚</p>
<p>é‡ç‚¹æ˜¯ç»´æŠ¤æ ‘ä¸Šå·®åˆ†ï¼Œç„¶ååœ¨æ¯ä¸€ä¸ªå¶å­ç»“ç‚¹ï¼Œå»ºç«‹ä¸€æ£µçº¿æ®µæ ‘ï¼Œåˆ°è¾¾æ¯ä¸€ä¸ªéå¶å­ç»“ç‚¹ï¼Œåˆå¹¶å…¶å­èŠ‚ç‚¹çš„çº¿æ®µæ ‘ã€‚</p>
<p>çº¿æ®µæ ‘åº”åŠ¨æ€å¼€ç‚¹ï¼Œä¿è¯ç©ºé—´å¤æ‚åº¦æ­£ç¡®ã€‚</p>
<h4 id="marge">marge</h4>
<p>åˆ†æƒ…å†µè®¨è®ºï¼š</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> marge<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">){</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(!</span>x<span class="op">)</span> <span class="cf">return</span> y<span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(!</span>y<span class="op">)</span> <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>nowl <span class="op">==</span> nowr<span class="op">)</span> <span class="cf">return</span> <span class="op">(</span>Val<span class="op">[</span>x<span class="op">].</span>Max <span class="op">+=</span> Val<span class="op">[</span>y<span class="op">].</span>Max<span class="op">,</span> x<span class="op">);</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    ls<span class="op">(</span>x<span class="op">)</span> <span class="op">=</span> marge<span class="op">(</span>ls<span class="op">(</span>x<span class="op">),</span> ls<span class="op">(</span>y<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">);</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    rs<span class="op">(</span>x<span class="op">)</span> <span class="op">=</span> marge<span class="op">(</span>rs<span class="op">(</span>x<span class="op">),</span> rs<span class="op">(</span>y<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">);</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    maintain<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
                                    </div>

                                    <!-- Article Footer -->
                                    <div class="article-footer">
                                                                            
                                        <section class="post-history">
                                            <div class="history-header">
                                                <h2>ğŸ“š Version History</h2>
                                                <span class="history-desc">Source Code Change History</span>
                                            </div>
                                            <div class="version-list">
                                                
                                                    <div class="version-item">
                                                        <div class="version-header">
                                                            <span class="version-badge">v1</span>
                                                            <time class="version-time" datetime="2020-09-06 20:05:35">
                                                                ğŸ“… 2020-09-06 20:05:35
                                                            </time>
                                                        </div>
                                                        <div class="version-hash-container">
                                                            <span class="hash-label">ğŸ”— Source Hash:</span>
                                                            <code class="version-hash" title="Source Code Hash (4ca42a88e3466fb6413779bc4855e23ae4fae06c6b18cebca98f02b9acdb701a)">4ca42a88e3466fb6413779bc4855e23ae4fae06c6b18cebca98f02b9acdb701a</code>
                                                        </div>
                                                    </div>
                                                
                                            </div>
                                        </section>
                    

                    
                                            <details class="build-logs">
                                                <summary>Build Logs</summary>
                                                <pre class="logs-content">Build Log - Filtered
================================================

ğŸ“‹ Information:
â€¢ Path information has been filtered for privacy protection
â€¢ File names are preserved for debugging purposes  
â€¢ All build status and error messages are kept intact

ğŸ” Filter Rules:
â€¢ /absolute/path/file.ext â†’ .../file.ext
â€¢ /home/username â†’ .../[user]
â€¢ /tmp/files â†’ .../[temp]
â€¢ /usr/share/packages â†’ .../[system]

================================================

html log:
CMD: ['pandoc', '-s', 'cache/oi-blog_ã€Œå­¦ä¹ æ€»ç»“ã€ä¹…æœˆ.md', '--filter', 'pandoc-crossref', '--filter', 'pandoc-katex', '--template=cache/pandoc_html_template.html', '-o', 'cache.../oi-blog_ã€Œå­¦ä¹ æ€»ç»“ã€ä¹…æœˆ.md.html', '--metadata', '--verbose', '--highlight-style=tango']
STDOUT: 
STDERR: WARNING: pandoc-crossref was compiled with pandoc 3.6.2 but is being run through 3.6.4. This is not supported. Strange things may (and likely will) happen silently.

====================================================================================================
pdf log:
CMD: ['pandoc', '-s', 'cache.../2b821c7b61.pdf.md', '-o', 'cache/2b821c7b61.pdf', '-H', 'static/pandoc.header.tex', '--pdf-engine=xelatex', '--verbose']
STDOUT: 
STDERR: [INFO] Loaded static.../pandoc.header.tex from static.../pandoc.header.tex
[INFO] Not rendering RawBlock (Format "html") "<!-- more -->"
[INFO] [makePDF] Temp dir:
  .../[temp]
[INFO] [makePDF] Command line:
  xelatex "-halt-on-error" "-interaction" "nonstopmode" "-output-directory" ".../[temp] ".../[temp]
[INFO] [makePDF] Relevant environment variables:
  ("TEXINPUTS",".../[temp]
  ("TEXMFOUTPUT",".../[temp]
  ("SHELL","/bin/bash")
  ("PWD",".../[user]/projects/blog")
  ("HOME",".../[user]
  ("LANG","zh_CN.UTF-8")
  ("PATH",".../[user]/.local/bin:.../[user]/.cargo/bin:.../[user]/miniconda3/envs/myblog/bin:.../[user]/miniconda3/condabin:.../[temp]
[INFO] [makePDF] Source:
  % Options for packages loaded elsewhere
  \PassOptionsToPackage{unicode}{hyperref}
  \PassOptionsToPackage{hyphens}{url}
  \PassOptionsToPackage{space}{xeCJK}
  \documentclass[
  ]{article}
  \usepackage{xcolor}
  \usepackage[a4paper,margin=2cm]{geometry}
  \usepackage{amsmath,amssymb}
  \setcounter{secnumdepth}{-\maxdimen} % remove section numbering
  \usepackage{iftex}
  \ifPDFTeX
    \usepackage[T1]{fontenc}
    \usepackage[utf8]{inputenc}
    \usepackage{textcomp} % provide euro and other symbols
  \else % if luatex or xetex
    \usepackage{unicode-math} % this also loads fontspec
    \defaultfontfeatures{Scale=MatchLowercase}
    \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
  \fi
  \usepackage{lmodern}
  \ifPDFTeX\else
    % xetex/luatex font selection
    \setmainfont[]{Latin Modern Roman}
    \ifXeTeX
      \usepackage{xeCJK}
      \setCJKmainfont[]{AR PL UKai CN}
    \fi
    \ifLuaTeX
      \usepackage[]{luatexja-fontspec}
      \setmainjfont[]{AR PL UKai CN}
    \fi
  \fi
  % Use upquote if available, for straight quotes in verbatim environments
  \IfFileExists{upquote.sty}{\usepackage{upquote}}{}
  \IfFileExists{microtype.sty}{% use microtype if available
    \usepackage[]{microtype}
    \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
  }{}
  \usepackage{setspace}
  \makeatletter
  \@ifundefined{KOMAClassName}{% if non-KOMA class
    \IfFileExists{parskip.sty}{%
      \usepackage{parskip}
    }{% else
      \setlength{\parindent}{0pt}
      \setlength{\parskip}{6pt plus 2pt minus 1pt}}
  }{% if KOMA class
    \KOMAoptions{parskip=half}}
  \makeatother
  \usepackage{color}
  \usepackage{fancyvrb}
  \newcommand{\VerbBar}{|}
  \newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
  \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
  % Add ',fontsize=\small' for more characters per line
  \newenvironment{Shaded}{}{}
  \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
  \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
  \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.50,0.00}{#1}}
  \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{#1}}}
  \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
  \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
  \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{#1}}
  \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
  \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
  \newcommand{\ExtensionTok}[1]{#1}
  \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{#1}}
  \newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.50,0.00}{\textbf{#1}}}
  \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
  \newcommand{\NormalTok}[1]{#1}
  \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
  \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{#1}}
  \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
  \newcommand{\RegionMarkerTok}[1]{#1}
  \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
  \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
  \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \setlength{\emergencystretch}{3em} % prevent overfull lines
  \providecommand{\tightlist}{%
    \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
  % \usepackage{xeCJK}
  % \setCJKmainfont{AR PL UKai CN}
  % \usepackage{unicode-math}
  
  \setmathfont{Latin Modern Math}
  \usepackage{bookmark}
  \IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
  \urlstyle{same}
  \hypersetup{
    pdftitle={ã€Œå­¦ä¹ æ€»ç»“ã€ä¹…æœˆ},
    pdfauthor={Jiayi Su (ShuYuMo)},
    hidelinks,
    pdfcreator={LaTeX via pandoc}}
  
  \title{ã€Œå­¦ä¹ æ€»ç»“ã€ä¹…æœˆ}
  \author{Jiayi Su (ShuYuMo)}
  \date{2020-09-06 20:05:35}
  
  \begin{document}
  \maketitle
  
  \setstretch{1.3}
  ä¹…æœˆä¹Ÿæ˜¯ä¸ªå¯çˆ±çš„æœˆä»½å‘¢ QAQ\textasciitilde{}
  
  \subsection{ç‚¹åˆ†æ²»}\label{ux70b9ux5206ux6cbb}
  
  ç‚¹åˆ†æ²»ä¸‰è¿ï¼š - Grt( o ): æ‰¾åˆ°ç»“ç‚¹ o æ‰€åœ¨å­æ ‘çš„ ã€‚ - solve( o ): åœ¨ä»¥ç»“ç‚¹
  o ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œå¤„ç†ç»è¿‡ çš„ ã€‚ - divide( o ): ç‚¹åˆ†æ²»ä¸»å‡½æ•°ï¼Œè°ƒç”¨
  \texttt{solve(o)} å¤„ç†ä»¥ o ä¸ºæ ¹ ç»è¿‡ç‚¹ o çš„ä¿¡æ¯ï¼Œç„¶ååˆ é™¤ç‚¹ o
  ï¼Œé€’å½’å¤„ç†å…¶å„¿å­ï¼ˆ\texttt{divide(ex)}ï¼‰
  
  \paragraph{æ³¨æ„}\label{ux6ce8ux610f}
  
  \begin{itemize}
  \tightlist
  \item
    åº”ä¿è¯ \texttt{solve(o)} åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸¥æ ¼ \(O(\text{size}_o)\)
    å¦åˆ™ä¼šå¯¼è‡´æ€»æ—¶é—´å¤æ‚åº¦ä¸æ­£ç¡®ã€‚
  \item
    åº”ä¿è¯ ä¸¤æ¬¡æ‰§è¡Œ \texttt{Grt()}
    ç¬¬äºŒæ¬¡è°ƒç”¨åªæ˜¯ä¸ºäº†ç¡®å®šä»¥é‡å¿ƒä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘å¤§å°ã€‚
  \item
    \texttt{solve(o)}ä¸­å¾€å¾€æ˜¯åœ¨è€ƒè™‘æ‰€æœ‰ä¹‹å‰è®¿é—®è¿‡çš„å­æ ‘ç»“ç‚¹ åˆ°
    å½“å‰åˆšåˆšè®¿é—®çš„ç»“ç‚¹ ä¹‹é—´ç»Ÿè®¡ç­”æ¡ˆã€‚
  \end{itemize}
  
  \subsubsection{ä¾‹é¢˜ 1}\label{ux4f8bux9898-1}
  
  ç»™å®šä¸€æ£µæœ‰ \(n\) ä¸ªç‚¹çš„æ ‘ï¼Œè¯¢é—®æ ‘ä¸Šè·ç¦»ä¸º \(k\) çš„ç‚¹å¯¹æ˜¯å¦å­˜åœ¨ã€‚
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ sum}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ si}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
  \DataTypeTok{bool}\NormalTok{ vis}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
  \DataTypeTok{bool}\NormalTok{ judge}\OperatorTok{[}\DataTypeTok{int}\OperatorTok{(}\FloatTok{1e7} \OperatorTok{+} \DecValTok{100}\OperatorTok{)];}
  \DataTypeTok{int}\NormalTok{ qer}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ MX}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ ans}\OperatorTok{[}\DataTypeTok{int}\OperatorTok{(}\FloatTok{1e7} \OperatorTok{+} \DecValTok{100}\OperatorTok{)];}
  \DataTypeTok{int}\NormalTok{ rt}\OperatorTok{;}
  
  \DataTypeTok{void}\NormalTok{ grt}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ f}\OperatorTok{)}
  \OperatorTok{\{}
  \NormalTok{    si}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    MX}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ MAX }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}\NormalTok{ i}\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{ex }\OperatorTok{==}\NormalTok{ f }\OperatorTok{||}\NormalTok{ vis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])}
              \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        grt}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ o}\OperatorTok{);}
  \NormalTok{        si}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{+=}\NormalTok{ si}\OperatorTok{[}\NormalTok{ex}\OperatorTok{];}
  \NormalTok{        MAX }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{si}\OperatorTok{[}\NormalTok{ex}\OperatorTok{],}\NormalTok{ MAX}\OperatorTok{);}
      \OperatorTok{\}}
  \NormalTok{    MAX }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{MAX}\OperatorTok{,}\NormalTok{ sum }\OperatorTok{{-}}\NormalTok{ si}\OperatorTok{[}\NormalTok{o}\OperatorTok{]);}
  \NormalTok{    MX}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=}\NormalTok{ MAX}\OperatorTok{;}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{MAX }\OperatorTok{\textless{}}\NormalTok{ MX}\OperatorTok{[}\NormalTok{rt}\OperatorTok{])}
  \NormalTok{        rt }\OperatorTok{=}\NormalTok{ o}\OperatorTok{;}
  \OperatorTok{\}}
  
  \DataTypeTok{int}\NormalTok{ cnt }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ tmp}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
  \DataTypeTok{void}\NormalTok{ GetAllDis}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ f}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ dis}\OperatorTok{)}
  \OperatorTok{\{}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{dis }\OperatorTok{\textgreater{}} \FloatTok{1e7}\OperatorTok{)}
          \ControlFlowTok{return}\OperatorTok{;}
  \NormalTok{    tmp}\OperatorTok{[++}\NormalTok{cnt}\OperatorTok{]} \OperatorTok{=}\NormalTok{ dis}\OperatorTok{;}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}\NormalTok{ i}\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{ex }\OperatorTok{==}\NormalTok{ f }\OperatorTok{||}\NormalTok{ vis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])}
              \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        GetAllDis}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ o}\OperatorTok{,}\NormalTok{ dis }\OperatorTok{+}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{w}\OperatorTok{);}
      \OperatorTok{\}}
  \OperatorTok{\}}
  
  \NormalTok{queue}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ Q}\OperatorTok{;}
  \DataTypeTok{void}\NormalTok{ solve}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{)}
  \OperatorTok{\{}
  \NormalTok{    judge}\OperatorTok{[}\DecValTok{0}\OperatorTok{]} \OperatorTok{=} \KeywordTok{true}\OperatorTok{;}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}\NormalTok{ i}\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{vis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])}
              \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        cnt }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{        GetAllDis}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{w}\OperatorTok{);}
          \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ j }\OperatorTok{\textless{}=}\NormalTok{ cnt}\OperatorTok{;}\NormalTok{ j}\OperatorTok{++)}
          \OperatorTok{\{}
              \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ k }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ k }\OperatorTok{\textless{}=}\NormalTok{ m}\OperatorTok{;}\NormalTok{ k}\OperatorTok{++)}
              \OperatorTok{\{}
                  \ControlFlowTok{if} \OperatorTok{(}\NormalTok{qer}\OperatorTok{[}\NormalTok{k}\OperatorTok{]} \OperatorTok{\textgreater{}=}\NormalTok{ tmp}\OperatorTok{[}\NormalTok{j}\OperatorTok{])}
  \NormalTok{                    ans}\OperatorTok{[}\NormalTok{k}\OperatorTok{]} \OperatorTok{|=}\NormalTok{ judge}\OperatorTok{[}\NormalTok{qer}\OperatorTok{[}\NormalTok{k}\OperatorTok{]} \OperatorTok{{-}}\NormalTok{ tmp}\OperatorTok{[}\NormalTok{j}\OperatorTok{]];}
              \OperatorTok{\}}
          \OperatorTok{\}}
          \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ j }\OperatorTok{\textless{}=}\NormalTok{ cnt}\OperatorTok{;}\NormalTok{ j}\OperatorTok{++)}
          \OperatorTok{\{}
  \NormalTok{            judge}\OperatorTok{[}\NormalTok{tmp}\OperatorTok{[}\NormalTok{j}\OperatorTok{]]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{            Q}\OperatorTok{.}\NormalTok{push}\OperatorTok{(}\NormalTok{tmp}\OperatorTok{[}\NormalTok{j}\OperatorTok{]);}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \ControlFlowTok{while} \OperatorTok{(!}\NormalTok{Q}\OperatorTok{.}\NormalTok{empty}\OperatorTok{())}
      \OperatorTok{\{}
  \NormalTok{        judge}\OperatorTok{[}\NormalTok{Q}\OperatorTok{.}\NormalTok{front}\OperatorTok{()]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{        Q}\OperatorTok{.}\NormalTok{pop}\OperatorTok{();}
      \OperatorTok{\}}
  \OperatorTok{\}}
  
  \DataTypeTok{void}\NormalTok{ divide}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{)}
  \OperatorTok{\{}
  \NormalTok{    vis}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    solve}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}\NormalTok{ i}\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{vis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])}
              \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        sum }\OperatorTok{=}\NormalTok{ si}\OperatorTok{[}\NormalTok{ex}\OperatorTok{];}
  \NormalTok{        MX}\OperatorTok{[}\NormalTok{rt }\OperatorTok{=} \DecValTok{0}\OperatorTok{]} \OperatorTok{=}\NormalTok{ INT\_MAX}\OperatorTok{;}
  \NormalTok{        grt}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,} \DecValTok{0}\OperatorTok{);}
  \NormalTok{        grt}\OperatorTok{(}\NormalTok{rt}\OperatorTok{,} \DecValTok{0}\OperatorTok{);}
  \NormalTok{        divide}\OperatorTok{(}\NormalTok{rt}\OperatorTok{);}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()}
  \OperatorTok{\{}
  \NormalTok{    n }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ m }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ u }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ v }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ w }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
  \NormalTok{        add}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{,}\NormalTok{ w}\OperatorTok{);}
  \NormalTok{        add}\OperatorTok{(}\NormalTok{v}\OperatorTok{,}\NormalTok{ u}\OperatorTok{,}\NormalTok{ w}\OperatorTok{);}
      \OperatorTok{\}}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ m}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}
  \NormalTok{        qer}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
  \NormalTok{    sum }\OperatorTok{=}\NormalTok{ n}\OperatorTok{;}
  \NormalTok{    MX}\OperatorTok{[}\NormalTok{rt }\OperatorTok{=} \DecValTok{0}\OperatorTok{]} \OperatorTok{=}\NormalTok{ INT\_MAX}\OperatorTok{;}
  \NormalTok{    grt}\OperatorTok{(}\DecValTok{1}\OperatorTok{,} \DecValTok{0}\OperatorTok{);}
  \NormalTok{    grt}\OperatorTok{(}\NormalTok{rt}\OperatorTok{,} \DecValTok{0}\OperatorTok{);}
  \NormalTok{    divide}\OperatorTok{(}\NormalTok{rt}\OperatorTok{);}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ m}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}
      \OperatorTok{\{}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{ans}\OperatorTok{[}\NormalTok{i}\OperatorTok{])}
  \NormalTok{            puts}\OperatorTok{(}\StringTok{"AYE"}\OperatorTok{);}
          \ControlFlowTok{else}
  \NormalTok{            puts}\OperatorTok{(}\StringTok{"NAY"}\OperatorTok{);}
      \OperatorTok{\}}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{ä¾‹é¢˜ 2}\label{ux4f8bux9898-2}
  
  \paragraph{ã€Œluogu-P2634ã€ã€Œå›½å®¶é›†è®­é˜Ÿã€èªèªå¯å¯}\label{luogu-p2634ux56fdux5bb6ux96c6ux8badux961fux806aux806aux53efux53ef}
  
  ç»™å‡ºä¸€ä¸ªå¸¦æƒæ ‘ï¼Œæ±‚å‡ºæ‰€æœ‰æ»¡è¶³é•¿åº¦ä¸º \(3\) çš„å€æ•°çš„ç®€å•è·¯å¾„æ•°é‡ã€‚
  
  ç»Ÿè®¡æ—¶ï¼Œç»Ÿè®¡æ¯ä¸ªå­æ ‘å†…ï¼Œåˆ†åˆ«ç»Ÿè®¡ æ ¹åˆ°å­æ ‘ä¸­ç»“ç‚¹çš„è·¯å¾„é•¿åº¦
  \(\text{mod}\ 3\) åï¼Œä¸åŒå€¼çš„æ•°é‡ã€‚ åœ¨æ ¹èŠ‚ç‚¹æ‹¼æ¥å³å¯ã€‚
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{;}
  \DataTypeTok{bool}\NormalTok{ vis}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
  \KeywordTok{namespace}\NormalTok{ GetCenter}
  \OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ sum}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ si}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
      \DataTypeTok{int}\NormalTok{ MX}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
      \DataTypeTok{int}\NormalTok{ rt}\OperatorTok{;}
      \DataTypeTok{void}\NormalTok{ dfs}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ f}\OperatorTok{)}
      \OperatorTok{\{}
  \NormalTok{        si}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{        MX}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ MAX }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
          \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}\NormalTok{ i}\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)}
          \OperatorTok{\{}
              \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
              \ControlFlowTok{if} \OperatorTok{(}\NormalTok{ex }\OperatorTok{==}\NormalTok{ f }\OperatorTok{||}\NormalTok{ vis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])}
                  \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{            dfs}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ o}\OperatorTok{);}
  \NormalTok{            si}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{+=}\NormalTok{ si}\OperatorTok{[}\NormalTok{ex}\OperatorTok{];}
  \NormalTok{            MAX }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{MAX}\OperatorTok{,}\NormalTok{ si}\OperatorTok{[}\NormalTok{ex}\OperatorTok{]);}
          \OperatorTok{\}}
  \NormalTok{        MAX }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{MAX}\OperatorTok{,}\NormalTok{ sum }\OperatorTok{{-}}\NormalTok{ si}\OperatorTok{[}\NormalTok{o}\OperatorTok{]);}
  \NormalTok{        MX}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=}\NormalTok{ MAX}\OperatorTok{;}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{MX}\OperatorTok{[}\NormalTok{rt}\OperatorTok{]} \OperatorTok{\textgreater{}}\NormalTok{ MX}\OperatorTok{[}\NormalTok{o}\OperatorTok{])}
  \NormalTok{            rt }\OperatorTok{=}\NormalTok{ o}\OperatorTok{;}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ grt}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ \_sum}\OperatorTok{)}
      \OperatorTok{\{}
  \NormalTok{        MX}\OperatorTok{[}\NormalTok{rt }\OperatorTok{=} \DecValTok{0}\OperatorTok{]} \OperatorTok{=}\NormalTok{ INT\_MAX}\OperatorTok{;}
  \NormalTok{        sum }\OperatorTok{=}\NormalTok{ \_sum}\OperatorTok{;}
  \NormalTok{        dfs}\OperatorTok{(}\NormalTok{o}\OperatorTok{,} \DecValTok{0}\OperatorTok{);}
  \NormalTok{        dfs}\OperatorTok{(}\NormalTok{rt}\OperatorTok{,} \DecValTok{0}\OperatorTok{);}
          \ControlFlowTok{return}\NormalTok{ rt}\OperatorTok{;}
      \OperatorTok{\}}
  \OperatorTok{\}} \CommentTok{// namespace GetCenter}
  \KeywordTok{using}\NormalTok{ GetCenter}\OperatorTok{::}\NormalTok{grt}\OperatorTok{;}
  \KeywordTok{using}\NormalTok{ GetCenter}\OperatorTok{::}\NormalTok{si}\OperatorTok{;}
  
  \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ cnt}\OperatorTok{[}\DecValTok{3}\OperatorTok{];}
  \DataTypeTok{void}\NormalTok{ GetDis}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ f}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ dis}\OperatorTok{)}
  \OperatorTok{\{}
  \NormalTok{    cnt}\OperatorTok{[}\NormalTok{dis }\OperatorTok{\%} \DecValTok{3}\OperatorTok{]++;}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}\NormalTok{ i}\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{ex }\OperatorTok{==}\NormalTok{ f }\OperatorTok{||}\NormalTok{ vis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])}
              \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        GetDis}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ o}\OperatorTok{,}\NormalTok{ dis }\OperatorTok{+}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{w}\OperatorTok{);}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ Bef}\OperatorTok{[}\DecValTok{3}\OperatorTok{];}
  \DataTypeTok{void}\NormalTok{ solve}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{)}
  \OperatorTok{\{}
  \NormalTok{    Bef}\OperatorTok{[}\DecValTok{0}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}\NormalTok{ i}\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{vis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])}
              \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        memset}\OperatorTok{(}\NormalTok{cnt}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{cnt}\OperatorTok{));}
  \NormalTok{        GetDis}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{w}\OperatorTok{);}
          \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}} \DecValTok{3}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}
  \NormalTok{            ans }\OperatorTok{+=}\NormalTok{ Bef}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{*}\NormalTok{ cnt}\OperatorTok{[(}\DecValTok{3} \OperatorTok{{-}}\NormalTok{ i}\OperatorTok{)} \OperatorTok{\%} \DecValTok{3}\OperatorTok{]} \OperatorTok{*} \DecValTok{2}\OperatorTok{;}
  
          \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}} \DecValTok{3}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}
  \NormalTok{            Bef}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{+=}\NormalTok{ cnt}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
      \OperatorTok{\}}
  \NormalTok{    memset}\OperatorTok{(}\NormalTok{Bef}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{Bef}\OperatorTok{));}
  \OperatorTok{\}}
  
  \DataTypeTok{void}\NormalTok{ divide}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{)}
  \OperatorTok{\{}
  \NormalTok{    vis}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \KeywordTok{true}\OperatorTok{;}
  \NormalTok{    solve}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}\NormalTok{ i}\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{vis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])}
              \ControlFlowTok{continue}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ rt }\OperatorTok{=}\NormalTok{ grt}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ si}\OperatorTok{[}\NormalTok{ex}\OperatorTok{]);}
  \NormalTok{        divide}\OperatorTok{(}\NormalTok{rt}\OperatorTok{);}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()}
  \OperatorTok{\{}
  \NormalTok{    n }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ u }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ v }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ w }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
  \NormalTok{        add}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{,}\NormalTok{ w}\OperatorTok{);}
  \NormalTok{        add}\OperatorTok{(}\NormalTok{v}\OperatorTok{,}\NormalTok{ u}\OperatorTok{,}\NormalTok{ w}\OperatorTok{);}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ rt }\OperatorTok{=}\NormalTok{ grt}\OperatorTok{(}\DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{);}
  \NormalTok{    divide}\OperatorTok{(}\NormalTok{rt}\OperatorTok{);}
  \NormalTok{    ans }\OperatorTok{+=}\NormalTok{ n}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ A }\OperatorTok{=}\NormalTok{ ans}\OperatorTok{,}\NormalTok{ B }\OperatorTok{=}\NormalTok{ n }\OperatorTok{*}\NormalTok{ n}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ g }\OperatorTok{=}\NormalTok{ gcd}\OperatorTok{(}\NormalTok{A}\OperatorTok{,}\NormalTok{ B}\OperatorTok{);}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{/}\SpecialCharTok{\%d\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ A }\OperatorTok{/}\NormalTok{ g}\OperatorTok{,}\NormalTok{ B }\OperatorTok{/}\NormalTok{ g}\OperatorTok{);}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \paragraph{æ —é¢˜ 3}\label{ux6817ux9898-3}
  
  \paragraph{ã€Œluogu-P4178ã€èªèªå¯å¯}\label{luogu-p4178ux806aux806aux53efux53ef}
  
  ç»™å®šä¸€æ£µ \(n\) ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ¯æ¡è¾¹æœ‰è¾¹æƒï¼Œæ±‚å‡ºæ ‘ä¸Šä¸¤ç‚¹è·ç¦»å°äºç­‰äº \(k\)
  çš„ç‚¹å¯¹æ•°é‡
  
  å¯¹æ¯ä¸ªå„¿å­ç»Ÿè®¡æ‰€æœ‰å¯èƒ½çš„é•¿åº¦ï¼Œä¹˜æ³•åŸç†ä»¥æ­¤åŒ¹é…å³å¯ã€‚
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ vis}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
  \KeywordTok{namespace}\NormalTok{ GetCenter}
  \OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ si}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
      \DataTypeTok{int}\NormalTok{ MX}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
      \DataTypeTok{int}\NormalTok{ rt}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ sum}\OperatorTok{;}
      \DataTypeTok{void}\NormalTok{ dfs}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ f}\OperatorTok{)}
      \OperatorTok{\{}
  \NormalTok{        si}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ MAX }\OperatorTok{=}\NormalTok{ INT\_MIN}\OperatorTok{;}
          \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}\NormalTok{ i}\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)}
          \OperatorTok{\{}
              \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
              \ControlFlowTok{if} \OperatorTok{(}\NormalTok{ex }\OperatorTok{==}\NormalTok{ f }\OperatorTok{||}\NormalTok{ vis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])}
                  \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{            dfs}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ o}\OperatorTok{);}
  \NormalTok{            si}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{+=}\NormalTok{ si}\OperatorTok{[}\NormalTok{ex}\OperatorTok{];}
  \NormalTok{            MAX }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{si}\OperatorTok{[}\NormalTok{ex}\OperatorTok{],}\NormalTok{ MAX}\OperatorTok{);}
          \OperatorTok{\}}
  \NormalTok{        MAX }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{MAX}\OperatorTok{,}\NormalTok{ sum }\OperatorTok{{-}}\NormalTok{ si}\OperatorTok{[}\NormalTok{o}\OperatorTok{]);}
  \NormalTok{        MX}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=}\NormalTok{ MAX}\OperatorTok{;}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{MAX }\OperatorTok{\textless{}}\NormalTok{ MX}\OperatorTok{[}\NormalTok{rt}\OperatorTok{])}
  \NormalTok{            rt }\OperatorTok{=}\NormalTok{ o}\OperatorTok{;}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ grt}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ \_sum}\OperatorTok{)}
      \OperatorTok{\{}
  \NormalTok{        MX}\OperatorTok{[}\NormalTok{rt }\OperatorTok{=} \DecValTok{0}\OperatorTok{]} \OperatorTok{=}\NormalTok{ INT\_MAX}\OperatorTok{;}
  \NormalTok{        sum }\OperatorTok{=}\NormalTok{ \_sum}\OperatorTok{;}
  \NormalTok{        dfs}\OperatorTok{(}\NormalTok{o}\OperatorTok{,} \DecValTok{0}\OperatorTok{);}
  \NormalTok{        dfs}\OperatorTok{(}\NormalTok{rt}\OperatorTok{,} \DecValTok{0}\OperatorTok{);}
          \ControlFlowTok{return}\NormalTok{ rt}\OperatorTok{;}
      \OperatorTok{\}}
  \OperatorTok{\}} \CommentTok{// namespace GetCenter}
  \KeywordTok{using}\NormalTok{ GetCenter}\OperatorTok{::}\NormalTok{grt}\OperatorTok{;}
  \KeywordTok{using}\NormalTok{ GetCenter}\OperatorTok{::}\NormalTok{si}\OperatorTok{;}
  
  \DataTypeTok{int}\NormalTok{ judge}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{],}\NormalTok{ tjt }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ tmp}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{],}\NormalTok{ ttt }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{void}\NormalTok{ GetDis}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ f}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ w}\OperatorTok{)}
  \OperatorTok{\{}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{w }\OperatorTok{\textgreater{}}\NormalTok{ k}\OperatorTok{)}
          \ControlFlowTok{return}\OperatorTok{;}
  \NormalTok{    tmp}\OperatorTok{[++}\NormalTok{ttt}\OperatorTok{]} \OperatorTok{=}\NormalTok{ w}\OperatorTok{;}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}\NormalTok{ i}\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{ex }\OperatorTok{==}\NormalTok{ f }\OperatorTok{||}\NormalTok{ vis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])}
              \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        GetDis}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ o}\OperatorTok{,}\NormalTok{ w }\OperatorTok{+}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{w}\OperatorTok{);}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{void}\NormalTok{ solve}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{)}
  \OperatorTok{\{}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}\NormalTok{ i}\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{vis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])}
              \ControlFlowTok{continue}\OperatorTok{;}
  
  \NormalTok{        ttt }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{        GetDis}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{w}\OperatorTok{);}
  
          \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ ttt}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}
          \OperatorTok{\{}
              \DataTypeTok{int}\NormalTok{ now }\OperatorTok{=}\NormalTok{ k }\OperatorTok{{-}}\NormalTok{ tmp}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
              \DataTypeTok{int}\NormalTok{ Q }\OperatorTok{=} \OperatorTok{(}\NormalTok{upper\_bound}\OperatorTok{(}\NormalTok{judge }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ judge }\OperatorTok{+} \DecValTok{1} \OperatorTok{+}\NormalTok{ tjt}\OperatorTok{,}\NormalTok{ now}\OperatorTok{)} \OperatorTok{{-}}\NormalTok{ judge }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{);}
  \NormalTok{            ans }\OperatorTok{+=}\NormalTok{ Q}\OperatorTok{;}
          \OperatorTok{\}}
          \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ ttt}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}
  \NormalTok{            judge}\OperatorTok{[++}\NormalTok{tjt}\OperatorTok{]} \OperatorTok{=}\NormalTok{ tmp}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
  \NormalTok{        sort}\OperatorTok{(}\NormalTok{judge }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ judge }\OperatorTok{+} \DecValTok{1} \OperatorTok{+}\NormalTok{ tjt}\OperatorTok{);}
      \OperatorTok{\}}
  \NormalTok{    ans }\OperatorTok{+=} \OperatorTok{(}\NormalTok{upper\_bound}\OperatorTok{(}\NormalTok{judge }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ judge }\OperatorTok{+} \DecValTok{1} \OperatorTok{+}\NormalTok{ tjt}\OperatorTok{,}\NormalTok{ k}\OperatorTok{)} \OperatorTok{{-}}\NormalTok{ judge }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{);}
  \NormalTok{    tjt }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  
  \DataTypeTok{void}\NormalTok{ divide}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{)}
  \OperatorTok{\{}
  \NormalTok{    vis}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \KeywordTok{true}\OperatorTok{;}
  \NormalTok{    solve}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}\NormalTok{ i}\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{vis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])}
              \ControlFlowTok{continue}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ rt }\OperatorTok{=}\NormalTok{ grt}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ si}\OperatorTok{[}\NormalTok{ex}\OperatorTok{]);}
  \NormalTok{        divide}\OperatorTok{(}\NormalTok{rt}\OperatorTok{);}
      \OperatorTok{\}}
  \OperatorTok{\}}
  
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()}
  \OperatorTok{\{}
  \NormalTok{    n }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ u }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ v }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ w }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
  \NormalTok{        add}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{,}\NormalTok{ w}\OperatorTok{);}
  \NormalTok{        add}\OperatorTok{(}\NormalTok{v}\OperatorTok{,}\NormalTok{ u}\OperatorTok{,}\NormalTok{ w}\OperatorTok{);}
      \OperatorTok{\}}
  \NormalTok{    k }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
      \DataTypeTok{int}\NormalTok{ rt }\OperatorTok{=}\NormalTok{ grt}\OperatorTok{(}\DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{);}
  \NormalTok{    divide}\OperatorTok{(}\NormalTok{rt}\OperatorTok{);}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsection{çº¿æ®µæ ‘åˆå¹¶}\label{ux7ebfux6bb5ux6811ux5408ux5e76}
  
  \subsubsection{æ —é¢˜}\label{ux6817ux9898}
  
  \paragraph{ã€Œluogu-P4556ã€ã€ŒVaniæœ‰çº¦ä¼šã€é›¨å¤©çš„å°¾å·´}\label{luogu-p4556vaniux6709ux7ea6ux4f1aux96e8ux5929ux7684ux5c3eux5df4}
  
  é¦–å…ˆæ‘è½é‡Œçš„ä¸€å…±æœ‰ \(n\) åº§æˆ¿å±‹ï¼Œå¹¶å½¢æˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ã€‚ç„¶åæ•‘æµç²®åˆ† \(m\)
  æ¬¡å‘æ”¾ï¼Œæ¯æ¬¡é€‰æ‹©ä¸¤ä¸ªæˆ¿å±‹ \((x , y)\)ï¼Œç„¶åå¯¹äº \(x\) åˆ° \(y\)
  çš„è·¯å¾„ä¸Š(å« \(x\) å’Œ \(y\))æ¯åº§æˆ¿å­é‡Œå‘æ”¾ä¸€è¢‹ \(z\) ç±»å‹çš„æ•‘æµç²®ã€‚
  
  ç„¶åæ·±ç»˜é‡Œæƒ³çŸ¥é“ï¼Œå½“æ‰€æœ‰çš„æ•‘æµç²®å‘æ”¾å®Œæ¯•åï¼Œæ¯åº§æˆ¿å­é‡Œå­˜æ”¾çš„æœ€å¤šçš„æ˜¯å“ªç§æ•‘æµç²®ã€‚
  
  é‡ç‚¹æ˜¯ç»´æŠ¤æ ‘ä¸Šå·®åˆ†ï¼Œç„¶ååœ¨æ¯ä¸€ä¸ªå¶å­ç»“ç‚¹ï¼Œå»ºç«‹ä¸€æ£µçº¿æ®µæ ‘ï¼Œåˆ°è¾¾æ¯ä¸€ä¸ªéå¶å­ç»“ç‚¹ï¼Œåˆå¹¶å…¶å­èŠ‚ç‚¹çš„çº¿æ®µæ ‘ã€‚
  
  çº¿æ®µæ ‘åº”åŠ¨æ€å¼€ç‚¹ï¼Œä¿è¯ç©ºé—´å¤æ‚åº¦æ­£ç¡®ã€‚
  
  \paragraph{marge}\label{marge}
  
  åˆ†æƒ…å†µè®¨è®ºï¼š
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ marge}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ x}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ y}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{)\{}
      \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{x}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ y}\OperatorTok{;}
      \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{y}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ x}\OperatorTok{;}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{nowl }\OperatorTok{==}\NormalTok{ nowr}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{(}\NormalTok{Val}\OperatorTok{[}\NormalTok{x}\OperatorTok{].}\NormalTok{Max }\OperatorTok{+=}\NormalTok{ Val}\OperatorTok{[}\NormalTok{y}\OperatorTok{].}\NormalTok{Max}\OperatorTok{,}\NormalTok{ x}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    ls}\OperatorTok{(}\NormalTok{x}\OperatorTok{)} \OperatorTok{=}\NormalTok{ marge}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{x}\OperatorTok{),}\NormalTok{ ls}\OperatorTok{(}\NormalTok{y}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}
  \NormalTok{    rs}\OperatorTok{(}\NormalTok{x}\OperatorTok{)} \OperatorTok{=}\NormalTok{ marge}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{x}\OperatorTok{),}\NormalTok{ rs}\OperatorTok{(}\NormalTok{y}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{);}
  \NormalTok{    maintain}\OperatorTok{(}\NormalTok{x}\OperatorTok{);}
      \ControlFlowTok{return}\NormalTok{ x}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  
  \end{document}
[INFO] [makePDF] LaTeX run number 1
[INFO] [makePDF] LaTeX output
  This is XeTeX, Version 3.141592653-2.6-0.999995 (TeX Live 2023/Debian) (preloaded format=xelatex)
   restricted \write18 enabled.
  entering extended mode
  (.../input.tex
  LaTeX2e <2023-11-01> patch level 1
  L3 programming layer <2024-01-22>
  (.../article.cls
  Document Class: article 2023/05/17 v1.4n Standard LaTeX document class
  (.../[system]
  (.../xcolor.sty
  (.../color.cfg)
  (.../xetex.def)
  (.../[system]
  (.../geometry.sty
  (.../keyval.sty)
  (.../ifvtex.sty
  (.../iftex.sty)))
  (.../amsmath.sty
  For additional information on amsmath, use the `?' option.
  (.../amstext.sty
  (.../amsgen.sty))
  (.../amsbsy.sty)
  (.../amsopn.sty))
  (.../amssymb.sty
  (.../amsfonts.sty))
  (.../unicode-math.sty
  (.../expl3.sty
  (.../l3backend-xetex.def))
  (.../unicode-math-xetex.sty
  (.../xparse.sty)
  (.../l3keys2e.sty)
  (.../fontspec.sty
  (.../fontspec-xetex.sty
  (.../fontenc.sty)
  (.../fontspec.cfg)))
  (.../fix-cm.sty
  (.../ts1enc.def))
  (.../unicode-math-table.tex)))
  (.../lmodern.sty)
  (.../xeCJK.sty
  (.../ctexhook.sty)
  (.../xtemplate.sty)
  (.../xeCJK.cfg))
  (.../upquote.sty
  (.../textcomp.sty))
  (.../microtype.sty
  (.../etoolbox.sty)
  (.../microtype-xetex.def)
  (.../microtype.cfg))
  (.../setspace.sty)
  (.../parskip.sty
  (.../kvoptions.sty
  (.../ltxcmds.sty)
  (.../kvsetkeys.sty)))
  (.../fancyvrb.sty)
  (.../bookmark.sty
  (.../hyperref.sty
  (.../kvdefinekeys.sty)
  (.../pdfescape.sty
  (.../pdftexcmds.sty
  (.../infwarerr.sty)))
  (.../hycolor.sty)
  (.../auxhook.sty)
  (.../nameref.sty
  (.../refcount.sty)
  (.../gettitlestring.sty))
  (.../pd1enc.def)
  (.../intcalc.sty)
  (.../puenc.def)
  (.../url.sty)
  (.../bitset.sty
  (.../bigintcalc.sty))
  (.../atbegshi-ltx.sty))
  (.../hxetex.def
  (.../stringenc.sty)
  (.../rerunfilecheck.sty
  (.../atveryend-ltx.sty)
  (.../uniquecounter.sty)))
  (.../bkm-dvipdfm.def))
  (.../xurl.sty)
  No file input.aux.
  *geometry* driver: auto-detecting
  *geometry* detected driver: xetex
  (.../mt-LatinModernRoman.cfg)
  
  Package hyperref Warning: Rerun to get /PageLabels entry.
  
  (.../omllmm.fd)
  (.../umsa.fd)
  (.../mt-msa.cfg)
  (.../umsb.fd)
  (.../mt-msb.cfg)
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/b/n' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 116.
  
  
  Package xeCJK Warning: Unknown CJK family `\CJKttdefault' is being ignored.
  (xeCJK)                
  (xeCJK)                Try to use `\setCJKmonofont[<...>]{<...>}' to define
  (xeCJK)                it.
  
  [1] [2] [3] [4] [5] [6] [7] [8] [9] (.../input.aux)
  
  LaTeX Font Warning: Some font shapes were not available, defaults substituted.
  
  
  LaTeX Warning: Label(s) may have changed. Rerun to get cross-references right.
  
   )
  Output written on .../input.pdf (9 pages).
  Transcript written on .../input.log.
[INFO] [makePDF] Rerun needed
  Package hyperref Warning: Rerun to get /PageLabels entry.
  LaTeX Warning: Label(s) may have changed. Rerun to get cross-references right.
[INFO] [makePDF] LaTeX run number 2
[INFO] [makePDF] LaTeX output
  This is XeTeX, Version 3.141592653-2.6-0.999995 (TeX Live 2023/Debian) (preloaded format=xelatex)
   restricted \write18 enabled.
  entering extended mode
  (.../input.tex
  LaTeX2e <2023-11-01> patch level 1
  L3 programming layer <2024-01-22>
  (.../article.cls
  Document Class: article 2023/05/17 v1.4n Standard LaTeX document class
  (.../[system]
  (.../xcolor.sty
  (.../color.cfg)
  (.../xetex.def)
  (.../[system]
  (.../geometry.sty
  (.../keyval.sty)
  (.../ifvtex.sty
  (.../iftex.sty)))
  (.../amsmath.sty
  For additional information on amsmath, use the `?' option.
  (.../amstext.sty
  (.../amsgen.sty))
  (.../amsbsy.sty)
  (.../amsopn.sty))
  (.../amssymb.sty
  (.../amsfonts.sty))
  (.../unicode-math.sty
  (.../expl3.sty
  (.../l3backend-xetex.def))
  (.../unicode-math-xetex.sty
  (.../xparse.sty)
  (.../l3keys2e.sty)
  (.../fontspec.sty
  (.../fontspec-xetex.sty
  (.../fontenc.sty)
  (.../fontspec.cfg)))
  (.../fix-cm.sty
  (.../ts1enc.def))
  (.../unicode-math-table.tex)))
  (.../lmodern.sty)
  (.../xeCJK.sty
  (.../ctexhook.sty)
  (.../xtemplate.sty)
  (.../xeCJK.cfg))
  (.../upquote.sty
  (.../textcomp.sty))
  (.../microtype.sty
  (.../etoolbox.sty)
  (.../microtype-xetex.def)
  (.../microtype.cfg))
  (.../setspace.sty)
  (.../parskip.sty
  (.../kvoptions.sty
  (.../ltxcmds.sty)
  (.../kvsetkeys.sty)))
  (.../fancyvrb.sty)
  (.../bookmark.sty
  (.../hyperref.sty
  (.../kvdefinekeys.sty)
  (.../pdfescape.sty
  (.../pdftexcmds.sty
  (.../infwarerr.sty)))
  (.../hycolor.sty)
  (.../auxhook.sty)
  (.../nameref.sty
  (.../refcount.sty)
  (.../gettitlestring.sty))
  (.../pd1enc.def)
  (.../intcalc.sty)
  (.../puenc.def)
  (.../url.sty)
  (.../bitset.sty
  (.../bigintcalc.sty))
  (.../atbegshi-ltx.sty))
  (.../hxetex.def
  (.../stringenc.sty)
  (.../rerunfilecheck.sty
  (.../atveryend-ltx.sty)
  (.../uniquecounter.sty)))
  (.../bkm-dvipdfm.def))
  (.../xurl.sty)
  (.../input.aux)
  *geometry* driver: auto-detecting
  *geometry* detected driver: xetex
  (.../mt-LatinModernRoman.cfg)
  (.../omllmm.fd)
  (.../umsa.fd)
  (.../mt-msa.cfg)
  (.../umsb.fd)
  (.../mt-msb.cfg)
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/b/n' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 116.
  
  
  Package xeCJK Warning: Unknown CJK family `\CJKttdefault' is being ignored.
  (xeCJK)                
  (xeCJK)                Try to use `\setCJKmonofont[<...>]{<...>}' to define
  (xeCJK)                it.
  
  [1] [2] [3] [4] [5] [6] [7] [8] [9] (.../input.aux)
  
  LaTeX Font Warning: Some font shapes were not available, defaults substituted.
  
   )
  Output written on .../input.pdf (9 pages).
  Transcript written on .../input.log.
</pre>
                                            </details>
                    
                                    </div>
                                </article>
                

                

                

                

            

                
                        </div>
                    </main>
            </div>

                <!-- Footer -->
                <footer id="footer">
                    <p>Â© 2025 ShuYuMo's Blog by Jiayi Su. All rights reserved.</p>  Powered by <b>MonoPy</b> - Single-Script Blog Generator in Python.
                </footer>
            </div>
        </div>
        
        <!-- Back to top button -->
        <button id="back-to-top" 
                aria-label="Back to top" 
                title="Back to top"
                style="display: none;">
            â†‘
        </button>
        
        <!-- JavaScript -->
        <script>
            // Back to top functionality
            (function() {
                const backToTopButton = document.getElementById('back-to-top');
                const scrollThreshold = 300;
                
                function toggleBackToTop() {
                    if (window.scrollY > scrollThreshold) {
                        backToTopButton.style.display = 'block';
                    } else {
                        backToTopButton.style.display = 'none';
                    }
                }
                
                function scrollToTop() {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                }
                
                window.addEventListener('scroll', toggleBackToTop);
                backToTopButton.addEventListener('click', scrollToTop);
            })();
            
            // Clean up redundant spans in code blocks
            document.querySelectorAll('pre code').forEach(codeBlock => {
                // Find all line spans
                const lineSpans = codeBlock.querySelectorAll('span[id^="cb"]');
                
                lineSpans.forEach(lineSpan => {
                    // Check if this line has nested spans that can be simplified
                    const children = Array.from(lineSpan.childNodes);
                    
                    // Skip the anchor link (first child is usually the line number anchor)
                    let contentStart = 0;
                    if (children[0] && children[0].tagName === 'A') {
                        contentStart = 1;
                    }
                    
                    // If there's only one span child after the anchor, unwrap it
                    const contentChildren = children.slice(contentStart);
                    if (contentChildren.length === 1 && contentChildren[0].tagName === 'SPAN') {
                        const spanChild = contentChildren[0];
                        // Move the span's contents directly to the line span
                        while (spanChild.firstChild) {
                            lineSpan.insertBefore(spanChild.firstChild, spanChild);
                        }
                        // Remove the now-empty span
                        spanChild.remove();
                    }
                });
            });
            
            // Code copy functionality
            document.querySelectorAll('pre code').forEach(block => {
                const button = document.createElement('button');
                button.className = 'copy-button';
                button.textContent = 'Copy';
                button.setAttribute('aria-label', 'Copy code to clipboard');
                
                button.addEventListener('click', function() {
                    navigator.clipboard.writeText(block.textContent).then(() => {
                        button.textContent = 'Copied!';
                        setTimeout(() => button.textContent = 'Copy', 2000);
                    }).catch(() => {
                        // Fallback for older browsers
                        const textArea = document.createElement('textarea');
                        textArea.value = block.textContent;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        button.textContent = 'Copied!';
                        setTimeout(() => button.textContent = 'Copy', 2000);
                    });
                });
                
                const pre = block.parentNode;
                pre.style.position = 'relative';
                pre.appendChild(button);
            });
        </script>
    </body>
</html>