<!-- Academic Blog Template
MIT License - Copyright (c) 2025 Su Jiayi <sujiayi2003@gmail.com>
-->

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        
        <!-- Primary Meta Tags -->
        <title>ShuYuMo&#39;s Blog | Jiayi Su</title>
        <meta name="description" content="‰∏Ä‰∫õÂ•áÂ•áÊÄ™ÊÄ™ÁöÑ INFP ÈöèÁ¢éÁ¢éÂøµ„ÄÇ">
        <meta name="keywords" content="nb1, nb2, nb3">
        <meta name="author" content="Su Jiayi">
        
        <!-- Open Graph Meta Tags -->
        <meta property="og:type" content="website">
        <meta property="og:title" content="ShuYuMo&#39;s Blog | Jiayi Su">
        <meta property="og:description" content="‰∏Ä‰∫õÂ•áÂ•áÊÄ™ÊÄ™ÁöÑ INFP ÈöèÁ¢éÁ¢éÂøµ„ÄÇ">
        <meta property="og:image" content="../static/images/header.jpg">
        
        <!-- Stylesheets -->
        <link rel="stylesheet" type="text/css" href="../static/css/default.css">
        <link rel="stylesheet" type="text/css" href="../static/css/syntax.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
        
        <!-- Google Analytics -->
        
    </head>
    <body>
        <!-- Skip to main content for accessibility -->
        <a href="#main-content" class="skip-link">Skip to main content</a>
        
        <div id="main">
            <div class="main-container">
                <!-- Header -->
                <header id="header">
                    <div class="header-content">
                        <h1 class="header-title">
                            <a href="./">ShuYuMo&#39;s Blog</a>
                        </h1>
                        <p class="header-subtitle">‰∏Ä‰∫õÂ•áÂ•áÊÄ™ÊÄ™ÁöÑ INFP ÈöèÁ¢éÁ¢éÂøµ„ÄÇ</p>
                        <div class="header-accent"></div>
                    </div>
                </header>
                
                <!-- Content Layout -->
                <div class="content-wrapper">
                    <!-- Sidebar -->
                    <nav id="sidebar">
                        <div class="profile-section">
                            <a href="./" class="profile-avatar-link">
                                <img src="../static/images/header.jpg" alt="ShuYuMo&#39;s header" class="profile-avatar" loading="lazy" />
                            </a>
                            <div class="profile-info">
                                <h3 class="profile-name">Jiayi Su (ShuYuMo)</h3>
            </div>
            </div>

                        <div class="nav-header">
                            <h2>üß≠ Navigation</h2>
                            <span class="nav-subtitle">Explore the site</span>
                        </div>
                        <nav class="nav-menu">
                            
                            
                            <a href="./_post.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">Posts</span>
                                
                            </a>
                            
                            
                            <a href="./_archive.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">Archive</span>
                                
                            </a>
                            
                            
                            <a href="./_category.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">Category</span>
                                
                            </a>
                            
                            
                            <a href="./_about.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">About</span>
                                
                            </a>
                            
                        </nav>
                    </nav>

                    <!-- Main Content -->
                    <main id="content">
                        <div id="main-content">
                            
                                <article>
                                    <!-- Article Header with Title and Actions -->
                                    <div class="article-header">
                                        <div class="article-title-section">
                                            
                                                <h1 class="article-title">„ÄåÂ≠¶‰π†ÊÄªÁªì„ÄçÊ∏ÖÂåóÂ≠¶Â†Ç ÂçÅËøûÊµã</h1>
                                            
                                            
                                            <!-- Article Meta Information -->
                                            <div class="article-meta">
                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">üìÖ</span>
                                                        <span class="meta-label">Last Updated: </span>
                                                        <span class="meta-value">2020-12-01</span>
                                                    </div>
                                                
                                                
                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">üìä</span>
                                                        <span class="meta-label">Word Count: </span>
                                                        <span class="meta-value">2466</span>
                                                    </div>
                    

                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">‚è±Ô∏è</span>
                                                        <span class="meta-label">Estimated Reading Time: </span>
                                                        <span class="meta-value">16 minutes</span>
                                                    </div>
                                                
                                            </div>
                                        </div>
                                        
                                        <div class="article-actions">
                    
                                                <a href="../pdf/oi-blog_„ÄåÂ≠¶‰π†ÊÄªÁªì„ÄçÊ∏ÖÂåóÂ≠¶Â†Ç-ÂçÅËøûÊµã.pdf" 
                                                   target="_blank" 
                                                   rel="noopener"
                                                   class="action-btn pdf-btn">
                                                    üìÑ PDF
                                                </a>
                                            
                                            
                                            
                                                <a href="../src/oi-blog/„ÄåÂ≠¶‰π†ÊÄªÁªì„ÄçÊ∏ÖÂåóÂ≠¶Â†Ç-ÂçÅËøûÊµã.md" 
                                                   target="_blank" 
                                                   rel="noopener"
                                                   class="action-btn source-btn">
                                                    üìù Source
                                                </a>
                                            
                                        </div>
                                    </div>

                                    <!-- Article Content -->
                                    <div class="article-content">
                                        <p>ÊµéÂçó Ê∏ÖÂåóÂ≠¶Â†ÇÔºåNOIPËÄÉÂâçÂçÅËøûÊµãÔºåÈ¢òÁõÆÊï¥ÁêÜ„ÄÇ <!-- more --> # Ê∏ÖÂåóÂ≠¶Â†Ç 10
ËøûÊµã</p>
<h2 id="round-1">Round 1</h2>
<h3 id="a.-yist">A. yist</h3>
<p>ÁªôÂá∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
Ê±Ç
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">!</mo><mi mathvariant="normal">mod</mi><mo>‚Å°</mo><msup><mn>2</mn><mn>32</mn></msup></mrow><annotation encoding="application/x-tex">n! \operatorname{mod} 2^{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord mathnormal">n</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm">mod</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span></span></span></span>„ÄÇ</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    A<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">50</span><span class="op">)</span> A<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>A<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">*</span> i<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> T <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>T<span class="op">--){</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>x <span class="op">&lt;=</span> <span class="dv">50</span><span class="op">)</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%llu\n</span><span class="st">&quot;</span><span class="op">,</span> A<span class="op">[</span>x<span class="op">]);</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> puts<span class="op">(</span><span class="st">&quot;0&quot;</span><span class="op">);</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="b.-ernd">B. ernd</h3>
<p>Êúâ‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>√ó</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n\times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>
ÁöÑÁΩëÊ†ºÔºåÁΩëÊ†º‰∏äÁöÑÊï∞Â≠óÈÉΩÂú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mi>m</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1,nm]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">nm</span><span class="mclose">]</span></span></span></span>
‰πãÈó¥‰∏î‰∏§‰∏§‰∏çÂêå„ÄÇ</p>
<p>Êúâ‰∏™ÈôêÂà∂ÔºåÁõ¥ËßÇÊèèËø∞ÊòØ‰ΩçÁΩÆÂ∑¶„ÄÅ‰∏äÁöÑÊ†ºÂ≠êÂøÖÈ°ªÊØîÂè≥„ÄÅ‰∏ãÁöÑÊ†ºÂ≠êÂ∞èÔºåÁ≤æÁ°ÆÂú∞ËØ¥Ôºö<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>&lt;</mo><msub><mi>A</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo separator="true">,</mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>&lt;</mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">A_{i,j} &lt; A_{i+1,j},A_{i,j} &lt; A_{i,j+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>
ÂøÖÈ°ªÊàêÁ´ãÔºåÂ¶ÇÊûú‰∏çÁ≠âÂºè‰∏≠ÁöÑ‰∏§‰∏™‰ΩçÁΩÆÈÉΩÂú®ÁΩëÊ†ºÂÜÖÁöÑËØù„ÄÇ</p>
<p>‰Ω†ÊÉ≥Áü•ÈÅìÂØπ‰∫é‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ÔºåÊúâÂ§öÂ∞ë‰∏™Ê†ºÂ≠êÁöÑÂÄºÂèØ‰ª•ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ÔºàÂç≥Â≠òÂú®‰∏ÄÁßçÁΩëÊ†ºÔºå‰ΩøÂæóÂÆÉÁöÑÂÄºÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>Ôºâ„ÄÇ</p>
<p>ËÄÉËôëÊØè‰∏™‰ΩçÁΩÆ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>
ËÉΩÂ°´Âì™‰∫õÊï∞Â≠óÔºåËøô‰∏™‰ΩçÁΩÆÂà∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>
ÂΩ¢ÊàêÁöÑÁü©ÂΩ¢‰∏≠ÁöÑÂÄºÈÉΩË¶ÅÂ§ß‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>
ÁöÑÂÄºÔºåËøô‰∏™‰ΩçÁΩÆÂà∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n, m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span></span></span></span>
ÂêåÁêÜ„ÄÇ</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ans<span class="op">[</span>_T<span class="op">],</span> C<span class="op">[</span>_T<span class="op">];</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> work<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span>  m<span class="op">){</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    memset<span class="op">(</span>C<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>C<span class="op">));</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> m<span class="op">){</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> L <span class="op">=</span> i <span class="op">*</span> j<span class="op">,</span> R <span class="op">=</span> n <span class="op">*</span> m <span class="op">-</span> <span class="op">((</span>n <span class="op">-</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span>m <span class="op">-</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        C<span class="op">[</span>L<span class="op">]++;</span> C<span class="op">[</span>R <span class="op">+</span> <span class="dv">1</span><span class="op">]--;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> now <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n <span class="op">*</span> m<span class="op">)</span> now <span class="op">+=</span> C<span class="op">[</span>i<span class="op">],</span> ans<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> now<span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> q <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>q<span class="op">--)</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">[</span>read<span class="op">()]);</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="c.-sanrd">C. sanrd</h3>
<p>Â∞èYÊúâ‰∏Ä‰∏™ÊéíÂàó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mn>1..</mn><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{1..n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1..</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>Ôºå‰Ωú‰∏∫Âº∫Ëø´ÁóáÊÇ£ËÄÖÔºåÂ•πÊÉ≥Ë¶ÅÊääÊéíÂàóÊéíÂ•ΩÂ∫è„ÄÇÂÖ±Êúâ
3 ÁßçÊìç‰Ωú„ÄÇ</p>
<p>Ëä±Ë¥π
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>
ÁöÑ‰ª£‰ª∑‰∫§Êç¢Áõ∏ÈÇª‰∏§‰∏™Êï∞„ÄÇ</p>
<p>Ëä±Ë¥π
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>
ÁöÑ‰ª£‰ª∑ÁøªËΩ¨Êï¥‰∏™ÊéíÂàó„ÄÇ</p>
<p>Ëä±Ë¥π
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>
ÁöÑ‰ª£‰ª∑Êâì‰π±Êï¥‰∏™ÊéíÂàóÔºåÊñ∞ÊéíÂàóÈöèÊú∫ÁîüÊàê„ÄÇ</p>
<p>Â∞èYÈúÄË¶ÅÁü•ÈÅìÔºåÂú®ÊúÄ‰ºòÁ≠ñÁï•‰∏ãÔºåÂ•πÈúÄË¶ÅËä±Ë¥πÂ§öÂ§ßÁöÑ‰ª£‰ª∑Âë¢Ôºü</p>
<p>ÊúÄ‰ºòÁöÑÊìç‰ΩúÔºåÊòæÁÑ∂ÊòØÂÖàÊâì‰π±ÊéíÂàóÔºàÂ¶ÇÊûúÊúâÔºâÔºåÂÜçÁøªËΩ¨ÊéíÂàóÔºàÂ¶ÇÊûúÊúâÔºâÔºåÊúÄÂêé‰∫§Êç¢Áõ∏ÈÇª‰∏§‰∏™Êï∞ÔºàÂ¶ÇÊûúÊúâÔºâ„ÄÇ</p>
<h4 id="Âá†‰∏™‰∫ãÂÆû">Âá†‰∏™‰∫ãÂÆû</h4>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mo>&gt;</mo><msub><mi>A</mi><mi>j</mi></msub><mo separator="true">,</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>=</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">A_i &gt; A_j, i + 1 = j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>
ÊòØ‰∫§Êç¢Áõ∏ÈÇª‰∏§‰∏™Êï∞Â≠óÁöÑÂøÖË¶ÅÊù°‰ª∂„ÄÇ</li>
<li>ÊâßË°å‰∏ÄÊ¨°‰∫§Êç¢Êìç‰ΩúÈÄÜÂ∫èÂØπÊï∞Èáè‰ºöÂáèÂ∞ë‰∏î‰ªÖÂáèÂ∞ë‰∏Ä„ÄÇ</li>
<li>Á≠îÊ°àÂè™‰∏éÈÄÜÂ∫èÂØπÊï∞ÈáèÊúâÂÖ≥„ÄÇ</li>
<li>Êâì‰π±ÂêéÈöèÊú∫ÁîüÊàêÁöÑ‰ª£‰ª∑Â∞±ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>
+ ÈïøÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÊâÄÊúâÊéíÂàóÊéíÂ•Ω‰ª£‰ª∑ÁöÑÂπ≥ÂùáÂÄº„ÄÇÂè™Ë¶Å‰ΩøÁî®ÊúÄÂêé‰∏ÄÁßçÊìç‰ΩúÔºåÈÇ£‰πà‰ªñ‰ª¨ÁöÑÁ≠îÊ°à‰∏ÄÂÆöÁõ∏Âêå„ÄÇ</li>
</ul>
<p>ËÆæÊéíÂàó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>P</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[P]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">]</span></span></span></span>
ÁöÑÈÄÜÂ∫èÂØπÊï∞‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
ÔºåÂ¶ÇÊûúÂè™‰ΩøÁî®Ââç‰∏§ÁßçÊìç‰ΩúÔºå ‰ª£‰ª∑Â∞±ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">min</mi><mo>‚Å°</mo><mo stretchy="false">{</mo><mrow><mo fence="true">(</mo><mfrac><mrow><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac><mo>‚àí</mo><mi>x</mi><mo fence="true">)</mo></mrow><mo>√ó</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo separator="true">,</mo><mi>x</mi><mo>√ó</mo><mi>a</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\operatorname{min}\{\left(\frac{n(n - 1)}{2} - x\right) \times a + b, x \times a\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mop"><span class="mord mathrm">min</span></span><span class="mopen">{</span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mclose">}</span></span></span></span>„ÄÇ
Êää
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[p]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span></span></span></span>
ÁöÑÊâÄÊúâÊéíÂàóÊåâÁÖßÂè™Áî®Ââç‰∏§ÁßçÊìç‰ΩúÁöÑËä±Ë¥πÊéíÂ•ΩÂ∫èÔºåÈÇ£‰πàÂèØËÉΩ‰ΩøÁî®ÊúÄÂêé‰∏ÄÁßçÊìç‰ΩúÁöÑ‰∏ÄÂÆöÊòØ‰∏ÄÊÆµÂêéÁºÄ„ÄÇ</p>
<p>‰ª•
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[p]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span></span></span></span>
ÁöÑÊâÄÊúâÊéíÂàóÊåâÁÖßÂè™Áî®Ââç‰∏§ÁßçÊìç‰ΩúÁöÑËä±Ë¥πÊéíÂ•ΩÂ∫èÁöÑ‰∏ãÊ†á‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
ËΩ¥Ôºå‰ª£‰ª∑‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>
ËΩ¥ÔºåÈÇ£‰πàÂè™Áî®Ââç‰∏§ÁßçÊìç‰ΩúÂ∞±ÊòØÁªøËâ≤ÁöÑÂõæÂÉè„ÄÇ
Â¶ÇÊûúÂØπÊüê‰∫õÊéíÂàó‰ΩøÁî®Á¨¨‰∏âÁßçÊìç‰ΩúÔºåÂèØ‰ª•Áî®Ê©ôËâ≤ÁöÑÂõæÂÉèË°®Á§∫„ÄÇ <img
src="/post_images/qbxt_Round0_C.png" alt="Round0_C.png" />
ÂÖ∂‰∏≠Ë¢´ÂáΩÊï∞ÂÄºÂéãÂπ≥ÁöÑÈÉ®ÂàÜÂ∞±ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>
+ ÊâÄÊúâÊéíÂàó‰ª£‰ª∑ÁöÑÂπ≥ÂùáÂÄº„ÄÇ
Êûö‰∏æÊòØÂ§öÈïøÁöÑÂêéÁºÄË¢´ÂéãÂπ≥Ôºà‰ΩøÁî®Á¨¨‰∏âÁßçÊìç‰ΩúÔºâ„ÄÇÁÑ∂ÂêéËß£ÊñπÁ®ãËß£Âá∫ÂáΩÊï∞ÂÄºÂπ≥ÂùáÂÄºÔºåÈÄâÂèñÊúÄÂ∞èÁöÑÂπ≥ÂùáÂÄºÂç≥ÂèØ„ÄÇ</p>
<p>Â¶ÇÊûúÊéíÂàóÊï∞ÊØîËæÉÂ§öÔºåÊó†Ê≥ï‰∏Ä‰∏™‰∏Ä‰∏™ÁöÑÁÆóÂá∫Êù•ÔºåÂèØ‰ª•ÈÄöËøá dp Ê±ÇÂá∫ÈïøÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÊéíÂàóÔºåÈÄÜÂ∫èÂØπ‰∏™Êï∞‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÁöÑÊéíÂàóÊï∞„ÄÇÂèØ‰ª•Ê≥®ÊÑèÂà∞ÔºåÈÄÜÂ∫èÂØπÊï∞Áõ∏ÂêåÁöÑÊéíÂàóÔºåÁ≠îÊ°à‰∏ÄÂÆöÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂèØ‰ª•ÊääÈÄÜÂ∫èÂØπÊòØÁõ∏ÂêåÁöÑÊéíÂàóÊçÜÁªëËÆ°ÁÆóÔºåÈÄÜÂ∫èÂØπÊï∞‰∏ÄÂÖ±Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>n</mi><mo>√ó</mo><mo stretchy="false">(</mo><mi>n</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\frac{n \times (n - 1)}{2} + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">√ó</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>
ÁßçÂèñÂÄº„ÄÇ</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cmath&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cmath&gt;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;climits&gt;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;assert.h&gt;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#define LL </span><span class="dt">long</span><span class="pp"> </span><span class="dt">long</span><span class="pp"> </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#define int </span><span class="dt">long</span><span class="pp"> </span><span class="dt">long</span><span class="pp"> </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="pp">#define rep</span><span class="op">(</span>i<span class="op">,</span><span class="pp"> </span>l<span class="op">,</span><span class="pp"> </span>r<span class="op">)</span><span class="pp"> </span><span class="cf">for</span><span class="op">(</span><span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="op">(</span>l<span class="op">),</span><span class="pp"> </span>___<span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="op">(</span>r<span class="op">);</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">&lt;=</span><span class="pp"> </span>___<span class="op">;</span><span class="pp"> </span>i<span class="op">++)</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="pp">#define per</span><span class="op">(</span>i<span class="op">,</span><span class="pp"> </span>l<span class="op">,</span><span class="pp"> </span>r<span class="op">)</span><span class="pp"> </span><span class="cf">for</span><span class="op">(</span><span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="op">(</span>r<span class="op">),</span><span class="pp"> </span>___<span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="op">(</span>l<span class="op">);</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">&gt;=</span><span class="pp"> </span>___<span class="op">;</span><span class="pp"> </span>i<span class="op">--)</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> <span class="dt">Read_t</span><span class="op">{</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">template</span><span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span> <span class="at">const</span> <span class="dt">Read_t</span> <span class="op">&amp;</span> <span class="kw">operator</span><span class="op">()</span> <span class="op">(</span> T <span class="op">&amp;</span> target <span class="op">)</span> <span class="at">const</span> <span class="op">{</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        T x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="dt">int</span> sign <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="dt">char</span> c <span class="op">=</span> getchar<span class="op">();</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(</span>c <span class="op">&lt;</span> <span class="ch">&#39;0&#39;</span> <span class="op">||</span> c <span class="op">&gt;</span> <span class="ch">&#39;9&#39;</span><span class="op">)</span> <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>c <span class="op">==</span> <span class="ch">&#39;-&#39;</span><span class="op">)</span> sign <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span> c <span class="op">=</span> getchar<span class="op">();</span> <span class="op">}</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(</span>c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span><span class="op">)</span> <span class="op">{</span> x <span class="op">=</span> <span class="op">(</span>x <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>x <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">);</span> x <span class="op">+=</span> c <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">;</span> c <span class="op">=</span> getchar<span class="op">();</span> <span class="op">}</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        target <span class="op">=</span> x <span class="op">*</span> sign<span class="op">;</span> <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Read<span class="op">;</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="pp">#warning dont forget enable int_64</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _N <span class="op">=</span> <span class="dv">500</span><span class="op">;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _S <span class="op">=</span> <span class="dv">500</span><span class="op">;</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>LL gcd<span class="op">(</span>LL a<span class="op">,</span> LL b<span class="op">){</span> <span class="cf">return</span> b <span class="op">==</span> <span class="dv">0</span> <span class="op">?</span> a <span class="op">:</span> gcd<span class="op">(</span>b<span class="op">,</span>  a <span class="op">%</span> b<span class="op">);</span> <span class="op">}</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>LL dp<span class="op">[</span>_N<span class="op">][</span>_S<span class="op">];</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>LL n<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> c<span class="op">,</span> d<span class="op">;</span> </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="pp">#define pb </span>push_back</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="pp">#define mp </span>make_pair</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="pp">#define fi </span>first</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="pp">#define se </span>second</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>pair<span class="op">&lt;</span>LL<span class="op">,</span> LL<span class="op">&gt;</span> Val<span class="op">[</span>_S<span class="op">];</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> <span class="kw">operator</span> <span class="op">&gt;</span> <span class="op">(</span>pair<span class="op">&lt;</span>LL<span class="op">,</span> LL<span class="op">&gt;</span> A<span class="op">,</span> pair<span class="op">&lt;</span>LL<span class="op">,</span> LL<span class="op">&gt;</span> B<span class="op">){</span> <span class="cf">return</span> <span class="op">(</span>A<span class="op">.</span>fi <span class="op">*</span> B<span class="op">.</span>se <span class="op">&gt;</span> A<span class="op">.</span>se <span class="op">*</span> B<span class="op">.</span>fi<span class="op">);</span> <span class="op">}</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>LL A<span class="op">[</span>_S<span class="op">];</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> doit<span class="op">(){</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">)(</span>a<span class="op">)(</span>b<span class="op">)(</span>c<span class="op">)(</span>d<span class="op">);</span> vector<span class="op">&lt;</span>pair<span class="op">&lt;</span>LL<span class="op">,</span> LL<span class="op">&gt;</span> <span class="op">&gt;</span> V<span class="op">;</span> V<span class="op">.</span>clear<span class="op">();</span> </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="op">(</span>n<span class="op">)</span> <span class="op">*</span> <span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">)</span> V<span class="op">.</span>pb<span class="op">(</span>mp<span class="op">(</span>min<span class="op">(</span>i <span class="op">*</span> a<span class="op">,</span> <span class="op">((</span>n <span class="op">*</span> <span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">)</span> <span class="op">-</span> i<span class="op">)</span> <span class="op">*</span> a <span class="op">+</span> b<span class="op">),</span> dp<span class="op">[</span>n<span class="op">][</span>i<span class="op">]));</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>V<span class="op">.</span>begin<span class="op">(),</span> V<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>L<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> V<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> R <span class="op">=</span> L<span class="op">;</span> <span class="cf">while</span><span class="op">(</span>V<span class="op">[</span>R <span class="op">+</span> <span class="dv">1</span><span class="op">].</span>fi <span class="op">==</span> V<span class="op">[</span>L<span class="op">].</span>fi <span class="op">&amp;&amp;</span> R <span class="op">+</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)(</span>V<span class="op">.</span>size<span class="op">())</span> <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> R<span class="op">++;</span> LL sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> L<span class="op">,</span> R<span class="op">)</span> sum <span class="op">+=</span> V<span class="op">[</span>i<span class="op">].</span>se<span class="op">;</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        V<span class="op">[</span>tot<span class="op">].</span>fi <span class="op">=</span> V<span class="op">[</span>L<span class="op">].</span>fi<span class="op">;</span> V<span class="op">[</span>tot<span class="op">].</span>se <span class="op">=</span> sum<span class="op">;</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        tot<span class="op">++;</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        L <span class="op">=</span> R<span class="op">;</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> LL S <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> tot <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> S <span class="op">+=</span> V<span class="op">[</span>i<span class="op">].</span>se<span class="op">;</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> tot <span class="op">-</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>        LL cnt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> rep<span class="op">(</span>j<span class="op">,</span> i<span class="op">,</span> tot <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> cnt <span class="op">+=</span> V<span class="op">[</span>j<span class="op">].</span>se<span class="op">;</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        LL A <span class="op">=</span> cnt <span class="op">*</span> c<span class="op">;</span>  rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> A <span class="op">+=</span> V<span class="op">[</span>j<span class="op">].</span>fi <span class="op">*</span> V<span class="op">[</span>j<span class="op">].</span>se<span class="op">;</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>        LL B <span class="op">=</span> S <span class="op">-</span> cnt<span class="op">;</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        LL g <span class="op">=</span> gcd<span class="op">(</span>A<span class="op">,</span> B<span class="op">);</span> Val<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> mp<span class="op">(</span>A <span class="op">/</span> g<span class="op">,</span> B <span class="op">/</span> g<span class="op">);</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> Mid <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> tot <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">if</span><span class="op">(</span>Val<span class="op">[</span>Mid<span class="op">]</span> <span class="op">&gt;</span> Val<span class="op">[</span>i<span class="op">])</span> Mid <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    pair<span class="op">&lt;</span>LL<span class="op">,</span> LL<span class="op">&gt;</span> MAns <span class="op">=</span> Val<span class="op">[</span>Mid<span class="op">];</span> MAns<span class="op">.</span>fi <span class="op">+=</span> MAns<span class="op">.</span>se <span class="op">*</span> c<span class="op">;</span> LL g <span class="op">=</span> gcd<span class="op">(</span>MAns<span class="op">.</span>fi<span class="op">,</span> MAns<span class="op">.</span>se<span class="op">);</span> MAns<span class="op">.</span>fi <span class="op">/=</span> g<span class="op">;</span> MAns<span class="op">.</span>se <span class="op">/=</span> g<span class="op">;</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>d<span class="op">--){</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> Read<span class="op">(</span>A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>        LL ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>j<span class="op">,</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> ans <span class="op">+=</span> <span class="op">(</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> A<span class="op">[</span>j<span class="op">]);</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> min<span class="op">(</span>ans <span class="op">*</span> a<span class="op">,</span> b <span class="op">+</span> a <span class="op">*</span> <span class="op">((</span>n <span class="op">*</span> <span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">)</span> <span class="op">-</span> ans<span class="op">));</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>ans <span class="op">*</span> MAns<span class="op">.</span>se <span class="op">&lt;</span> MAns<span class="op">.</span>fi<span class="op">)</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld</span><span class="st">/1</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld</span><span class="st">/</span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> MAns<span class="op">.</span>fi<span class="op">,</span> MAns<span class="op">.</span>se<span class="op">);</span> <span class="ot">assert</span><span class="op">(</span>MAns<span class="op">.</span>fi <span class="op">&gt;</span> <span class="dv">0</span><span class="op">);</span>  <span class="ot">assert</span><span class="op">(</span>MAns<span class="op">.</span>se <span class="op">&gt;</span> <span class="dv">0</span><span class="op">);</span> </span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> Init<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="op">((</span>i<span class="op">)</span> <span class="op">*</span> <span class="op">(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">/</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>            LL <span class="op">&amp;</span>ans <span class="op">=</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>            rep<span class="op">(</span>k<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> min<span class="op">(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> j<span class="op">))</span> ans <span class="op">+=</span> dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j <span class="op">-</span> k<span class="op">];</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="dt">signed</span> main<span class="op">(){</span> freopen<span class="op">(</span><span class="st">&quot;in.txt&quot;</span><span class="op">,</span> <span class="st">&quot;r&quot;</span><span class="op">,</span> stdin<span class="op">);</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>    Init<span class="op">(</span><span class="dv">17</span><span class="op">);</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> T<span class="op">;</span> Read<span class="op">(</span>T<span class="op">);</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>T<span class="op">--)</span> doit<span class="op">();</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;bits/stdc++.h&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define fi </span>first</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#define se </span>second</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define pb </span>push_back</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define mp </span>make_pair</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#define SZ</span><span class="op">(</span>x<span class="op">)</span><span class="pp"> </span><span class="op">((</span><span class="dt">int</span><span class="op">)</span>x<span class="op">.</span>size<span class="op">())</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ALL</span><span class="op">(</span>x<span class="op">)</span><span class="pp"> </span>x<span class="op">.</span>begin<span class="op">(),</span><span class="pp"> </span>x<span class="op">.</span>end<span class="op">()</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#define L</span><span class="op">(</span>i<span class="op">,</span><span class="pp"> </span>u<span class="op">)</span><span class="pp"> </span><span class="cf">for</span><span class="pp"> </span><span class="op">(</span><span class="at">register</span><span class="pp"> </span><span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span>head<span class="op">[</span>u<span class="op">];</span><span class="pp"> </span>i<span class="op">;</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span>nxt<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#define rep</span><span class="op">(</span>i<span class="op">,</span><span class="pp"> </span>a<span class="op">,</span><span class="pp"> </span>b<span class="op">)</span><span class="pp"> </span><span class="cf">for</span><span class="pp"> </span><span class="op">(</span><span class="at">register</span><span class="pp"> </span><span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="op">(</span>a<span class="op">);</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">&lt;=</span><span class="pp"> </span><span class="op">(</span>b<span class="op">);</span><span class="pp"> </span>i<span class="op">++)</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#define per</span><span class="op">(</span>i<span class="op">,</span><span class="pp"> </span>a<span class="op">,</span><span class="pp"> </span>b<span class="op">)</span><span class="pp"> </span><span class="cf">for</span><span class="pp"> </span><span class="op">(</span><span class="at">register</span><span class="pp"> </span><span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="op">(</span>a<span class="op">);</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">&gt;=</span><span class="pp"> </span><span class="op">(</span>b<span class="op">);</span><span class="pp"> </span>i<span class="op">--)</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">double</span> ld<span class="op">;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> ll<span class="op">;</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">unsigned</span> <span class="dt">int</span> ui<span class="op">;</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> pair<span class="op">&lt;</span>ll<span class="op">,</span> ll<span class="op">&gt;</span> Pll<span class="op">;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> Vi<span class="op">;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> read<span class="op">(</span>T <span class="op">&amp;</span>x<span class="op">){</span>x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span><span class="dt">char</span> c <span class="op">=</span> getchar<span class="op">();</span><span class="dt">int</span> f <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(!</span>isdigit<span class="op">(</span>c<span class="op">))</span> <span class="op">{</span> <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="ch">&#39;-&#39;</span><span class="op">)</span> f <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span> c <span class="op">=</span> getchar<span class="op">();</span> <span class="op">}</span> <span class="cf">while</span> <span class="op">(</span>isdigit<span class="op">(</span>c<span class="op">))</span> <span class="op">{</span> x <span class="op">=</span> x <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> c <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">;</span> c <span class="op">=</span> getchar<span class="op">();</span> <span class="op">}</span> x <span class="op">*=</span> f<span class="op">;</span> <span class="op">}</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>T gcd<span class="op">(</span>T a<span class="op">,</span> T b<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">!</span>b <span class="op">?</span> a <span class="op">:</span> gcd<span class="op">(</span>b<span class="op">,</span> a <span class="op">%</span> b<span class="op">);</span> <span class="op">}</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> umin<span class="op">(</span>T <span class="op">&amp;</span>x<span class="op">,</span> T y<span class="op">)</span> <span class="op">{</span> x <span class="op">=</span> x <span class="op">&lt;</span> y <span class="op">?</span> x <span class="op">:</span> y<span class="op">;</span> <span class="op">}</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> umax<span class="op">(</span>T <span class="op">&amp;</span>x<span class="op">,</span> T y<span class="op">)</span> <span class="op">{</span> x <span class="op">=</span> x <span class="op">&gt;</span> y <span class="op">?</span> x <span class="op">:</span> y<span class="op">;</span> <span class="op">}</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>ll dp<span class="op">[</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">16</span> <span class="op">|</span> <span class="dv">3</span><span class="op">][</span><span class="dv">141</span><span class="op">];</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Yzr</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    ll gs<span class="op">[</span><span class="dv">141</span><span class="op">];</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> ini<span class="op">(</span><span class="dt">int</span> nn<span class="op">)</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> nn<span class="op">;</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>        memset<span class="op">(</span>dp<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>dp<span class="op">));</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>s<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> n<span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> <span class="cf">if</span> <span class="op">(~</span>s <span class="op">&gt;&gt;</span> i <span class="op">-</span> <span class="dv">1</span> <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> del <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> cnt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>            rep<span class="op">(</span>j<span class="op">,</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> del <span class="op">+=</span> s <span class="op">&gt;&gt;</span> j <span class="op">-</span> <span class="dv">1</span> <span class="op">&amp;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>            rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> cnt <span class="op">+=</span> s <span class="op">&gt;&gt;</span> j <span class="op">-</span> <span class="dv">1</span> <span class="op">&amp;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>            rep<span class="op">(</span>k<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> cnt <span class="op">*</span> <span class="op">(</span>cnt <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">)</span> dp<span class="op">[</span>s <span class="op">|</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k <span class="op">+</span> del<span class="op">]</span> <span class="op">+=</span> dp<span class="op">[</span>s<span class="op">][</span>k<span class="op">];</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>k<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n <span class="op">*</span> <span class="op">(</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">)</span> gs<span class="op">[</span>k<span class="op">]</span> <span class="op">=</span> dp<span class="op">[(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> n<span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">];</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> yzr<span class="op">[</span><span class="dv">17</span><span class="op">];</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> cmp<span class="op">(</span>Pll a<span class="op">,</span> Pll b<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">(</span>ld<span class="op">)</span>a<span class="op">.</span>fi <span class="op">/</span> a<span class="op">.</span>se <span class="op">&lt;</span> <span class="op">(</span>ld<span class="op">)</span>b<span class="op">.</span>fi <span class="op">/</span> b<span class="op">.</span>se<span class="op">;</span> <span class="op">}</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>ll n<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> c<span class="op">,</span> d<span class="op">,</span> qz<span class="op">[</span><span class="dv">141</span><span class="op">],</span> p<span class="op">[</span><span class="dv">166</span><span class="op">];</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>Pll s<span class="op">[</span><span class="dv">166</span><span class="op">];</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>ll calc<span class="op">(</span>ll x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> min<span class="op">(</span>x <span class="op">*</span> a<span class="op">,</span> <span class="op">(</span>n <span class="op">*</span> <span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> x<span class="op">)</span> <span class="op">*</span> a <span class="op">+</span> b<span class="op">);</span> <span class="op">}</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    freopen<span class="op">(</span><span class="st">&quot;in.txt&quot;</span><span class="op">,</span> <span class="st">&quot;r&quot;</span><span class="op">,</span> stdin<span class="op">);</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>n<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">16</span><span class="op">)</span> yzr<span class="op">[</span>n<span class="op">].</span>ini<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> T<span class="op">;</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    read<span class="op">(</span>T<span class="op">);</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>T<span class="op">--)</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>        read<span class="op">(</span>n<span class="op">);</span> read<span class="op">(</span>a<span class="op">);</span> read<span class="op">(</span>b<span class="op">);</span> read<span class="op">(</span>c<span class="op">);</span> read<span class="op">(</span>d<span class="op">);</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>        Pll res<span class="op">(</span><span class="fl">1e18</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>        ll tot <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> tot <span class="op">*=</span> i<span class="op">;</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> len <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n <span class="op">*</span> <span class="op">(</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">)</span> <span class="cf">if</span> <span class="op">(</span>yzr<span class="op">[</span>n<span class="op">].</span>gs<span class="op">[</span>i<span class="op">])</span> s<span class="op">[++</span>len<span class="op">]</span> <span class="op">=</span> mp<span class="op">(</span>calc<span class="op">(</span>i<span class="op">),</span> yzr<span class="op">[</span>n<span class="op">].</span>gs<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>        sort<span class="op">(</span>s <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> s <span class="op">+</span> len <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">static</span> ll qz<span class="op">[</span><span class="dv">166</span><span class="op">],</span> hz<span class="op">[</span><span class="dv">166</span><span class="op">];</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> len<span class="op">)</span> qz<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> qz<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> s<span class="op">[</span>i<span class="op">].</span>fi <span class="op">*</span> s<span class="op">[</span>i<span class="op">].</span>se<span class="op">;</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>        hz<span class="op">[</span>len <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>        per<span class="op">(</span>i<span class="op">,</span> len<span class="op">,</span> <span class="dv">1</span><span class="op">)</span> hz<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> hz<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> s<span class="op">[</span>i<span class="op">].</span>se<span class="op">;</span></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> len<span class="op">)</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>            Pll cur <span class="op">=</span> mp<span class="op">(</span>qz<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> hz<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">*</span> c<span class="op">,</span> tot <span class="op">-</span> hz<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">]);</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>cmp<span class="op">(</span>cur<span class="op">,</span> res<span class="op">))</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>                res <span class="op">=</span> cur<span class="op">;</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>        pair<span class="op">&lt;</span>ll<span class="op">,</span> ll<span class="op">&gt;</span> ans <span class="op">=</span> mp<span class="op">(</span>res<span class="op">.</span>fi <span class="op">+</span> c <span class="op">*</span> res<span class="op">.</span>se<span class="op">,</span> res<span class="op">.</span>se<span class="op">);</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>        cerr <span class="op">&lt;&lt;</span> <span class="st">&quot;N = &quot;</span> <span class="op">&lt;&lt;</span> n <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>        cout <span class="op">&lt;&lt;</span> ans<span class="op">.</span>fi <span class="op">&lt;&lt;</span> <span class="st">&quot; &quot;</span> <span class="op">&lt;&lt;</span> ans<span class="op">.</span>se <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>d<span class="op">--)</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>            rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> read<span class="op">(</span>p<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> nx <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>            rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>j<span class="op">,</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> nx <span class="op">+=</span> p<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> p<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>            Pll ans <span class="op">=</span> mp<span class="op">(</span>calc<span class="op">(</span>nx<span class="op">),</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>cmp<span class="op">(</span>mp<span class="op">(</span>res<span class="op">.</span>fi <span class="op">+</span> c <span class="op">*</span> res<span class="op">.</span>se<span class="op">,</span> res<span class="op">.</span>se<span class="op">),</span> ans<span class="op">))</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>                ans <span class="op">=</span> mp<span class="op">(</span>res<span class="op">.</span>fi <span class="op">+</span> c <span class="op">*</span> res<span class="op">.</span>se<span class="op">,</span> res<span class="op">.</span>se<span class="op">);</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>            ll g <span class="op">=</span> gcd<span class="op">(</span>ans<span class="op">.</span>fi<span class="op">,</span> ans<span class="op">.</span>se<span class="op">);</span></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>            ans<span class="op">.</span>fi <span class="op">/=</span> g<span class="op">;</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>            ans<span class="op">.</span>se <span class="op">/=</span> g<span class="op">;</span></span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>            printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld</span><span class="st">/</span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">.</span>fi<span class="op">,</span> ans<span class="op">.</span>se<span class="op">);</span></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="d.-sith">D. sith</h3>
<p>‰Ω†Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
Ê£µÁÇπÊï∞Âùá‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÊ†ë</p>
<p>ÂØπ‰∫éÊØèÂØπÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i,j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>Ôºå‰Ω†ÈÉΩÈúÄË¶ÅÊ±ÇÂá∫ÔºåÊúâÂ§öÂ∞ë‰∏™ÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ÔºåÊª°Ë∂≥Âú®ÊâÄÊúâÊ†ë‰∏≠ÈÉΩÂú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>‚Üî</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i\leftrightarrow j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚Üî</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>
ÁöÑÊ†ëÈìæ‰∏äÔºàÊ†ëÈìæÂåÖÂê´Á´ØÁÇπÂç≥
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i,j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>Ôºâ„ÄÇ</p>
<p>ÂÆö‰πâÂáΩÊï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal"><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><msub><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi></msub></mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{dis_t}(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">di</span><span class="mord"><span class="mord mathrm">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">t</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>
‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>Ôºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>
Ëøô‰∏§‰∏™ÁªìÁÇπÂú®Ê†ë
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>
‰∏äÁöÑÊúÄÁü≠Ë∑ùÁ¶ªÔºàÁÆÄÂçïË∑ØÂæÑÈïøÂ∫¶Ôºâ„ÄÇ</p>
<p>ÂØπ‰∫é‰∏ÄÊ£µÊ†ë
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>
Ôºå‚Äú<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal"><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><msub><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi></msub></mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal"><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><msub><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi></msub></mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="normal"><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><msub><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi></msub></mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{dis_t}(i, j) = \operatorname{dis_t}(i, x) + \operatorname{dis_t}(x, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">di</span><span class="mord"><span class="mord mathrm">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">t</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">di</span><span class="mord"><span class="mord mathrm">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">t</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">di</span><span class="mord"><span class="mord mathrm">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">t</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>‚Äù
‰∏∫ ‚ÄúÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
Âú®
ÁÇπ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚Üî</mo></mrow><annotation encoding="application/x-tex">\leftrightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">‚Üî</span></span></span></span>
ÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>
ÁöÑÊ†ëÈìæ‰∏ä‚Äù ÁöÑÂÖÖË¶ÅÊù°‰ª∂„ÄÇ</p>
<p>Êâ©Â±ï‰∏Ä‰∏ãÂèØ‰ª•ÂèëÁé∞</p>
<p>ÂØπ‰∫éÊ£ÆÊûó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>Ôºå‚Äú<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>‚àë</mo><mrow><mi>t</mi><mo>‚àà</mo><mi>T</mi></mrow></munder><mrow><mi mathvariant="normal"><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><msub><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi></msub></mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><mo>=</mo><munder><mo>‚àë</mo><mrow><mi>t</mi><mo>‚àà</mo><mi>T</mi></mrow></munder><mrow><mi mathvariant="normal"><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><msub><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi></msub></mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>+</mo><munder><mo>‚àë</mo><mrow><mi>t</mi><mo>‚àà</mo><mi>T</mi></mrow></munder><mrow><mi mathvariant="normal"><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><msub><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi></msub></mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sum_{t \in T}\limits{\operatorname{dis_t}(i, j)} = \sum_{t \in T}\limits{\operatorname{dis_t}(i, x)} + \sum_{t \in T}\limits{\operatorname{dis_t}(x, j)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.7717em;vertical-align:-1.0217em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.1057em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">‚àà</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">‚àë</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.0217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mop"><span class="mord mathrm">di</span><span class="mord"><span class="mord mathrm">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">t</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7717em;vertical-align:-1.0217em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.1057em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">‚àà</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">‚àë</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.0217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mop"><span class="mord mathrm">di</span><span class="mord"><span class="mord mathrm">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">t</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.7717em;vertical-align:-1.0217em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.1057em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">‚àà</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">‚àë</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.0217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mop"><span class="mord mathrm">di</span><span class="mord"><span class="mord mathrm">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">t</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></span>‚Äù
‰∏∫ ‚ÄúÂØπ‰∫éÊØèÊ£µÊ†ë ÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
Âú®
ÁÇπ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚Üî</mo></mrow><annotation encoding="application/x-tex">\leftrightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">‚Üî</span></span></span></span>
ÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>
ÁöÑÊ†ëÈìæ‰∏ä‚Äù ÁöÑÂÖÖË¶ÅÊù°‰ª∂„ÄÇ</p>
<p>ËøôÊ†∑Â∞±ÂèØ‰ª•ÂàÜÂºÄÁÆó‰∫ÜÔºåÈöè‰æøÂÅöÂ∞±Â•Ω‰∫Ü„ÄÇ</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;bits/stdc++.h&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define fi </span>first</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#define se </span>second</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define pb </span>push_back</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define mp </span>make_pair</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#define SZ</span><span class="op">(</span>x<span class="op">)</span><span class="pp"> </span><span class="op">((</span><span class="dt">int</span><span class="op">)</span>x<span class="op">.</span>size<span class="op">())</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ALL</span><span class="op">(</span>x<span class="op">)</span><span class="pp"> </span>x<span class="op">.</span>begin<span class="op">(),</span><span class="pp"> </span>x<span class="op">.</span>end<span class="op">()</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#define L</span><span class="op">(</span>i<span class="op">,</span><span class="pp"> </span>u<span class="op">)</span><span class="pp"> </span><span class="cf">for</span><span class="pp"> </span><span class="op">(</span><span class="at">register</span><span class="pp"> </span><span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span>head<span class="op">[</span>u<span class="op">];</span><span class="pp"> </span>i<span class="op">;</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span>nxt<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#define rep</span><span class="op">(</span>i<span class="op">,</span><span class="pp"> </span>a<span class="op">,</span><span class="pp"> </span>b<span class="op">)</span><span class="pp"> </span><span class="cf">for</span><span class="pp"> </span><span class="op">(</span><span class="at">register</span><span class="pp"> </span><span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="op">(</span>a<span class="op">);</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">&lt;=</span><span class="pp"> </span><span class="op">(</span>b<span class="op">);</span><span class="pp"> </span>i<span class="op">++)</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#define per</span><span class="op">(</span>i<span class="op">,</span><span class="pp"> </span>a<span class="op">,</span><span class="pp"> </span>b<span class="op">)</span><span class="pp"> </span><span class="cf">for</span><span class="pp"> </span><span class="op">(</span><span class="at">register</span><span class="pp"> </span><span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="op">(</span>a<span class="op">);</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">&gt;=</span><span class="pp"> </span><span class="op">(</span>b<span class="op">);</span><span class="pp"> </span>i<span class="op">--)</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">double</span> ld<span class="op">;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> ll<span class="op">;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">unsigned</span> <span class="dt">int</span> ui<span class="op">;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> Pii<span class="op">;</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> Vi<span class="op">;</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> read<span class="op">(</span>T <span class="op">&amp;</span>x<span class="op">){</span>x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span><span class="dt">char</span> c <span class="op">=</span> getchar<span class="op">();</span><span class="dt">int</span> f <span class="op">=</span> <span class="dv">1</span><span class="op">;</span><span class="cf">while</span> <span class="op">(!</span>isdigit<span class="op">(</span>c<span class="op">)){</span><span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="ch">&#39;-&#39;</span><span class="op">)</span>f <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span>c <span class="op">=</span> getchar<span class="op">();}</span><span class="cf">while</span> <span class="op">(</span>isdigit<span class="op">(</span>c<span class="op">)){</span>x <span class="op">=</span> x <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> c <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">;</span>c <span class="op">=</span> getchar<span class="op">();}</span>x <span class="op">*=</span> f<span class="op">;}</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>T gcd<span class="op">(</span>T a<span class="op">,</span> T b<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">!</span>b <span class="op">?</span> a <span class="op">:</span> gcd<span class="op">(</span>b<span class="op">,</span> a <span class="op">%</span> b<span class="op">);</span> <span class="op">}</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> umin<span class="op">(</span>T <span class="op">&amp;</span>x<span class="op">,</span> T y<span class="op">)</span> <span class="op">{</span> x <span class="op">=</span> x <span class="op">&lt;</span> y <span class="op">?</span> x <span class="op">:</span> y<span class="op">;</span> <span class="op">}</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> umax<span class="op">(</span>T <span class="op">&amp;</span>x<span class="op">,</span> T y<span class="op">)</span> <span class="op">{</span> x <span class="op">=</span> x <span class="op">&gt;</span> y <span class="op">?</span> x <span class="op">:</span> y<span class="op">;</span> <span class="op">}</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> T Abs<span class="op">(</span><span class="at">const</span> T <span class="op">&amp;</span>x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> x <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> x <span class="op">:</span> <span class="op">-</span>x<span class="op">;</span> <span class="op">}</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> ui R<span class="op">()</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> ui seed <span class="op">=</span> <span class="dv">613</span><span class="op">;</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seed <span class="op">^=</span> seed <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">,</span> seed <span class="op">^=</span> seed <span class="op">&lt;&lt;</span> <span class="dv">17</span><span class="op">,</span> seed <span class="op">^=</span> seed <span class="op">&gt;&gt;</span> <span class="dv">13</span><span class="op">;</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">505</span><span class="op">;</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> k<span class="op">,</span> dis<span class="op">[</span>N<span class="op">][</span>N<span class="op">];</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>Vi e<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> s<span class="op">,</span> <span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> fa<span class="op">,</span> <span class="dt">int</span> dep<span class="op">)</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    dis<span class="op">[</span>s<span class="op">][</span>u<span class="op">]</span> <span class="op">+=</span> dep<span class="op">;</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> e<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v <span class="op">!=</span> fa<span class="op">)</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>            dfs<span class="op">(</span>s<span class="op">,</span> v<span class="op">,</span> u<span class="op">,</span> dep <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    read<span class="op">(</span>n<span class="op">);</span>read<span class="op">(</span>k<span class="op">);</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>tt<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> k<span class="op">){</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> e<span class="op">[</span>i<span class="op">].</span>clear<span class="op">();</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> u<span class="op">,</span> v<span class="op">;</span>read<span class="op">(</span>u<span class="op">);</span>read<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>            e<span class="op">[</span>u<span class="op">].</span>pb<span class="op">(</span>v<span class="op">);</span>e<span class="op">[</span>v<span class="op">].</span>pb<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> dfs<span class="op">(</span>i<span class="op">,</span> i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> ans <span class="op">+=</span> dis<span class="op">[</span>i<span class="op">][</span>x<span class="op">]</span> <span class="op">+</span> dis<span class="op">[</span>j<span class="op">][</span>x<span class="op">]</span> <span class="op">==</span> dis<span class="op">[</span>i<span class="op">][</span>j<span class="op">];</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%c</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">,</span> j <span class="op">&lt;</span> n <span class="op">?</span> <span class="ch">&#39; &#39;</span> <span class="op">:</span> <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span><span class="op">);</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="round-2">Round 2</h2>
<h3 id="a.-one">A. one</h3>
<p>Áªô‰Ω†‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÊï∞ÁªÑÔºå‰Ω†ÈúÄË¶ÅÂ∞ÜÂÖ∂ÂàíÂàÜ‰∏∫Ëã•Âπ≤‰∏™ËøûÁª≠ÊÆµ„ÄÇÂØπ‰∫é‰∏ÄÁßçÂàíÂàÜÔºåÂÆö‰πâÂÖ∂ÊùÉÂÄº‰∏∫ÔºåÊ±ÇÂá∫ÊØèÊÆµÁöÑÊÆµÂÜÖÊâÄÊúâÂÖÉÁ¥†
xor ÂÄºÔºåÂÜçÊääÊâÄÊúâÊÆµÁöÑ xor ÂÄºÁõ∏Âä†Âç≥‰∏∫ÊùÉÂÄº„ÄÇ</p>
<p>‰Ω†ÈúÄË¶ÅËÆ°ÁÆóÂØπ‰∫éÊâÄÊúâÂàíÂàÜÔºåËøô‰∏™ÊùÉÂÄºÁöÑÊúÄÂ∞è„ÄÅÊúÄÂ§ßÂÄºÂàÜÂà´ÊòØÂ§öÂ∞ë„ÄÇ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">n \le 10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi mathvariant="normal">xor</mi><mo>‚Å°</mo><mi>B</mi><mo>‚â§</mo><mi>A</mi><mo>+</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \operatorname{xor} B \le A + B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm">xor</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mtext>¬†</mtext><mo>&amp;</mo><mi>B</mi><mo>‚â§</mo><mi>A</mi><mtext>¬†</mtext><mi mathvariant="normal">‚à£</mi><mtext>¬†</mtext><mi>B</mi><mo>‚â§</mo><mi>A</mi><mo>+</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \ \And B \le A\ |\ B \le A + B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">A</span><span class="mspace">¬†</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&amp;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mspace">¬†</span><span class="mord">‚à£</span><span class="mspace">¬†</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></p>
<p>ÂÖ®ÈÉ®ÊãÜÂºÄÊúÄÂ§ßÔºåÂÖ®ÈÉ®ÂêàÂπ∂ÊúÄÂ∞è„ÄÇ</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span> MIN <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> LL MAX <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> Read<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> x<span class="op">;</span> Read<span class="op">(</span>x<span class="op">);</span> MIN <span class="op">^=</span> x<span class="op">;</span> MAX <span class="op">+=</span> x<span class="op">;</span> <span class="op">}</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st"> </span><span class="sc">%lld</span><span class="st">&quot;</span><span class="op">,</span> MIN<span class="op">,</span> MAX<span class="op">);</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="b.-two">B. two</h3>
<p>Êúâ‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1..</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">1..n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1..</span><span class="mord mathnormal">n</span></span></span></span>
‰æùÊ¨°ËøûÊàêÁöÑÁéØÔºåÊúâ‰∏Ä‰∏™‰ªé
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>
ÂºÄÂßãÁßªÂä®ÁöÑÊåáÈíàÔºåÊØèÊ¨°ÊåáÈíàÊâÄÂú®‰ΩçÁΩÆÊúâ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>ÁöÑÊ¶ÇÁéáÊ∂àÂ§±Âπ∂Â∞ÜËøô‰∏™‰ΩçÁΩÆÂØπÂ∫îÁöÑ‰∏ãÊ†áÔºàÂú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1..</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">1..n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1..</span><span class="mord mathnormal">n</span></span></span></span>
‰∏≠ÔºâÊèíÂÖ•Â∫èÂàó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>
ÁöÑÊú´Â∞æÔºåÁÑ∂ÂêéÊåáÈíàÁßªÂä®‰∏ÄÊ†ºÔºà
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>
ÁßªÂà∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>Ôºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁßªÂà∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>
ËøôÊ†∑Ôºå‰∏Ä‰∏™‰ΩçÁΩÆËã•Â∑≤ÁªèÊ∂àÂ§±Âàô‰∏ç‰ºöË¢´ÁßªÂä®Âà∞Ôºâ„ÄÇÊâÄÊúâ‰ΩçÁΩÆÈÉΩÊ∂àÂ§±Êó∂Ê∏∏ÊàèÁªìÊùü„ÄÇÊúÄÂêé
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>
‰ºöÊòØ‰∏Ä‰∏™ÊéíÂàó„ÄÇ</p>
<p>ËøôÈÅìÈ¢òË∑üÂ∫èÂàó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>
Ê≤°‰ªÄ‰πàÂÖ≥Á≥ªÔºå‰Ω†Âè™ÈúÄË¶ÅÊ±ÇÂá∫Ê∏∏ÊàèÊúüÊúõËøõË°åÂá†ËΩÆÔºåÁ≠îÊ°àÂØπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>998244353</mn></mrow><annotation encoding="application/x-tex">998244353</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">998244353</span></span></span></span>
ÂèñÊ®°„ÄÇ</p>
<p>ËØªÂÖ•ÊèèËø∞Ôºö ‰∏ÄË°å‰∏â‰∏™Êï¥Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">n,x,y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>„ÄÇÊ¶ÇÁéá
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mfrac><mi>x</mi><mi>y</mi></mfrac></mrow><annotation encoding="application/x-tex">p=\frac x y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1765em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p>ËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">f[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>
‰∏∫ ÈïøÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ËøòÈúÄË¶ÅËøõË°åÂ§öÂ∞ëËΩÆ„ÄÇ</p>
<p>ÊòìÁü•
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo>=</mo><mn>1</mn><mo>+</mo><mi>p</mi><mo>√ó</mo><mi>f</mi><mo stretchy="false">[</mo><mi>n</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>‚àí</mo><mi>p</mi><mo fence="true">)</mo></mrow><mo>√ó</mo><mi>f</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">f[n] = 1 + p \times f[n - 1] + \left(1 - p \right) \times f[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span></p>
<p>ÁßªÈ°πÂæó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo>=</mo><mi>n</mi><mo>√ó</mo><mfrac><mn>1</mn><mi>p</mi></mfrac></mrow><annotation encoding="application/x-tex">f[n] = n \times \frac{1}{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">)(</span>x<span class="op">)(</span>y<span class="op">);</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="dt">int</span><span class="op">(</span>n <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> y <span class="op">%</span> MOD <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> inv<span class="op">(</span>x<span class="op">,</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">));</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="c.-three">C. three</h3>
<p>Â∞èYÊã•Êúâ‰∏Ä‰∏™Â∫èÂàó<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>Ôºà‰ªé0ÂºÄÂßãÊ†áÂè∑Ôºâ„ÄÇ</p>
<p>Â∞èYÊÉ≥Ë¶ÅÂØπÂ∫èÂàóËøõË°å<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span>Ê¨°Êìç‰ΩúÔºåÊìç‰ΩúÊúâ‰∏ãÈù¢Âá†ÁßçÔºö</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ÔºöÂØπÂå∫Èó¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>ÊâßË°å<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">a_i=a_i+x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ÔºöÂØπÂå∫Èó¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>ÊâßË°å<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mo stretchy="false">‚åä</mo><mfrac><msub><mi>a</mi><mi>i</mi></msub><mi>x</mi></mfrac><mo stretchy="false">‚åã</mo></mrow><annotation encoding="application/x-tex">a_i=\lfloor \frac {a_i} {x} \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mopen">‚åä</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7115em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">‚åã</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">t=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>ÔºöÊü•ËØ¢Âå∫Èó¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>ÁöÑ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>‚Å°</mo><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\max {a_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mop">max</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">t=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span>ÔºöÊääÂå∫Èó¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>ÁöÑ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ÊÅ¢Â§ç‰∏∫ÂàùÂßãÁªôÂá∫ÁöÑ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup><mo separator="true">;</mo><mi>n</mi><mo separator="true">,</mo><mi>Q</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">a_i \le 10^8; n, Q \le 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
<h4 id="ÂÆö‰πâ‰∏ÄÁ±ªÁâπÊÆäÊ†áËÆ∞">ÂÆö‰πâ‰∏ÄÁ±ªÁâπÊÆäÊ†áËÆ∞</h4>
<p>ËÆ∞ÂΩïÊ†áËÆ∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a, b, c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span></span></span></span>
Ë°®Á§∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
ÂèòÊàê
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">‚åä</mo><mfrac><mrow><mi>x</mi><mo>+</mo><mi>a</mi></mrow><mi>b</mi></mfrac><mo stretchy="false">‚åã</mo><mo>+</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">\lfloor \frac{x + a}{b} \rfloor + c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1473em;vertical-align:-0.345em;"></span><span class="mopen">‚åä</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8023em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">‚åã</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>„ÄÇ
ÂÖ∂‰∏≠Ë¶ÅÊ±Ç
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&lt;</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a &lt; b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>„ÄÇ
- ÂØπ‰∫éÂä†Ê≥ïÊìç‰Ωú
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>+</mo><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">c += x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">c</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
Âç≥ÂèØ„ÄÇ - ÂØπ‰∫éÈô§Ê≥ïÊìç‰ΩúÂ¶ÇÊûúÊòØÈô§
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>
Ôºö<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">‚åä</mo><mfrac><mrow><mo stretchy="false">‚åä</mo><mfrac><mrow><mi>x</mi><mo>+</mo><mi>a</mi></mrow><mi>b</mi></mfrac><mo stretchy="false">‚åã</mo><mo>+</mo><mi>c</mi></mrow><mi>d</mi></mfrac><mo stretchy="false">‚åã</mo><mo>=</mo><mo stretchy="false">‚åä</mo><mfrac><mrow><mo stretchy="false">‚åä</mo><mfrac><mrow><mi>x</mi><mo>+</mo><mi>a</mi><mo>+</mo><mi>b</mi><mi>c</mi></mrow><mi>b</mi></mfrac><mo stretchy="false">‚åã</mo></mrow><mi>d</mi></mfrac><mo stretchy="false">‚åã</mo><mo>=</mo><mo stretchy="false">‚åä</mo><mfrac><mrow><mi>x</mi><mo>+</mo><mi>a</mi><mo>+</mo><mi>b</mi><mi>c</mi></mrow><mrow><mi>b</mi><mi>d</mi></mrow></mfrac><mo stretchy="false">‚åã</mo></mrow><annotation encoding="application/x-tex">\lfloor \frac{ \lfloor \frac{x + a}{b} \rfloor + c}{d} \rfloor = \lfloor \frac{ \lfloor \frac{x + a + bc}{b} \rfloor}{d} \rfloor = \lfloor \frac{x + a + bc}{bd} \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4563em;vertical-align:-0.345em;"></span><span class="mopen">‚åä</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1113em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5508em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">‚åä</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8007em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mclose mtight">‚åã</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">‚åã</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.5118em;vertical-align:-0.345em;"></span><span class="mopen">‚åä</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1668em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5508em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">‚åä</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.88em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">a</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mclose mtight">‚åã</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">‚åã</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mopen">‚åä</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">a</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">‚åã</span></span></span></span>
ÁÑ∂Âêé‰ºòÂåñ‰∏Ä‰∏ã
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>+</mo><mi>a</mi><mo>+</mo><mi>b</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">x + a + bc</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal">c</span></span></span></span>
‰øùÊåÅ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mo mathvariant="normal" lspace="0em" rspace="0em">‚Ä≤</mo></msup><mo>&lt;</mo><msup><mi>b</mi><mo mathvariant="normal" lspace="0em" rspace="0em">‚Ä≤</mo></msup></mrow><annotation encoding="application/x-tex">a&#x27; &lt; b&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.791em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span>ÔºåÁ±ª‰ºº‰∫éÂÅáÂàÜÊï∞Êç¢ÁÆóÂ∏¶ÂàÜÊï∞Ôºå‰øùËØÅ‰∏ç‰ºöÁàÜ<code>long long</code>„ÄÇ</p>
<p>ÂØπ‰∫éÂ§ÑÁêÜÈô§Êï∞ËøáÂ§ßÁöÑÊÉÖÂÜµÔºö</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>fm <span class="op">&gt;</span> inf<span class="op">)</span> fz <span class="op">=</span> max<span class="op">(</span><span class="dv">0</span><span class="bu">ll</span><span class="op">,</span> fz <span class="op">+</span> <span class="op">(</span>inf <span class="op">-</span> fm<span class="op">)),</span> fm <span class="op">=</span> inf<span class="op">;</span></span></code></pre></div>
<p>Â¶ÇÊûúÂàÜÊØç
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mi mathvariant="normal">inf</mi><mo>‚Å°</mo></mrow><annotation encoding="application/x-tex">&gt; \operatorname{inf}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.07778em;">inf</span></span></span></span></span>ÔºåÈÇ£‰πà
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">‚åä</mo><mfrac><mrow><mi>x</mi><mo>+</mo><mi>a</mi></mrow><mi>b</mi></mfrac><mo stretchy="false">‚åã</mo><mo>+</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">\lfloor \frac{x + a}{b} \rfloor + c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1473em;vertical-align:-0.345em;"></span><span class="mopen">‚åä</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8023em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">‚åã</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>
Á≠â‰ª∑‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo>‚â•</mo><mi>b</mi><mo>‚àí</mo><mi>a</mi><mo stretchy="false">]</mo><mo>+</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">[x \ge b - a] + c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â•</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>
ÂΩìÂàÜÊØçÂæàÂ§ßÊó∂ÔºåÂèØ‰ª•‰ΩøÂæó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a, b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span></span></span></span>
ÂêåÊó∂ÂáèÂéª‰∏Ä‰∏™Â∏∏Êï∞‰ΩøÂæó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>
‰∏ç‰ºöÊ∫¢Âá∫ÔºåÂØπ‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo>‚â•</mo><mi>b</mi><mo>‚àí</mo><mi>a</mi><mo stretchy="false">]</mo><mo>+</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">[x \ge b - a] + c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â•</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>
‰∏çÂΩ±ÂìçÂèñÂÄº„ÄÇ</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;bits/stdc++.h&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define fi </span>first</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#define se </span>second</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define pb </span>push_back</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define mp </span>make_pair</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#define SZ</span><span class="op">(</span>x<span class="op">)</span><span class="pp"> </span><span class="op">((</span><span class="dt">int</span><span class="op">)</span>x<span class="op">.</span>size<span class="op">())</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ALL</span><span class="op">(</span>x<span class="op">)</span><span class="pp"> </span>x<span class="op">.</span>begin<span class="op">(),</span><span class="pp"> </span>x<span class="op">.</span>end<span class="op">()</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#define L</span><span class="op">(</span>i<span class="op">,</span><span class="pp"> </span>u<span class="op">)</span><span class="pp"> </span><span class="cf">for</span><span class="pp"> </span><span class="op">(</span><span class="at">register</span><span class="pp"> </span><span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span>head<span class="op">[</span>u<span class="op">];</span><span class="pp"> </span>i<span class="op">;</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span>nxt<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#define rep</span><span class="op">(</span>i<span class="op">,</span><span class="pp"> </span>a<span class="op">,</span><span class="pp"> </span>b<span class="op">)</span><span class="pp"> </span><span class="cf">for</span><span class="pp"> </span><span class="op">(</span><span class="at">register</span><span class="pp"> </span><span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="op">(</span>a<span class="op">);</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">&lt;=</span><span class="pp"> </span><span class="op">(</span>b<span class="op">);</span><span class="pp"> </span>i<span class="op">++)</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#define per</span><span class="op">(</span>i<span class="op">,</span><span class="pp"> </span>a<span class="op">,</span><span class="pp"> </span>b<span class="op">)</span><span class="pp"> </span><span class="cf">for</span><span class="pp"> </span><span class="op">(</span><span class="at">register</span><span class="pp"> </span><span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="op">(</span>a<span class="op">);</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">&gt;=</span><span class="pp"> </span><span class="op">(</span>b<span class="op">);</span><span class="pp"> </span>i<span class="op">--)</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">double</span> ld<span class="op">;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> ll<span class="op">;</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">unsigned</span> <span class="dt">int</span> ui<span class="op">;</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> Pii<span class="op">;</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> Vi<span class="op">;</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>T gcd<span class="op">(</span>T a<span class="op">,</span> T b<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">!</span>b <span class="op">?</span> a <span class="op">:</span> gcd<span class="op">(</span>b<span class="op">,</span> a <span class="op">%</span> b<span class="op">);</span> <span class="op">}</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> umin<span class="op">(</span>T <span class="op">&amp;</span>x<span class="op">,</span> T y<span class="op">)</span> <span class="op">{</span> x <span class="op">=</span> x <span class="op">&lt;</span> y <span class="op">?</span> x <span class="op">:</span> y<span class="op">;</span> <span class="op">}</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> T<span class="op">&gt;</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> umax<span class="op">(</span>T <span class="op">&amp;</span>x<span class="op">,</span> T y<span class="op">)</span> <span class="op">{</span> x <span class="op">=</span> x <span class="op">&gt;</span> y <span class="op">?</span> x <span class="op">:</span> y<span class="op">;</span> <span class="op">}</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> ui R<span class="op">()</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> ui seed <span class="op">=</span> <span class="dv">416</span><span class="op">;</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seed <span class="op">^=</span> seed <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">,</span> seed <span class="op">^=</span> seed <span class="op">&lt;&lt;</span> <span class="dv">17</span><span class="op">,</span> seed <span class="op">^=</span> seed <span class="op">&gt;&gt;</span> <span class="dv">13</span><span class="op">;</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">233333</span><span class="op">,</span> inf <span class="op">=</span> <span class="fl">2e9</span> <span class="op">+</span> <span class="fl">1e8</span><span class="op">;</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> node</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    ll ans<span class="op">;</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> emp<span class="op">;</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    ll a<span class="op">,</span> b<span class="op">,</span> c<span class="op">,</span> mx<span class="op">;</span> <span class="co">//(x+a)/b+c (a&lt;b&lt;=inf)</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    node<span class="op">()</span> <span class="op">{</span> b <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> tree<span class="op">[</span>N <span class="op">&lt;&lt;</span> <span class="dv">2</span><span class="op">];</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> pushadd<span class="op">(</span><span class="dt">int</span> k<span class="op">,</span> ll x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    tree<span class="op">[</span>k<span class="op">].</span>ans <span class="op">+=</span> x<span class="op">;</span> tree<span class="op">[</span>k<span class="op">].</span>c <span class="op">+=</span> x<span class="op">;</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> pushdiv<span class="op">(</span><span class="dt">int</span> k<span class="op">,</span> <span class="dt">int</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    tree<span class="op">[</span>k<span class="op">].</span>ans <span class="op">/=</span> d<span class="op">;</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    ll fm <span class="op">=</span> <span class="dv">1</span><span class="bu">ll</span> <span class="op">*</span> tree<span class="op">[</span>k<span class="op">].</span>b <span class="op">*</span> d<span class="op">,</span> tmp <span class="op">=</span> <span class="op">(</span>tree<span class="op">[</span>k<span class="op">].</span>a <span class="op">+</span> <span class="dv">1</span><span class="bu">ll</span> <span class="op">*</span> tree<span class="op">[</span>k<span class="op">].</span>b <span class="op">*</span> tree<span class="op">[</span>k<span class="op">].</span>c<span class="op">)</span> <span class="op">/</span> fm<span class="op">;</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    ll fz <span class="op">=</span> <span class="op">(</span>tree<span class="op">[</span>k<span class="op">].</span>a <span class="op">+</span> <span class="dv">1</span><span class="bu">ll</span> <span class="op">*</span> tree<span class="op">[</span>k<span class="op">].</span>b <span class="op">*</span> tree<span class="op">[</span>k<span class="op">].</span>c<span class="op">)</span> <span class="op">-</span> fm <span class="op">*</span> tmp<span class="op">;</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    tree<span class="op">[</span>k<span class="op">].</span>c <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>fm <span class="op">&gt;</span> inf<span class="op">)</span> fz <span class="op">=</span> max<span class="op">(</span><span class="dv">0</span><span class="bu">ll</span><span class="op">,</span> fz <span class="op">+</span> <span class="op">(</span>inf <span class="op">-</span> fm<span class="op">)),</span> fm <span class="op">=</span> inf<span class="op">;</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    tree<span class="op">[</span>k<span class="op">].</span>a <span class="op">=</span> fz<span class="op">,</span> tree<span class="op">[</span>k<span class="op">].</span>b <span class="op">=</span> fm<span class="op">;</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>    <span class="co">//  printf(&quot;%d:%lld %lld %lld\n&quot;,k,tree[k].a,tree[k].b,tree[k].c);</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> pushemp<span class="op">(</span><span class="dt">int</span> k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    tree<span class="op">[</span>k<span class="op">].</span>emp <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    tree<span class="op">[</span>k<span class="op">].</span>a <span class="op">=</span> tree<span class="op">[</span>k<span class="op">].</span>c <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    tree<span class="op">[</span>k<span class="op">].</span>b <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>    tree<span class="op">[</span>k<span class="op">].</span>ans <span class="op">=</span> tree<span class="op">[</span>k<span class="op">].</span>mx<span class="op">;</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> pushdown<span class="op">(</span><span class="dt">int</span> k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>tree<span class="op">[</span>k<span class="op">].</span>emp<span class="op">)</span> pushemp<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">),</span> pushemp<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">),</span> tree<span class="op">[</span>k<span class="op">].</span>emp <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>tree<span class="op">[</span>k<span class="op">].</span>a<span class="op">)</span> pushadd<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> tree<span class="op">[</span>k<span class="op">].</span>a<span class="op">),</span> pushadd<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> tree<span class="op">[</span>k<span class="op">].</span>a<span class="op">),</span> tree<span class="op">[</span>k<span class="op">].</span>a <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>tree<span class="op">[</span>k<span class="op">].</span>b <span class="op">!=</span> <span class="dv">1</span><span class="op">)</span> pushdiv<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> tree<span class="op">[</span>k<span class="op">].</span>b<span class="op">),</span> pushdiv<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> tree<span class="op">[</span>k<span class="op">].</span>b<span class="op">),</span> tree<span class="op">[</span>k<span class="op">].</span>b <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>tree<span class="op">[</span>k<span class="op">].</span>c<span class="op">)</span> pushadd<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> tree<span class="op">[</span>k<span class="op">].</span>c<span class="op">),</span> pushadd<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> tree<span class="op">[</span>k<span class="op">].</span>c<span class="op">),</span> tree<span class="op">[</span>k<span class="op">].</span>c <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> upd<span class="op">(</span><span class="dt">int</span> k<span class="op">){</span> tree<span class="op">[</span>k<span class="op">].</span>ans <span class="op">=</span> max<span class="op">(</span>tree<span class="op">[</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">].</span>ans<span class="op">,</span> tree<span class="op">[</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">].</span>ans<span class="op">);</span> <span class="op">}</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> mdy1<span class="op">(</span><span class="dt">int</span> k<span class="op">,</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">,</span> <span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>l <span class="op">==</span> L <span class="op">&amp;&amp;</span> r <span class="op">==</span> R<span class="op">)</span> <span class="op">{</span> pushadd<span class="op">(</span>k<span class="op">,</span> x<span class="op">);</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>    pushdown<span class="op">(</span>k<span class="op">);</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>r <span class="op">&lt;=</span> mid<span class="op">)</span> mdy1<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> L<span class="op">,</span> mid<span class="op">);</span></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>l <span class="op">&gt;</span> mid<span class="op">)</span> mdy1<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> mdy1<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> mid<span class="op">,</span> x<span class="op">,</span> L<span class="op">,</span> mid<span class="op">),</span> mdy1<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>    upd<span class="op">(</span>k<span class="op">);</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> mdy2<span class="op">(</span><span class="dt">int</span> k<span class="op">,</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">,</span> <span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>l <span class="op">==</span> L <span class="op">&amp;&amp;</span> r <span class="op">==</span> R<span class="op">)</span> <span class="op">{</span> pushdiv<span class="op">(</span>k<span class="op">,</span> x<span class="op">);</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>    pushdown<span class="op">(</span>k<span class="op">);</span></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>r <span class="op">&lt;=</span> mid<span class="op">)</span> mdy2<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> L<span class="op">,</span> mid<span class="op">);</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>l <span class="op">&gt;</span> mid<span class="op">)</span> mdy2<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> mdy2<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> mid<span class="op">,</span> x<span class="op">,</span> L<span class="op">,</span> mid<span class="op">),</span> mdy2<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>    upd<span class="op">(</span>k<span class="op">);</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> mdy3<span class="op">(</span><span class="dt">int</span> k<span class="op">,</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">,</span> <span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>l <span class="op">==</span> L <span class="op">&amp;&amp;</span> r <span class="op">==</span> R<span class="op">)</span> <span class="op">{</span> pushemp<span class="op">(</span>k<span class="op">);</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>    pushdown<span class="op">(</span>k<span class="op">);</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>r <span class="op">&lt;=</span> mid<span class="op">)</span> mdy3<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> L<span class="op">,</span> mid<span class="op">);</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>l <span class="op">&gt;</span> mid<span class="op">)</span> mdy3<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> mdy3<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> mid<span class="op">,</span> x<span class="op">,</span> L<span class="op">,</span> mid<span class="op">),</span> mdy3<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>    upd<span class="op">(</span>k<span class="op">);</span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> qry<span class="op">(</span><span class="dt">int</span> k<span class="op">,</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">,</span> <span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">)</span></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>l <span class="op">==</span> L <span class="op">&amp;&amp;</span> r <span class="op">==</span> R<span class="op">)</span> <span class="cf">return</span> tree<span class="op">[</span>k<span class="op">].</span>ans<span class="op">;</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>    pushdown<span class="op">(</span>k<span class="op">);</span></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>r <span class="op">&lt;=</span> mid<span class="op">)</span></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> qry<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> L<span class="op">,</span> mid<span class="op">);</span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>l <span class="op">&gt;</span> mid<span class="op">)</span></span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> qry<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max<span class="op">(</span>qry<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> mid<span class="op">,</span> x<span class="op">,</span> L<span class="op">,</span> mid<span class="op">),</span> qry<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">));</span></span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> q<span class="op">,</span> a<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> build<span class="op">(</span><span class="dt">int</span> k<span class="op">,</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">)</span></span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>l <span class="op">==</span> r<span class="op">)</span> <span class="op">{</span> tree<span class="op">[</span>k<span class="op">].</span>mx <span class="op">=</span> tree<span class="op">[</span>k<span class="op">].</span>ans <span class="op">=</span> a<span class="op">[</span>l<span class="op">];</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>l <span class="op">+</span> r<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>    build<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> mid<span class="op">);</span></span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>    build<span class="op">(</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> r<span class="op">);</span></span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>    tree<span class="op">[</span>k<span class="op">].</span>mx <span class="op">=</span> tree<span class="op">[</span>k<span class="op">].</span>ans <span class="op">=</span> max<span class="op">(</span>tree<span class="op">[</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">].</span>mx<span class="op">,</span> tree<span class="op">[</span>k <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">].</span>mx<span class="op">);</span></span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a>    read<span class="op">(</span>n<span class="op">);</span> read<span class="op">(</span>q<span class="op">);</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> read<span class="op">(</span>a<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>    build<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>q<span class="op">--)</span></span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> op<span class="op">,</span> l<span class="op">,</span> r<span class="op">,</span> x<span class="op">;</span></span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a>        read<span class="op">(</span>op<span class="op">);</span> read<span class="op">(</span>l<span class="op">);</span> read<span class="op">(</span>r<span class="op">);</span> read<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> mdy1<span class="op">(</span><span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> mdy2<span class="op">(</span><span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> qry<span class="op">(</span><span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> r<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">));</span></span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> mdy3<span class="op">(</span><span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="ÊµÆÁÇπÊï∞ËøêÁÆóÊéßÂà∂Á≤æÂ∫¶">ÊµÆÁÇπÊï∞ËøêÁÆóÊéßÂà∂Á≤æÂ∫¶</h4>
<p>Áõ¥Êé•ÂÖ®ÈÉ®ËΩ¨ÂåñÊàêÊµÆÁÇπÊï∞ËøêÁÆóÔºå‰∏âÊ†áËÆ∞Á∫øÊÆµÊ†ë„ÄÇ</p>
<p>ËÄÉËôëÂà∞ÊµÆÁÇπÊï∞Ëá™Â∏¶Á≤æÂ∫¶ÊçüÂ§±ÔºåÂØπ‰∫éËæÉÂ§ßÁöÑÈô§Êï∞ÔºåËá™Âä®‰ΩøÂæóÂéüÊï∞ÂèòÊàêÈõ∂Ôºå<code>long double</code>
ÁöÑÁ≤æÂ∫¶ÂèØ‰ª•ÊîØÊåÅ„ÄÇ</p>
<p>ÁàÜÈõ∂Â∞èÊäÄÂ∑ßÔºö<code>ST</code>Ë°®Á©∫Èó¥ÂºÄ‰∏ÄÂÄç</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ST<span class="op">[</span>_<span class="op">][</span>LOG <span class="op">+</span> <span class="dv">3</span><span class="op">],</span> Log<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> init_query<span class="op">(){</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> ST<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> A<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> LOG<span class="op">)</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> ST<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>ST<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">],</span> ST<span class="op">[</span>i <span class="op">+</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="op">(</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">))][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">]);</span> <span class="co">// ST[i + (1 &lt;&lt; (j - 1))][j - 1] ‰ºöËÆøÈóÆ O( 2 * N )</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    Log<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> n<span class="op">)</span> Log<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> Log<span class="op">[</span>i <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">2e5</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> q<span class="op">;</span> LL A<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> Acceptable_Solution<span class="op">{</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">2e5</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="dt">int</span> LOG <span class="op">=</span> <span class="dv">17</span><span class="op">;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ST<span class="op">[</span>_<span class="op">][</span>LOG <span class="op">+</span> <span class="dv">3</span><span class="op">],</span> Log<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> init_query<span class="op">(){</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> ST<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> A<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> LOG<span class="op">)</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> ST<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>ST<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">],</span> ST<span class="op">[</span>i <span class="op">+</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="op">(</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">))][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">]);</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        Log<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> n<span class="op">)</span> Log<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> Log<span class="op">[</span>i <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> Query_Max<span class="op">(</span><span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> Lg <span class="op">=</span> Log<span class="op">[</span>R <span class="op">-</span> L <span class="op">+</span> <span class="dv">1</span><span class="op">];</span> <span class="dt">int</span> Len <span class="op">=</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> Lg<span class="op">);</span> <span class="cf">return</span> max<span class="op">(</span>ST<span class="op">[</span>L<span class="op">][</span>Lg<span class="op">],</span> ST<span class="op">[</span>R <span class="op">-</span> Len <span class="op">+</span> <span class="dv">1</span><span class="op">][</span>Lg<span class="op">]);</span> <span class="op">}</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define LB </span><span class="dt">long</span><span class="pp"> </span><span class="dt">double</span><span class="pp"> </span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    LB eps<span class="op">;</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> print<span class="op">(</span>LB x<span class="op">)</span> <span class="op">{</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%.20Lf\n</span><span class="st">&quot;</span><span class="op">,</span> x<span class="op">);</span> <span class="op">}</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">namespace</span> SegmentTree<span class="op">{</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> same<span class="op">(</span>LB x<span class="op">,</span> LB y<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> fabs<span class="op">(</span>x <span class="op">-</span> y<span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">1e-12</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">6e5</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ch<span class="op">[</span>_<span class="op">][</span><span class="dv">2</span><span class="op">],</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>        LB v<span class="op">[</span>_<span class="op">],</span> tag_add<span class="op">[</span>_<span class="op">],</span> tag_mul<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> tag_ret<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        <span class="pp">#define ls</span><span class="op">(</span>o<span class="op">)</span><span class="pp"> </span><span class="op">(</span>ch<span class="op">[</span>o<span class="op">][</span><span class="dv">0</span><span class="op">])</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        <span class="pp">#define rs</span><span class="op">(</span>o<span class="op">)</span><span class="pp"> </span><span class="op">(</span>ch<span class="op">[</span>o<span class="op">][</span><span class="dv">1</span><span class="op">])</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>        <span class="pp">#define maintain</span><span class="op">(</span>o<span class="op">)</span><span class="pp"> </span><span class="op">(</span>v<span class="op">[</span>o<span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span>max<span class="op">(</span>v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)],</span><span class="pp"> </span>v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)]))</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>        <span class="pp">#define make </span><span class="op">(</span>tot<span class="op">++,</span><span class="pp"> </span>ch<span class="op">[</span>tot<span class="op">][</span><span class="dv">0</span><span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span>ch<span class="op">[</span>tot<span class="op">][</span><span class="dv">1</span><span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="dv">0</span><span class="op">,</span><span class="pp"> </span>tag_add<span class="op">[</span>tot<span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="dv">0</span><span class="op">,</span><span class="pp"> </span>tag_mul<span class="op">[</span>tot<span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="dv">1</span><span class="op">,</span><span class="pp"> </span>tag_ret<span class="op">[</span>tot<span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="dv">0</span><span class="op">,</span><span class="pp"> </span>tot<span class="op">)</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> Groot<span class="op">(){</span> <span class="cf">return</span> make<span class="op">;</span> <span class="op">}</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> build<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>L <span class="op">==</span> R<span class="op">)</span> <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">)(</span>v<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> A<span class="op">[</span>L<span class="op">]);</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span> ls<span class="op">(</span>o<span class="op">)</span> <span class="op">=</span> make<span class="op">;</span> rs<span class="op">(</span>o<span class="op">)</span> <span class="op">=</span> make<span class="op">;</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>            build<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> L<span class="op">,</span> mid<span class="op">);</span> build<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>            maintain<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> tar_ret<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>            v<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> Query_Max<span class="op">(</span>L<span class="op">,</span> R<span class="op">);</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>            tag_add<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> tag_mul<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>            tag_ret<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> push_ret<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(!</span>tag_ret<span class="op">[</span>o<span class="op">])</span> <span class="cf">return</span> <span class="op">;</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>            tar_ret<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> L<span class="op">,</span> mid<span class="op">);</span> tar_ret<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>            tag_ret<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> tar_add<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> LB Val<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>            push_ret<span class="op">(</span>o<span class="op">,</span> L<span class="op">,</span> R<span class="op">);</span> </span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>            v<span class="op">[</span>o<span class="op">]</span> <span class="op">+=</span> Val<span class="op">;</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>            tag_add<span class="op">[</span>o<span class="op">]</span> <span class="op">+=</span> Val<span class="op">;</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> tar_mul<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> LB Val<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>            push_ret<span class="op">(</span>o<span class="op">,</span> L<span class="op">,</span> R<span class="op">);</span> </span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>            v<span class="op">[</span>o<span class="op">]</span> <span class="op">*=</span> Val<span class="op">;</span> </span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>            tag_mul<span class="op">[</span>o<span class="op">]</span> <span class="op">*=</span> Val<span class="op">;</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>            tag_add<span class="op">[</span>o<span class="op">]</span> <span class="op">*=</span> Val<span class="op">;</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> push<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>            push_ret<span class="op">(</span>o<span class="op">,</span> L<span class="op">,</span> R<span class="op">);</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(!</span>same<span class="op">(</span>tag_mul<span class="op">[</span>o<span class="op">],</span> <span class="dv">1</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>                tar_mul<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> tag_mul<span class="op">[</span>o<span class="op">],</span> L<span class="op">,</span> mid<span class="op">);</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>                tar_mul<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> tag_mul<span class="op">[</span>o<span class="op">],</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>                tag_mul<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(!</span>same<span class="op">(</span>tag_add<span class="op">[</span>o<span class="op">],</span> <span class="dv">0</span><span class="op">)){</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>                tar_add<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> tag_add<span class="op">[</span>o<span class="op">],</span> L<span class="op">,</span> mid<span class="op">);</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>                tar_add<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> tag_add<span class="op">[</span>o<span class="op">],</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>                tag_add<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> update_add<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">,</span> <span class="dt">int</span> Val<span class="op">){</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> nowl <span class="op">&amp;&amp;</span> nowr <span class="op">&lt;=</span> R<span class="op">)</span> <span class="cf">return</span> tar_add<span class="op">(</span>o<span class="op">,</span> Val<span class="op">,</span> nowl<span class="op">,</span> nowr<span class="op">);</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>            push<span class="op">(</span>o<span class="op">,</span> nowl<span class="op">,</span> nowr<span class="op">);</span></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> mid<span class="op">)</span> update_add<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> Val<span class="op">);</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>R  <span class="op">&gt;</span> mid<span class="op">)</span> update_add<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> Val<span class="op">);</span></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>            maintain<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> update_mul<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">,</span> LB Val<span class="op">){</span></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> nowl <span class="op">&amp;&amp;</span> nowr <span class="op">&lt;=</span> R<span class="op">)</span> <span class="cf">return</span> tar_mul<span class="op">(</span>o<span class="op">,</span> Val<span class="op">,</span> nowl<span class="op">,</span> nowr<span class="op">);</span></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>            push<span class="op">(</span>o<span class="op">,</span> nowl<span class="op">,</span> nowr<span class="op">);</span></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> mid<span class="op">)</span> update_mul<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> Val<span class="op">);</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>R  <span class="op">&gt;</span> mid<span class="op">)</span> update_mul<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> Val<span class="op">);</span></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>            maintain<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> update_ret<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> nowl <span class="op">&amp;&amp;</span> nowr <span class="op">&lt;=</span> R<span class="op">)</span> <span class="cf">return</span> tar_ret<span class="op">(</span>o<span class="op">,</span> nowl<span class="op">,</span> nowr<span class="op">);</span></span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>            push<span class="op">(</span>o<span class="op">,</span> nowl<span class="op">,</span> nowr<span class="op">);</span></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> mid<span class="op">)</span> update_ret<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> L<span class="op">,</span> R<span class="op">);</span></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>R  <span class="op">&gt;</span> mid<span class="op">)</span> update_ret<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> L<span class="op">,</span> R<span class="op">);</span></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>            maintain<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>        LB query<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> nowl <span class="op">&amp;&amp;</span> nowr <span class="op">&lt;=</span> R<span class="op">)</span> <span class="cf">return</span> v<span class="op">[</span>o<span class="op">];</span></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>            push<span class="op">(</span>o<span class="op">,</span> nowl<span class="op">,</span> nowr<span class="op">);</span></span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>            LB ans <span class="op">=</span> LLONG_MIN<span class="op">;</span></span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> mid<span class="op">)</span> ans <span class="op">=</span> max<span class="op">(</span>ans<span class="op">,</span> query<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> L<span class="op">,</span> R<span class="op">));</span></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>R  <span class="op">&gt;</span> mid<span class="op">)</span> ans <span class="op">=</span> max<span class="op">(</span>ans<span class="op">,</span> query<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> L<span class="op">,</span> R<span class="op">));</span></span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> </span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span><span class="kw">using</span> SegmentTree<span class="op">::</span>build<span class="op">;</span>       <span class="kw">using</span> SegmentTree<span class="op">::</span>query<span class="op">;</span>       <span class="kw">using</span> SegmentTree<span class="op">::</span>update_add<span class="op">;</span></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>     <span class="kw">using</span> SegmentTree<span class="op">::</span>update_mul<span class="op">;</span>  <span class="kw">using</span> SegmentTree<span class="op">::</span>update_ret<span class="op">;</span>  <span class="kw">using</span> SegmentTree<span class="op">::</span>Groot<span class="op">;</span></span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> work<span class="op">(){</span></span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>        init_query<span class="op">();</span></span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> root <span class="op">=</span> Groot<span class="op">();</span> build<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">);</span> LB one <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(</span>q<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> t<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> x<span class="op">;</span> Read<span class="op">(</span>t<span class="op">)(</span>L<span class="op">)(</span>R<span class="op">)(</span>x<span class="op">);</span> L <span class="op">++,</span> R <span class="op">++;</span></span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>t <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> update_add<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> x<span class="op">);</span></span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>t <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> update_mul<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> one <span class="op">/</span> x<span class="op">);</span></span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>t <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span><span class="op">)(</span>query<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> L<span class="op">,</span> R<span class="op">)</span> <span class="op">+</span> <span class="fl">1e-10</span><span class="op">));</span></span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>t <span class="op">==</span> <span class="dv">3</span><span class="op">)</span> update_ret<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> L<span class="op">,</span> R<span class="op">);</span></span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span> <span class="co">//freopen(&quot;in.txt&quot;, &quot;r&quot;, stdin);</span></span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">)(</span>q<span class="op">);</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> Read<span class="op">(</span>A<span class="op">[</span>i<span class="op">]);</span> </span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>    Acceptable_Solution<span class="op">::</span>work<span class="op">();</span></span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="d.-four">D. four</h3>
<p>‰Ω†Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1..2</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">1..2n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1..2</span><span class="mord mathnormal">n</span></span></span></span>
ÂÖ±
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">2n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span></span></span></span>
‰∏™Êï∞ÔºåÊúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
‰∏™‰∫∫Ôºå‰Ω†‰ºöÁªôÊØè‰∏™‰∫∫ÂàÜ‰∏§‰∏™ÈöèÊú∫ÁöÑÊï∞ÔºåËøôÊ†∑Â∞±Êää
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">2n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span></span></span></span>
‰∏™Êï∞ÂàÜÂÆå‰∫ÜÔºåÊØè‰∏™‰∫∫Ëé∑ÂæóÁöÑÊÄªÊï∞Â∞±ÊòØËøô‰∏§‰∏™Êï∞Áõ∏Âä†„ÄÇËøô‰∏™ÈöèÊú∫ËøáÁ®ãÂèØ‰ª•ËÆ§‰∏∫ÊòØÔºåÂÖàÊää
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">2n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span></span></span></span>
‰∏™Êï∞ÈöèÊú∫ÊéíÂàóÔºåÂ∞ÜÂâç2‰∏™Êï∞ÂàÜÁªôÁ¨¨‰∏Ä‰∏™‰∫∫ÔºåÂ∞ÜÊé•‰∏ãÊù•Ââç2‰∏™Êï∞ÂàÜÁªôÁ¨¨‰∫å‰∏™‰∫∫‚Ä¶‚Ä¶‰∏çÈöæÁúãÂá∫Ëøô‰∏™ËøáÁ®ãÊòØÊ≤°ÊúâÊ≠ß‰πâÁöÑ</p>
<p>‰Ω†ÊÉ≥Áü•ÈÅìÊúâÂ§öÂ§ßÊ¶ÇÁéáÔºå‰ΩøÂæóÊÄªÂíåÊúÄÂ§ßÁöÑ‰∫∫ÂîØ‰∏ÄÔºà‰∏çÂ≠òÂú®‰∏§‰∏™Áõ∏ÂêåÁöÑÊúÄÂ§ßÂÄºÔºâÔºåÁ≠îÊ°àÊ®°
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>998244353</mn></mrow><annotation encoding="application/x-tex">998244353</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">998244353</span></span></span></span></p>
<p>Ê≤°Âê¨ÊáÇ‚Ä¶„ÄÇ</p>
<h2 id="round-3">Round 3</h2>
<h3 id="a.-diyiti">A. diyiti</h3>
<p>Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
‰∏™Áâ©ÂìÅÔºåÊØè‰∏™Áâ©ÂìÅ‰ª∑Ê†º
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ÔºåÊî∂Áõä‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">B_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ÔºåÁî±‰∫é‰∏Ä‰∫õÂ••Â¶ôÈáçÈáçÁöÑÂéüÂõ†ÔºåÂΩì‰Ω†‰π∞‰∫Ü‰∏Ä‰∫õÁâ©ÂìÅÔºåÊÄª‰ª∑Ê†º‰∏∫ÈÄâÊã©ÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ÁöÑÊåâ‰ΩçÊàñËÄå‰∏çÊòØ‰ª£Êï∞Áõ∏Âä†!</p>
<p>‰Ω†Ë∫´‰∏äÂè™Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÂÖÉÈí±Ôºå‰Ω†Â∏åÊúõÈÄâÊã©ÊÄª‰ª∑Ê†º‰∏çË∂ÖËøá
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÁöÑ‰∏Ä‰∫õÁâ©ÂìÅÔºåÊù•Ëé∑ÂæóÊúÄÂ§ßÁöÑÊî∂Áõä„ÄÇ</p>
<p>ÂØπ‰∫éÊâÄÊúâÊï∞ÊçÆÔºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚â§</mo><mi>n</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup><mo separator="true">,</mo><mn>0</mn><mo>‚â§</mo><mi>k</mi><mo>&lt;</mo><msup><mn>2</mn><mn>30</mn></msup><mo separator="true">,</mo><mn>0</mn><mo>‚â§</mo><msub><mi>A</mi><mi>i</mi></msub><mo>&lt;</mo><msup><mn>2</mn><mn>30</mn></msup><mo separator="true">,</mo><mn>0</mn><mo>‚â§</mo><msub><mi>B</mi><mi>i</mi></msub><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding="application/x-tex">1\leq n\leq 10^5,0\leq k &lt; 2^{30},0 \leq A_i &lt; 2^{30},0 \leq B_i \leq 10^9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">30</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">30</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span>„ÄÇ</p>
<p>‰∏ÄÁßçÂ§©ÁÑ∂ÁöÑÊÉ≥Ê≥ïÂ∞±ÊòØËÄÉËôëÊûö‰∏æÔºåÊØè‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>‚â§</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i \le k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7955em;vertical-align:-0.136em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÁÑ∂ÂêéÁ¥ØÂä†ÊâÄÊúâÂèØ‰ª•Ë¢´ÈÄâÁöÑÁâ©ÂìÅÊ±ÇÊúÄÂ§ßÂÄºÔºåÊòæÁÑ∂ËÉΩ‰øùËØÅÊ≠£Á°ÆÊÄß„ÄÇÂæóÂà∞‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>k</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(k n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">kn</span><span class="mclose">)</span></span></span></span>
ÁöÑ‰ºòÁßÄÂÅöÊ≥ï„ÄÇ ÂèëÁé∞ËøôÊ†∑Êûö‰∏æÁöÑÊØè‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>
ÊúâÂæàÂ§öÊ≤°ÊúâÂøÖË¶ÅÁöÑÊûö‰∏æ„ÄÇ</p>
<p>ÂÖ∂ÂÆûÂèØ‰ª•Êûö‰∏æÊîæÂºÉ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÁöÑÂì™‰∏Ä‰Ωç <code>1</code>„ÄÇ</p>
<p>‰æãÂ¶Ç: Ëã•
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1001101001</mn><msub><mo stretchy="false">)</mo><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">k = (1001101001)_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1001101001</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ÈÇ£‰πàÊúâÊÑè‰πâÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>
Â∞±ÂèØËÉΩÊòØÔºö -
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0111111111</mn><msub><mo stretchy="false">)</mo><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">(0111111111)_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0111111111</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
-
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1000111111</mn><msub><mo stretchy="false">)</mo><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">(1000111111)_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1000111111</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
-
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1001011111</mn><msub><mo stretchy="false">)</mo><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">(1001011111)_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1001011111</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
-
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1001100111</mn><msub><mo stretchy="false">)</mo><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">(1001100111)_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1001100111</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
-
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1001101001</mn><msub><mo stretchy="false">)</mo><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">(1001101001)_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1001101001</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>‰πüÂ∞±ÊòØÊûö‰∏æÊüê‰∏Ä‰Ωç
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>
ÊääËøô‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>
ÂèòÊàê
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ÔºåÁÑ∂ÂêéÊääËøôÂêéÈù¢ÁöÑÊâÄÊúâÊï∞Â≠óÂèòÊàê
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>„ÄÇ</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> k<span class="op">;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> Lim<span class="op">[</span>_<span class="op">],</span> Pr<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>LL calc<span class="op">(</span><span class="dt">int</span> x<span class="op">){</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    LL ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> <span class="cf">if</span><span class="op">((</span>x <span class="op">|</span> Lim<span class="op">[</span>i<span class="op">])</span> <span class="op">==</span> x<span class="op">)</span> ans <span class="op">+=</span> Pr<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">)(</span>k<span class="op">);</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> Read<span class="op">(</span>Lim<span class="op">[</span>i<span class="op">])(</span>Pr<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    LL ans <span class="op">=</span> calc<span class="op">(</span>k<span class="op">);</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">30</span><span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--){</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>k <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> i<span class="op">))</span> <span class="op">;</span> <span class="cf">else</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> Lit <span class="op">=</span> k<span class="op">;</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        Lit <span class="op">^=</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> i<span class="op">);</span> Lit <span class="op">|=</span> <span class="op">((</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> i<span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> max<span class="op">(</span>calc<span class="op">(</span>Lit<span class="op">),</span> ans<span class="op">);</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="b.-dierti">B. dierti</h3>
<p>Áªô‰Ω†‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÊï∞ÁªÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">a_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>Ôºå‰Ω†ÈúÄË¶ÅÊ±ÇÂá∫‰∏Ä‰∏™ÊúÄÈïøÁöÑÂ≠êÂ∫èÂàó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>Ôºå‰ΩøÂæóÂÖ∂Áõ∏ÈÇª‰∏§È°πÊåâ‰Ωç‰∏éÁöÑÁªìÊûúÂùáÈùûÈõ∂
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="normal">‚àÄ</mi><mtext>¬†</mtext><mi>i</mi><mo separator="true">,</mo><mtext>¬†</mtext><msub><mi>C</mi><mi>i</mi></msub><mtext>¬†</mtext><mo>&amp;</mo><mtext>¬†</mtext><msub><mi>C</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>&gt;</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">( \forall\ i,\ C_i\ \And \  C_{i+1} &gt; 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">‚àÄ</span><span class="mspace">¬†</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace">¬†</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace">¬†</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&amp;</span><span class="mspace">¬†</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>„ÄÇ</p>
<p>ËøôÊØîÁ¨¨‰∏ÄÈ¢òÂ•ΩÊÉ≥Â§ö‰∫ÜÂêß„ÄÇ ËÄÉËôë
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>
Ë°®Á§∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1, n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>
‰∏≠Âº∫Âà∂
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
‰∏ÄÂÆöÈÄâ Á¨¶ÂêàË¶ÅÊ±ÇÁöÑÊúÄÈïøÂ≠êÂ∫èÂàóÔºåÂèØ‰ª•ËÄÉËôëÊûö‰∏æ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1..</mn><mi>n</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1..n - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1..</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>
‰∏≠‰∏ä‰∏Ä‰∏™ÈÄâÊã©ÁöÑÊòØÂì™‰∏Ä‰∏™ÔºåÂç≥
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo>=</mo><mn>1</mn><mo>+</mo><msubsup><mrow><mi>max</mi><mo>‚Å°</mo></mrow><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow></msubsup><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>C</mi><mi>i</mi></msub><mo>&amp;</mo><msub><mi>C</mi><mi>n</mi></msub><mo>&gt;</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">dp[n] = 1 + \max_{i = 1}^{n - 1}\limits{dp[i][C_i \And C_n &gt; 0]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.9093em;vertical-align:-0.7277em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1817em;"><span style="top:-2.3723em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">max</span></span></span><span style="top:-3.6306em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.7277em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&amp;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span></span>
ËøôÊ†∑ÁöÑÂ§çÊùÇÂ∫¶ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
ÁöÑ„ÄÇ</p>
<p>ËÄÉËôëÂ¶ÇÊûúÊª°Ë∂≥
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub><mo>&amp;</mo><msub><mi>C</mi><mi>j</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">C_i \And C_j &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&amp;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>
ÈÇ£‰πàÈúÄË¶Å
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>C</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">C_i, C_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>
Ëá≥Â∞ë‰∏Ä‰∏™‰∫åËøõÂà∂‰ΩçÁΩÆÁõ∏Âêå„ÄÇÈÇ£Â∞±Áª¥Êä§‰∏Ä‰∏™Êï∞ÁªÑÔºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Bmax[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>
Ë°®Á§∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>
ÁöÑÁ¨¨
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>
‰Ωç‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>
ÁöÑÊâÄÊúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">C_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>
ÊúÄÂ§ßÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>ÔºåÂç≥ÂèØÂÆûÁé∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>‚Å°</mo><msub><mi>C</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\log C_{max})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
ËΩ¨Áßª„ÄÇÂêåÊó∂ÈúÄË¶Å
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>‚Å°</mo><msub><mi>C</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\log C_{max})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
Áª¥Êä§Êï∞ÁªÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">Bmax</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span></span></span></span>„ÄÇ</p>
<p>ÊÄªÂ§çÊùÇÂ∫¶
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>‚Å°</mo><msub><mi>C</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n\log C_{max} )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>„ÄÇ</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> A<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> Bmax<span class="op">[</span><span class="dv">60</span><span class="op">];</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dp<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> read<span class="op">();</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> Read<span class="op">(</span>A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">30</span><span class="op">)</span> <span class="cf">if</span><span class="op">(</span>A<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> j<span class="op">))</span> Bmax<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>Bmax<span class="op">[</span>j<span class="op">],</span> dp<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> n<span class="op">){</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">30</span><span class="op">)</span> <span class="cf">if</span><span class="op">(</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> j<span class="op">))</span> ans <span class="op">=</span> max<span class="op">(</span>ans<span class="op">,</span> Bmax<span class="op">[</span>j<span class="op">]);</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> ans <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">30</span><span class="op">)</span> <span class="cf">if</span><span class="op">(</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> j<span class="op">))</span> Bmax<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>Bmax<span class="op">[</span>j<span class="op">],</span> dp<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> ans <span class="op">=</span> max<span class="op">(</span>ans<span class="op">,</span> dp<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span> cerr <span class="op">&lt;&lt;</span> <span class="st">&quot;std&#39;s ans = &quot;</span> <span class="op">&lt;&lt;</span> ans <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="c.-disanti">C. disanti</h3>
<h4 id="statement">statement</h4>
<p>‰Ω†Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span>
ËøõÂà∂‰∏ãÁöÑ‰ΩçÊï∞‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>
ÁöÑÊï∞</p>
<p>Êúâ‰∫õÊï∞Â≠óË¢´ÊäπÂéª‰∫ÜÔºåÂõ†Ê≠§ÂèñÂÄº‰ªªÊÑè„ÄÇ</p>
<p>‰Ω†Â∏åÊúõËøô
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
‰∏™Êï∞ÂçïË∞ÉÈÄíÂ¢ûÔºåËØ∑Ê±ÇÂá∫ÊâÄÊúâÊª°Ë∂≥Ëøô‰∏™Êù°‰ª∂ÁöÑÊñπÊ°à‰∏ãÔºåËøô
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
‰∏™Êï∞‰πãÂíåÁöÑÊÄªÂíå„ÄÇ</p>
<p>Á≠îÊ°àÂØπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>998244353</mn></mrow><annotation encoding="application/x-tex">998244353</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">998244353</span></span></span></span>
ÂèñÊ®°„ÄÇ</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo>‚â§</mo><mn>30</mn></mrow><annotation encoding="application/x-tex">n,m\leq 30</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">30</span></span></span></span>
#### input</p>
<p>Á¨¨‰∏ÄË°å‰∏§‰∏™Êï¥Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">(</mo><mn>1</mn><mo>‚â§</mo><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo>‚â§</mo><mn>50</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n,m(1\leq n,m\leq 50)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">50</span><span class="mclose">)</span></span></span></span></p>
<p>Êé•‰∏ãÊù•
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
Ë°åÔºåÊØèË°å
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>
‰∏™Â≠óÁ¨¶ÔºåÂ≠óÁ¨¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0..9</mn></mrow><annotation encoding="application/x-tex">0..9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0..9</span></span></span></span>
ÁöÑÊï∞Â≠óÊàñËÄÖ<code>?</code>„ÄÇ</p>
<pre><code>INPUT0:
4 1
0
?
4
8
OUTPUT0:
42</code></pre>
<pre><code>INPUT1:
5 5
?1234
23333
???66
??666
?233?
OUTPUT1:
819525655</code></pre>
<p>Ê≤°Âê¨ÊáÇ‚Ä¶ ÂæÖË°•„ÄÇ</p>
<h3 id="d.-disiti">D. disiti</h3>
<p>‰Ω†Êúâ‰∏ÄÂ†Ü<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>‰∏™Áü≥Â≠êÁöÑÁü≥Â≠êÂ†ÜÔºå‰Ω†ÊÉ≥Ë¶ÅÊääÁü≥Â≠êÂ†ÜË£ÇÊàê<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>‰∏™Â§ßÂ∞è‰∏∫<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ÁöÑÁü≥Â≠êÂ†Ü„ÄÇ‰∏∫‰∫ÜËææÊàêËøô‰∏™ÁõÆÁöÑÔºå‰Ω†ÊØèÊ¨°ÂèØ‰ª•ËøõË°åÂ¶Ç‰∏ãÊìç‰ΩúÔºöÂÅáËÆæÁé∞Âú®Êúâ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>Â†ÜÁü≥Â≠êÔºåÂ§ßÂ∞èÂàÜÂà´‰∏∫<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>a</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">a_1, a_2, ... ,a_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>Ôºå‰Ω†ÂèØ‰ª•ÊåáÂÆö‰∏Ä‰∏™ÈùûË¥üÊï¥Êï∞Â∫èÂàó<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>b</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">b_1, b_2, ... ,b_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ÔºåÊª°Ë∂≥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àë</mo><msub><mi>b</mi><mi>i</mi></msub><mo>‚â§</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">\sum b_i\leq m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">‚àë</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>ÔºåÊØèÂ†ÜÁü≥Â≠êÂ∞±‰ºöÂàÜË£ÇÊàê‰∏§Â†Ü<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>‚àí</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i, a_i-b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ÔºàÂ¶ÇÊûú‰∏∫<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>Â∞±ËÆ§‰∏∫‰∏çÂ≠òÂú®ÔºåÊòæÁÑ∂ËøòÈúÄË¶ÅÊª°Ë∂≥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>‚â§</mo><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i \leq a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>Ôºâ„ÄÇ‰Ω†ÊÉ≥Ë¶ÅÁü•ÈÅìÊúÄÂ∞ëÂá†Ê¨°Êìç‰ΩúÂèØ‰ª•ËææÊàêÁõÆÁöÑ„ÄÇ
ÂØπ‰∫éÊâÄÊúâÊï∞ÊçÆÔºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>‚â§</mo><mn>1000</mn><mo separator="true">,</mo><mn>1</mn><mo>‚â§</mo><mi>m</mi><mo>‚â§</mo><mi>n</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding="application/x-tex">T\leq 1000,1\leq m\leq n\leq 10^9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1000</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span></p>
<p>Ê≤°Âê¨ÊáÇ‚Ä¶ ÂæÖË°•„ÄÇ</p>
<h2 id="round-4">Round 4</h2>
<h3 id="a.-‰∏Ä">A. ‰∏Ä</h3>
<p>‰Ω†ÊòØËÉΩÁúãÂà∞Á¨¨‰∏ÄÈ¢òÁöÑfriendsÂë¢„ÄÇ ‚Äî‚Äîhja
‰ºóÊâÄÂë®Áü•ÔºåÂ∞èËë±ÂêåÂ≠¶ÊìÖÈïøËÆ°ÁÆóÔºåÂ∞§ÂÖ∂ÊìÖÈïøËÆ°ÁÆóÁªÑÂêàÊï∞Ôºå‰ΩÜËøô‰∏™È¢òÂíåÁªÑÂêàÊï∞Ê≤°‰ªÄ‰πàÂÖ≥Á≥ª„ÄÇ</p>
<p>Áé∞Âú®Êàë‰ª¨Ë¶ÅÊâßË°åËã•Âπ≤‰ª£Á†ÅÔºå‰ª£Á†Å‰∏∫ÂØπ‰∫éÂèòÈáèÁöÑÊìç‰ΩúÔºåÂåÖÂê´‰ª•‰∏ã‰∏âÁßçÔºö -
1„ÄÅÂèòÈáèÂêç=ÂèòÈáèÂÄºÔºåÂèòÈáèÂêçÁî±Â∞èÂÜôÂ≠óÊØçÁªÑÊàêÔºåÂèòÈáèÂÄºÊúâÂèØËÉΩÊòØÊ≠£Êï¥Êï∞ÊàñËÄÖÂ≠óÁ¨¶‰∏≤ÔºàÂ∞èÂÜôÂ≠óÊØçÊàñËÄÖÊï∞Â≠óÔºâÔºå‰æãÂ¶ÇÔºöa=3,b=‚Äú233‚Äù„ÄÇ
- 2„ÄÅÂèòÈáèÂêçÔºå‰ª£Ë°®ËØ¢ÈóÆËØ•ÂèòÈáèÁöÑÂÄºÔºåÂ¶ÇÊûúËØ•ÂèòÈáèÊú™ËµãÂÄºÔºåÂàôËæìÂá∫no„ÄÇ -
3„ÄÅÂèòÈáèÂêç+=ÂÄºÔºåÂ¶ÇÊûúËØ•ÂèòÈáèÊú™ÂÆö‰πâÔºåÁõ¥Êé•Ë∑≥ËøáËØ•Ê¨°Êìç‰Ωú„ÄÇËÆæËØ•ÂèòÈáèÁöÑÂÄº‰∏∫xÔºåÂä†‰∏äÁöÑÂÄº‰∏∫yÔºåÂ¶ÇÊûú‰∏§ËÄÖÂùá‰∏∫Êï¥Êï∞Áõ¥Êé•Áõ∏Âä†ÔºõÂ¶ÇÊûúxÊòØÊï¥Êï∞y‰∏∫Â≠óÁ¨¶‰∏≤ÂàôË∑≥ËøáÊ≠§Ê¨°Êìç‰ΩúÔºõÂ¶ÇÊûúxÊòØÂ≠óÁ¨¶‰∏≤yÊòØÊï¥Êï∞ÂàôÂ∞ÜyËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤ËøõË°åÂ≠óÁ¨¶‰∏≤ÊãºÊé•ÔºõÂ¶ÇÊûú‰∏§ËÄÖÂùá‰∏∫Â≠óÁ¨¶‰∏≤Áõ¥Êé•ËøõË°åÂ≠óÁ¨¶‰∏≤ÊãºÊé•„ÄÇ
-</p>
<p>ÂÖ®Á®ã STL„ÄÇ</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>map<span class="op">&lt;</span>string <span class="op">,</span> string<span class="op">&gt;</span> M<span class="op">;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>map<span class="op">&lt;</span>string <span class="op">,</span> <span class="dt">bool</span> <span class="op">&gt;</span> Type<span class="op">;</span> <span class="co">// true for string , false for int</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>string tmp<span class="op">;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>pair<span class="op">&lt;</span>string <span class="op">,</span> string<span class="op">&gt;</span> Res<span class="op">;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> split<span class="op">(</span>string S<span class="op">){</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>S<span class="op">.</span>find<span class="op">(</span><span class="ch">&#39;=&#39;</span><span class="op">)</span> <span class="op">&gt;=</span> S<span class="op">.</span>size<span class="op">()</span> <span class="op">||</span> S<span class="op">.</span>find<span class="op">(</span><span class="ch">&#39;=&#39;</span><span class="op">)</span> <span class="op">&lt;</span> <span class="dv">0</span><span class="op">){</span> <span class="co">// </span><span class="al">TODO</span><span class="co">: check</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>S<span class="op">.</span>find<span class="op">(</span><span class="ch">&#39;+&#39;</span><span class="op">)</span> <span class="op">&lt;</span> S<span class="op">.</span>size<span class="op">()</span> <span class="op">&amp;&amp;</span> S<span class="op">.</span>find<span class="op">(</span><span class="ch">&#39;+&#39;</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">){</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>            Res <span class="op">=</span> make_pair<span class="op">(</span>S<span class="op">.</span>substr<span class="op">(</span><span class="dv">0</span><span class="op">,</span> S<span class="op">.</span>find<span class="op">(</span><span class="ch">&#39;+&#39;</span><span class="op">)),</span> S<span class="op">.</span>substr<span class="op">(</span>S<span class="op">.</span>find<span class="op">(</span><span class="ch">&#39;=&#39;</span><span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> S<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> S<span class="op">.</span>find<span class="op">(</span><span class="ch">&#39;=&#39;</span><span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">));</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>            Res <span class="op">=</span> make_pair<span class="op">(</span>S<span class="op">.</span>substr<span class="op">(</span><span class="dv">0</span><span class="op">,</span> S<span class="op">.</span>find<span class="op">(</span><span class="ch">&#39;=&#39;</span><span class="op">)),</span> S<span class="op">.</span>substr<span class="op">(</span>S<span class="op">.</span>find<span class="op">(</span><span class="ch">&#39;=&#39;</span><span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> S<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> S<span class="op">.</span>find<span class="op">(</span><span class="ch">&#39;=&#39;</span><span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">));</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>string calc<span class="op">(</span>string A<span class="op">,</span> string B<span class="op">){</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> ResA <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> A<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>        ResA <span class="op">*=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>        ResA <span class="op">+=</span> A<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">;</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> ResB <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> B<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>        ResB <span class="op">*=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>        ResB <span class="op">+=</span> B<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">;</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    ResA <span class="op">+=</span> ResB<span class="op">;</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    string Res<span class="op">,</span> ans <span class="op">;</span> Res <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>ResA<span class="op">)</span> Res<span class="op">.</span>push_back<span class="op">(</span>ResA <span class="op">%</span> <span class="dv">10</span> <span class="op">+</span> <span class="ch">&#39;0&#39;</span><span class="op">),</span> ResA <span class="op">/=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> Res<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--)</span> ans<span class="op">.</span>push_back<span class="op">(</span>Res<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> pdType<span class="op">(</span>string <span class="op">&amp;</span>S<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> S<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">==</span> <span class="ch">&#39;&quot;&#39;</span><span class="op">;</span> <span class="op">}</span> <span class="co">// true for string</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span> <span class="co">//freopen(&quot;in.txt&quot;, &quot;r&quot;, stdin); freopen(&quot;out.txt&quot;, &quot;w&quot;, stdout);</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    ios<span class="op">::</span>sync_with_stdio<span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> q<span class="op">;</span> cin <span class="op">&gt;&gt;</span> q<span class="op">;</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>q<span class="op">--){</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>        cin <span class="op">&gt;&gt;</span> tmp<span class="op">;</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> r <span class="op">=</span> split<span class="op">(</span>tmp<span class="op">);</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>r <span class="op">==</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> re <span class="op">=</span> pdType<span class="op">(</span>Res<span class="op">.</span>second<span class="op">);</span> <span class="cf">if</span><span class="op">(</span>re<span class="op">)</span> Res<span class="op">.</span>second <span class="op">=</span> <span class="op">(</span>Res<span class="op">.</span>second<span class="op">.</span>size<span class="op">()</span> <span class="op">==</span> <span class="dv">2</span> <span class="op">?</span> string<span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">)</span> <span class="op">:</span> Res<span class="op">.</span>second<span class="op">.</span>substr<span class="op">(</span><span class="dv">1</span><span class="op">,</span> Res<span class="op">.</span>second<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">2</span><span class="op">));</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>            M<span class="op">[</span>Res<span class="op">.</span>first<span class="op">]</span> <span class="op">=</span> Res<span class="op">.</span>second<span class="op">;</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>            Type<span class="op">[</span>Res<span class="op">.</span>first<span class="op">]</span> <span class="op">=</span> re<span class="op">;</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>r <span class="op">==</span> <span class="dv">2</span><span class="op">){</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>M<span class="op">.</span>count<span class="op">(</span>tmp<span class="op">))</span>  cout <span class="op">&lt;&lt;</span> M<span class="op">[</span>tmp<span class="op">]</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> cout <span class="op">&lt;&lt;</span> <span class="st">&quot;no&quot;</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>M<span class="op">.</span>count<span class="op">(</span>Res<span class="op">.</span>first<span class="op">))</span> <span class="op">;</span> <span class="cf">else</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> <span class="dt">ex_t</span> <span class="op">=</span> pdType<span class="op">(</span>Res<span class="op">.</span>second<span class="op">);</span> <span class="cf">if</span><span class="op">(</span><span class="dt">ex_t</span><span class="op">)</span> Res<span class="op">.</span>second <span class="op">=</span> Res<span class="op">.</span>second<span class="op">.</span>substr<span class="op">(</span><span class="dv">1</span><span class="op">,</span> Res<span class="op">.</span>second<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> <span class="dt">no_t</span> <span class="op">=</span> Type<span class="op">[</span>Res<span class="op">.</span>first<span class="op">];</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span> <span class="dt">ex_t</span> <span class="op">&amp;&amp;</span>  <span class="dt">no_t</span><span class="op">)</span> M<span class="op">[</span>Res<span class="op">.</span>first<span class="op">]</span> <span class="op">=</span> M<span class="op">[</span>Res<span class="op">.</span>first<span class="op">]</span> <span class="op">+</span> Res<span class="op">.</span>second<span class="op">;</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span> <span class="dt">ex_t</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="dt">no_t</span><span class="op">)</span> <span class="op">{</span> <span class="cf">continue</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(!</span><span class="dt">ex_t</span> <span class="op">&amp;&amp;</span>  <span class="dt">no_t</span><span class="op">)</span> M<span class="op">[</span>Res<span class="op">.</span>first<span class="op">]</span> <span class="op">=</span> M<span class="op">[</span>Res<span class="op">.</span>first<span class="op">]</span> <span class="op">+</span> Res<span class="op">.</span>second<span class="op">;</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(!</span><span class="dt">ex_t</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="dt">no_t</span><span class="op">)</span> M<span class="op">[</span>Res<span class="op">.</span>first<span class="op">]</span> <span class="op">=</span> calc<span class="op">(</span>M<span class="op">[</span>Res<span class="op">.</span>first<span class="op">],</span> Res<span class="op">.</span>second<span class="op">);</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="b.-‰∫å">B. ‰∫å</h3>
<p>‰Ω†ÊòØËÉΩÁúãÂà∞Á¨¨‰∫åÈ¢òÁöÑfriendsÂë¢„ÄÇ ‚Äî‚Äîaoao</p>
<p>‰ºóÊâÄÂë®Áü•ÔºåÂ∞èËë±ÂêåÂ≠¶ÊìÖÈïøËÆ°ÁÆóÔºåÂ∞§ÂÖ∂ÊìÖÈïøËÆ°ÁÆóÁªÑÂêàÊï∞Ôºå‰ΩÜËøô‰∏™È¢òÂíåÁªÑÂêàÊï∞Ê≤°‰ªÄ‰πàÂÖ≥Á≥ª„ÄÇ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>
‰∏™Â∞èÂÜôÂ≠óÊØçÂ≠óÁ¨¶‰∏≤Ôºå Alice Âíå Bob ÊåâÁÖßÂ¶Ç‰∏ãÊñπÊ≥ïÁé©Ê∏∏ÊàèÔºö -
1„ÄÅAliceÈÄâÊã©‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂπ∂ÈáçÊñ∞ÂÆö‰πâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>26</mn></mrow><annotation encoding="application/x-tex">26</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">26</span></span></span></span>
‰∏™Â≠óÊØçÁöÑÂ≠óÂÖ∏Â∫èÔºåÁÑ∂ÂêéÂÜçÂ∞ÜËøô‰∏™Â≠óÁ¨¶‰∏≤ÂÜÖÈÉ®Â≠óÁ¨¶ÊåâÁÖß‰ªªÊÑèÈ°∫Â∫èÈáçÊéí„ÄÇ -
2„ÄÅBob‰ªéÂâ©‰∏ãÁöÑÂ≠óÁ¨¶‰∏≤‰∏≠ÈÄâÊã©‰∏Ä‰∏™ÔºåÂπ∂Â∞ÜËøô‰∏™Â≠óÁ¨¶‰∏≤ÂÜÖÈÉ®Â≠óÁ¨¶ÊåâÁÖß‰ªªÊÑèÈ°∫Â∫èÈáçÊéí„ÄÇ
‰ªñ‰ª¨ÁöÑÁõÆÊ†áÊòØ‰ΩøÂæóËá™Â∑±Â≠óÁ¨¶‰∏≤ÁöÑÂ≠óÂÖ∏Â∫èÊØîÂØπÈù¢Â∞èÔºåË∞ÅÁöÑÂ≠óÁ¨¶‰∏≤Â≠óÂÖ∏Â∫èÊõ¥Â∞èË∞ÅÂ∞±Ëµ¢‰∫Ü„ÄÇÈóÆ
Alice ÊúâÂ§öÂ∞ë‰∏™ÂèØ‰ª•ÈÄâÊã©ÁöÑÂ≠óÁ¨¶‰∏≤ËÉΩÂ§ü‰ΩøÂæóËá™Â∑±Ëé∑ËÉúÔºü
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>‚â§</mo><mn>1000</mn></mrow><annotation encoding="application/x-tex">N \le 1000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1000</span></span></span></span></p>
<p>Âõ†‰∏∫ÂèØ‰ª•ÈáçÊñ∞ÊéíÂàóÂ≠óÁ¨¶‰∏≤ÔºåÊâÄ‰ª•ÂØπ‰∫éÊØè‰∏™Â≠óÁ¨¶‰∏≤Êù•ËØ¥ÔºåÊúâÁî®ÁöÑ‰ø°ÊÅØÂ∞±ÊòØÊØè‰∏™Â≠óÁ¨¶‰∏≤‰∏≠ÊØè‰∏™Â≠óÁ¨¶ÁöÑÂá∫Áé∞Ê¨°Êï∞„ÄÇ</p>
<p>ÂèØ‰ª•ËÄÉËôëÂÖàÊûö‰∏æ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÁÑ∂ÂêéÂà§Êñ≠Ëøô‰∏™Â≠óÁ¨¶‰∏≤ÊòØÂê¶ËÉΩË¢´ Alice
ÈÄâ„ÄÇÁÑ∂ÂêéËÄÉËôëÁ°ÆÂÆöÂ≠óÂÖ∏Â∫èÔºåÂèØ‰ª•‰ª•Ê≠§ËÄÉËôëÂ≠óÂÖ∏Â∫èÊúÄÂ∞èÁöÑÂ∫îËØ•ÊòØÂì™‰∏™Â≠óÁ¨¶ÔºåÁ°ÆÂÆö‰∫ÜÂ≠óÂÖ∏Â∫èÊúÄÂ∞èÁöÑÂ≠óÁ¨¶‰πãÂêéÔºåÂèØ‰ª•ÊéíÈô§Êéâ‰∏Ä‰∫õÂ≠óÁ¨¶‰∏≤ÔºàÂ≠óÂÖ∏Â∫èÊúÄÂ∞èÁöÑÂ≠óÁ¨¶Âú®Ëøô‰∫õ‰∏≤‰∏≠ÁöÑÂá∫Áé∞Ê¨°Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo></mrow><annotation encoding="application/x-tex">&lt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span></span></span></span>
Âú®Êûö‰∏æ‰∏≤‰∏≠ÁöÑÂá∫Áé∞Ê¨°Êï∞ÔºâÔºåÁÑ∂ÂêéÂèàËΩ¨ÂåñÊàêÂéüÊù•Áõ∏ÂêåÁöÑÈóÆÈ¢ò„ÄÇ</p>
<p>ÂÖ≥ÈîÆÂú®‰∫éÂ¶Ç‰ΩïÁ°ÆÂÆöÂΩìÂâçÊÉÖÂÜµ‰∏ãÂ≠óÂÖ∏Â∫èÊúÄÂ∞èÁöÑÂ≠óÁ¨¶„ÄÇÊòæÁÑ∂ÔºåÁêÜÊÉ≥ÁöÑÂ≠óÂÖ∏Â∫èÊúÄÂ∞èÁöÑÂ≠óÁ¨¶
Âú®ÂΩìÂâçÊûö‰∏æÂà∞ÁöÑÂ≠óÁ¨¶‰∏≤‰∏≠ÁöÑÂá∫Áé∞Ê¨°Êï∞‰∏ÄÂÆö‰∏çÂ∞ë‰∫éÂú®ÂÖ∂‰ªñ‰∏≤‰∏≠ÁöÑÂá∫Áé∞Ê¨°Êï∞„ÄÇ‰ΩÜÊòØËøôÊ†∑ÁöÑÂ≠óÁ¨¶ÂèØËÉΩÊúâÂ§ö‰∏™ÔºåÂ∫îËØ•ÈÄâÂì™‰∏™Ôºü</p>
<p>ÂÖ∂ÂÆûÈÄâÂì™‰∏™ÊïàÊûú‰∏ÄÊ†∑ÔºåÊú¨Ë¥®‰∏äÂè™ÊòØ‰ª•Ê≠§ÈÄâÊã©ÂΩìÂâçÊÉÖÂÜµ‰∏ãÂ≠óÂÖ∏Â∫èÊúÄÂ∞èÁöÑÂ≠óÁ¨¶ÔºåÁÑ∂ÂêéÂâîÈô§‰∏Ä‰∫õÂ≠óÁ¨¶‰∏≤Ôºå‰ΩÜÊòØÂâîÈô§Â≠óÁ¨¶‰∏≤ÁöÑÊù°‰ª∂ÂíåÂâîÈô§È°∫Â∫èÊó†ÂÖ≥„ÄÇ</p>
<p>ÊúÄÂêéÂà§Êñ≠ÊòØÂê¶ÊâÄÊúâÂ≠óÁ¨¶‰∏≤ÈÉΩË¢´ÂâîÈô§ÊéâÂç≥ÂèØ„ÄÇ</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cmath&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#define rep</span><span class="op">(</span>i<span class="op">,</span><span class="pp"> </span>l<span class="op">,</span><span class="pp"> </span>r<span class="op">)</span><span class="pp"> </span><span class="cf">for</span><span class="op">(</span><span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="op">(</span>l<span class="op">),</span><span class="pp"> </span>__<span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="op">(</span>r<span class="op">);</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">&lt;=</span><span class="pp"> </span>__<span class="op">;</span><span class="pp"> </span>i<span class="op">++)</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="dv">1010</span><span class="op">;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">int</span> idx<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> c <span class="op">-</span> <span class="ch">&#39;a&#39;</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ch<span class="op">[</span>_<span class="op">][</span><span class="dv">30</span><span class="op">];</span> <span class="dt">int</span> n<span class="op">;</span> </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> S<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> book<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> bch<span class="op">[</span><span class="dv">200</span><span class="op">];</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">);</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> <span class="op">{</span> scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%s</span><span class="st">&quot;</span><span class="op">,</span> S <span class="op">+</span> <span class="dv">1</span><span class="op">);</span> <span class="dt">int</span> k <span class="op">=</span> strlen<span class="op">(</span>S <span class="op">+</span> <span class="dv">1</span><span class="op">);</span> rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> k<span class="op">)</span> ch<span class="op">[</span>i<span class="op">][</span>idx<span class="op">(</span>S<span class="op">[</span>j<span class="op">])]</span> <span class="op">++;</span> <span class="op">}</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">){</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        memset<span class="op">(</span>book<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>book<span class="op">));</span> memset<span class="op">(</span>bch<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>bch<span class="op">));</span> book<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">26</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>            rep<span class="op">(</span>k<span class="op">,</span> <span class="ch">&#39;a&#39;</span><span class="op">,</span> <span class="ch">&#39;z&#39;</span><span class="op">)</span> <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>bch<span class="op">[</span>k<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span> </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>                <span class="dt">bool</span> pass <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>                rep<span class="op">(</span>l<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span><span class="op">(</span>book<span class="op">[</span>l<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span><span class="op">(</span>ch<span class="op">[</span>l<span class="op">][</span>idx<span class="op">(</span>k<span class="op">)]</span> <span class="op">&gt;</span> ch<span class="op">[</span>i<span class="op">][</span>idx<span class="op">(</span>k<span class="op">)])</span> <span class="op">{</span> pass <span class="op">=</span> <span class="kw">false</span><span class="op">;</span> <span class="cf">break</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span><span class="op">(</span>pass<span class="op">){</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>                    bch<span class="op">[</span>k<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>                    rep<span class="op">(</span>l<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> <span class="cf">if</span><span class="op">(</span>ch<span class="op">[</span>l<span class="op">][</span>idx<span class="op">(</span>k<span class="op">)]</span> <span class="op">&lt;</span> ch<span class="op">[</span>i<span class="op">][</span>idx<span class="op">(</span>k<span class="op">)])</span> book<span class="op">[</span>l<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span><span class="op">;</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> pass <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> <span class="cf">if</span><span class="op">(</span>book<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> pass <span class="op">=</span> <span class="kw">false</span><span class="op">;</span> <span class="cf">break</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">+=</span> pass<span class="op">;</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="c.-‰∏â">C. ‰∏â</h3>
<p>‰Ω†ÊòØËÉΩÁúãÂà∞Á¨¨‰∏âÈ¢òÁöÑfriendsÂë¢„ÄÇ ‚Äî‚Äîlaekov
‰ºóÊâÄÂë®Áü•ÔºåÂ∞èËë±ÂêåÂ≠¶ÊìÖÈïøËÆ°ÁÆóÔºåÂ∞§ÂÖ∂ÊìÖÈïøËÆ°ÁÆóÁªÑÂêàÊï∞Ôºå‰ΩÜËøô‰∏™È¢òÂíåÁªÑÂêàÊï∞Ê≤°‰ªÄ‰πàÂÖ≥Á≥ª„ÄÇ</p>
<p>ÁªôÂÆö<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>‰∏™Êï∞ÔºåËÆæÊÄªÂÖ±Êúâ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>‰∏™Âå∫Èó¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false">[</mo><msub><mi>l</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo separator="true">,</mo><msub><mi>p</mi><mn>2</mn></msub><mo>=</mo><mo stretchy="false">[</mo><msub><mi>l</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo separator="true">,</mo><mo>‚ãØ</mo><mtext>‚Äâ</mtext><mo separator="true">,</mo><msub><mi>p</mi><mi>M</mi></msub><mo>=</mo><mo stretchy="false">[</mo><msub><mi>l</mi><mi>m</mi></msub><mo separator="true">,</mo><msub><mi>r</mi><mi>m</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">p_1=[l_1,r_1],p_2=[l_2,r_2 ],\cdots,p_M=[l_m,r_m]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">‚ãØ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>ÁöÑÈÄÜÂ∫èÂØπÊï∞Èáè‰∏çÂ∞ë‰∫é<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>‰∏™„ÄÇÂÆö‰πâÂáΩÊï∞<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>p</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(p_i,p_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>‰∏∫ËÆ°ÁÆó‰∏§‰∏™Âå∫Èó¥ÁöÑ‰∫§ÈõÜÂ§ßÂ∞èÁöÑÂáΩÊï∞ÔºàÂç≥ÂÖ±ÂêåË¶ÜÁõñ‰∫ÜÂ§öÂ∞ë‰∏™Êï∞Ôºâ„ÄÇÊ±Ç
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></msubsup><msubsup><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi>M</mi></msubsup><mi>f</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>p</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sum_{i=1}^M\sum_{j=i+1}^M f(p_i,p_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.417em;vertical-align:-0.4358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">‚àë</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">‚àë</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">N \le 10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></p>
<p>ËÄÉËôëÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑË¥°ÁåÆÔºå‰∏çÈöæÂèëÁé∞ÔºåÂÖÉÁ¥†ÁöÑË¥°ÁåÆ‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mtext>Ë¢´Ë¶ÜÁõñÁöÑÂå∫Èó¥Êï∞</mtext><mn>2</mn></mfrac><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\binom{Ë¢´Ë¶ÜÁõñÁöÑÂå∫Èó¥Êï∞}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2723em;vertical-align:-0.35em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9223em;"><span style="top:-2.355em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">Ë¢´Ë¶ÜÁõñÁöÑÂå∫Èó¥Êï∞</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span>
ÔºåÈóÆÈ¢òËΩ¨Âåñ‰∏∫ÊÄé‰πàÊ±ÇÊØè‰∏™ÂÖÉÁ¥†Ë¢´Ë¶ÜÁõñÁöÑÊ¨°Êï∞„ÄÇ</p>
<p>ËÄÉËôëÂØπ‰∫éÊØè‰∏Ä‰∏™Â∑¶Á´ØÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span>ÔºåÂêàÊ≥ïÁöÑÂè≥Á´ØÁÇπÂèñÂÄº‰∏ÄÂÆöÊòØ‰∏ÄÊÆµËøûÁª≠ÁöÑÂå∫Èó¥Ôºå‰∏î
Â¶ÇÊûúÂ≠òÂú®‰∏äÁïå‰∏ÄÂÆöÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÔºåÂØπ‰∫éÊØè‰∏™Â∑¶Á´ØÁÇπÔºåÊ±ÇÂá∫ÂÖ∂ÂØπÂ∫îÁöÑÊúÄÂ∞èÁöÑÂè≥Á´ØÁÇπÔºåËøôÈáåÂèØ‰ª•‰ΩøÁî®
<code>two-point</code> „ÄÇÂÄºÂüüÊ†ëÁä∂Êï∞ÁªÑÁªüËÆ°ÈÄÜÂ∫èÂØπÊï∞„ÄÇ</p>
<p>ËÄÉËôëÊØè‰∏™Â∑¶Á´ØÁÇπ‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span>
ÁöÑÂå∫Èó¥ÂØπÂÖÉÁ¥†Ë¶ÜÁõñÊï∞ÁöÑË¥°ÁåÆÔºåÂèëÁé∞‰∏ÄÂÆöÊòØ‰∏ÄÊù°Âπ≥Áõ¥Á∫øÂíå‰∏Ä‰∏™‰∏ãÈôçÁõ¥Á∫øÔºåÂèØ‰ª•ÂØπÂ∑ÆÂàÜÊï∞ÁªÑÁöÑÂ∑ÆÂàÜÊï∞ÁªÑÂÅö‰øÆÊîπÔºåÁÑ∂Âêé‰∏§Ê¨°ÂâçÁºÄÂíåËøòÂéüÂá∫ÂéüÂ∫èÂàó„ÄÇ</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">2e6</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> inv2 <span class="op">=</span> <span class="dv">500000004</span><span class="op">;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> k<span class="op">,</span> A<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> BIT<span class="op">{</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define lowbit</span><span class="op">(</span>x<span class="op">)</span><span class="pp"> </span><span class="op">(</span>x<span class="pp"> </span><span class="op">&amp;</span><span class="pp"> </span><span class="op">(-</span>x<span class="op">))</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> C<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> add<span class="op">(</span><span class="dt">int</span> p<span class="op">,</span> <span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>p <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="op">;</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> p<span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">+=</span> lowbit<span class="op">(</span>i<span class="op">))</span> C<span class="op">[</span>i<span class="op">]</span> <span class="op">+=</span> x<span class="op">;</span> <span class="op">}</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span>  query<span class="op">(</span><span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> p<span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">-=</span> lowbit<span class="op">(</span>i<span class="op">))</span> ans <span class="op">+=</span> C<span class="op">[</span>i<span class="op">];</span> <span class="cf">return</span> ans<span class="op">;</span> <span class="op">}</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="kw">using</span> BIT<span class="op">::</span>add<span class="op">;</span> <span class="kw">using</span> BIT<span class="op">::</span>query<span class="op">;</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> L <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> R <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> Rp<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> C<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">)(</span>k<span class="op">);</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> Read<span class="op">(</span>A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    LL ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>L<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">){</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">-</span> <span class="dv">1</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> add<span class="op">(</span>A<span class="op">[</span>L <span class="op">-</span> <span class="dv">1</span><span class="op">],</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">-</span> <span class="dv">1</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> ans <span class="op">-=</span> query<span class="op">(</span>A<span class="op">[</span>L <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">((</span>R <span class="op">&lt;</span> L<span class="op">)</span> <span class="op">||</span> <span class="op">(</span>ans <span class="op">&lt;</span> k <span class="op">&amp;&amp;</span> R <span class="op">&lt;=</span> n<span class="op">))</span> <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>R <span class="op">==</span> n<span class="op">)</span> <span class="op">{</span> R<span class="op">++;</span> <span class="cf">break</span><span class="op">;</span> <span class="op">};</span> add<span class="op">(</span>A<span class="op">[++</span>R<span class="op">],</span> <span class="dv">1</span><span class="op">);</span> ans <span class="op">+=</span> query<span class="op">(</span>n<span class="op">)</span> <span class="op">-</span> query<span class="op">(</span>A<span class="op">[</span>R<span class="op">]);</span> <span class="op">}</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>        Rp<span class="op">[</span>L<span class="op">]</span> <span class="op">=</span> R<span class="op">;</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>L<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">){</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>Rp<span class="op">[</span>L<span class="op">]</span> <span class="op">&gt;</span> n<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span> <span class="dt">int</span> cnt <span class="op">=</span> <span class="op">(</span>n <span class="op">-</span> Rp<span class="op">[</span>L<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>        C<span class="op">[</span>L<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>C<span class="op">[</span>L<span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> cnt<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span> C<span class="op">[</span>L <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span>C<span class="op">[</span>L <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> <span class="op">(</span>MOD <span class="op">-</span><span class="dv">0</span><span class="bu">ll</span><span class="op">-</span> cnt<span class="op">)</span> <span class="op">%</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>        C<span class="op">[</span>Rp<span class="op">[</span>L<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span>C<span class="op">[</span>Rp<span class="op">[</span>L<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> MOD <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> C<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>C<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> C<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">])</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> C<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>C<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> C<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">])</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> <span class="op">(</span>C<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> <span class="op">(</span>C<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">%</span> MOD <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> inv2 <span class="op">%</span> MOD<span class="op">))</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="d.-Âõõ">D. Âõõ</h3>
<p>‰Ω†ÊòØËÉΩÁúãÂà∞Á¨¨ÂõõÈ¢òÁöÑ friends Âë¢„ÄÇ ‚Äî‚Äîlaekov</p>
<p>‰ºóÊâÄÂë®Áü•ÔºåÂ∞èËë±ÂêåÂ≠¶ÊìÖÈïøËÆ°ÁÆóÔºåÂ∞§ÂÖ∂ÊìÖÈïøËÆ°ÁÆóÁªÑÂêàÊï∞Ôºå‰ΩÜËøô‰∏™È¢òÂíåÁªÑÂêàÊï∞Ê≤°‰ªÄ‰πàÂÖ≥Á≥ª„ÄÇ</p>
<p>‰ªäÂ§©‰πüÊòØÁöÆÂÖãÊïè‰ª¨ÊâìÂ∑•ÁöÑ‰∏ÄÂ§©Ôºå‰Ω†Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>
Âè™ÁöÆÂÖãÊïèÔºåÊØèÂè™ÁöÆÂÖãÊïèÊúâ‰∏ÄÈ¢óÁÇ∏Âºπ„ÄÇÁé∞Âú®Êúâ‰∏ÄÈ¢ó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>
‰∏™ÁÇπÁöÑÊ†ëÔºåÂêåÊó∂ÁöÆÂÖãÊïè‰ª¨ÂèØ‰ª•‰ªé
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">p_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ÊàñËÄÖ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
‰∏§‰∏™ÁÇπ‰∏≠ÁöÑ‰ªªÊÑè‰∏Ä‰∏™ËøõÂÖ•Ê†ë„ÄÇÊØèÊ¨°‰Ω†ÈúÄË¶ÅÊ¥æ‰∏ÄÂè™ÁöÆÂÖãÊïèÂéªÂà∞Êüê‰∏™ÁÇπÔºåÁÑ∂ÂêéÂ∞ÜÁÇ∏ÂºπËøûÂêåÁöÆÂÖãÊïèÂíåËøô‰∏™ÁÇπ‰∏ÄËµ∑ÁÇ∏Êéâ„ÄÇ‰∏Ä‰∏™ÁÇπË¢´ÁÇ∏Êéâ‰∫Ü‰πãÂêéÁöÆÂÖãÊïèÂ∞±ÂÜç‰πü‰∏çËÉΩÈÄöËøá‰∫Ü„ÄÇÁé∞Âú®‰Ω†ÈúÄË¶ÅÂÜ≥ÂÆöÁöÆÂÖãÊïè‰ª¨ÁÇ∏ÁÇπÁöÑÈ°∫Â∫èÔºåÈóÆ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">n!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">n</span><span class="mclose">!</span></span></span></span>
ÁßçÁÇ∏ÁÇπÊñπÊ°à‰∏≠ÊúâÂ§öÂ∞ëÁßçËÉΩÁÇ∏ÊéâÊâÄÊúâÁÇπ„ÄÇ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>‚â§</mo><mn>1000</mn></mrow><annotation encoding="application/x-tex">N \le 1000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1000</span></span></span></span></p>
<p>ËÄÉËôë <code>DP</code> „ÄÇ</p>
<p>È¶ñÂÖàËÄÉËôë‰∏Ä‰∏™Â≠êÊ†ëÔºàÂ≠êÊ†ëÂÜÖÊ≤°Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_1, p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ÔºâÂÖ®ÈÉ®Ë¢´Ê∏ÖÁ©∫Â∫îËØ•ÊòØ‰ªÄ‰πàÈ°∫Â∫èÔºå‰∏ÄÂÆöÊòØÊØè‰∏™ÂÑøÂ≠êÁöÑÂ≠êÊ†ëÂÖàË¢´Ê∏ÖÁ©∫ÁÑ∂ÂêéÊ∏ÖÊ•öÂΩìÂâçÁÇπ„ÄÇ
ËøôÈáåÂèØ‰ª•‰ΩøÁî®Ê†ëÂΩ¢ dp Â§ÑÁêÜ„ÄÇ</p>
<p>ÂÖàËÄÉËôë
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>‚Üî</mo><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_1 \leftrightarrow p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚Üî</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
Ëøô‰∏ÄÊù°Èìæ‰∏äÁöÑÁÇπÂ∫îËØ•ÊòØÊåâÁÖß‰ªÄ‰πàÈ°∫Â∫èË¢´Ê∏ÖÁ©∫Ôºå‰ªªÊÑèÊó∂ÂàªÔºåË¢´Ê∏ÖÁ©∫ÁöÑÁÇπ‰∏ÄÂÆöÊòØÈìæ‰∏äÁöÑËøûÁª≠ÁöÑ‰∏ÄÊÆµÔºåËøôÈáåÂèØ‰ª•Âå∫Èó¥
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">dp</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span></span></span></span>
ÁªüËÆ°Á≠îÊ°àÔºåËΩ¨ÁßªËÄÉËôëÊúÄÂêé‰∏ÄÊ¨°Âà†Èô§ÊòØÂà†Âπ≤ÂáÄ‰∫ÜÈìæ‰∏äÊúÄÂè≥ËæπÁöÑÁÇπËøòÊòØÊúÄÂ∑¶ËæπÁöÑÁÇπ„ÄÇ</p>
<p>ÁÑ∂ÂêéÂíå
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_1, p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ÁöÑÊØè‰∏™‰∏çÂú®Èìæ‰∏äÁöÑÂÑøÂ≠êÂêàÂπ∂Á≠îÊ°àÔºåÊúÄÂêéÂÜ≥Á≠ñÂÖàÂà†Èô§
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">p_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ËøòÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>„ÄÇ
‰ª£Á†ÅËøòÊ≤°ÂÜô„ÄÇ</p>
<h2 id="round-5">Round 5</h2>
<h3 id="a.-‰∏Ä-1">A. ‰∏Ä</h3>
<p>Áé∞Âú®ÊúâÂõõÁßçÈ¢úËâ≤ÁöÑ‰∏úË•øÔºåÂêÑÊúâ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>n</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>n</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>n</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">n_1,n_2,n_3,n_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>‰∏™„ÄÇ‰Ω†ÈúÄË¶ÅÊää‰ªñ‰ª¨ÊîæÂà∞‰∏ÄÊéíÈáåÈù¢ÔºåÂπ∂‰∏î‰øùËØÅÁõ∏ÈÇªÁöÑ‰∏úË•øÈ¢úËâ≤‰∏çÂêåÔºåÈóÆÊñπÊ°àÊï∞„ÄÇ
ÂØπ‰∫é<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>80</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">80\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">80%</span></span></span></span>ÁöÑÊï∞ÊçÆÔºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub><mo>+</mo><msub><mi>n</mi><mn>3</mn></msub><mo>+</mo><msub><mi>n</mi><mn>4</mn></msub><mo>‚â§</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">n_1+n_2+n_3+n_4\leq 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span>„ÄÇ
ÂØπ‰∫éÂè¶Â§ñ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">10\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">10%</span></span></span></span>ÁöÑÊï∞ÊçÆÔºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn><mo separator="true">,</mo><msub><mi>n</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>n</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>n</mi><mn>4</mn></msub><mo>‚â§</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">n_1=0,n_2,n_3,n_4\leq 50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">50</span></span></span></span>„ÄÇ
ÂØπ‰∫é<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">100\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">100%</span></span></span></span>ÁöÑÊï∞ÊçÆÔºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>‚â§</mo><msub><mi>n</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>n</mi><mn>2</mn></msub><mo>‚â§</mo><mn>200</mn><mo separator="true">,</mo><mn>0</mn><mo>‚â§</mo><msub><mi>n</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>n</mi><mn>4</mn></msub><mo>‚â§</mo><mn>50000</mn></mrow><annotation encoding="application/x-tex">0\leq n_1,n_2\leq 200,0\leq n_3,n_4\leq50000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">200</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">50000</span></span></span></span>„ÄÇ</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> subtask1<span class="op">{</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dp<span class="op">[</span>_<span class="op">][</span>_<span class="op">][</span>_<span class="op">][</span>_<span class="op">][</span><span class="dv">5</span><span class="op">];</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> work<span class="op">(){</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        memset<span class="op">(</span>dp<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>dp<span class="op">));</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">1</span><span class="op">][</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> A<span class="op">)</span> rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> B<span class="op">)</span> rep<span class="op">(</span>k<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> C<span class="op">)</span> rep<span class="op">(</span>l<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> D<span class="op">){</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>i <span class="op">+</span> j <span class="op">+</span> k <span class="op">+</span> l <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span>l<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span>dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span>l<span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span>l<span class="op">][</span><span class="dv">3</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span>  dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span>l<span class="op">][</span><span class="dv">4</span><span class="op">])</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>j <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span>l<span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">][</span>l<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> dp<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">][</span>l<span class="op">][</span><span class="dv">3</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span>  dp<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">][</span>l<span class="op">][</span><span class="dv">4</span><span class="op">])</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>k <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span>l<span class="op">][</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>l<span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>l<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span>  dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>l<span class="op">][</span><span class="dv">4</span><span class="op">])</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>l <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span>l<span class="op">][</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span>l <span class="op">-</span> <span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span>l <span class="op">-</span> <span class="dv">1</span><span class="op">][</span><span class="dv">3</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span>  dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span>l <span class="op">-</span> <span class="dv">1</span><span class="op">][</span><span class="dv">1</span><span class="op">])</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> ans1 <span class="op">=</span> <span class="dt">int</span><span class="op">((</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> dp<span class="op">[</span>A<span class="op">][</span>B<span class="op">][</span>C<span class="op">][</span>D<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span>  dp<span class="op">[</span>A<span class="op">][</span>B<span class="op">][</span>C<span class="op">][</span>D<span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">+</span>  dp<span class="op">[</span>A<span class="op">][</span>B<span class="op">][</span>C<span class="op">][</span>D<span class="op">][</span><span class="dv">3</span><span class="op">]</span> <span class="op">+</span>  dp<span class="op">[</span>A<span class="op">][</span>B<span class="op">][</span>C<span class="op">][</span>D<span class="op">][</span><span class="dv">4</span><span class="op">])</span> <span class="op">%</span> MOD<span class="op">));</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> subtask2<span class="op">{</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="dv">53</span><span class="op">;</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dp<span class="op">[</span>_<span class="op">][</span>_<span class="op">][</span>_<span class="op">][</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> work<span class="op">(){</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        memset<span class="op">(</span>dp<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>dp<span class="op">));</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">][</span><span class="dv">1</span><span class="op">][</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> B<span class="op">)</span> rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> C<span class="op">)</span> rep<span class="op">(</span>k<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> D<span class="op">){</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>i <span class="op">+</span> j <span class="op">+</span> k <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span>dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span><span class="dv">3</span><span class="op">])</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>j <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> dp<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">][</span><span class="dv">3</span><span class="op">])</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>k <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k<span class="op">][</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">][</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">][</span><span class="dv">1</span><span class="op">])</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> ans2 <span class="op">=</span> <span class="dt">int</span><span class="op">((</span> dp<span class="op">[</span>B<span class="op">][</span>C<span class="op">][</span>D<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> dp<span class="op">[</span>B<span class="op">][</span>C<span class="op">][</span>D<span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> dp<span class="op">[</span>B<span class="op">][</span>C<span class="op">][</span>D<span class="op">][</span><span class="dv">3</span><span class="op">]</span> <span class="op">)</span> <span class="op">%</span> MOD<span class="op">));</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="b.-‰∫å-1">B. ‰∫å</h3>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>‰∏™‰∫åÂÖÉÁªÑ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a_i,b_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ÔºåÂÆö‰πâ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><mi>m</mi><mi>a</mi><mi>x</mi><mtext>‚Å°</mtext><mo stretchy="false">(</mo><msub><mi>c</mi><mrow><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msubsup><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>i</mi></msubsup><msub><mi>a</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c_1=a_1+b_1,c_i=b_i+max‚Å°(c_{i-1},\sum_{j=1}^ia_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.4004em;vertical-align:-0.4358em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mord">‚Å°</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">‚àë</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9646em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>„ÄÇÁé∞Âú®‰Ω†ÂèØ‰ª•ÈöèÊÑèÈáçÊéíËøô<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>‰∏™‰∫åÂÖÉÁªÑÔºåÊ±Ç<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>N</mi></msub></mrow><annotation encoding="application/x-tex">c_N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ÁöÑÊúÄÂ∞èÂÄº
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup><mo separator="true">;</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo>‚â§</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">N \le 10^6; A, B \le N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></p>
<p>ËÄÉËôëÁõ∏ÈÇª‰∏§‰∏™‰∫åÂÖÉÁªÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a_1, b_1) (a_2, b_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
Â∫îËØ•ÊÄé‰πàÊØîËæÉÂ§ßÂ∞è„ÄÇ ÂàÜÂà´ÂàóÂá∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a_1, b_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
Âú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a_2, b_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
‰πãÂâçÁöÑÁ≠îÊ°àÂíå‰∫§Êç¢‰πãÂêéÁöÑÁ≠îÊ°à„ÄÇ</p>
<p>Â¶ÇÊûú
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a_1, b_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
Âú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a_2, b_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
‰πãÂâçÔºöËÆæËøô‰∏§‰∏™‰∫åÂÖÉÁªÑ‰πãÂâçÊâÄÊúâ‰∫åÂÖÉÁªÑ‰∏≠
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>
ÁöÑÂíå‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ÔºåËÆæ‰∏ä‰∏Ä‰∏™‰∫åÂÖÉÁªÑÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>
ÂÄº‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>„ÄÇ
Ê†πÊçÆÂÆö‰πâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub><mo>=</mo><msub><mi>b</mi><mn>1</mn></msub><mo>+</mo><mi>max</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>y</mi><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">C_1 = b_1 + \max(y, a_1 + x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>Ôºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub><mo>=</mo><msub><mi>b</mi><mn>2</mn></msub><mo>+</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>C</mi><mn>1</mn></msub><mo separator="true">,</mo><mi>x</mi><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">C_2 = b_2 + max(C_1, x + a_1 + a_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
ÂåñÁÆÄÂêéÂæóÂà∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub><mo>=</mo><mi>max</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>y</mi><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>x</mi><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>x</mi><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">C_2 = \max(y + b_1 + b_2, x + a_1 + b_1 + b_2, x + a_1 + a_2 + b_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
ÊòìÁü• ‰∫§Êç¢Âêé
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>C</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">‚Ä≤</mo></msubsup><mo>=</mo><mi>max</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>y</mi><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>x</mi><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>x</mi><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">C_2&#x27; = \max(y + b_1 + b_2, x + a_2 + b_1 + b_2, x + a_1 + a_2 + b_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
Áé∞Âú®ÈúÄË¶ÅÊØîËæÉ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">C_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
Âíå
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>C</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">‚Ä≤</mo></msubsup></mrow><annotation encoding="application/x-tex">C_2&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span>
ÁöÑÂ§ßÂ∞è„ÄÇÁõ∏ÂΩì‰∫éÂØπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">6</span></span></span></span>
‰∏™ÂºèÂ≠êÂèñÊúÄÂ§ßÂÄºÔºåÁúãÊúÄÂ§ßÂÄºÂá∫Áé∞Âú®Âì™Ëæπ„ÄÇÁõ∏ÂêåÁöÑÈ°π
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">y + b_1 + b_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ÂèØ‰ª•Ê∂àÂéªÔºåÂ¶ÇÊûúÂÖ∂‰∏∫ÊúÄÂ§ßÂÄºÔºåÈÇ£‰πà‰∏§‰∏™ÂºèÂ≠êË∞ÅÂú®ÂâçË∞ÅÂú®ÂêéÊó†ÊâÄË∞ìÔºåÂ¶ÇÊûúÂÖ∂‰∏çÊòØÊúÄÂ§ßÂÄºÔºåÈÇ£‰πà‰πüÊ≤°ÊúâÂΩ±Âìç„ÄÇ
Ê∂àÂéªÊØè‰∏ÄÈ°π‰∏≠Áõ∏ÂêåÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>„ÄÇ</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub><mo>=</mo><mi>max</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">C_2 = \max(a_1 + b_1 + b_2, a_1 + a_2 + b_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>C</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">‚Ä≤</mo></msubsup><mo>=</mo><mi>max</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">C_2&#x27; = \max(a_2 + b_1 + b_2, a_1 + a_2 + b_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>ÊèêÂá∫ÂÖ±ÂêåÁöÑÈ°πÔºö
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><mo>+</mo><mi>max</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">C_2 = a_1 + b_2 + \max(b_1,a_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>C</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">‚Ä≤</mo></msubsup><mo>=</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo>+</mo><mi>max</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">C_2&#x27; = a_2 + b_1 + \max(b_2, a_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>ÂÅáËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub><mo>&lt;</mo><msubsup><mi>C</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">‚Ä≤</mo></msubsup></mrow><annotation encoding="application/x-tex">C_2 &lt; C_2&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>Âàô
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><mo>+</mo><mi>max</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>&lt;</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo>+</mo><mi>max</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_1 + b_2 + \max(b_1,a_2) &lt; a_2 + b_1 + \max(b_2, a_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>ÁßªÈ°πÂæó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><mo>‚àí</mo><mi>max</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>&lt;</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo>‚àí</mo><mi>max</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_1 + b_2 - \max(b_2,a_1) &lt; a_2 + b_1 - \max(b_1, a_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>ÂæóÂá∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>&lt;</mo><mi>min</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\min(a_1, b_2) &lt; \min(a_2, b_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>‰∏ÄÁßçÁâπÊÆäÊÉÖÂÜµÊòØÂèñÁ≠âÁöÑÊó∂ÂÄôÔºö<del>‰∏æÂá†‰∏™Ê†óÂ≠êÂæóÂá∫</del> ÁªìËÆ∫ÊòØÂèñÁ≠âÊó∂ÊØîËæÉ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>a</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">a_1 &lt; a_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>„ÄÇ</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> CMP<span class="op">(</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> x<span class="op">,</span> pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> y<span class="op">){</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> r0 <span class="op">=</span> min<span class="op">(</span>x<span class="op">.</span>first<span class="op">,</span> y<span class="op">.</span>second<span class="op">);</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> r1 <span class="op">=</span> min<span class="op">(</span>y<span class="op">.</span>first<span class="op">,</span> x<span class="op">.</span>second<span class="op">);</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>r0 <span class="op">!=</span> r1<span class="op">)</span> <span class="cf">return</span> r0 <span class="op">&lt;</span> r1<span class="op">;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">.</span>first <span class="op">&lt;</span> y<span class="op">.</span>first<span class="op">;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="c.-‰∏â-1">C. ‰∏â</h3>
<p>ÁªôÂÆö
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>
‰∏™Êï∞Ôºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>
Ê¨°Êìç‰ΩúÔºåÊìç‰ΩúÊúâ‰ª•‰∏ãÂõõÁßçÔºö - 1„ÄÅÂå∫Èó¥Âä†‰∏Ä‰∏™Êï∞„ÄÇ - 2„ÄÅÂå∫Èó¥‰πò‰∏Ä‰∏™Êï∞„ÄÇ -
3„ÄÅÂå∫Èó¥ÂèòÊàê‰∏Ä‰∏™Êï∞„ÄÇ -
4„ÄÅÊ±ÇÊâÄÊúâÂ≠êÂå∫Èó¥ÁöÑÂπ≥ÂùáÂÄºÁöÑÂíå(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><mi>D</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mo>+</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">MOD = 10^9 + 7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">MO</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">7</span></span></span></span>)„ÄÇ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>N</mi><mo separator="true">,</mo><mi>Q</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">a_i, N,Q \le 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>n</mi><mi>s</mi><mo>=</mo><msubsup><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mrow><msubsup><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi></mrow><mi>n</mi></msubsup><mfrac><mrow><msubsup><mo>‚àë</mo><mrow><mi>k</mi><mo>=</mo><mi>i</mi></mrow><mi>j</mi></msubsup><msub><mi>a</mi><mi>k</mi></msub></mrow><mrow><mi>j</mi><mo>‚àí</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">Ans = \sum_{i=1}^{n}\limits{\sum_{j=i}^{n}\limits{\frac{\sum_{k=i}^{j}\limits{a_k}}{j-i+1}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.2921em;vertical-align:-1.1138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3514em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">‚àë</span></span></span><span style="top:-3.95em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.9777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3514em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">‚àë</span></span></span><span style="top:-3.95em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.1138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.1783em;"><span style="top:-2.7848em;"><span class="pstrut" style="height:3.1298em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">‚àí</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.3598em;"><span class="pstrut" style="height:3.1298em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.1783em;"><span class="pstrut" style="height:3.1298em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop op-limits mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.614em;"><span style="top:-1.838em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-2.75em;"><span class="pstrut" style="height:2.75em;"></span><span><span class="mop op-symbol small-op mtight">‚àë</span></span></span><span style="top:-3.7499em;margin-left:0em;"><span class="pstrut" style="height:2.75em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.055em;"><span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>
ËÄÉËôëÊØè‰∏™Êï∞Â≠óÁöÑË¥°ÁåÆ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>n</mi><mi>s</mi><mo>=</mo><msubsup><mo>‚àë</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mrow><msub><mi>a</mi><mi>k</mi></msub><mo>√ó</mo><msubsup><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mrow><msubsup><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi></mrow><mi>n</mi></msubsup><mfrac><mn>1</mn><mrow><mi>j</mi><mo>‚àí</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow></mfrac></mrow></mrow></mrow><annotation encoding="application/x-tex">Ans = \sum_{k=1}^{n}\limits{a_k \times \sum_{i=1}^{n}\limits{\sum_{j=i}^{n}\limits{\frac{1}{j-i+1}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4652em;vertical-align:-1.1138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3514em;"><span style="top:-2.0979em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">‚àë</span></span></span><span style="top:-3.95em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.0021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3514em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">‚àë</span></span></span><span style="top:-3.95em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.9777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3514em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">‚àë</span></span></span><span style="top:-3.95em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.1138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">‚àí</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></span>
ÁÆóÂá∫Ë¥°ÁåÆÔºåÁ∫øÊÆµÊ†ëÁª¥Êä§Âç≥ÂèØ„ÄÇÂèØ‰ª•ËÄÉËôë
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÊØèÂ¢ûÂä† 1 Ë¥°ÁåÆ‰ºöÂèòÂåñÂ§öÂ∞ë„ÄÇ‰πüÂèØ‰ª•ÂèëÁé∞Ë¥°ÁåÆÁ±ª‰ºº‰∫é‰∏Ä‰∏™Ê¢ØÂΩ¢ÔºåÂèØ‰ª•Áõ¥Êé•ÁÆó„ÄÇ</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> work<span class="op">(){</span> cerr <span class="op">&lt;&lt;</span> <span class="st">&quot;FUCK&quot;</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    S<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> n<span class="op">)</span> S<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>S<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> inv<span class="op">(</span>i<span class="op">))</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> dp <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">){</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> last <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> dp <span class="op">=</span> <span class="op">(</span>dp <span class="op">-</span><span class="dv">0</span><span class="bu">ll</span><span class="op">-</span> S<span class="op">[</span>last<span class="op">]</span> <span class="op">+</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        dp <span class="op">=</span> <span class="op">(</span>dp <span class="op">-</span><span class="dv">0</span><span class="bu">ll</span><span class="op">-</span> <span class="op">(</span>S<span class="op">[</span>n<span class="op">]</span> <span class="op">-</span><span class="dv">0</span><span class="bu">ll</span><span class="op">-</span> S<span class="op">[</span>n <span class="op">-</span> last<span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> MOD<span class="op">)</span> <span class="op">%</span> MOD <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        dp <span class="op">=</span> <span class="op">(</span>dp <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> <span class="op">(</span>S<span class="op">[</span>n<span class="op">]</span> <span class="op">-</span><span class="dv">0</span><span class="bu">ll</span><span class="op">-</span> S<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        dp <span class="op">=</span> <span class="op">(</span> dp <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> S<span class="op">[</span>i<span class="op">])</span> <span class="op">%</span> MOD<span class="op">;</span> <span class="co">// ËøôÈáåÁöÑ dp Â∞±ÊòØ‰ΩçÁΩÆ‰∏∫ i ÁöÑÊï∞Â≠óÂØπÁ≠îÊ°àË¥°ÁåÆÁöÑÁ≥ªÊï∞„ÄÇ</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> dp <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> A<span class="op">[</span>i<span class="op">]</span> <span class="op">%</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="d.-Âõõ-1">D. Âõõ</h3>
<p>‰ºóÊâÄÂë®Áü•ÔºåÂ∞èËë±ÂêåÂ≠¶ÊìÖÈïøËÆ°ÁÆóÔºåÂ∞§ÂÖ∂ÊìÖÈïøËÆ°ÁÆóÁªÑÂêàÊï∞Ôºå‰ΩÜËøô‰∏™È¢òÂíåÁªÑÂêàÊï∞Ê≤°‰ªÄ‰πàÂÖ≥Á≥ª„ÄÇ</p>
<p>ÁöÆÂÖãÊïè‰ª¨ÊâìÂÆåÂ∑•‰∫ÜÔºåÊòØÊó∂ÂÄôÂ∞ÜÊâÄÊúâÁöÆÂÖãÊïèÂ§ÑÁêÜÊéâ‰∫Ü„ÄÇÁé∞Âú®ÁöÆÂÖãÊïè‰ª¨Ë∫≤Âú®‰∏ÄÊ£µÊ†ë‰∏äÔºàÁÇπÂíåËæπÁöÑ‰ªªÊÑè‰ΩçÁΩÆÈÉΩÊúâÂèØËÉΩÔºâÔºå‰Ω†ÂèØ‰ª•ÈÄâÊã©Ëã•Âπ≤Âè∂Â≠êËäÇÁÇπÈáäÊîæÊØíÊ∞îÔºåÊØíÊ∞î‰ºö‰ª•ÊØèÂçï‰ΩçÊó∂Èó¥‰∏ÄÂçï‰ΩçÁöÑË∑ùÁ¶ªÊ≤øÁùÄËæπËîìÂª∂ÂºÄÊù•„ÄÇ‰∏∫‰∫ÜËÉΩÂ§üÁÅ≠ÁªùÁöÆÂÖãÊïèÔºå‰Ω†ÈúÄË¶Å‰øùËØÅÊ†ë‰∏äÊØè‰∏™‰ΩçÁΩÆÈÉΩÂÖÖÊª°‰∫ÜÊØíÊ∞î„ÄÇ‰ΩÜÊòØ‰ªÖ‰ªÖÊòØÊ±Ç‰∏Ä‰∏™ÊúÄÂ∞èÁöÑÁÅ≠ÁªùÁöÆÂÖãÊïèÁöÑÊó∂Èó¥ÂÆûÂú®Â§™Êó†Ë∂£‰∫ÜÔºå‰Ω†ÊÉ≥Ë¶ÅÁü•ÈÅì‰Ω†ÊúâÂ§öÂ∞ëÁßç‰∏çÂêåÁöÑÊñπÊ≥ïËÉΩÂ§üÁÅ≠ÁªùÁöÆÂÖãÊïèÔºå‰∏§‰∏™ÊñπÊ≥ï‰∏çÂêåÂΩì‰∏î‰ªÖÂΩì‰∏§ÁßçÊñπÊ≥ïÁÅ≠ÁªùÊâÄÊúâÁöÆÂÖãÊïèÁöÑÊó∂Èó¥‰∏çÂêå„ÄÇ</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>‚â§</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N \le 200</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">200</span></span></span></span>
Á¨¨‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>
‰ª£Ë°®Ê†ë‰∏äÁÇπÁöÑ‰∏™Êï∞„ÄÇ</p>
<p>Êé•‰∏ãÊù•
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N‚àí1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>
Ë°åÊØèË°å‰∏â‰∏™Êï¥Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo separator="true">,</mo><mi>e</mi><mo separator="true">,</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">s,e,d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span></span></span></span>
‰ª£Ë°®‰∏ÄÊù°ËæπÁöÑ‰∏§Á´ØÂíåÈïøÂ∫¶„ÄÇ</p>
<p>Á≠îÊ°àÂè™ËÉΩÊòØÊüê‰∏§‰∏™Âè∂Â≠ê‰πãÈó¥ÁöÑË∑ùÁ¶ªÊàñËÄÖË∑ùÁ¶ª $ / 2$ „ÄÇ Êûö‰∏æ‰∏§‰∏™Âè∂Â≠êÔºåÊää -
Ëøô‰∏™Âè∂Â≠ê‰πãÈó¥ÁöÑË∑ùÁ¶ªÔºàÂè™Âú®‰∏ÄËæπÊîæÊØíÊ∞îÔºâÔºàÂ¶ÇÊûúËÉΩÊàê‰∏∫Á≠îÊ°àÔºâ -
‰∏§‰∏™Âè∂Â≠ê‰πãÈó¥Ë∑ùÁ¶ª $ / 2$Ôºà‰∏§‰∏™Âè∂Â≠ê‰∏äÈÉΩÊîæÊØíÊ∞îÔºâÔºàÂ¶ÇÊûúËÉΩÊàê‰∏∫Á≠îÊ°àÔºâ
Âä†ÂÖ•Á≠îÊ°àÈõÜÂêà„ÄÇ ÊúÄÂêéËæìÂá∫Á≠îÊ°àÈõÜÂêàÁöÑÂ§ßÂ∞è„ÄÇ</p>
<p>Êûö‰∏æ‰∏§‰∏™Âè∂Â≠êÔºåÂà§Êñ≠ÂÖ∂Ë∑ùÁ¶ªÊòØÂê¶ËÉΩÊàê‰∏∫Á≠îÊ°à„ÄÇËÄÉËôëÂì™‰∫õÂÖ∂‰ªñÂè∂Â≠êÊîæÊØíÊ∞îËÉΩËÆ©Ëøô‰∏™Ë∑ùÁ¶ªÂ∞ΩÂèØËÉΩÊàê‰∏∫Á≠îÊ°àÔºåÂ∞±ÊòØÈÇ£‰∫õÊîæ‰∏äÊØíÊ∞î‰∏ç‰ºöÂΩ±ÂìçËøô‰∏§‰∏™Êûö‰∏æÁöÑÂè∂Â≠ê‰πãÈó¥ÊØíÊ∞î‰º†Êí≠Êó∂Èó¥ÁöÑÂè∂Â≠êÈÉΩÊîæ‰∏äÊØíÊ∞îÔºåÁÑ∂ÂêéË∑ë‰∏ÄÈÅçÊúÄÁü≠Ë∑ØÔºåÁÆóÂÖ®Ê†ëË¢´ÊØíÊ∞îË¶ÜÁõñÁöÑÊó∂Èó¥ÊòØÂê¶Á≠â‰∫éÂΩìÂâçÊûö‰∏æÁöÑÂè∂Â≠ê„ÄÇ</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="dv">510</span><span class="op">;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>pair<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;,</span> <span class="dt">int</span> <span class="op">&gt;</span> E<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> m<span class="op">;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> M<span class="op">[</span>_<span class="op">][</span>_<span class="op">];</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>set<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> Ans<span class="op">;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>queue<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span>Q<span class="op">;</span> <span class="dt">bool</span> inQ<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> SPFA<span class="op">(){</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> <span class="dt">int</span> dis<span class="op">[</span>_<span class="op">];</span> memset<span class="op">(</span>dis<span class="op">,</span> <span class="bn">0x3f</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>dis<span class="op">));</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> <span class="cf">if</span><span class="op">(</span>inQ<span class="op">[</span>i<span class="op">])</span> dis<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(!</span>Q<span class="op">.</span>empty<span class="op">()){</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> now <span class="op">=</span> Q<span class="op">.</span>front<span class="op">();</span> Q<span class="op">.</span>pop<span class="op">();</span> inQ<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span> i <span class="op">;</span>i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span> </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>dis<span class="op">[</span>now<span class="op">]</span> <span class="op">+</span> edge<span class="op">[</span>i<span class="op">].</span>w <span class="op">&lt;</span> dis<span class="op">[</span>ex<span class="op">])</span> <span class="op">{</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                dis<span class="op">[</span>ex<span class="op">]</span> <span class="op">=</span> dis<span class="op">[</span>now<span class="op">]</span> <span class="op">+</span> edge<span class="op">[</span>i<span class="op">].</span>w<span class="op">;</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span><span class="op">(!</span>inQ<span class="op">[</span>ex<span class="op">])</span> Q<span class="op">.</span>push<span class="op">(</span>ex<span class="op">),</span> inQ<span class="op">[</span>ex<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> MAX <span class="op">=</span> INT_MIN<span class="op">;</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>        pair<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;,</span> <span class="dt">int</span><span class="op">&gt;</span> now <span class="op">=</span> E<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> T <span class="op">=</span> min<span class="op">(</span>dis<span class="op">[</span>now<span class="op">.</span>first<span class="op">.</span>first<span class="op">]</span> <span class="op">+</span> now<span class="op">.</span>second<span class="op">,</span> dis<span class="op">[</span>now<span class="op">.</span>first<span class="op">.</span>second<span class="op">]</span> <span class="op">+</span> now<span class="op">.</span>second<span class="op">,</span> <span class="op">(</span>dis<span class="op">[</span>now<span class="op">.</span>first<span class="op">.</span>first<span class="op">]</span> <span class="op">+</span> dis<span class="op">[</span>now<span class="op">.</span>first<span class="op">.</span>second<span class="op">]</span> <span class="op">+</span> now<span class="op">.</span>second<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>        MAX <span class="op">=</span> max<span class="op">(</span>MAX<span class="op">,</span> T<span class="op">);</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> MAX<span class="op">;</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ind<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> work1<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> D<span class="op">)</span> <span class="op">{</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    Q<span class="op">.</span>push<span class="op">(</span>x<span class="op">);</span> inQ<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>i <span class="op">==</span> x <span class="op">||</span> i <span class="op">==</span> y<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span> <span class="cf">if</span><span class="op">(</span>M<span class="op">[</span>i<span class="op">][</span>y<span class="op">]</span> <span class="op">&gt;=</span> D <span class="op">&amp;&amp;</span> ind<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> Q<span class="op">.</span>push<span class="op">(</span>i<span class="op">),</span> inQ<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> SPFA<span class="op">()</span> <span class="op">==</span> D<span class="op">;</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> work2<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> D<span class="op">){</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>    Q<span class="op">.</span>push<span class="op">(</span>x<span class="op">);</span> Q<span class="op">.</span>push<span class="op">(</span>y<span class="op">);</span> inQ<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> inQ<span class="op">[</span>y<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">){</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>x <span class="op">==</span> i <span class="op">||</span> y <span class="op">==</span> i<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>max<span class="op">(</span>M<span class="op">[</span>x<span class="op">][</span>i<span class="op">],</span> M<span class="op">[</span>y<span class="op">][</span>i<span class="op">])</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">&gt;=</span> D <span class="op">&amp;&amp;</span> ind<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> Q<span class="op">.</span>push<span class="op">(</span>i<span class="op">),</span> inQ<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> SPFA<span class="op">()</span> <span class="op">==</span> D<span class="op">;</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>    memset<span class="op">(</span>M<span class="op">,</span> <span class="bn">0x3f</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>M<span class="op">));</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> M<span class="op">[</span>i<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> </span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">);</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> u<span class="op">,</span> v<span class="op">,</span> w<span class="op">;</span> Read<span class="op">(</span>u<span class="op">)(</span>v<span class="op">)(</span>w<span class="op">);</span> ind<span class="op">[</span>u<span class="op">]</span> <span class="op">++;</span> ind<span class="op">[</span>v<span class="op">]++;</span> w <span class="op">&lt;&lt;=</span> <span class="dv">1</span><span class="op">;</span> add<span class="op">(</span>u<span class="op">,</span> v<span class="op">,</span> w<span class="op">);</span> add<span class="op">(</span>v<span class="op">,</span> u<span class="op">,</span> w<span class="op">);</span> M<span class="op">[</span>u<span class="op">][</span>v<span class="op">]</span> <span class="op">=</span> M<span class="op">[</span>v<span class="op">][</span>u<span class="op">]</span> <span class="op">=</span> w<span class="op">;</span> E<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> make_pair<span class="op">(</span>make_pair<span class="op">(</span>u<span class="op">,</span> v<span class="op">),</span> w<span class="op">);</span> <span class="op">}</span></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>k<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> M<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> M<span class="op">[</span>j<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>M<span class="op">[</span>i<span class="op">][</span>j<span class="op">],</span> M<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">+</span> M<span class="op">[</span>k<span class="op">][</span>j<span class="op">]);</span></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">){</span> <span class="cf">if</span><span class="op">(</span>i <span class="op">==</span> j<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span> <span class="cf">if</span><span class="op">(</span>ind<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> <span class="dv">1</span> <span class="op">||</span> ind<span class="op">[</span>j<span class="op">]</span> <span class="op">!=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>Ans<span class="op">.</span>count<span class="op">(</span>M<span class="op">[</span>i<span class="op">][</span>j<span class="op">])</span>      <span class="op">&amp;&amp;</span> work1<span class="op">(</span>i<span class="op">,</span> j<span class="op">,</span> M<span class="op">[</span>i<span class="op">][</span>j<span class="op">]))</span>      Ans<span class="op">.</span>insert<span class="op">(</span>M<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>Ans<span class="op">.</span>count<span class="op">(</span>M<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&amp;&amp;</span> work2<span class="op">(</span>i<span class="op">,</span> j<span class="op">,</span> M<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">))</span> Ans<span class="op">.</span>insert<span class="op">(</span>M<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="dt">int</span><span class="op">(</span>Ans<span class="op">.</span>size<span class="op">()));</span></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="round-6">Round 6</h2>
<h3 id="a.-‰∏Ä-2">A. ‰∏Ä</h3>
<p>Áé∞Âú®Êàë‰ª¨Êúâ‰∏§ÈòüÁöÆÂÖãÊïèÔºå‰∏™Êï∞ÂàÜÂà´‰∏∫<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">n_1,n_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ÔºåÁé∞Âú®Êàë‰ª¨Ë¶ÅÊùÄÊéâËøô‰∫õÁöÆÂÖãÊïèÔºåÊåâÁÖßÂ¶Ç‰∏ãËßÑÂàôÊìç‰ΩúÔºöÂØπ‰∫éÁ¨¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ËΩÆÊùÄÁöÆÂÖãÊïèÁöÑÊìç‰ΩúÔºåÊàë‰ª¨È¶ñÂÖàÈÄâÊã©ÁöÆÂÖãÊïèËæÉÂ§öÁöÑÈÇ£‰∏ÄÈòüÔºåÂ¶ÇÊûú‰∏ÄÊ†∑Â∞±ÈÄâÊã©Á¨¨‰∏ÄÈòüÔºåÁÑ∂ÂêéÊùÄÊéâËøôÈòü‰∏≠ÁöÑ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>‰∏™ÁöÆÂÖãÊïèÔºåÂ¶ÇÊûú‰∏çÂ§üÔºåÊ∏∏ÊàèÁªìÊùüÔºåËÆ∞ÂÅöÊ∏∏ÊàèÂú®Á¨¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ËΩÆÁªìÊùü„ÄÇÈóÆÊúÄÂêé‰∏§ÈòüÂêÑÂâ©‰∏ãÂ§öÂ∞ë‰∏™ÁöÆÂÖãÊïèÔºü
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>16</mn></msup></mrow><annotation encoding="application/x-tex">n \le 10^{16}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>ÂàÜÊàê‰∏§Èò∂ÊÆµÔºå‰∏ÄÈò∂ÊÆµÊòØÂè™ÊùÄÂ§öÁöÑÈÇ£ÈòüÔºåÁõ¥Âà∞ÊØîÂè¶‰∏ÄÈòüÂ∞ë„ÄÇ‰∫åÈò∂ÊÆµÊòØ‰∏§Èòü‰∫§ÊõøÁùÄÊùÄÔºåÂèØ‰ª•ËØÅÊòéÔºåÂ¶ÇÊûúÁªèËøá‰∫ÜÁ¨¨‰∏ÄÈò∂ÊÆµÔºåÈÇ£‰πàÁ¨¨‰∫åÈò∂ÊÆµ‰∏ÄÂÆöÊòØ‰∫§ÊõøÁùÄÊùÄ„ÄÇ
<del>ÊùÄÂ∞±ÂÆå‰∫Ü„ÄÇ</del> ÂàÜÂà´‰∫åÂàÜÂç≥ÂèØÔºåÂΩìÁÑ∂Á¨¨‰∏ÄÊ≠•‰πüÂèØ‰ª•Áõ¥Êé•Ëß£ÊñπÁ®ã„ÄÇ</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>LL A<span class="op">,</span> B<span class="op">;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> LL check<span class="op">(</span>LL x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> x <span class="op">*</span> <span class="op">(</span>x <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>LL Get<span class="op">(</span>LL res<span class="op">){</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    LL L <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> R <span class="op">=</span> <span class="fl">1e9</span><span class="op">,</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>L <span class="op">&lt;</span> R<span class="op">){</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        LL mid <span class="op">=</span> L <span class="op">+</span> <span class="op">((</span>R <span class="op">-</span> L <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>check<span class="op">(</span>mid<span class="op">)</span> <span class="op">&lt;=</span> res<span class="op">)</span> ans <span class="op">=</span> mid<span class="op">,</span> L <span class="op">=</span> mid<span class="op">;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> R <span class="op">=</span> mid <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>LL Start <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> LL tA<span class="op">,</span> tB<span class="op">;</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> check0<span class="op">(</span>LL Round<span class="op">,</span> LL A<span class="op">,</span> LL B<span class="op">){</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    LL dA<span class="op">,</span> dB<span class="op">;</span> <span class="dt">bool</span> sf <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>A <span class="op">&lt;</span> B<span class="op">)</span> sf <span class="op">=</span> <span class="kw">true</span><span class="op">,</span> swap<span class="op">(</span>A<span class="op">,</span> B<span class="op">);</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>Round <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        dA <span class="op">=</span> <span class="op">(</span>Start <span class="op">+</span> <span class="op">(</span>Start <span class="op">+</span> Round <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">*</span> <span class="op">(</span>Round <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span> </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>        dB <span class="op">=</span> <span class="op">(</span>Start <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> <span class="op">(</span>Start <span class="op">+</span> Round <span class="op">-</span> <span class="dv">2</span><span class="op">))</span> <span class="op">*</span> <span class="op">(</span>Round <span class="op">/</span> <span class="dv">2</span><span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        dA <span class="op">=</span> <span class="op">(</span>Start <span class="op">+</span> <span class="op">(</span>Start <span class="op">+</span> Round <span class="op">-</span> <span class="dv">2</span><span class="op">))</span> <span class="op">*</span> <span class="op">(</span>Round <span class="op">/</span> <span class="dv">2</span><span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span> </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>        dB <span class="op">=</span> <span class="op">(</span>Start <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> <span class="op">(</span>Start <span class="op">+</span> Round <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">*</span> <span class="op">(</span>Round <span class="op">/</span> <span class="dv">2</span><span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> A <span class="op">-=</span> dA<span class="op">;</span> B <span class="op">-=</span> dB<span class="op">;</span> </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>sf<span class="op">)</span> swap<span class="op">(</span>A<span class="op">,</span> B<span class="op">);</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    tA <span class="op">=</span> A<span class="op">;</span> tB <span class="op">=</span> B<span class="op">;</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> A <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> B <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> doit<span class="op">(){</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>A<span class="op">)(</span>B<span class="op">);</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    LL d <span class="op">=</span> max<span class="op">(</span>A<span class="op">,</span> B<span class="op">)</span> <span class="op">-</span> min<span class="op">(</span>A<span class="op">,</span> B<span class="op">);</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    LL Round <span class="op">=</span> Get<span class="op">(</span>d<span class="op">);</span> LL del <span class="op">=</span> check<span class="op">(</span>Round<span class="op">);</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>A <span class="op">&lt;</span> B<span class="op">)</span> B <span class="op">-=</span> del<span class="op">;</span> <span class="cf">else</span> A <span class="op">-=</span> del<span class="op">;</span> </span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>A <span class="op">==</span> B<span class="op">)</span> <span class="op">{</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>A <span class="op">&lt;</span> Round <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> Round <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> A<span class="op">,</span> B<span class="op">);</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> Round <span class="op">++,</span> A <span class="op">-=</span> Round<span class="op">;</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>max<span class="op">(</span>A<span class="op">,</span> B<span class="op">)</span> <span class="op">&lt;</span> Round <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> Round <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> A<span class="op">,</span> B<span class="op">);</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> Round <span class="op">++,</span> <span class="op">(</span>A <span class="op">&gt;</span> B <span class="op">?</span> A <span class="op">-=</span> Round <span class="op">:</span> B <span class="op">-=</span> Round<span class="op">);</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    LL L <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> R <span class="op">=</span> <span class="fl">1e9</span><span class="op">,</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> Start <span class="op">=</span> Round <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>L <span class="op">&lt;</span> R<span class="op">)</span> <span class="op">{</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>        LL mid <span class="op">=</span> L <span class="op">+</span> <span class="op">((</span>R <span class="op">-</span> L <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>check0<span class="op">(</span>mid<span class="op">,</span> A<span class="op">,</span> B<span class="op">))</span> ans <span class="op">=</span> mid<span class="op">,</span> L <span class="op">=</span> mid<span class="op">;</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> R <span class="op">=</span> mid <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> check0<span class="op">(</span>ans<span class="op">,</span> A<span class="op">,</span> B<span class="op">);</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> ans <span class="op">+</span> Round <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> tA<span class="op">,</span> tB<span class="op">);</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> T <span class="op">=</span> read<span class="op">();</span> cerr <span class="op">&lt;&lt;</span> <span class="st">&quot;std&#39;s T = &quot;</span> <span class="op">&lt;&lt;</span> T <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>T<span class="op">--)</span> doit<span class="op">();</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="b.-‰∫å-2">B. ‰∫å</h3>
<p>Áé∞Âú®Êúâ‰∏âÁªÑN‰∏™Êï∞ËÆ∞ÂÅö<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo separator="true">,</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A,B,C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>ÔºåÂÆö‰πâÂáΩÊï∞<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>A</mi><mi>i</mi></msub><mo>√ó</mo><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">f(A,B)=\sum_{i=1}^NA_i\times B_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">‚àë</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>„ÄÇÁé∞Âú®ÁªôÂÆö<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A,B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>ÔºåÂπ∂ÂëäËØâ‰Ω†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">f(A,C)=x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ÔºåÁé∞Âú®ÊÉ≥Ê±ÇÂú®Êª°Ë∂≥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo>‚â§</mo><msub><mi>C</mi><mi>i</mi></msub><mo>‚â§</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">‚àë_{i=1}^NC_i=1,0\leq C_i\leq1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">‚àë</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ÁöÑÊÉÖÂÜµ‰∏ã<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(B,C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span>ÁöÑÊúÄÂ§ßÂÄº„ÄÇ
ÂØπ‰∫é<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">100\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">100%</span></span></span></span>ÁöÑÊï∞ÊçÆÔºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚â§</mo><mi>N</mi><mo separator="true">,</mo><mi>M</mi><mo>‚â§</mo><mn>100</mn><mo separator="true">,</mo><mn>1</mn><mo>‚â§</mo><msub><mi>A</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>B</mi><mi>i</mi></msub><mo>‚â§</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">1\leq N,M\leq 100,1\leq A_i,B_i\leq100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">100</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">100</span></span></span></span></p>
<p>[skip] ÁªìËÆ∫ÊòØÂè™Êúâ‰∏§‰∏™ÁÇπÊúâÁî®ÔºåÂè™Êûö‰∏æ‰∏§‰∏™ÁÇπÂç≥ÂèØ„ÄÇ</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode cpp"><code class="sourceCode cpp"></code></pre></div>
<h3 id="c.-‰∏â-2">C. ‰∏â</h3>
<p>‰ºóÊâÄÂë®Áü•ÔºåÂ∞èËë±ÂêåÂ≠¶ÊìÖÈïøËÆ°ÁÆóÔºåÂ∞§ÂÖ∂ÊìÖÈïøËÆ°ÁÆóÁªÑÂêàÊï∞Ôºå‰ΩÜËøô‰∏™È¢òÂíåÁªÑÂêàÊï∞Ê≤°‰ªÄ‰πàÂÖ≥Á≥ª„ÄÇ</p>
<p>Áé∞Âú®Êúâ‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>
ÁöÑÊéíÂàóÔºåÂ∞ÜÂÖ∂ÊØè‰∏™Êï∞ÁúãÂÅö‰∏Ä‰∏™ÈõÜÂêà„ÄÇÂÆö‰πâ‰∏ÄÁßçÂØπ‰∏§‰∏™ÈõÜÂêàÁöÑËøêÁÆó‰∏∫Ôºö<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mo>‚àë</mo><mrow><mi>x</mi><mo>‚àà</mo><msub><mi>s</mi><mn>1</mn></msub></mrow></msub><mo stretchy="false">[</mo><mi mathvariant="normal">‚àÉ</mi><mi>y</mi><mo>‚àà</mo><msub><mi>s</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>y</mi><mo>&lt;</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">f(s_1,s_2 )=\sum_{x\in s_1}[\exists y\in s_2,y &lt; x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1498em;vertical-align:-0.3998em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">‚àë</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0777em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">‚àà</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.3998em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord">‚àÉ</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span>
‰πüÂèØ‰ª•Áî®ËøôÊ†∑‰∏ÄÊÆµ‰º™‰ª£Á†ÅÂéªÁêÜËß£Ôºö</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Ans<span class="op">=</span><span class="dv">0</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>For x <span class="kw">in</span> s1:</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    Able <span class="op">=</span> <span class="va">False</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    For y <span class="kw">in</span> s2:</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        If y<span class="op">&lt;</span>x:</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>            Able<span class="op">=</span><span class="va">True</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    If Able:</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        Ans<span class="op">++</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>Return Ans</span></code></pre></div>
<p>Áé∞Âú®‰Ω†ÊØèÊ¨°ÂèØ‰ª•ÂêàÂπ∂‰∏§‰∏™Áõ∏ÈÇªÁöÑÈõÜÂêàÂ∞ÜÂÖ∂Âèò‰∏∫‰∏§‰∏™ÈõÜÂêàÁöÑÂπ∂ÈõÜÔºåÂÖ∂‰ª£‰ª∑‰∏∫<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(s_1,s_2)+f(s_2,s_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>„ÄÇÊ±ÇÊúÄÂ∞è‰ª£‰ª∑ÔºåÂ∞ÜÊâÄÊúâÈõÜÂêàÂêàÂπ∂‰∏∫‰∏Ä‰∏™ÈõÜÂêà„ÄÇ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">N \le 10^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></p>
<p>ÂáΩÊï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(A, B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span>
ÂÖ∂ÂÆûÂ∞±ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>
‰∏≠ÊúâÂ§öÂ∞ëÂÖÉÁ¥†Â§ß‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>‚Å°</mo><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\min{B_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>
„ÄÇÊåâÁÖßÂÆö‰πâÂå∫Èó¥ dp Âç≥ÂèØÔºåÁî±‰∫éÊòØÂ∞è‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
Á∫ßÂà´ÁöÑ‰∫åÁª¥Êï∞ÁÇπÔºåÂèØ‰ª•‰ΩøÁî®‰∫åÁª¥ÂâçÁºÄÂíå„ÄÇ Êü•ËØ¢ÊúÄÂ∞èÂÄºÈöèÊâãÈ¢ÑÂ§ÑÁêÜ‰∏Ä‰∏ã
<code>ST</code> Ë°®Âç≥ÂèØ„ÄÇ</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="dv">600</span><span class="op">;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dp<span class="op">[</span>_<span class="op">][</span>_<span class="op">];</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> S<span class="op">[</span>_<span class="op">][</span>_<span class="op">];</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> A<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> query<span class="op">(</span><span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">,</span> <span class="dt">int</span> up<span class="op">){</span> <span class="co">// how many elements in range[L, R] which is &gt; up </span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> S<span class="op">[</span>n<span class="op">][</span>R<span class="op">]</span> <span class="op">-</span> S<span class="op">[</span>up<span class="op">][</span>R<span class="op">]</span> <span class="op">-</span> S<span class="op">[</span>n<span class="op">][</span>L <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> S<span class="op">[</span>up<span class="op">][</span>L <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _S <span class="op">=</span> <span class="dv">4000</span><span class="op">;</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> LOG <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ST<span class="op">[</span>_S<span class="op">][</span>LOG <span class="op">+</span> <span class="dv">2</span><span class="op">];</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> Log<span class="op">[</span>_S<span class="op">];</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> initQuery<span class="op">(){</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> ST<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> A<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> LOG<span class="op">)</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> ST<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>ST<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">],</span> ST<span class="op">[</span>i <span class="op">+</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="op">(</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">))][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">]);</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    Log<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> n<span class="op">)</span> Log<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> Log<span class="op">[</span>i <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> RMQ<span class="op">(</span><span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> Ln <span class="op">=</span> Log<span class="op">[</span>R <span class="op">-</span> L <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> min<span class="op">(</span>ST<span class="op">[</span>L<span class="op">][</span>Ln<span class="op">],</span> ST<span class="op">[</span>R <span class="op">-</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> Ln<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">][</span>Ln<span class="op">]);</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> calc<span class="op">(</span><span class="dt">int</span> L0<span class="op">,</span> <span class="dt">int</span> R0<span class="op">,</span> <span class="dt">int</span> L1<span class="op">,</span> <span class="dt">int</span> R1<span class="op">){</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> min0 <span class="op">=</span> RMQ<span class="op">(</span>L0<span class="op">,</span> R0<span class="op">),</span> min1 <span class="op">=</span> RMQ<span class="op">(</span>L1<span class="op">,</span> R1<span class="op">);</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> query<span class="op">(</span>L0<span class="op">,</span> R0<span class="op">,</span> min1<span class="op">)</span> <span class="op">+</span> query<span class="op">(</span>L1<span class="op">,</span> R1<span class="op">,</span> min0<span class="op">);</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">);</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> Read<span class="op">(</span>A<span class="op">[</span>i<span class="op">]);</span> initQuery<span class="op">();</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> S<span class="op">[</span>A<span class="op">[</span>i<span class="op">]][</span>i<span class="op">]++;</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> S<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">+=</span> S<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">+</span> S<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">-</span> S<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    memset<span class="op">(</span>dp<span class="op">,</span> <span class="bn">0x3f</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>dp<span class="op">));</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> dp<span class="op">[</span>i<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>Len<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> n<span class="op">){</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>L<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">){</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> R <span class="op">=</span> L <span class="op">+</span> Len <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">if</span><span class="op">(</span>R <span class="op">&gt;</span> n<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> <span class="op">&amp;</span>ans <span class="op">=</span> dp<span class="op">[</span>L<span class="op">][</span>R<span class="op">];</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>            rep<span class="op">(</span>k<span class="op">,</span> L<span class="op">,</span> R <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> ans <span class="op">=</span> min<span class="op">(</span>ans<span class="op">,</span> dp<span class="op">[</span>L<span class="op">][</span>k<span class="op">]</span> <span class="op">+</span> dp<span class="op">[</span>k <span class="op">+</span> <span class="dv">1</span><span class="op">][</span>R<span class="op">]</span> <span class="op">+</span> calc<span class="op">(</span>L<span class="op">,</span> k<span class="op">,</span> k <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">));</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> dp<span class="op">[</span><span class="dv">1</span><span class="op">][</span>n<span class="op">]);</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="d.-Âõõ-2">D. Âõõ</h3>
<p>ÁªôÂÆö
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚àí</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1-N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>
ÁöÑÊéíÂàó‰ΩÜÂÖ∂‰∏≠
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>
‰∏™‰ΩçÁΩÆÁöÑÂÄºË¢´Âà†Âéª‰∫ÜÔºàÁî®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>
Ë°®Á§∫ÔºâÔºåÁé∞Âú®‰Ω†ÈúÄË¶ÅÂ∞ÜÂÖ∂Â§çÂéüÔºåÈóÆÊúâÂ§öÂ∞ëÁßçÊñπÊ°àËÉΩÂ§ü‰ΩøÂæóÂ§çÂéüÁöÑÂ∫èÂàóÁöÑÈÄÜÂ∫èÂØπ‰∏™Êï∞Âú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>L</mi><mo separator="true">,</mo><mi>R</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[L,R]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">]</span></span></span></span>
‰πãÈó¥</p>
<p>ÊäòÂçäÊêúÁ¥¢Ôºå‰∏≠Èó¥
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
ÂêàÂπ∂„ÄÇ</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode cpp"><code class="sourceCode cpp"></code></pre></div>
<h2 id="round-7">Round 7</h2>
<p>AK„ÄÇ ### A. ‰∏Ä</p>
<p>Êúâ‰∏Ä‰∏™<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>√ó</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n\times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ÁöÑÁü©ÈòµÔºåÁü©Èòµ‰∏≠ÁöÑÊØè‰∏™Êï∞ÈÉΩÊòØÊï¥Êï∞„ÄÇÁé∞Âú®Ë¶Å‰ªéÁü©Èòµ‰∏≠Âèñ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>‰∏™Êï∞ÔºåË¶ÅÊ±ÇÊØè‰∏ÄË°åÊúÄÂ§öÂèñ‰∏Ä‰∏™Êï∞ÔºåÊØè‰∏ÄÂàó‰πüÊúÄÂ§öÂèñ‰∏Ä‰∏™Êï∞„ÄÇËøô<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>‰∏™Êï∞ÁöÑÂíåÊúÄÂ§ßËÉΩÊòØÂ§öÂ∞ëÔºü
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚â§</mo><mn>15</mn><mo separator="true">,</mo><mi>m</mi><mo>‚â§</mo><mn>3</mn><mo separator="true">,</mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">n \le 15, m \le 3, A_{i,j} \le 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">15</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="dv">20</span><span class="op">;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> m<span class="op">,</span> A<span class="op">[</span>_<span class="op">][</span>_<span class="op">];</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">)(</span>m<span class="op">);</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> Read<span class="op">(</span>A<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>m <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> MAX <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> MAX <span class="op">=</span> max<span class="op">(</span>MAX<span class="op">,</span> A<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> MAX<span class="op">);</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>m <span class="op">==</span> <span class="dv">2</span><span class="op">){</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> MAX <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>a<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>b<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>c<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>d<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">){</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>a <span class="op">==</span> c <span class="op">||</span> b <span class="op">==</span> d<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>            MAX <span class="op">=</span> max<span class="op">(</span>MAX<span class="op">,</span> A<span class="op">[</span>a<span class="op">][</span>b<span class="op">]</span> <span class="op">+</span> A<span class="op">[</span>c<span class="op">][</span>d<span class="op">]);</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> MAX<span class="op">);</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>m <span class="op">==</span> <span class="dv">3</span><span class="op">){</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> MAX <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>a<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>b<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>c<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>d<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>e<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> rep<span class="op">(</span>f<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">){</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>a <span class="op">==</span> c <span class="op">||</span> c <span class="op">==</span> e <span class="op">||</span> a <span class="op">==</span> e <span class="op">||</span> b <span class="op">==</span> d <span class="op">||</span> d <span class="op">==</span> f <span class="op">||</span> b <span class="op">==</span> f<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>            MAX <span class="op">=</span> max<span class="op">(</span>MAX<span class="op">,</span> A<span class="op">[</span>a<span class="op">][</span>b<span class="op">]</span> <span class="op">+</span> A<span class="op">[</span>c<span class="op">][</span>d<span class="op">]</span> <span class="op">+</span> A<span class="op">[</span>e<span class="op">][</span>f<span class="op">]);</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> MAX<span class="op">);</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="b.-‰∫å-3">B. ‰∫å</h3>
<p>ÊúâÂ§öÂ∞ëÊï¥Êï∞Â§ß‰∫éÁ≠â‰∫é<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ÔºåÂ∞è‰∫éÁ≠â‰∫é<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ÔºåËÄå‰∏îÊòØ7ÁöÑÂÄçÊï∞ÔºåÂèà‰∏çÊòØ2,3,5ÁöÑÂÄçÊï∞Âë¢Ôºü
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>18</mn></msup></mrow><annotation encoding="application/x-tex">x,y \le 10^{18}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">18</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>ÂÆπÊñ•ÂéüÁêÜ</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>LL calc<span class="op">(</span>LL R<span class="op">){</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    LL ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">+=</span> R <span class="op">/</span> <span class="dv">7</span><span class="op">;</span> ans <span class="op">-=</span> R <span class="op">/</span> <span class="dv">14</span><span class="op">;</span> ans <span class="op">-=</span> R <span class="op">/</span> <span class="dv">21</span><span class="op">;</span> ans <span class="op">-=</span> R <span class="op">/</span> <span class="dv">35</span><span class="op">;</span> ans <span class="op">+=</span> R <span class="op">/</span> <span class="dv">42</span><span class="op">;</span> ans <span class="op">+=</span> R <span class="op">/</span> <span class="dv">70</span><span class="op">;</span> ans <span class="op">+=</span> R <span class="op">/</span> <span class="dv">105</span><span class="op">;</span> ans <span class="op">-=</span> R <span class="op">/</span> <span class="dv">210</span><span class="op">;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    LL L<span class="op">,</span> R<span class="op">;</span> Read<span class="op">(</span>L<span class="op">)(</span>R<span class="op">);</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld</span><span class="st">&quot;</span><span class="op">,</span> calc<span class="op">(</span>R<span class="op">)</span> <span class="op">-</span> calc<span class="op">(</span>L <span class="op">-</span> <span class="dv">1</span><span class="op">));</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="c.-‰∏â-3">C. ‰∏â</h3>
<p>ÁªôÂá∫‰∏Ä‰∏™<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>‰∏™ÁÇπ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>Êù°ËæπÁöÑÂõæ„ÄÇ</p>
<p>Áé∞Âú®ÊÉ≥Ë¶ÅÈÄâÊã©‰∏§‰∏™Êï¥Êï∞<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>Âíå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>ÔºåÊª°Ë∂≥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚â§</mo><mi>a</mi><mo>&lt;</mo><mi>b</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1 \leq a &lt; b &lt; n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ÔºåÁÑ∂ÂêéÊääÁºñÂè∑Âú®Âå∫Èó¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1,a]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">]</span></span></span></span>‰∏≠ÁöÑÁÇπÊüìÊàêËìùËâ≤ÔºåÊääÁºñÂè∑Âú®Âå∫Èó¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>a</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[a+1,b]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">]</span></span></span></span>‰∏≠ÁöÑÁÇπÊüìÊàêÁ∫¢Ëâ≤ÔºåÁºñÂè∑Âú®Âå∫Èó¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>b</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[b+1,n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>‰∏≠ÁöÑÁÇπÊüìÊàêËìùËâ≤„ÄÇ</p>
<p>Â¶ÇÊûú‰∏ÄÊù°ËæπÁöÑ‰∏§‰∏™Á´ØÁÇπÈ¢úËâ≤‰∏çÂêåÔºåÊàë‰ª¨Áß∞ËøôÊù°Ëæπ‰∏∫ÂèåËâ≤ËæπÔºåÂê¶ÂàôÁß∞‰πã‰∏∫ÂçïËâ≤Ëæπ„ÄÇ</p>
<p>Â¶Ç‰ΩïÈÄâÊã©<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a,b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span></span></span></span>ÔºåËÉΩÂ§üÊúÄÂ∞èÂåñÂèåËâ≤ËæπÁöÑÊï∞ÈáèÔºü
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">n, m \le 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></p>
<p>ÁªèÂÖ∏Â•óË∑ØÔºåÊåâÈ°∫Â∫èÊûö‰∏æ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>ÔºåÁ∫øÊÆµÊ†ëÁª¥Êä§
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>
ÁöÑÊØè‰∏Ä‰∏™ÂèñÂÄºÊó∂ÁöÑÂèåËâ≤ËæπÊï∞ÈáèÔºåÊûö‰∏æ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>
ÁöÑËøáÁ®ã‰∏≠Áª¥Êä§
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>
ÁöÑÂèñÂÄºÔºåÊõ¥Êñ∞Á≠îÊ°àÂç≥ÂèØ„ÄÇ</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> m<span class="op">;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">3e5</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> ToL<span class="op">[</span>_<span class="op">];</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> ToR<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> SegmentTree<span class="op">{</span>  <span class="co">// maintain the number of double-color edge;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                        <span class="co">// the min number ;</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">2e6</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ch<span class="op">[</span>_<span class="op">][</span><span class="dv">2</span><span class="op">],</span> v<span class="op">[</span>_<span class="op">],</span> tag_add<span class="op">[</span>_<span class="op">],</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define ls</span><span class="op">(</span>o<span class="op">)</span><span class="pp"> </span><span class="op">(</span>ch<span class="op">[</span>o<span class="op">][</span><span class="dv">0</span><span class="op">])</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define rs</span><span class="op">(</span>o<span class="op">)</span><span class="pp"> </span><span class="op">(</span>ch<span class="op">[</span>o<span class="op">][</span><span class="dv">1</span><span class="op">])</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define maintain</span><span class="op">(</span>o<span class="op">)</span><span class="pp"> </span><span class="op">(</span>v<span class="op">[</span>o<span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span>min<span class="op">(</span>v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)],</span><span class="pp"> </span>v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)]))</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define make </span><span class="op">(</span>tot<span class="op">++,</span><span class="pp"> </span>ch<span class="op">[</span>tot<span class="op">][</span><span class="dv">0</span><span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span>ch<span class="op">[</span>tot<span class="op">][</span><span class="dv">1</span><span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span>v<span class="op">[</span>tot<span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span>tag_add<span class="op">[</span>tot<span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="dv">0</span><span class="op">,</span><span class="pp"> </span>tot<span class="op">)</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> Groot<span class="op">(){</span> <span class="cf">return</span> make<span class="op">;</span> <span class="op">}</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> build<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">==</span> R<span class="op">)</span> <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">)(</span>v<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">);</span> <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        ls<span class="op">(</span>o<span class="op">)</span> <span class="op">=</span> make<span class="op">;</span> rs<span class="op">(</span>o<span class="op">)</span> <span class="op">=</span> make<span class="op">;</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        build<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> L<span class="op">,</span> mid<span class="op">);</span> build<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>        maintain<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> tar<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> _v<span class="op">){</span> tag_add<span class="op">[</span>o<span class="op">]</span> <span class="op">+=</span> _v<span class="op">;</span> v<span class="op">[</span>o<span class="op">]</span> <span class="op">+=</span> _v<span class="op">;</span> <span class="op">}</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> push<span class="op">(</span><span class="dt">int</span> o<span class="op">)</span> <span class="op">{</span> <span class="cf">if</span><span class="op">(!</span>tag_add<span class="op">[</span>o<span class="op">])</span> <span class="cf">return</span> <span class="op">;</span> tar<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> tag_add<span class="op">[</span>o<span class="op">]);</span> tar<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> tag_add<span class="op">[</span>o<span class="op">]);</span> tag_add<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> update<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">,</span> <span class="dt">int</span> Val<span class="op">){</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> nowl <span class="op">&amp;&amp;</span> nowr <span class="op">&lt;=</span> R<span class="op">)</span> <span class="cf">return</span> tar<span class="op">(</span>o<span class="op">,</span> Val<span class="op">);</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span> push<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> mid<span class="op">)</span> update<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> Val<span class="op">);</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>R  <span class="op">&gt;</span> mid<span class="op">)</span> update<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> Val<span class="op">);</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>        maintain<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> query<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> nowl <span class="op">&amp;&amp;</span> nowr <span class="op">&lt;=</span> R<span class="op">)</span> <span class="cf">return</span> v<span class="op">[</span>o<span class="op">];</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span> push<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ans <span class="op">=</span> INT_MAX<span class="op">;</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> mid<span class="op">)</span> ans <span class="op">=</span> min<span class="op">(</span>ans<span class="op">,</span> query<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> L<span class="op">,</span> R<span class="op">));</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>R  <span class="op">&gt;</span> mid<span class="op">)</span> ans <span class="op">=</span> min<span class="op">(</span>ans<span class="op">,</span> query<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> L<span class="op">,</span> R<span class="op">));</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>   <span class="kw">using</span> SegmentTree<span class="op">::</span>update<span class="op">;</span>  <span class="kw">using</span> SegmentTree<span class="op">::</span>build<span class="op">;</span> </span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> SegmentTree<span class="op">::</span>query<span class="op">;</span>   <span class="kw">using</span> SegmentTree<span class="op">::</span>Groot<span class="op">;</span> </span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span> </span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">)(</span>m<span class="op">);</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> root <span class="op">=</span> Groot<span class="op">();</span> build<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">);</span> <span class="dt">int</span> ans <span class="op">=</span> INT_MAX<span class="op">;</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> m<span class="op">){</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u<span class="op">,</span> v<span class="op">;</span> Read<span class="op">(</span>u<span class="op">)(</span>v<span class="op">);</span> <span class="cf">if</span><span class="op">(</span>u <span class="op">&gt;</span> v<span class="op">)</span> swap<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>        ToL<span class="op">[</span>v<span class="op">].</span>push_back<span class="op">(</span>u<span class="op">);</span> ToR<span class="op">[</span>u<span class="op">].</span>push_back<span class="op">(</span>v<span class="op">);</span> update<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> u<span class="op">,</span> v <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>        update<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dt">int</span><span class="op">(</span>ToL<span class="op">[</span>i<span class="op">].</span>size<span class="op">()));</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> ToR<span class="op">[</span>i<span class="op">].</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> update<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> i<span class="op">,</span> ToR<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">),</span> update<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> ToR<span class="op">[</span>i<span class="op">][</span>j<span class="op">],</span> n<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> min<span class="op">(</span>ans<span class="op">,</span> query<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">));</span></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="d.-Âõõ-3">D. Âõõ</h3>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>‰∏™Â∞è‰ºô‰º¥ÔºàÁºñÂè∑‰ªé0Âà∞<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n‚àí1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ÔºâÂõ¥Âùê‰∏ÄÂúàÁé©Ê∏∏Êàè„ÄÇÊåâÁÖßÈ°∫Êó∂ÈíàÊñπÂêëÁªô<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>‰∏™‰ΩçÁΩÆÁºñÂè∑Ôºå‰ªé0Âà∞<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n‚àí1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>„ÄÇÊúÄÂàùÔºåÁ¨¨0Âè∑Â∞è‰ºô‰º¥Âú®Á¨¨0Âè∑‰ΩçÁΩÆÔºåÁ¨¨1Âè∑Â∞è‰ºô‰º¥Âú®Á¨¨1Âè∑‰ΩçÁΩÆÔºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚Ä¶</mo></mrow><annotation encoding="application/x-tex">\dots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.123em;"></span><span class="minner">‚Ä¶</span></span></span></span>Ôºå‰æùÊ≠§Á±ªÊé®„ÄÇÊ∏∏ÊàèËßÑÂàôÂ¶Ç‰∏ãÔºö
-
Êúâ‰∏Ä‰∏™Â∫èÂàó<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>‚Ä¶</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>m</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A=\{a_1,\dots,a_m\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">‚Ä¶</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>ÔºåÂÖ∂‰∏≠ÊØè‰∏™Êï∞‰∫í‰∏çÁõ∏ÂêåÔºå‰∏îÈÉΩÊòØ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1,n-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>‰∏≠ÁöÑÊ≠£Êï¥Êï∞„ÄÇ
-
ÊØè‰∏ÄËΩÆ‰ªé<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>‰∏≠ÈÄâÊã©‰∏Ä‰∏™Êï∞<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>ÔºåÁ¨¨0Âè∑‰ΩçÁΩÆ‰∏äÁöÑÂ∞è‰ºô‰º¥È°∫Êó∂ÈíàËµ∞Âà∞Á¨¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>Âè∑‰ΩçÁΩÆÔºåÁ¨¨1Âè∑‰ΩçÁΩÆÂ∞è‰ºô‰º¥Ëµ∞Âà∞Á¨¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>Âè∑‰ΩçÁΩÆ„ÄÇ‰æùÊ≠§Á±ªÊé®ÔºåÁ¨¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚àí</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">n-a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>Âè∑‰ΩçÁΩÆ‰∏äÁöÑÂ∞è‰ºô‰º¥Ëµ∞Âà∞Á¨¨0Âè∑‰ΩçÁΩÆÔºåÁ¨¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚àí</mo><mi>a</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-a+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>Âè∑‰ΩçÁΩÆ‰∏äÁöÑÂ∞è‰ºô‰º¥Ëµ∞Âà∞Á¨¨1Âè∑‰ΩçÁΩÆÔºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚Ä¶</mo></mrow><annotation encoding="application/x-tex">\dots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.123em;"></span><span class="minner">‚Ä¶</span></span></span></span>ÔºåÁ¨¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>Âè∑‰ΩçÁΩÆ‰∏äÁöÑÂ∞è‰ºô‰º¥È°∫Êó∂ÈíàËµ∞Âà∞Á¨¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>Âè∑‰ΩçÁΩÆ„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÁ¨¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>Âè∑‰ΩçÁΩÆ‰∏äÁöÑÂ∞è‰ºô‰º¥Ëµ∞Âà∞Á¨¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mi>a</mi><mo stretchy="false">)</mo><mspace></mspace><mspace width="0.6667em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>‚Äâ</mtext><mtext>‚Äâ</mtext><mtext>¬†</mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">(i+a)\mod\ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6667em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace">¬†</span><span class="mord mathnormal">n</span></span></span></span>Âè∑‰ΩçÁΩÆ</p>
<p>Ê∏∏ÊàèËøõË°å<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>ËΩÆ„ÄÇÁî±‰∫éÊØè‰∏ÄËΩÆÈÉΩÈúÄË¶Å‰ªé<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>‰∏≠ÁöÑ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>‰∏™Êï∞‰∏≠ÈÄâ‰∏Ä‰∏™Êï∞ÔºåÊâÄ‰ª•Ê∏∏ÊàèÂÖ±Êúâ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">m^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7936em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span>ÁßçÁé©Ê≥ï„ÄÇÂÖ∂‰∏≠ÊúâÂ§öÂ∞ëÁßçÁé©Ê≥ïËÉΩÂ§ü‰ΩøÂæóÊ∏∏ÊàèÁªìÊùüÊó∂ÔºåÁ¨¨0Âè∑Â∞è‰ºô‰º¥ÊâÄÂú®ÁöÑ‰ΩçÁΩÆÁºñÂè∑ÊòØ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>ÁöÑÂÄçÊï∞ÔºüÔºà0‰πüÊòØ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>ÁöÑÂÄçÊï∞Ôºâ„ÄÅ
ÂØπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mo>+</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">10^9 + 7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">7</span></span></span></span>ÂèñÊ®°„ÄÇ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚â§</mo><mi>m</mi><mo>‚â§</mo><mi>n</mi><mo>‚â§</mo><mn>1000</mn><mo separator="true">,</mo><mn>1</mn><mo>‚â§</mo><mi>t</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mo separator="true">,</mo><mn>1</mn><mo>‚â§</mo><mi>d</mi><mo>‚â§</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1\le m \le n \le 1000, 1 \le t \le 10^9, 1 \le d \le n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1000</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>„ÄÇ</p>
<p>ËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>
‰∏∫ËøõË°åËã•Âπ≤ËΩÆ‰πãÂêéÂú®‰ΩçÁΩÆ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>
ÁöÑÊñπÊ°àÊï∞„ÄÇ ËΩ¨ÁßªÊòæÁÑ∂ÊòØÂç∑ÁßØ„ÄÇ ÂåÖË£Ö‰∫ÜÂæ™ÁéØÂç∑ÁßØÁöÑÂÆö‰πâ„ÄÇ</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> subtask_acceptable_solution<span class="op">{</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="dv">1500</span><span class="op">;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Matrix<span class="op">{</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> dp<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>        Matrix <span class="op">(){</span> memset<span class="op">(</span>dp<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>dp<span class="op">));</span> <span class="op">}</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>        Matrix <span class="kw">operator</span> <span class="op">*</span> <span class="op">(</span><span class="at">const</span> Matrix <span class="op">&amp;</span> rhs<span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>            Matrix Res<span class="op">;</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>            rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> Res<span class="op">.</span>dp<span class="op">[(</span>i <span class="op">+</span> j<span class="op">)</span> <span class="op">%</span> n<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>Res<span class="op">.</span>dp<span class="op">[(</span>i <span class="op">+</span> j<span class="op">)</span> <span class="op">%</span> n<span class="op">]</span> <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> dp<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> rhs<span class="op">.</span>dp<span class="op">[</span>j<span class="op">]</span> <span class="op">%</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> Res<span class="op">;</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    Matrix pow<span class="op">(</span>Matrix a<span class="op">,</span> <span class="dt">int</span> b<span class="op">){</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        Matrix ans <span class="op">=</span> a<span class="op">;</span> b<span class="op">--;</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(</span>b<span class="op">){</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>b <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> ans <span class="op">=</span> ans <span class="op">*</span> a<span class="op">;</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>            a <span class="op">=</span> a <span class="op">*</span> a<span class="op">;</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>            b <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> work<span class="op">(){</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>        Matrix a<span class="op">;</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> m<span class="op">)</span> a<span class="op">.</span>dp<span class="op">[</span>A<span class="op">[</span>i<span class="op">]]</span> <span class="op">++;</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>        Matrix Ans <span class="op">=</span> pow<span class="op">(</span>a<span class="op">,</span> t<span class="op">);</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i <span class="op">+=</span> d<span class="op">)</span> ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> Ans<span class="op">.</span>dp<span class="op">[</span>i<span class="op">])</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span> <span class="co">//freopen(&quot;in.txt&quot;, &quot;r&quot;, stdin);</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">)(</span>m<span class="op">)(</span>t<span class="op">)(</span>d<span class="op">);</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> m<span class="op">)</span> A<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> read<span class="op">()</span> <span class="op">%</span> n<span class="op">;</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    subtask_acceptable_solution<span class="op">::</span>work<span class="op">();</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="round-8">Round 8</h2>
<h3 id="a.-ÂèåÊåÇ">A. ÂèåÊåÇ</h3>
<p>‰ªäÂπ¥Êúü‰∏≠ËÄÉËØïËÄÉ‰∫Ü„ÄäÁ®ãÂ∫èËÆæËÆ°„Äã„ÄÅ„ÄäÁÆóÊ≥ïËÆæËÆ°„ÄãÂíå„ÄäÊï∞ÊçÆÁªìÊûÑ„ÄãÂÖ±‰∏âÈó®ËØæ„ÄÇÁî±‰∫éËÄÉËØïÂ§™Èöæ‰∫ÜÔºåÂ•ΩÂ§öÂêåÂ≠¶ÈÉΩÊåÇÁßë‰∫Ü„ÄÇÁè≠Èáå‰∏ÄÂÖ±<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>‰∏™‰∫∫ÔºåÂÖ∂‰∏≠<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>‰∏™‰∫∫ÊåÇ‰∫Ü„ÄäÁ®ãÂ∫èËÆæËÆ°„ÄãÔºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>‰∏™‰∫∫ÊåÇ‰∫Ü„ÄäÁÆóÊ≥ïËÆæËÆ°„ÄãÔºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>‰∏™‰∫∫ÊåÇ‰∫Ü„ÄäÊï∞ÊçÆÁªìÊûÑ„Äã„ÄÇ</p>
<p>Â¶ÇÊûú‰∏Ä‰∏™ÂêåÂ≠¶ÊåÇ‰∫ÜÊÅ∞Â•Ω‰∏§Èó®ËØæÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ËØ¥‰ªñ‚ÄúÂèåÊåÇ‚Äù‰∫Ü„ÄÇ
ÁªôÂá∫<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">n,a,b,c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span></span></span></span>ÔºåÈóÆÊúÄÂ∞ëÊúâÂ§öÂ∞ëÂêåÂ≠¶‚ÄúÂèåÊåÇ‚Äù‰∫Ü„ÄÇ</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>‚â§</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi><mo>‚â§</mo><mi>n</mi><mo separator="true">,</mo><mi>n</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding="application/x-tex">0 \le a, b, c \le n, n \le 10^9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span></p>
<p>ËÆæ‰∏âÈó®ËØæÊåÇÁßëÁöÑ‰∫∫ÂØπÂ∫îÈõÜÂêàÂàÜÂà´‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">A</mi><mo separator="true">,</mo><mi mathvariant="double-struck">B</mi><mo separator="true">,</mo><mi mathvariant="double-struck">C</mi></mrow><annotation encoding="application/x-tex">\mathbb{A}, \mathbb{B}, \mathbb{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833em;vertical-align:-0.1944em;"></span><span class="mord mathbb">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbb">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbb">C</span></span></span></span></p>
<p>ÊòæÁÑ∂Âπ∂‰∏çÊòØÊâÄÊúâ‰∫∫ÈÉΩ‰ºöÊåÇÁßëÁõÆ„ÄÇ</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">A</mi><mo>‚à™</mo><mi mathvariant="double-struck">B</mi><mo>‚à™</mo><mi mathvariant="double-struck">C</mi><mi mathvariant="normal">‚à£</mi><mo>=</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">A</mi><mi mathvariant="normal">‚à£</mi><mo>+</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">B</mi><mi mathvariant="normal">‚à£</mi><mo>+</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">C</mi><mi mathvariant="normal">‚à£</mi><mo>‚àí</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">A</mi><mo>‚à©</mo><mi mathvariant="double-struck">B</mi><mi mathvariant="normal">‚à£</mi><mo>‚àí</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">A</mi><mo>‚à©</mo><mi mathvariant="double-struck">C</mi><mi mathvariant="normal">‚à£</mi><mo>‚àí</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">B</mi><mo>‚à©</mo><mi mathvariant="double-struck">C</mi><mi mathvariant="normal">‚à£</mi><mo>+</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">A</mi><mo>‚à©</mo><mi mathvariant="double-struck">B</mi><mo>‚à©</mo><mi mathvariant="double-struck">C</mi><mi mathvariant="normal">‚à£</mi><mo>‚â§</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">|\mathbb{A} \cup \mathbb{B} \cup \mathbb{C}| = |\mathbb{A}| + |\mathbb{B}| + |\mathbb{C}| - |\mathbb{A} \cap \mathbb{B}|  - |\mathbb{A} \cap \mathbb{C}| - |\mathbb{B} \cap \mathbb{C}| + |\mathbb{A} \cap \mathbb{B} \cap \mathbb{C}| \le n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathbb">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚à™</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚à™</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">C</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathbb">A</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathbb">B</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathbb">C</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathbb">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚à©</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">B</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathbb">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚à©</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">C</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathbb">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚à©</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">C</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathbb">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚à©</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚à©</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">C</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></p>
<p>ÁßªÈ°πÂæó</p>
<p>‰∏∫‰∫ÜÊñπ‰æøÔºöËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mi mathvariant="double-struck">A</mi><mo>‚à©</mo><mi mathvariant="double-struck">B</mi><mo>‚à©</mo><mi mathvariant="double-struck">C</mi></mrow><annotation encoding="application/x-tex">S = \mathbb{A} \cap \mathbb{B} \cap \mathbb{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚à©</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚à©</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">C</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">(</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">A</mi><mo>‚à©</mo><mi mathvariant="double-struck">B</mi><mi mathvariant="normal">‚à£</mi><mo>‚àí</mo><mi mathvariant="normal">‚à£</mi><mi>S</mi><mi mathvariant="normal">‚à£</mi><mo fence="true">)</mo></mrow><mo>+</mo><mrow><mo fence="true">(</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">A</mi><mo>‚à©</mo><mi mathvariant="double-struck">C</mi><mi mathvariant="normal">‚à£</mi><mo>‚àí</mo><mi mathvariant="normal">‚à£</mi><mi>S</mi><mi mathvariant="normal">‚à£</mi><mo fence="true">)</mo></mrow><mo>+</mo><mrow><mo fence="true">(</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">B</mi><mo>‚à©</mo><mi mathvariant="double-struck">C</mi><mi mathvariant="normal">‚à£</mi><mo>‚àí</mo><mi mathvariant="normal">‚à£</mi><mi>S</mi><mi mathvariant="normal">‚à£</mi><mo fence="true">)</mo></mrow><mo>‚â•</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">A</mi><mi mathvariant="normal">‚à£</mi><mo>+</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">B</mi><mi mathvariant="normal">‚à£</mi><mo>+</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">C</mi><mi mathvariant="normal">‚à£</mi><mo>+</mo><mi mathvariant="normal">‚à£</mi><mi>S</mi><mi mathvariant="normal">‚à£</mi><mo>‚àí</mo><mi>n</mi><mo>‚àí</mo><mn>3</mn><mi mathvariant="normal">‚à£</mi><mi>S</mi><mi mathvariant="normal">‚à£</mi></mrow><annotation encoding="application/x-tex">\left(|\mathbb{A} \cap \mathbb{B}| - |S|\right) + \left(|\mathbb{A} \cap \mathbb{C}| - |S|\right) + \left(|\mathbb{B} \cap \mathbb{C}| - |S|\right) \ge |\mathbb{A}| + |\mathbb{B}| + |\mathbb{C}| + |S| - n - 3|S|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">‚à£</span><span class="mord mathbb">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚à©</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbb">B</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">‚à£</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">‚à£</span><span class="mord mathbb">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚à©</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbb">C</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">‚à£</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">‚à£</span><span class="mord mathbb">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚à©</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbb">C</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">‚à£</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â•</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathbb">A</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathbb">B</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathbb">C</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3‚à£</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">‚à£</span></span></span></span></p>
<p>Á≠îÊ°àÂèñÂÄº‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">A</mi><mi mathvariant="normal">‚à£</mi><mo>+</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">B</mi><mi mathvariant="normal">‚à£</mi><mo>+</mo><mi mathvariant="normal">‚à£</mi><mi mathvariant="double-struck">C</mi><mi mathvariant="normal">‚à£</mi><mo>‚àí</mo><mn>2</mn><mi mathvariant="normal">‚à£</mi><mi>S</mi><mi mathvariant="normal">‚à£</mi><mo>‚àí</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">|\mathbb{A}| + |\mathbb{B}| + |\mathbb{C}| -2|S| - n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathbb">A</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathbb">B</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathbb">C</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2‚à£</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ÔºåÂÖ∂‰∏≠
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">‚à£</mi><mi>S</mi><mi mathvariant="normal">‚à£</mi></mrow><annotation encoding="application/x-tex">|S|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">‚à£</span></span></span></span>
Ë∂äÂ§ß Á≠îÊ°àË∂äÂ∞èÔºåÂÖ∂ÊúÄÂ§ßÂèñÂÄºÂ∞±ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>‚Å°</mo><mrow><mo stretchy="false">{</mo><mi mathvariant="double-struck">A</mi><mo separator="true">,</mo><mi mathvariant="double-struck">B</mi><mo separator="true">,</mo><mi mathvariant="double-struck">C</mi><mo stretchy="false">}</mo></mrow></mrow><annotation encoding="application/x-tex">\max{ \{ \mathbb{A}, \mathbb{B}, \mathbb{C} \} }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">{</span><span class="mord mathbb">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbb">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbb">C</span><span class="mclose">}</span></span></span></span></span></p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>LL n<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> c<span class="op">;</span> Read<span class="op">(</span>n<span class="op">)(</span>a<span class="op">)(</span>b<span class="op">)(</span>c<span class="op">);</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld</span><span class="st">&quot;</span><span class="op">,</span> max<span class="op">(</span><span class="dv">0</span><span class="bu">LL</span><span class="op">,</span> a <span class="op">+</span> b <span class="op">+</span> c <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> min<span class="op">(</span>a<span class="op">,</span> min<span class="op">(</span>b<span class="op">,</span> c<span class="op">))</span> <span class="op">-</span> n<span class="op">));</span></span></code></pre></div>
<h3 id="b.-ddlÈÄâÊâã">B. DDLÈÄâÊâã</h3>
<p>DDLÈÄâÊâãÊÄªÊòØÂú®ÊúÄÂêéÂÅö‰Ωú‰∏ö„ÄÇ</p>
<p>Êúâ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>‰∏™‰Ωú‰∏öÔºåÁ¨¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>‰∏™‰Ωú‰∏öÁöÑDDLÊó∂Èó¥ÊòØ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ÔºåÂÅöËøô‰∏™‰Ωú‰∏öÈúÄË¶Å<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ÁöÑÊó∂Èó¥„ÄÇ</p>
<p>ÂÅö‰Ωú‰∏öË¶Å‰∏ÄÂøÉ‰∏ÄÊÑèÔºåÊâÄ‰ª•‰∏çËÉΩÂêåÊó∂ÂÅö‰∏§‰∏™‰Ωú‰∏ö„ÄÇÂ¶ÇÊûúÁé∞Âú®ÂºÄÂßãÂÅöÁ¨¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>‰∏™‰Ωú‰∏öÔºåÈÇ£‰πàÊé•‰∏ãÊù•<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ÁöÑÊó∂Èó¥ÈÉΩË¶ÅÂÅöËøô‰∏™‰Ωú‰∏öÔºå‰∏çËÉΩÂÅöÂà´ÁöÑ„ÄÇ</p>
<p>DDLÈÄâÊâãÊÄªÊòØÂÖàÂÅöDDLÊó∂Èó¥Êó©ÁöÑ‰Ωú‰∏ö„ÄÇÂ¶ÇÊûú‰∏§‰∏™‰Ωú‰∏öÁöÑDDLÊó∂Èó¥‰∏ÄÊ†∑ÔºåÈÇ£‰πàDDLÈÄâÊâã‰ºöÂÖàÂÅöÂÖ∂‰∏≠ÁºñÂè∑Â∞èÁöÑ</p>
<p>‰∏∫DDLÈÄâÊâãËÆæËÆ°ÊØè‰∏™‰Ωú‰∏öÂºÄÂßãÂÅöÁöÑÊó∂Èó¥Ôºå‰ΩøÂæóDDLÈÄâÊâãÂÖàÂÅöDDLÊó©ÁöÑ‰Ωú‰∏öÔºàÂ¶ÇÊûú‰∏§‰∏™‰Ωú‰∏öÁöÑDDLÊó∂Èó¥‰∏ÄÊ†∑ÔºåÈÇ£‰πàÂÖàÂÅöÂÖ∂‰∏≠ÁºñÂè∑Â∞èÁöÑÔºâÔºåËÄå‰∏îÊØè‰∏™‰Ωú‰∏öÈÉΩËÉΩÂú®DDLÊó∂Èó¥‰πãÂâçÂÅöÂÆåÔºàÊó∂Èó¥ÊòØËøûÁª≠ÁöÑÔºå‚Äú‰πãÂâç‚ÄùÁöÑÊÑèÊÄùÊòØÔºåÊúÄÊôöÊÅ∞Â•ΩËøô‰∏™Êó∂Èó¥ÂÆåÊàê„ÄÇÔºâ„ÄÇÂú®‰øùËØÅÂÆåÊàêÁöÑÂâçÊèê‰∏ãÔºåÂ∞ΩÂèØËÉΩÊääÂºÄÂßãÂÅö‰Ωú‰∏öÁöÑÊó∂Èó¥ÂæÄÂêéÊé®„ÄÇÔºà‰πüÂ∞±ÊòØÂ¶ÇÊûúÊúâÂ§ö‰∏™ÊñπÊ°àÂèØ‰ª•ÂÅöÂÆå‰Ωú‰∏öÔºåÈÄâÊã©ÂºÄÂßãÊó∂Èó¥ÊúÄÊôöÁöÑÊñπÊ°à„ÄÇÂèØ‰ª•ËØÅÊòéÔºåÊúÄ‰ºòÊñπÊ°à‰∏≠ÔºåÊØè‰∏Ä‰∏™‰Ωú‰∏öÁöÑÂºÄÂßãÊó∂Èó¥ÈÉΩ‰∏çÊó©‰∫éÂÖ∂‰ªñÊñπÊ°àÁöÑÂºÄÂßãÊó∂Èó¥„ÄÇËæìÂá∫Ëøô‰∏™ÊúÄ‰ºòÊñπÊ°à„ÄÇÔºâ</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup><mo separator="true">,</mo><msub><mi>t</mi><mi>i</mi></msub><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">n \le 10^5, t_i \le 10^4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></p>
<p>‰æùÁÖßÈ¢òÊÑèÂèçÂêëÊ®°Êãü„ÄÇ</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">2e5</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define int </span><span class="dt">long</span><span class="pp"> </span><span class="dt">long</span><span class="pp"> </span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> <span class="dt">HomeWork_t</span><span class="op">{</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> d<span class="op">,</span> t<span class="op">,</span> id<span class="op">;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>H<span class="op">[</span>_<span class="op">];</span> <span class="dt">int</span> n <span class="op">;</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> Ans<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> CMP<span class="op">(</span><span class="at">const</span> <span class="dt">HomeWork_t</span> <span class="op">&amp;</span> A<span class="op">,</span> <span class="at">const</span> <span class="dt">HomeWork_t</span> <span class="op">&amp;</span> B<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">(</span>A<span class="op">.</span>d <span class="op">&lt;</span> B<span class="op">.</span>d<span class="op">)</span> <span class="op">||</span> <span class="op">(</span>A<span class="op">.</span>d <span class="op">==</span> B<span class="op">.</span>d <span class="op">&amp;&amp;</span> A<span class="op">.</span>id <span class="op">&lt;</span> B<span class="op">.</span>id<span class="op">);</span> <span class="op">}</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#undef int </span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">);</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> Read<span class="op">(</span>H<span class="op">[</span>i<span class="op">].</span>d<span class="op">)(</span>H<span class="op">[</span>i<span class="op">].</span>t<span class="op">),</span> H<span class="op">[</span>i<span class="op">].</span>id <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>H <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> H <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> n<span class="op">,</span> CMP<span class="op">);</span> </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define int </span><span class="dt">long</span><span class="pp"> </span><span class="dt">long</span><span class="pp"> </span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> Last <span class="op">=</span> LLONG_MAX<span class="op">;</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n<span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">1</span><span class="op">;</span> i<span class="op">--){</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>Last <span class="op">&gt;=</span> H<span class="op">[</span>i<span class="op">].</span>d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>            Last <span class="op">=</span> H<span class="op">[</span>i<span class="op">].</span>d <span class="op">-</span> H<span class="op">[</span>i<span class="op">].</span>t<span class="op">;</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>            Ans<span class="op">[</span>H<span class="op">[</span>i<span class="op">].</span>id<span class="op">]</span> <span class="op">=</span> Last<span class="op">;</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>            Last <span class="op">=</span> <span class="op">(</span>Last<span class="op">)</span> <span class="op">-</span> H<span class="op">[</span>i<span class="op">].</span>t<span class="op">;</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>            Ans<span class="op">[</span>H<span class="op">[</span>i<span class="op">].</span>id<span class="op">]</span> <span class="op">=</span> Last<span class="op">;</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> Ans<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#undef int</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="c.-Á∫¶Êï∞Èìæ">C. Á∫¶Êï∞Èìæ</h3>
<p>Â¶ÇÊûú<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>‰∏™Êï∞<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>‚Ä¶</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">a_1,\dots,a_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">‚Ä¶</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>Êª°Ë∂≥ÔºöÂØπ‰∫é<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚â§</mo><mi>i</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1\leq i &lt; n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6986em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>Ôºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ÊòØ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">a_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>ÁöÑÁ∫¶Êï∞ÔºåÈÇ£‰πà<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>‚Ä¶</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">a_1,\dots,a_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">‚Ä¶</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>Ë¢´Áß∞‰∏∫‰∏Ä‰∏™Á∫¶Êï∞Èìæ„ÄÇ‰∏Ä‰∏™Á∫¶Êï∞ÈìæÁöÑÊùÉÂÄºÊòØÂÆÉÊâÄÂåÖÂê´ÁöÑ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>‰∏™Êï∞ÁöÑ‰πòÁßØ„ÄÇ</p>
<p>ÁªôÂá∫<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n,m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span></span></span></span>ÔºåÂè™ÂÖÅËÆ∏‰ΩøÁî®‰∏çË∂ÖËøá<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>ÁöÑÊ≠£Êï¥Êï∞ÁªÑÊàêÈïø‰∏∫<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ÁöÑÁ∫¶Êï∞ÈìæÔºå‰ºöÊúâÈùûÂ∏∏Â§öÁöÑÊñπÂºè„ÄÇÊ±ÇÊâÄÊúâËøô‰∫õÊñπÂºèÂæóÂà∞ÁöÑÁ∫¶Êï∞ÈìæÁöÑÊùÉÂÄº‰πãÂíå„ÄÇ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚â§</mo><mn>10</mn><mo separator="true">,</mo><mi>m</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>7</mn></msup></mrow><annotation encoding="application/x-tex">n \le 10, m \le 10^7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span></span></span></span></p>
<p>ÂèØ‰ª• <strong>dp</strong> ‰∏Ä‰∏ãÔºåËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[n][k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span>
‰∏∫ÈïøÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÁ∫¶Êï∞ÈìæÔºåÁªìÂ∞æÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÁöÑÊùÉÂÄºÂíå„ÄÇ ËΩ¨Áßª‰∏∫Âà∑Ë°®„ÄÇÂ§çÊùÇÂ∫¶ÂÅöÂà∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>m</mi><mi>log</mi><mo>‚Å°</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(nm\log m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">nm</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>„ÄÇÊ†πÊú¨Ëøá‰∏çÂéª„ÄÇ</p>
<p>ËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">f_n(k) = dp[n][k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span>
ÂÖ∂‰∏≠ ÂáΩÊï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_k(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>
‰∏∫ÁßØÊÄßÂáΩÊï∞„ÄÇ</p>
<p>ÂØπ‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>‚ä•</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a \perp b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚ä•</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>
ËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><mi>a</mi><mo>√ó</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">c = a \times b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>
ÂØπ‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_n(c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span>
ÊâÄÁªüËÆ°ÁöÑÊñπÊ°à‰∏≠ÁöÑÊØè‰∏Ä‰∏™Êï∞Â≠óÈÉΩÂèØ‰ª•Ë¥®Âõ†Êï∞ÂàÜËß£Êàê‰∏§ÁªÑÔºå‰∏ÄÁªÑÊòØÂè™Â±û‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>
ÁöÑË¥®Âõ†Â≠êÔºåÂè¶‰∏ÄÁªÑÊòØÂè™Â±û‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>
ÁöÑË¥®Âõ†Â≠ê„ÄÇÊâã‰∏æÂá†‰∏™Ê†óÂ≠êÂ∞±ËÉΩÂèëÁé∞Á¨¶ÂêàÁßØÊÄßÂáΩÊï∞ÁöÑÊÄßË¥®„ÄÇ</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">1e7</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MOD <span class="op">=</span> <span class="fl">1e9</span> <span class="op">+</span> <span class="dv">7</span><span class="op">;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> np<span class="op">[</span>_<span class="op">],</span> prime<span class="op">[</span><span class="dt">int</span><span class="op">(</span><span class="fl">1e6</span><span class="op">)],</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> Mid<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> Init<span class="op">(</span><span class="dt">int</span> n<span class="op">){</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    Mid<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> np<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>np<span class="op">[</span>i<span class="op">])</span> prime<span class="op">[++</span>tot<span class="op">]</span> <span class="op">=</span> i<span class="op">,</span> Mid<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> tot <span class="op">&amp;&amp;</span> prime<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> i <span class="op">&lt;=</span> n<span class="op">;</span> j<span class="op">++){</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> x <span class="op">=</span> prime<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> i<span class="op">;</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>            np<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> Mid<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> prime<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>i <span class="op">%</span> prime<span class="op">[</span>j<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> m<span class="op">;</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dp<span class="op">[</span><span class="dt">int</span><span class="op">(</span><span class="dv">20</span><span class="op">)][</span><span class="dt">int</span><span class="op">(</span><span class="dv">30</span><span class="op">)];</span> <span class="dt">int</span> Ans<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> t <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span> <span class="co">//freopen(&quot;in.txt&quot;, &quot;r&quot;, stdin);</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    Init<span class="op">(</span><span class="fl">1e7</span> <span class="op">+</span> <span class="dv">2</span><span class="op">);</span> Read<span class="op">(</span>n<span class="op">)(</span>m<span class="op">);</span> </span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>S<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> tot<span class="op">){</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> now <span class="op">=</span> prime<span class="op">[</span>S<span class="op">];</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>        memset<span class="op">(</span>dp<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>dp<span class="op">));</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> t <span class="op">&lt;=</span> m<span class="op">;</span> j<span class="op">++,</span> t <span class="op">*=</span> now<span class="op">)</span> dp<span class="op">[</span><span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> n<span class="op">){</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>            t <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> t <span class="op">&lt;=</span> m<span class="op">;</span> j<span class="op">++,</span> t <span class="op">*=</span> now<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> <span class="op">&amp;</span>ans <span class="op">=</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>                rep<span class="op">(</span>k<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> j<span class="op">)</span> ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> dp<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>k<span class="op">]</span> <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> t <span class="op">%</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> t <span class="op">&lt;=</span> m<span class="op">;</span> j<span class="op">++,</span> t <span class="op">*=</span> now<span class="op">)</span> Ans<span class="op">[</span>t<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>n<span class="op">][</span>j<span class="op">];</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    Ans<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> m<span class="op">){</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>Ans<span class="op">[</span>i<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> A <span class="op">=</span> i<span class="op">,</span> B <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(</span>A <span class="op">%</span> Mid<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> A <span class="op">/=</span> Mid<span class="op">[</span>i<span class="op">],</span> B <span class="op">*=</span> Mid<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>        Ans<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>Ans<span class="op">[</span>A<span class="op">]</span> <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> Ans<span class="op">[</span>B<span class="op">])</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> m<span class="op">)</span> ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> Ans<span class="op">[</span>i<span class="op">])</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="d.-ËøûÈÄö">D. ËøûÈÄö</h3>
<p>ÁªôÂá∫‰∏ÄÂº†Êó†ÂêëÂõæÔºåÊ±ÇÊúâÂ§öÂ∞ëÁßçÊñπÊ°à‰ΩøÂæóÂà†Èô§‰∏âÊù°ËæπÔºå‰ΩøÂéüÂõæ‰∏çËøûÈÄö„ÄÇ</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo>‚â§</mo><mn>2000</mn></mrow><annotation encoding="application/x-tex">n,m \le 2000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2000</span></span></span></span></p>
<p>ËÄÉËôëÊûö‰∏æÂà†Èô§ÁöÑÁ¨¨‰∏ÄÊù°ËæπÊòØÈÇ£Êù°ÔºåÁÑ∂ÂêéÈóÆÈ¢òËΩ¨ÂåñÊàê‰∫Ü
Ê±ÇÂú®‰∏ÄÂº†Âõæ‰∏≠Âà†Èô§‰∏§Êù°Ëæπ‰ΩøÂõæ‰∏çËøûÈÄöÁöÑÊñπÊ°àÊï∞„ÄÇ
ÂÖàÂà†Âéª‰∏ÄÊù°ËæπÔºåËÄÉËôëÂâ©‰∏ãÁöÑÂõæÁöÑÂΩ¢ÊÄÅÔºå -
ÂõæÂ∑≤Áªè‰∏çËøûÈÄö‰∫ÜÔºåÈÇ£Á≠îÊ°àÁöÑË¥°ÁåÆÂ∞±ÊòØÊØèÊù°Ëæπ‰∏§‰∏§ÈÖçÂØπÁöÑÊñπÊ°àÊï∞ -
ÂõæÊòØËÅîÈÄöÁöÑÔºåËÄÉËôëÂØπÂõæÂª∫‰∏Ä‰∏™ÁîüÊàêÊ†ëÔºåËÄÉËôëÂà†ËæπÁöÑÊñπÂºè - Âà†Èô§‰∏§Êù°ÈùûÊ†ëËæπ
‰∏ÄÂÆö‰∏çÂêàÊ≥ïÔºå‰πãÂâçÁöÑÊ†ë‰ªçÁÑ∂Â≠òÂú®Ôºå‰øùËØÅ‰∫ÜÂõæÁöÑËøûÈÄöÊÄß„ÄÇ -
Âà†Èô§‰∏ÄÊù°Ê†ëËæπÔºå‰∏ÄÊù°ÈùûÊ†ëËæπ
Ë¢´ËÆ°ÂÖ•Á≠îÊ°àÔºåÂΩì‰∏î‰ªÖÂΩìÔºåËøôÊù°Ê†ëËæπË¢´ËøôÊù°ÈùûÊ†ëËæπÂîØ‰∏ÄË¶ÜÁõñ„ÄÇËøôÈáåÁöÑÊ≠£Á°ÆÊÄßÊòæÁÑ∂„ÄÇ -
Âà†Èô§‰∏§Êù°ÈùûÊ†ëËæπ Ë¢´ËÆ°ÂÖ•Á≠îÊ°àÔºåÂΩì‰∏î‰ªÖÂΩìÔºåËøô‰∏§Êù°ËæπË¢´Áõ∏ÂêåÁöÑ‰∏ÄÁªÑÈùûÊ†ëËæπË¶ÜÁõñ„ÄÇ -
ËØÅÊòéÂèØ‰ª•ËÄÉËôëÔºåÂØπ‰∫éÂéüÊ†ëÊù•ËØ¥ÔºåÂ¶ÇÊûúÂà†Èô§‰∏§Êù°Ê†ëËæπÔºåÊñ≠Êàê‰∏â‰ªΩÔºåÂ¶ÇÊûú‰∏§Êù°ËæπË¢´Áõ∏ÂêåÁöÑ‰∏ÄÁªÑÈùûÊ†ëËæπË¶ÜÁõñÔºåÊ≤°ÊúâËæπÂèØ‰ª•ËÅîÈÄöÊñ≠ÂºÄÁöÑ‰∏≠Èó¥ÈÉ®ÂàÜ„ÄÇ
-
ËÄÉËôëÂ¶Ç‰ΩïÂÆûÁé∞ÔºåÂØπÊØè‰∏ÄÊù°ÈùûÊ†ëËæπËµã‰∏Ä‰∏™ÈöèÊú∫ÊùÉÂÄºÔºåÁÑ∂ÂêéÊ†ëËæπÁöÑÊùÉÂÄºÂÆö‰πâ‰∏∫Ë¶ÜÁõñÂÖ∂ÁöÑÊØè‰∏ÄÊù°ÈùûÊ†ëËæπÁöÑÊùÉÂÄºÂºÇÊàñÂíå„ÄÇÁªüËÆ°Âà†Èô§‰∏§Êù°ËæπÂêéÂõæ‰∏çËÅîÈÄöÁöÑÊñπÊ°àÊï∞ÔºåÂ∞±ËΩ¨Âåñ‰∏∫ÔºåÁªüËÆ°ÊúâÂ§öÂ∞ëÁßçÊñπÊ°àÈÄâÂá∫‰∏§Êù°ËæπÔºå‰ΩøÂÖ∂ÊùÉÂÄºÁõ∏Âêå„ÄÇ
Ê†ë‰∏äÂ∑ÆÂàÜÂç≥ÂèØÔºåÂºÇÊàñÊúâËá™ÂèçÊÄßÔºåÂÖ∂Ê†áËÆ∞Âú® LCA Â§ÑËá™Âä®Ê∂àÂ§±„ÄÇ</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="dv">4100</span><span class="op">;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> head<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> edges<span class="op">{</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> node<span class="op">;</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> nxt<span class="op">;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>edge<span class="op">[</span>_<span class="op">];</span> <span class="dt">int</span> tot <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MOD <span class="op">=</span> <span class="fl">1e9</span> <span class="op">+</span> <span class="dv">7</span><span class="op">;</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> m<span class="op">;</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ToEid<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ToNid<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> book<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>u64 tag<span class="op">[</span><span class="dt">int</span><span class="op">(</span><span class="dv">2100</span><span class="op">)];</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> vis<span class="op">[</span><span class="dt">int</span><span class="op">(</span><span class="dv">2100</span><span class="op">)];</span> </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>u64 EVal<span class="op">[</span><span class="dt">int</span><span class="op">(</span><span class="dv">2100</span><span class="op">)];</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> add<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> v<span class="op">){</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    tot<span class="op">++;</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    edge<span class="op">[</span>tot<span class="op">].</span>node <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    edge<span class="op">[</span>tot<span class="op">].</span>nxt  <span class="op">=</span> head<span class="op">[</span>u<span class="op">];</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    head<span class="op">[</span>u<span class="op">]</span>        <span class="op">=</span> tot<span class="op">;</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>u64 gen<span class="op">(){</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    u64 A <span class="op">=</span> rand<span class="op">()</span> <span class="op">*</span><span class="dv">1</span><span class="bu">ull</span><span class="op">*</span> rand<span class="op">()</span> <span class="op">*</span> rand<span class="op">()</span> <span class="op">*</span><span class="dv">1</span><span class="bu">ull</span><span class="op">*</span> rand<span class="op">();</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    u64 B <span class="op">=</span> rand<span class="op">()</span> <span class="op">*</span><span class="dv">1</span><span class="bu">ull</span><span class="op">*</span> rand<span class="op">()</span> <span class="op">*</span> rand<span class="op">()</span> <span class="op">*</span><span class="dv">1</span><span class="bu">ull</span><span class="op">*</span> rand<span class="op">();</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> A <span class="op">+</span> B <span class="op">+</span> rand<span class="op">();</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs0<span class="op">(</span><span class="dt">int</span> now<span class="op">,</span> <span class="dt">int</span> f<span class="op">){</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    vis<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span> i <span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span> <span class="cf">if</span><span class="op">(</span>ex <span class="op">==</span> f<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span> <span class="cf">if</span><span class="op">(</span>book<span class="op">[</span>i<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>vis<span class="op">[</span>ex<span class="op">])</span> dfs0<span class="op">(</span>ex<span class="op">,</span> now<span class="op">);</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span> </span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span> EVal<span class="op">[</span>ToNid<span class="op">[</span>i<span class="op">]])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>            u64 g <span class="op">=</span> EVal<span class="op">[</span>ToNid<span class="op">[</span>i<span class="op">]]</span> <span class="op">=</span> gen<span class="op">();</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>            tag<span class="op">[</span>now<span class="op">]</span> <span class="op">^=</span> g<span class="op">;</span> tag<span class="op">[</span>ex<span class="op">]</span> <span class="op">^=</span> g<span class="op">;</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs1<span class="op">(</span><span class="dt">int</span> now<span class="op">,</span> <span class="dt">int</span> f<span class="op">){</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>    u64 <span class="op">&amp;</span>ntag <span class="op">=</span> tag<span class="op">[</span>now<span class="op">];</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span> i <span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span> <span class="cf">if</span><span class="op">(</span>ex <span class="op">==</span> f<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span> <span class="cf">if</span><span class="op">(</span>book<span class="op">[</span>i<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>EVal<span class="op">[</span>ToNid<span class="op">[</span>i<span class="op">]])</span> dfs1<span class="op">(</span>ex<span class="op">,</span> now<span class="op">),</span> EVal<span class="op">[</span>ToNid<span class="op">[</span>i<span class="op">]]</span> <span class="op">=</span> tag<span class="op">[</span>ex<span class="op">],</span> ntag <span class="op">^=</span> tag<span class="op">[</span>ex<span class="op">];</span> </span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>map<span class="op">&lt;</span>u64<span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> M<span class="op">;</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> inv6 <span class="op">=</span> <span class="dv">166666668</span><span class="op">;</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span><span class="co">// freopen(&quot;in.txt&quot;, &quot;r&quot;, stdin);</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">)(</span>m<span class="op">);</span> <span class="dt">int</span> <span class="op">*</span>seed <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">;</span> srand<span class="op">(*</span>seed <span class="op">+</span> n <span class="op">+</span> m<span class="op">);</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> m<span class="op">){</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u<span class="op">,</span> v<span class="op">;</span> Read<span class="op">(</span>u<span class="op">)(</span>v<span class="op">);</span></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>        ToEid<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> tot <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> ToNid<span class="op">[</span>tot <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> ToNid<span class="op">[</span>tot <span class="op">+</span> <span class="dv">2</span><span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>        add<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span> add<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> Pans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> m<span class="op">){</span> </span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> rs <span class="op">=</span> ToEid<span class="op">[</span>i<span class="op">];</span> </span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>        book<span class="op">[</span>rs<span class="op">]</span> <span class="op">=</span> book<span class="op">[</span>rs <span class="op">^</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>        memset<span class="op">(</span>tag<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>tag<span class="op">));</span> memset<span class="op">(</span>vis<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>vis<span class="op">));</span> memset<span class="op">(</span>EVal<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>EVal<span class="op">));</span> M<span class="op">.</span>clear<span class="op">();</span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>        dfs0<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span> </span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> pass <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span>  <span class="cf">if</span><span class="op">(!</span>vis<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> pass <span class="op">=</span> <span class="kw">false</span><span class="op">;</span> <span class="cf">break</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>pass<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> t <span class="op">=</span> m <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> Pans <span class="op">=</span> <span class="op">(</span>Pans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> <span class="op">(</span>t <span class="op">*</span> <span class="op">(</span>t <span class="op">-</span> <span class="dv">1</span><span class="op">)))</span> <span class="op">%</span> MOD<span class="op">;</span> book<span class="op">[</span>rs<span class="op">]</span> <span class="op">=</span> book<span class="op">[</span>rs <span class="op">^</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">continue</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>        dfs1<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>        rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> m<span class="op">)</span> <span class="cf">if</span><span class="op">(</span>i <span class="op">!=</span> j<span class="op">)</span> M<span class="op">[</span>EVal<span class="op">[</span>j<span class="op">]]</span> <span class="op">++;</span></span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span>map<span class="op">&lt;</span>u64<span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> <span class="op">::</span> iterator i <span class="op">=</span> M<span class="op">.</span>begin<span class="op">();</span> i <span class="op">!=</span> M<span class="op">.</span>end<span class="op">();</span> i<span class="op">++){</span></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>i<span class="op">-&gt;</span>first <span class="op">==</span> <span class="dv">0</span><span class="bu">ull</span><span class="op">)</span></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>                ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> <span class="op">(</span>i<span class="op">-&gt;</span>second <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> <span class="op">(</span>i<span class="op">-&gt;</span>second <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">%</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">,</span></span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>                ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> <span class="op">(((</span>m <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span>i<span class="op">-&gt;</span>second<span class="op">))</span> <span class="op">*</span><span class="dv">2</span><span class="bu">ll</span><span class="op">*</span> <span class="op">(</span>i<span class="op">-&gt;</span>second<span class="op">))</span> <span class="op">%</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>                ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> <span class="op">(</span>i<span class="op">-&gt;</span>second <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> <span class="op">(</span>i<span class="op">-&gt;</span>second <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">%</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>        Pans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> Pans<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>        book<span class="op">[</span>rs<span class="op">]</span> <span class="op">=</span> book<span class="op">[</span>rs <span class="op">^</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="dt">int</span><span class="op">(</span>Pans <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> inv6 <span class="op">%</span> MOD<span class="op">));</span></span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="round-9">Round 9</h2>
<p>ÈôçÊô∫Âú∫„ÄÇ ### A. ÊúÄÂ§ßÂÖ¨Á∫¶Êï∞</p>
<p>ÁªôÂá∫‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÂ∫èÂàó„ÄÇ ËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><msub><mrow><mi>max</mi><mo>‚Å°</mo></mrow><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow></msub><mrow><mi mathvariant="normal">gcd</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">k = \max_{i &lt; j}{\operatorname{gcd}(A_i, A_j)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mop"><span class="mord mathrm">gcd</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>Ôºå
Ê±ÇÂá∫Ôºö -
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
-
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>‚àë</mo><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow></munder><mrow><mo stretchy="false">[</mo><mi mathvariant="normal">gcd</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">\sum_{i &lt; j}\limits{[\operatorname{gcd}(A_i, A_j)=k]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8638em;vertical-align:-1.1138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">‚àë</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.1138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">[</span><span class="mop"><span class="mord mathrm">gcd</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span></span>
-
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>‚àë</mo><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow></munder><mrow><mo stretchy="false">[</mo><mi mathvariant="normal">gcd</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi><mo stretchy="false">]</mo><msub><mi>A</mi><mi>i</mi></msub><mo>√ó</mo><msub><mi>A</mi><mi>j</mi></msub></mrow></mrow><annotation encoding="application/x-tex">\sum_{i &lt; j}\limits{[\operatorname{gcd}(A_i, A_j)=k]A_i \times A_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8638em;vertical-align:-1.1138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">‚àë</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.1138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">[</span><span class="mop"><span class="mord mathrm">gcd</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>Êûö‰∏æ‰∏Ä‰∏ã
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">gcd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span></span></span></span>
ÂèØËÉΩ‰ª•Ëøô‰∏™Êï∞Â≠ó‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">gcd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span></span></span></span>
ÁöÑ‰∏§‰∏™Êï∞Â≠ó‰∏ÄÂÆöÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">gcd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span></span></span></span>
ÁöÑÂÄçÊï∞„ÄÇ ‰ªéÂ§ßÂà∞Â∞èÊûö‰∏æ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">gcd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span></span></span></span>
Êü•ËØ¢ÊúâÂ§öÂ∞ëÂÄçÊï∞ÔºåÂ¶ÇÊûúÂ§ß‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>
ÔºåËøô‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">gcd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span></span></span></span>
Â∞±ÂèØ‰ª•„ÄÇ Ââ©‰ΩôÁöÑ‰∏§È°πÂú®ÂæóÂà∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÁöÑÂü∫Á°Ä‰∏äÂà§Êñ≠Âç≥ÂèØ„ÄÇ</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MOD <span class="op">=</span> <span class="dv">998244353</span><span class="op">;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">2e6</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> inv2 <span class="op">=</span> <span class="dv">499122177</span><span class="op">;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> book<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> A<span class="op">[</span>_<span class="op">],</span> n<span class="op">,</span> MAX <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> K <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">);</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> Read<span class="op">(</span>A<span class="op">[</span>i<span class="op">]),</span> book<span class="op">[</span>A<span class="op">[</span>i<span class="op">]]++,</span> MAX <span class="op">=</span> max<span class="op">(</span>MAX<span class="op">,</span> A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> MAX<span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">1</span><span class="op">;</span> i<span class="op">--){</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> cnt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i<span class="op">;</span> j <span class="op">&lt;=</span> MAX<span class="op">;</span> j <span class="op">+=</span> i<span class="op">)</span> cnt <span class="op">+=</span> book<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>cnt <span class="op">&gt;=</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span> K <span class="op">=</span> i<span class="op">;</span> <span class="cf">break</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> SUM <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> ans1 <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> ans2 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> K<span class="op">;</span> i <span class="op">&lt;=</span> MAX<span class="op">;</span> i <span class="op">+=</span> K<span class="op">){</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>book<span class="op">[</span>i<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>        ans1 <span class="op">+=</span> book<span class="op">[</span>i<span class="op">];</span> SUM <span class="op">=</span> <span class="op">(</span>SUM <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> book<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> i <span class="op">%</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    ans1 <span class="op">=</span> <span class="op">((</span>ans1 <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> <span class="op">(</span>ans1 <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">%</span> MOD <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> inv2<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> K<span class="op">;</span> i <span class="op">&lt;=</span> MAX<span class="op">;</span> i <span class="op">+=</span> K<span class="op">){</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>book<span class="op">[</span>i<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>        ans2 <span class="op">=</span> <span class="op">(</span>ans2 <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> <span class="op">(</span> <span class="op">(</span>SUM <span class="op">-</span><span class="dv">0</span><span class="bu">ll</span><span class="op">-</span> i <span class="op">+</span> MOD<span class="op">)</span> <span class="op">%</span> MOD <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> i <span class="op">%</span> MOD <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> book<span class="op">[</span>i<span class="op">])</span> <span class="op">%</span> MOD <span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st"> </span><span class="sc">%d</span><span class="st"> </span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> K<span class="op">,</span> ans1<span class="op">,</span> ans2 <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> inv2 <span class="op">%</span> MOD<span class="op">);</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="b.-Á¥ßÊÄ•Âá∫Âè£">B. Á¥ßÊÄ•Âá∫Âè£</h3>
<p>Âú®‰∏Ä‰∏™Ëµ∞ÂªäÈáåÂÖ±Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>
‰∏™Ê•ºÊ¢ØÔºåÂÖ∂‰∏≠
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>
‰∏™Ê•ºÊ¢Ø‰πãÈó¥Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>
‰∏™Èó¥ÈöîÔºå ‰∏™Èó¥Èöî‰ºöË¥¥Êúâ‰∏Ä‰∏™Á¥ßÊÄ•Âá∫Âè£ÁöÑÊåáÁ§∫ÁâåÊåáÂêëÂ∑¶‰æßÊàñËÄÖÂè≥‰æß„ÄÇ</p>
<p>ÈóÆÂú®ÊâÄÊúâÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>N</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2N‚àí1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>
ÁßçÊåáÁ§∫ÁâåÁöÑË¥¥Ê≥ïÂΩì‰∏≠ÔºåÊúâÂ§öÂ∞ëÁßçË¥¥Ê≥ïÊª°Ë∂≥ÊÅ∞Â•ΩÊúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>
‰∏™Ê•ºÊ¢Ø(ÂåÖÊã¨ÊúÄÂ∑¶ÊúÄÂè≥)ÁöÑÂ∑¶Âè≥‰æßÁöÑÁ¥ßÊÄ•Âá∫Âè£Ê†áËØÜÈÉΩ‰∏çÊåáÂêëËá™Â∑±„ÄÇ</p>
<p>ËæìÂá∫ÁöÑÁ≠îÊ°àÂØπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>998244353</mn></mrow><annotation encoding="application/x-tex">998244353</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">998244353</span></span></span></span>
ÂèñÊ®°„ÄÇ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>3</mn></msup><mo separator="true">,</mo><mi>M</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding="application/x-tex">N \le 10^3, M \le 10^9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span></p>
<h4 id="ÂÄçÂ¢ûdp">ÂÄçÂ¢ûDP</h4>
<p>ÂæÖÂ°´</p>
<h4 id="ÈöîÊùøÊ≥ï">ÈöîÊùøÊ≥ï</h4>
<p>Áß∞ ‚ÄúÂ∑¶Âè≥‰æßÁöÑÁ¥ßÊÄ•Âá∫Âè£Ê†áËØÜÈÉΩ‰∏çÊåáÂêëËá™Â∑±ÁöÑÁÇπ‚Äù ‰∏∫ÂÖ≥ÈîÆÁÇπ„ÄÇ</p>
<p>ËÄÉËôëÂ¶ÇÊûúÈÄâÂÆö‰∫Ü‰∏Ä‰∏™ÁÇπÊòØÂÖ≥ÈîÆÁÇπÔºåÈÇ£‰πà‰ªñ‰ª¨‰∏§ËæπÂ∞±ÂΩ¢Â¶Ç
<code>&lt; o &gt;</code> ÔºåÂèØ‰ª•ÂèëÁé∞Áõ∏ÈÇªÁöÑ‰∏§‰∏™ÂÖ≥ÈîÆÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>O</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">O_1, O_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
‰πãÈó¥Ë¥¥ÁâåÁöÑÊñπÊ°à‰∏ÄÂÆöÂΩ¢Â¶Ç
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>&lt;</mo><msub><mi>O</mi><mn>1</mn></msub><mo>&gt;</mo><mi>o</mi><mo>&gt;</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>&gt;</mo><mi>o</mi><mo>&lt;</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>&lt;</mo><mi>o</mi><mo>&lt;</mo><msub><mi>O</mi><mn>2</mn></msub><mo>&gt;</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">...&lt; O_1 &gt; o &gt; ... &gt; o &lt; ... &lt; o &lt; O_2 &gt;...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">o</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">o</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">o</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.1056em;"></span><span class="mord">...</span></span></span></span>
ÊòæÁÑ∂ÔºåÂÖ∂ÂÆûÊòØÊääÂéüÂ∫èÂàóÂàÜÊàêËøûÁª≠ÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>m</mi></mrow><annotation encoding="application/x-tex">2m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mord mathnormal">m</span></span></span></span>
ÊÆµÔºåÊØèÊÆµÂÜÖÊñπÂêëÁõ∏ÂêåÔºåÁõ∏ÈÇª‰∏§ÊÆµÊñπÂêëÁõ∏Âèç„ÄÇ ÈöîÊùøÂç≥ÂèØ„ÄÇ</p>
<p>ËÄÉËôëÁªÑÂêàÊï∞ÁöÑÈÄöÈ°πÂÖ¨ÂºèÔºåÈ°πÊï∞Âè™Êúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>
È°π„ÄÇ</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> m<span class="op">;</span> Read<span class="op">(</span>n<span class="op">)(</span>m<span class="op">);</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> C<span class="op">(</span>n<span class="op">,</span> <span class="dv">2</span> <span class="op">*</span> m <span class="op">-</span> <span class="dv">1</span><span class="op">));</span></span></code></pre></div>
<h3 id="c.-ÂêàÂΩ±">C. ÂêàÂΩ±</h3>
<p>‰ºóÊâÄÂë®Áü•Ôºå ACM ICPC ÊòØ‰∏â‰∫∫ÁªÑÈòüÂèÇËµõÁöÑÊØîËµõ„ÄÇÁé∞Âú®Âú® ICPC WF2020 Áé∞Âú∫ÔºåÊúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÊîØÂèÇËµõÈòü‰ºçË¶ÅÁ´ôÊàê‰∏ÄÊéíÊãçÁÖßÔºÅ</p>
<p>ÊëÑÂΩ±Â∏àÂ∞èZÊÉ≥‰øÉËøõÈòü‰ºçÈó¥ÁöÑ‰∫§ÊµÅÔºå‰∫éÊòØÂ∞èZË¶ÅÊ±ÇÊØè‰∏™Èòü‰ºçÁöÑ3‰∏™ÈòüÂëò‰∏çËÉΩÈÉΩÊå®Âú®‰∏ÄËµ∑</p>
<p>Áé∞Âú®Â∞èZÊÉ≥ÈóÆ‰∏ÄÈóÆ‰Ω†ÔºåËøô
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÊîØÈòü‰ºçÊúâÂ§öÂ∞ëÁßçÊãçÁÖßÊñπÂºèÂë¢ÔºüÁî±‰∫éÊï∞Â≠óÂæàÂ§ßÔºåÊâÄ‰ª•ÂØπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>998244353</mn></mrow><annotation encoding="application/x-tex">998244353</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">998244353</span></span></span></span>
ÂèñÊ®°Â∞±Â•Ω~
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">k \le 10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></p>
<p>Ë¶ÅÊ±ÇÊòØÊØè‰∏ÄÈòüÁöÑ‰∏â‰∏™ÈòüÂëò‰∏çËÉΩÂÖ®ÈÉ®Êå®Âú®‰∏ÄËµ∑„ÄÇ
Êó†Ê≥ïÁõ¥Êé•ÂÖ®ÈÉ®Êª°Ë∂≥ÔºåËÄÉËôëÂÆπÊñ•„ÄÇ</p>
<p>ÂÅáÂ¶ÇÊâÄÊúâ‰∫∫Êåâ‰ªªÊÑèÈ°∫Â∫èÊéíÂàóÊúâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>3</mn><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">(3k)!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)!</span></span></span></span>
ÁßçÊéíÂàóÊñπÂºè„ÄÇ</p>
<p>ÊòæÁÑ∂‰ºöÁÆóÂÖ•‰∫Ü‰∏çÂêàÊ≥ïÁöÑÊÉÖÂÜµÔºåËÄÉËôëÂéªÈô§Ëøô‰∫õ
Èí¶ÂÆöÂì™‰∏ÄÈòüÂÖ®ÈÉ®Êå®Âú®‰∏ÄËµ∑‰∫ÜÔºåÂ¶ÇÊûúÂº∫Âà∂Êüê‰∏ÄÈòüÊå®Âú®‰∏ÄËµ∑ÂèØ‰ª•ÂêßÈÇ£‰∏ÄÈòüÊçÜÊàê‰∏Ä‰∏™‰∫∫
ËøôÊ†∑ÁöÑÊñπÊ°àÊï∞‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>3</mn><mi>k</mi><mo>‚àí</mo><mn>2</mn><mo stretchy="false">)</mo><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">(3k - 2)!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)!</span></span></span></span>ÔºåÁÆóÂÖ•Á≠îÊ°àÂ∞±ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac linethickness="0px"><mi>k</mi><mn>1</mn></mfrac></mstyle><mo fence="true">)</mo></mrow><mo stretchy="false">(</mo><mn>3</mn><mi>k</mi><mo>‚àí</mo><mn>2</mn><mo stretchy="false">)</mo><mo stretchy="false">!</mo><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">!</mo><msup><mo stretchy="false">)</mo><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">\dbinom{k}{1}(3k - 2)!(3!)^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mopen">(</span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)!</span><span class="mopen">(</span><span class="mord">3</span><span class="mclose">!</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span>
ÊúÄÂêé‰∏Ä‰∏™ÊòØÂõ†‰∏∫Âêå‰∏ÄÈòü‰∏≠ÁöÑÈòüÂëò‰πüÊúâÈ°∫Â∫è„ÄÇ</p>
<p>ÊòæÁÑ∂‰ºöÂéªÈô§Â§ö‰∫ÜÔºåÂ¶ÇÊûúÊúâÂ§öÈòüÂêåÊó∂‰∏çÂêàÊ≥ïÔºåËøô‰∫õÊñπÊ°à‰ºöË¢´ÂéªÈô§Â§öÊ¨°ÔºåÈí¶ÂÆöÂì™‰∏§ÈòüÂÖ®ÈÉ®Êå®Âú®‰∏ÄËµ∑‰∫ÜÔºåÁÆóÂÖ•Á≠îÊ°àÂ∞±ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac linethickness="0px"><mi>k</mi><mn>2</mn></mfrac></mstyle><mo fence="true">)</mo></mrow><mo stretchy="false">(</mo><mn>3</mn><mi>k</mi><mo>‚àí</mo><mn>4</mn><mo stretchy="false">)</mo><mo stretchy="false">!</mo><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">!</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\dbinom{k}{2}(3k - 4)!(3!)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mopen">(</span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mclose">)!</span><span class="mopen">(</span><span class="mord">3</span><span class="mclose">!</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>„ÄÇ</p>
<p>ÊòæÁÑ∂Âä†Â§ö‰∫Ü‚Ä¶‚Ä¶</p>
<p>ÁÑ∂ÂêéÂ∞±ÊòØÂÆπÊñ•ÂéüÁêÜ‰∫Ü„ÄÇ</p>
<p>Á≠îÊ°àÂ∫îËØ•ÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>k</mi></msubsup><mrow><mo stretchy="false">(</mo><mo>‚àí</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>i</mi></msup><mrow><mo fence="true">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac linethickness="0px"><mi>k</mi><mi>i</mi></mfrac></mstyle><mo fence="true">)</mo></mrow><mo stretchy="false">(</mo><mn>3</mn><mi>k</mi><mo>‚àí</mo><mn>2</mn><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">!</mo><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">!</mo><msup><mo stretchy="false">)</mo><mi>i</mi></msup></mrow></mrow><annotation encoding="application/x-tex">\sum_{i=0}^{k}\limits{(-1)^i\dbinom{k}{i}(3k - 2i)!(3!)^i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.5138em;vertical-align:-0.9777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5361em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">‚àë</span></span></span><span style="top:-3.95em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.9777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">‚àí</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">i</span></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mopen">(</span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal">i</span><span class="mclose">)!</span><span class="mopen">(</span><span class="mord">3</span><span class="mclose">!</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></span></p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> C<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> m<span class="op">){</span> <span class="cf">return</span> frac<span class="op">[</span>n<span class="op">]</span> <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> ifrac<span class="op">[</span>n <span class="op">-</span> m<span class="op">]</span> <span class="op">%</span> MOD <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> ifrac<span class="op">[</span>m<span class="op">]</span> <span class="op">%</span> MOD<span class="op">;</span> <span class="op">}</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> k<span class="op">;</span> Read<span class="op">(</span>k<span class="op">);</span> Init<span class="op">((</span>k <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">*</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> k<span class="op">){</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> tans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        tans <span class="op">=</span> C<span class="op">(</span>k<span class="op">,</span> i<span class="op">)</span> <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> frac<span class="op">[</span><span class="dv">3</span> <span class="op">*</span> k <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> i<span class="op">]</span> <span class="op">%</span> MOD <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> pow<span class="op">(</span><span class="dv">6</span><span class="op">,</span> i<span class="op">,</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        tans <span class="op">=</span> <span class="op">(</span>i <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">?</span> MOD <span class="op">-</span> tans <span class="op">:</span> tans<span class="op">;</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span><span class="dv">0</span><span class="bu">ll</span><span class="op">+</span> tans<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="d.-Ë∑ØÂæÑ">D. Ë∑ØÂæÑ</h3>
<p>ÁªôÂÆö‰∏Ä‰∏™<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>‰∏™È°∂ÁÇπÁöÑÊó†Ê†πÊ†ëÔºåÈ°∂ÁÇπÁºñÂè∑
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mtext>¬†</mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">1 ~ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace nobreak">¬†</span><span class="mord mathnormal">n</span></span></span></span>„ÄÇ</p>
<p>ÂêåÊó∂ÁªôÂÆöÊ†ë‰∏äÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
Êù°Â∏¶ÊùÉË∑ØÂæÑÔºåË¶ÅÊ±ÇÊîØÊåÅ‰ª•‰∏ãÊìç‰Ωú:</p>
<ul>
<li><code>1 k</code> ÔºåÂà†Èô§Á¨¨
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
Êù°Â∏¶ÊùÉË∑ØÂæÑ„ÄÇ</li>
<li><code>2 k v</code> ÔºåÂ∞ÜÁ¨¨
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
Êù°Â∏¶ÊùÉË∑ØÂæÑÁöÑÊùÉÂÄº‰øÆÊîπ‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span>
„ÄÇ</li>
<li><code>3 p</code> ÔºåÁªôÂÆö‰∏Ä‰∏™Ê†ë‰∏äËäÇÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>
ÔºåËØ¢ÈóÆÊâÄÊúâÊ≤°ÊúâË¢´Âà†ÂéªÁöÑÂ∏¶ÊùÉË∑ØÂæÑ‰∏≠Ôºå‰∏ç‰∏éËØ•ËäÇÁÇπÁõ∏‰∫§ÁöÑÊâÄÊúâË∑ØÂæÑ‰∏≠ÁöÑÊúÄÂ∞èÊùÉÂÄº„ÄÇ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>k</mi><mo separator="true">,</mo><mi>q</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">n, k, q \le 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
<h4 id="ÂÅöÊ≥ï‰∏ÄÊ†ëÂâñ-stdset-Áª¥Êä§Ê†áËÆ∞-Ê†áËÆ∞Ê∞∏‰πÖÂåñÁ∫øÊÆµÊ†ë">ÂÅöÊ≥ï‰∏ÄÔºöÊ†ëÂâñ +
<code>std::set</code> Áª¥Êä§Ê†áËÆ∞ Ê†áËÆ∞Ê∞∏‰πÖÂåñÁ∫øÊÆµÊ†ë</h4>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mi>q</mi><mo stretchy="false">)</mo><msubsup><mrow><mi>log</mi><mo>‚Å°</mo></mrow><mn>2</mn><mn>3</mn></msubsup><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}((k + q)\log_2^3{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1484em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8984em;"><span style="top:-2.453em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1473em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">n</span></span><span class="mclose">)</span></span></span></span>
ÂÖàÊ†ëÂâñÔºåË∑ØÂæÑË°•ÈõÜ‰ªçÁÑ∂ÊòØÁ∫øÊÆµÊ†ë‰∏ä
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>log</mi><mo>‚Å°</mo></mrow><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log_2(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>
ÊÆµÔºåÂèØ‰ª•Âú®Ëøô‰∫õÊÆµÈáåÈù¢Âä†ÂÖ•ÂèØÈÄâÁöÑËæπÔºå‰∏∫‰∫ÜÈò≤Ê≠¢Âà†Èô§ÈáçÂ§çÔºå<code>std::set</code>
ÂÜÖÂ±ÇÊï∞ÊçÆÁ±ªÂûã‰∏∫ <code>pair&lt;int, int&gt;</code>
ÂàÜÂà´Â≠òÂÇ®Ë∑ØÂæÑÁöÑÊùÉÂÄºÂíåÁºñÂè∑„ÄÇÁÑ∂ÂêéÂ∞±Áõ¥Êé•ÂÅöÂ∞±Â•Ω‰∫Ü„ÄÇ <del>ÂêéËÆ∞ÔºöË¢´Âá∫È¢ò‰∫∫Âç°Êàê‰∫Ü
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>30</mn></mrow><annotation encoding="application/x-tex">30</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">30</span></span></span></span>
‚Ä¶‚Ä¶„ÄÇ</del></p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define rep</span><span class="op">(</span>i<span class="op">,</span><span class="pp"> </span>l<span class="op">,</span><span class="pp"> </span>r<span class="op">)</span><span class="pp"> </span><span class="cf">for</span><span class="op">(</span><span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span>l<span class="op">,</span><span class="pp"> </span>__<span class="pp"> </span><span class="op">=</span><span class="pp"> </span>r<span class="op">;</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">&lt;=</span><span class="pp"> </span>__<span class="op">;</span><span class="pp"> </span>i<span class="op">++)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> k<span class="op">,</span> p<span class="op">;</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">2e6</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> head<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> edges<span class="op">{</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> node<span class="op">;</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> nxt<span class="op">;</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>edge<span class="op">[</span>_<span class="op">];</span> <span class="dt">int</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> add<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> v<span class="op">)</span> <span class="op">{</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    tot<span class="op">++;</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    edge<span class="op">[</span>tot<span class="op">].</span>node <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    edge<span class="op">[</span>tot<span class="op">].</span>nxt  <span class="op">=</span> head<span class="op">[</span>u<span class="op">];</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    head<span class="op">[</span>u<span class="op">]</span>        <span class="op">=</span> tot<span class="op">;</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Path<span class="op">{</span> <span class="dt">int</span> u<span class="op">,</span> v<span class="op">,</span> Val<span class="op">;</span> Path<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> c<span class="op">)</span> <span class="op">{</span> u <span class="op">=</span> a<span class="op">;</span> v <span class="op">=</span> b<span class="op">;</span> Val <span class="op">=</span> c<span class="op">;</span> <span class="op">}</span> Path<span class="op">(){}</span> <span class="op">}</span> P<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dfn<span class="op">[</span>_<span class="op">],</span> rnk<span class="op">[</span>_<span class="op">],</span> dfc<span class="op">,</span> dep<span class="op">[</span>_<span class="op">],</span> top<span class="op">[</span>_<span class="op">],</span> fa<span class="op">[</span>_<span class="op">],</span> si<span class="op">[</span>_<span class="op">],</span> son<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs0<span class="op">(</span><span class="dt">int</span> now<span class="op">,</span> <span class="dt">int</span> f<span class="op">,</span> <span class="dt">int</span> dp<span class="op">){</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    fa<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> f<span class="op">;</span>  dep<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> dp<span class="op">;</span> <span class="dt">int</span> <span class="op">&amp;</span>Mid <span class="op">=</span> son<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="dt">int</span> <span class="op">&amp;</span>Si <span class="op">=</span> si<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span> i <span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span> <span class="cf">if</span><span class="op">(</span>ex <span class="op">==</span> f<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>        dfs0<span class="op">(</span>ex<span class="op">,</span> now<span class="op">,</span> dp <span class="op">+</span> <span class="dv">1</span><span class="op">);</span> Si <span class="op">+=</span> si<span class="op">[</span>ex<span class="op">];</span> <span class="cf">if</span><span class="op">(</span>si<span class="op">[</span>ex<span class="op">]</span> <span class="op">&gt;</span> si<span class="op">[</span>Mid<span class="op">])</span> Mid <span class="op">=</span> ex<span class="op">;</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs1<span class="op">(</span><span class="dt">int</span> now<span class="op">,</span> <span class="dt">int</span> f<span class="op">,</span> <span class="dt">int</span> tp<span class="op">){</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    dfn<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> <span class="op">++</span>dfc<span class="op">;</span>  top<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> tp<span class="op">;</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>son<span class="op">[</span>now<span class="op">])</span> dfs1<span class="op">(</span>son<span class="op">[</span>now<span class="op">],</span> now<span class="op">,</span> tp<span class="op">);</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span> i <span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span> <span class="cf">if</span><span class="op">(</span>ex <span class="op">==</span> f <span class="op">||</span> ex <span class="op">==</span> son<span class="op">[</span>now<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>        dfs1<span class="op">(</span>ex<span class="op">,</span> now<span class="op">,</span> ex<span class="op">);</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> SegmentTree<span class="op">{</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">3e6</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ch<span class="op">[</span>_<span class="op">][</span><span class="dv">2</span><span class="op">];</span> set<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span> <span class="op">,</span><span class="dt">int</span><span class="op">&gt;,</span> less <span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span> <span class="op">,</span><span class="dt">int</span><span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span> v<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define ls</span><span class="op">(</span>o<span class="op">)</span><span class="pp"> </span><span class="op">(</span>ch<span class="op">[</span>o<span class="op">][</span><span class="dv">0</span><span class="op">])</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define rs</span><span class="op">(</span>o<span class="op">)</span><span class="pp"> </span><span class="op">(</span>ch<span class="op">[</span>o<span class="op">][</span><span class="dv">1</span><span class="op">])</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define make </span><span class="op">(</span>tot<span class="op">++,</span><span class="pp"> </span>ch<span class="op">[</span>tot<span class="op">][</span><span class="dv">0</span><span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span>ch<span class="op">[</span>tot<span class="op">][</span><span class="dv">1</span><span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="dv">0</span><span class="op">,</span><span class="pp"> </span>v<span class="op">[</span>tot<span class="op">].</span>clear<span class="op">(),</span><span class="pp"> </span>tot<span class="op">)</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> Groot<span class="op">(){</span> <span class="cf">return</span> make<span class="op">;</span> <span class="op">}</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> build<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">==</span> R<span class="op">)</span> <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>v<span class="op">[</span>o<span class="op">].</span>insert<span class="op">(</span>make_pair<span class="op">(</span>INT_MAX<span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">));</span></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>        ls<span class="op">(</span>o<span class="op">)</span> <span class="op">=</span> make<span class="op">;</span> rs<span class="op">(</span>o<span class="op">)</span> <span class="op">=</span> make<span class="op">;</span> v<span class="op">[</span>o<span class="op">].</span>insert<span class="op">(</span>make_pair<span class="op">(</span>INT_MAX<span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">));</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>        build<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> L<span class="op">,</span> mid<span class="op">);</span> build<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> update_add<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">,</span> <span class="dt">int</span> V<span class="op">,</span> <span class="dt">int</span> id<span class="op">){</span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&gt;</span> R<span class="op">)</span> <span class="cf">return</span> <span class="op">;</span></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> nowl <span class="op">&amp;&amp;</span> nowr <span class="op">&lt;=</span> R<span class="op">)</span> <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>v<span class="op">[</span>o<span class="op">].</span>insert<span class="op">(</span>make_pair<span class="op">(</span>V<span class="op">,</span> id<span class="op">));</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> mid<span class="op">)</span> update_add<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> V<span class="op">,</span> id<span class="op">);</span></span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>R  <span class="op">&gt;</span> mid<span class="op">)</span> update_add<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> V<span class="op">,</span> id<span class="op">);</span></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> update_del<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">,</span> <span class="dt">int</span> V<span class="op">,</span> <span class="dt">int</span> id<span class="op">){</span></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&gt;</span> R<span class="op">)</span> <span class="cf">return</span> <span class="op">;</span></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> nowl <span class="op">&amp;&amp;</span> nowr <span class="op">&lt;=</span> R<span class="op">)</span> <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>v<span class="op">[</span>o<span class="op">].</span>erase<span class="op">(</span>make_pair<span class="op">(</span>V<span class="op">,</span> id<span class="op">));</span></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">&lt;=</span> mid<span class="op">)</span> update_del<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> V<span class="op">,</span> id<span class="op">);</span></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>R  <span class="op">&gt;</span> mid<span class="op">)</span> update_del<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> L<span class="op">,</span> R<span class="op">,</span> V<span class="op">,</span> id<span class="op">);</span></span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>    pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> query<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> p<span class="op">,</span> pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> ans <span class="op">=</span> make_pair<span class="op">(</span>INT_MAX<span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">)){</span></span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>nowl <span class="op">==</span> nowr<span class="op">)</span> <span class="cf">return</span> min<span class="op">(</span>ans<span class="op">,</span> <span class="op">*(</span>v<span class="op">[</span>o<span class="op">].</span>begin<span class="op">()));</span></span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span> ans <span class="op">=</span> min<span class="op">(</span>ans<span class="op">,</span> <span class="op">*(</span>v<span class="op">[</span>o<span class="op">].</span>begin<span class="op">()));</span></span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> p <span class="op">&lt;=</span> mid <span class="op">?</span> query<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> p<span class="op">,</span> ans<span class="op">)</span> <span class="op">:</span> query<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> p<span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="kw">using</span> SegmentTree<span class="op">::</span>query<span class="op">;</span>     <span class="kw">using</span> SegmentTree<span class="op">::</span>update_add<span class="op">;</span> <span class="kw">using</span> SegmentTree<span class="op">::</span>Groot<span class="op">;</span> </span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>  <span class="kw">using</span> SegmentTree<span class="op">::</span>build<span class="op">;</span>     <span class="kw">using</span> SegmentTree<span class="op">::</span>update_del<span class="op">;</span></span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a><span class="pp">#define fi </span>first</span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a><span class="pp">#define se </span>second</span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> <span class="op">&gt;</span> TMP<span class="op">;</span></span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> root <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> AddWithoutPath<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> v<span class="op">,</span> <span class="dt">int</span> Val<span class="op">,</span> <span class="dt">int</span> id<span class="op">){</span></span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>    TMP<span class="op">.</span>clear<span class="op">();</span></span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>top<span class="op">[</span>u<span class="op">]</span> <span class="op">!=</span> top<span class="op">[</span>v<span class="op">]){</span></span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>dep<span class="op">[</span>top<span class="op">[</span>u<span class="op">]]</span> <span class="op">&lt;</span> dep<span class="op">[</span>top<span class="op">[</span>v<span class="op">]])</span> swap<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>        TMP<span class="op">.</span>push_back<span class="op">(</span>make_pair<span class="op">(</span>dfn<span class="op">[</span>top<span class="op">[</span>u<span class="op">]],</span> dfn<span class="op">[</span>u<span class="op">]));</span> u <span class="op">=</span> fa<span class="op">[</span>top<span class="op">[</span>u<span class="op">]];</span></span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>dep<span class="op">[</span>u<span class="op">]</span> <span class="op">&lt;</span> dep<span class="op">[</span>v<span class="op">])</span> swap<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a>    TMP<span class="op">.</span>push_back<span class="op">(</span>make_pair<span class="op">(</span>dfn<span class="op">[</span>v<span class="op">],</span> dfn<span class="op">[</span>u<span class="op">]));</span></span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>TMP<span class="op">.</span>begin<span class="op">(),</span> TMP<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> TMP<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">2</span><span class="op">)</span> update_add<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> TMP<span class="op">[</span>i<span class="op">].</span>se <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> TMP<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">].</span>fi <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> Val<span class="op">,</span> id<span class="op">);</span></span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>    update_add<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> TMP<span class="op">[</span><span class="dv">0</span><span class="op">].</span>fi <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> Val<span class="op">,</span> id<span class="op">);</span></span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a>    update_add<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> TMP<span class="op">[</span>TMP<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>se <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> Val<span class="op">,</span> id<span class="op">);</span></span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> DelWithoutPath<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> v<span class="op">,</span> <span class="dt">int</span> Val<span class="op">,</span> <span class="dt">int</span> id<span class="op">){</span></span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a>    TMP<span class="op">.</span>clear<span class="op">();</span></span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>top<span class="op">[</span>u<span class="op">]</span> <span class="op">!=</span> top<span class="op">[</span>v<span class="op">]){</span></span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>dep<span class="op">[</span>top<span class="op">[</span>u<span class="op">]]</span> <span class="op">&lt;</span> dep<span class="op">[</span>top<span class="op">[</span>v<span class="op">]])</span> swap<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a>        TMP<span class="op">.</span>push_back<span class="op">(</span>make_pair<span class="op">(</span>dfn<span class="op">[</span>top<span class="op">[</span>u<span class="op">]],</span> dfn<span class="op">[</span>u<span class="op">]));</span> u <span class="op">=</span> fa<span class="op">[</span>top<span class="op">[</span>u<span class="op">]];</span></span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>dep<span class="op">[</span>u<span class="op">]</span> <span class="op">&lt;</span> dep<span class="op">[</span>v<span class="op">])</span> swap<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb39-94"><a href="#cb39-94" aria-hidden="true" tabindex="-1"></a>    TMP<span class="op">.</span>push_back<span class="op">(</span>make_pair<span class="op">(</span>dfn<span class="op">[</span>v<span class="op">],</span> dfn<span class="op">[</span>u<span class="op">]));</span></span>
<span id="cb39-95"><a href="#cb39-95" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>TMP<span class="op">.</span>begin<span class="op">(),</span> TMP<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb39-96"><a href="#cb39-96" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> TMP<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">2</span><span class="op">)</span> update_del<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> TMP<span class="op">[</span>i<span class="op">].</span>se <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> TMP<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">].</span>fi <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> Val<span class="op">,</span> id<span class="op">);</span></span>
<span id="cb39-97"><a href="#cb39-97" aria-hidden="true" tabindex="-1"></a>    update_del<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> TMP<span class="op">[</span><span class="dv">0</span><span class="op">].</span>fi <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> Val<span class="op">,</span> id<span class="op">);</span></span>
<span id="cb39-98"><a href="#cb39-98" aria-hidden="true" tabindex="-1"></a>    update_del<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> TMP<span class="op">[</span>TMP<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>se <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> Val<span class="op">,</span> id<span class="op">);</span></span>
<span id="cb39-99"><a href="#cb39-99" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb39-100"><a href="#cb39-100" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span> <span class="co">// freopen(&quot;in.txt&quot;, &quot;r&quot;, stdin);</span></span>
<span id="cb39-101"><a href="#cb39-101" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">)(</span>k<span class="op">)(</span>p<span class="op">);</span></span>
<span id="cb39-102"><a href="#cb39-102" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb39-103"><a href="#cb39-103" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u<span class="op">,</span> v<span class="op">;</span> Read<span class="op">(</span>u<span class="op">)(</span>v<span class="op">);</span></span>
<span id="cb39-104"><a href="#cb39-104" aria-hidden="true" tabindex="-1"></a>        add<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span> add<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb39-105"><a href="#cb39-105" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-106"><a href="#cb39-106" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb39-107"><a href="#cb39-107" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> p<span class="op">,</span> q<span class="op">,</span> v<span class="op">;</span> Read<span class="op">(</span>p<span class="op">)(</span>q<span class="op">)(</span>v<span class="op">);</span></span>
<span id="cb39-108"><a href="#cb39-108" aria-hidden="true" tabindex="-1"></a>        P<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> Path<span class="op">(</span>p<span class="op">,</span> q<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb39-109"><a href="#cb39-109" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-110"><a href="#cb39-110" aria-hidden="true" tabindex="-1"></a>    dfs0<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span> dfs1<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb39-111"><a href="#cb39-111" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> Groot<span class="op">();</span> build<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb39-112"><a href="#cb39-112" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> k<span class="op">)</span> AddWithoutPath<span class="op">(</span>P<span class="op">[</span>i<span class="op">].</span>u<span class="op">,</span> P<span class="op">[</span>i<span class="op">].</span>v<span class="op">,</span> P<span class="op">[</span>i<span class="op">].</span>Val<span class="op">,</span> i<span class="op">);</span></span>
<span id="cb39-113"><a href="#cb39-113" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>p<span class="op">--){</span></span>
<span id="cb39-114"><a href="#cb39-114" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> opt<span class="op">,</span> k<span class="op">;</span> Read<span class="op">(</span>opt<span class="op">)(</span>k<span class="op">);</span></span>
<span id="cb39-115"><a href="#cb39-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>opt <span class="op">==</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb39-116"><a href="#cb39-116" aria-hidden="true" tabindex="-1"></a>            DelWithoutPath<span class="op">(</span>P<span class="op">[</span>k<span class="op">].</span>u<span class="op">,</span> P<span class="op">[</span>k<span class="op">].</span>v<span class="op">,</span> P<span class="op">[</span>k<span class="op">].</span>Val<span class="op">,</span> k<span class="op">);</span></span>
<span id="cb39-117"><a href="#cb39-117" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>opt <span class="op">==</span> <span class="dv">2</span><span class="op">){</span></span>
<span id="cb39-118"><a href="#cb39-118" aria-hidden="true" tabindex="-1"></a>            DelWithoutPath<span class="op">(</span>P<span class="op">[</span>k<span class="op">].</span>u<span class="op">,</span> P<span class="op">[</span>k<span class="op">].</span>v<span class="op">,</span> P<span class="op">[</span>k<span class="op">].</span>Val<span class="op">,</span> k<span class="op">);</span></span>
<span id="cb39-119"><a href="#cb39-119" aria-hidden="true" tabindex="-1"></a>            Read<span class="op">(</span>P<span class="op">[</span>k<span class="op">].</span>Val<span class="op">);</span></span>
<span id="cb39-120"><a href="#cb39-120" aria-hidden="true" tabindex="-1"></a>            AddWithoutPath<span class="op">(</span>P<span class="op">[</span>k<span class="op">].</span>u<span class="op">,</span> P<span class="op">[</span>k<span class="op">].</span>v<span class="op">,</span> P<span class="op">[</span>k<span class="op">].</span>Val<span class="op">,</span> k<span class="op">);</span></span>
<span id="cb39-121"><a href="#cb39-121" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb39-122"><a href="#cb39-122" aria-hidden="true" tabindex="-1"></a>            pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> r <span class="op">=</span> query<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> dfn<span class="op">[</span>k<span class="op">]);</span></span>
<span id="cb39-123"><a href="#cb39-123" aria-hidden="true" tabindex="-1"></a>            printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> r<span class="op">.</span>first <span class="op">&lt;</span> INT_MAX <span class="op">?</span> r<span class="op">.</span>first <span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb39-124"><a href="#cb39-124" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb39-125"><a href="#cb39-125" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-126"><a href="#cb39-126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb39-127"><a href="#cb39-127" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="ÂÅöÊ≥ï‰∫åÁ∫øÊÆµÊ†ëÁª¥Êä§Ë∑ØÂæÑ‰∫§ÈõÜ-‰∫åÂàÜÊúÄÂ∞èÂÄº">ÂÅöÊ≥ï‰∫åÔºöÁ∫øÊÆµÊ†ëÁª¥Êä§Ë∑ØÂæÑ‰∫§ÈõÜ
+ ‰∫åÂàÜÊúÄÂ∞èÂÄº</h4>
<blockquote>
<p>Â∑ßÂ¶ôÁªù‰º¶ÁöÑÂÅöÊ≥ï„ÄÇ</p>
</blockquote>
<p>Ë¶ÅÊ±ÇÂõûÁ≠îÁöÑÊòØÔºö‰∏ç‰∏éËäÇÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>
Áõ∏‰∫§ÁöÑÊâÄÊúâË∑ØÂæÑ‰∏≠ÁöÑÊúÄÂ∞èÊùÉÂÄº„ÄÇ</p>
<p>ËÄÉËôë‰∫åÂàÜ‰∏Ä‰∏™ÊúÄÂ∞èÊùÉÂÄº
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ÔºåÁÑ∂ÂêéÂà§Êñ≠ÊòØÊâÄÊúâÊùÉÂÄºÂ∞è‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
ÁöÑË∑ØÂæÑÊòØ‰∏çÊòØÂÖ®ÈÉΩÂíåÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>
Êúâ‰∫§„ÄÇ</p>
<p>Â¶ÇÊûúÊääÊâÄÊúâË∑ØÂæÑÊåâÁÖßÊùÉÂÄºÊéíÂ∫èÔºåÈÇ£‰πàÊàê‰∏∫Á≠îÊ°àÁöÑÈÇ£Êù°Ë∑ØÂæÑ‰πãÂâçÁöÑË∑ØÂæÑ‰∏ÄÂÆöÈÉΩÂíåÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>
Êúâ‰∫§ÔºåËøôÂ∞±ÂèØ‰ª•Áõ¥Êé•‰∫åÂàÜÁ≠îÊ°à‰∫Ü„ÄÇ</p>
<p>‰ΩÜÊòØË∑ØÂæÑÈúÄË¶ÅÊîØÊåÅÂà†Èô§Âíå‰øÆÊîπ„ÄÇ ÊòæÁÑ∂ÈúÄË¶ÅÊï∞ÊçÆÁªìÊûÑ„ÄÇ</p>
<p>‰∏Ä‰∏™ÊòæÁÑ∂ÁöÑ‰∫ãÂÆûÊòØÔºö‰∏§Êù°Ë∑ØÂæÑÁöÑ‰∫§
‰πüÊòØ‰∏ÄÊù°Ë∑ØÂæÑÔºàÂÆö‰πâ‰∏Ä‰∏™ÁÇπÊàñËÄÖÁ©∫ÈÉΩÂ±û‰∫éË∑ØÂæÑÔºâ„ÄÇ</p>
<p>Á∫øÊÆµÊ†ëÂ∞±ÂèØ‰ª•Âø´ÈÄüÊ±ÇÂá∫‰∏ÄÊÆµË∑ØÂæÑÂå∫Èó¥ÂÜÖÊâÄÊúâË∑ØÂæÑÁöÑ‰∫§ÈõÜË∑ØÂæÑ„ÄÇ</p>
<p>ÊâÄÊúâË∑ØÂæÑÊåâÁÖßÊùÉÂÄºÊéíÂ•ΩÂ∫èÂêéÁöÑ‰∏Ä‰∏™ÂâçÁºÄÂÖ®ÈÉ®ÂíåÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>
Êúâ‰∫§ÔºåÁ≠â‰ª∑‰∫éÔºåËøô‰∏™ÂâçÁºÄÊâÄÊúâÁöÑË∑ØÂæÑÁöÑ‰∫§ÈõÜÂíåÁÇπ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>
Êúâ‰∫§„ÄÇ</p>
<p>ÂØπ‰∫éÂà†Èô§Êìç‰ΩúÔºåÂèØ‰ª•ËÄÉËôëÂú®Á∫øÊÆµÊ†ëÂØπÂ∫îÊìç‰Ωú‰∏äÊâìÂà†Èô§Ê†áËÆ∞„ÄÇÂØπ‰∫é‰øÆÊîπÊìç‰ΩúÔºåÂõ†‰∏∫Ê≤°ÊúâÂº∫Âà∂Âú®Á∫øÔºåÂèØ‰ª•ËÄÉËôë‰∏ÄÂºÄÂßãÊääËøôÊù°Ë∑ØÂæÑÁöÑÊâÄÊúâÊùÉÂÄºÊéíÂ•ΩÂ∫èÂêéÂä†ÂÖ•Á∫øÊÆµÊ†ëÔºåÁÑ∂ÂêéÂØπ‰∫éÂΩìÂâçÊó†Áî®ÁöÑÁâàÊú¨ÔºåÊâì‰∏äÂà†Èô§Ê†áËÆ∞Âç≥ÂèØ„ÄÇÂØπ‰∫é‰∏ÄÊ¨°‰øÆÊîπÔºåËΩ¨ÂåñÊàê‰∏ÄÊ¨°Âà†Èô§Âíå‰∏ÄÊ¨°ÊÅ¢Â§çÊìç‰Ωú„ÄÇ</p>
<p>ÂΩìÁÑ∂Âπ≥Ë°°Ê†ëÂèØ‰ª•ËΩªÊòìÂÆåÊàêËøôÊ†∑ÁöÑÂ∑•‰ΩúÔºåÂú®Âπ≥Ë°°Ê†ë‰∏äÁª¥Êä§Ê†ë‰∏äË∑ØÂæÑ‰∫§ÈõÜÔºåÂÜô‰∏çÂá∫Êù•Âïä‚Ä¶</p>
<p>ËøôÊ†∑Â∞±ÂèØ‰ª•Áõ¥Êé•Áî®Á∫øÊÆµÊ†ëÊ±ÇÂá∫Êüê‰∏™ÂâçÁºÄÁöÑÊâÄÊúâË∑ØÂæÑÁöÑ‰∫§ÈõÜË∑ØÂæÑ‰∫Ü„ÄÇÁ∫øÊÆµÊ†ëÂêàÂπ∂‰ø°ÊÅØÊó∂ÔºåÈúÄË¶ÅËØ¢ÈóÆ
<code>LCA</code>ÔºåÁÆó‰∏ä‰∫åÂàÜÔºåËøôÊ†∑ÁöÑÂçïÊ¨°ËØ¢ÈóÆÂ§çÊùÇÂ∫¶ÂèØ‰ª•ÂÅöÂà∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>‚Å°</mo><mi>k</mi><mi>log</mi><mo>‚Å°</mo><mi>w</mi><mi>log</mi><mo>‚Å°</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\log k \log w \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ÔºàÂÄçÂ¢û
<code>LCA</code>ÔºâÔºåÊàñËÄÖ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>‚Å°</mo><mi>k</mi><mi>log</mi><mo>‚Å°</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\log k \log w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span>Ôºà<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n) - \mathcal{O}(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>
<code>LCA</code>Ôºâ„ÄÇ</p>
<p>Ê≥®ÊÑèÂà∞Á∫øÊÆµÊ†ëÊú¨Ë∫´Â∞±ÊòØ‰∏Ä‰∏™ÂàÜÊ≤ªÁöÑÁªìÊûÑÔºåÂèØ‰ª•Áõ¥Êé•Âú®Á∫øÊÆµÊ†ë‰∏ä‰∫åÂàÜÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ÂÅöÂà∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>‚Å°</mo><mi>k</mi><mi>log</mi><mo>‚Å°</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\log k \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ÔºàÂÄçÂ¢û
<code>LCA</code>ÔºâÔºåÊàñËÄÖ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>‚Å°</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\log k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span>Ôºà<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n) - \mathcal{O}(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>
<code>LCA</code>Ôºâ„ÄÇ</p>
<p>ÊàëÁöÑÂÆûÁé∞ÊòØ ÂÄçÂ¢û <code>LCA</code> +
Á∫øÊÆµÊ†ë‰∫åÂàÜÔºåÁÆó‰∏äÈ¢ÑÂ§ÑÁêÜÔºåÊÄªÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mi>q</mi><mi>log</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>q</mi><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo><mi>log</mi><mo>‚Å°</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n\log(n) + q\log(q+k)\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">2e5</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> head<span class="op">[</span>_<span class="op">],</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> edges<span class="op">{</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> node<span class="op">;</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> nxt<span class="op">;</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>edge<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> add<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> v<span class="op">){</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    tot<span class="op">++;</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    edge<span class="op">[</span>tot<span class="op">].</span>node <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    edge<span class="op">[</span>tot<span class="op">].</span>nxt  <span class="op">=</span> head<span class="op">[</span>u<span class="op">];</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    head<span class="op">[</span>u<span class="op">]</span>        <span class="op">=</span> tot<span class="op">;</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> k<span class="op">,</span> q<span class="op">;</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> LOG <span class="op">=</span> <span class="dv">18</span><span class="op">;</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fa<span class="op">[</span>_<span class="op">][</span>LOG <span class="op">+</span> <span class="dv">2</span><span class="op">],</span> dep<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs0<span class="op">(</span><span class="dt">int</span> now<span class="op">,</span> <span class="dt">int</span> f<span class="op">,</span> <span class="dt">int</span> dp<span class="op">){</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    fa<span class="op">[</span>now<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> f<span class="op">;</span> dep<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> dp<span class="op">;</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span> i <span class="op">;</span> i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ex <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span> <span class="cf">if</span><span class="op">(</span>ex <span class="op">==</span> f<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>        dfs0<span class="op">(</span>ex<span class="op">,</span> now<span class="op">,</span> dp <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>map <span class="op">&lt;</span> pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> <span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span>  Mem<span class="op">;</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> LCA<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> v<span class="op">){</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> P <span class="op">=</span> make_pair<span class="op">(</span>min<span class="op">(</span>u<span class="op">,</span> v<span class="op">),</span> max<span class="op">(</span>u<span class="op">,</span> v<span class="op">));</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>Mem<span class="op">.</span>count<span class="op">(</span>P<span class="op">))</span> <span class="cf">return</span> Mem<span class="op">[</span>P<span class="op">];</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>dep<span class="op">[</span>u<span class="op">]</span> <span class="op">&lt;</span> dep<span class="op">[</span>v<span class="op">])</span> swap<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> d <span class="op">=</span> dep<span class="op">[</span>u<span class="op">]</span> <span class="op">-</span> dep<span class="op">[</span>v<span class="op">];</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> u<span class="op">,</span> y <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> LOG<span class="op">)</span> <span class="cf">if</span><span class="op">(</span>d <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> i<span class="op">))</span> x <span class="op">=</span> fa<span class="op">[</span>x<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>x <span class="op">==</span> y<span class="op">)</span> <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> LOG<span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--){</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>fa<span class="op">[</span>x<span class="op">][</span>i<span class="op">]</span> <span class="op">==</span> fa<span class="op">[</span>y<span class="op">][</span>i<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> fa<span class="op">[</span>x<span class="op">][</span>i<span class="op">];</span> y <span class="op">=</span> fa<span class="op">[</span>y<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Mem<span class="op">[</span>P<span class="op">]</span> <span class="op">=</span> fa<span class="op">[</span>x<span class="op">][</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> InitQuery<span class="op">(){</span></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>    dfs0<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>j<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> LOG<span class="op">)</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> fa<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> fa<span class="op">[</span>fa<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">]][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> <span class="dt">Path_t</span><span class="op">{</span></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> id<span class="op">,</span> u<span class="op">,</span> v<span class="op">,</span> w<span class="op">,</span> ver<span class="op">;</span></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Path_t</span><span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> c<span class="op">,</span> <span class="dt">int</span> d<span class="op">,</span> <span class="dt">int</span> e<span class="op">)</span> <span class="op">{</span> id <span class="op">=</span> a<span class="op">;</span> u <span class="op">=</span> b<span class="op">;</span> v <span class="op">=</span> c<span class="op">;</span> w <span class="op">=</span> d<span class="op">;</span> ver <span class="op">=</span> e<span class="op">;</span> <span class="op">}</span></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Path_t</span><span class="op">()</span> <span class="op">{</span> <span class="op">}</span></span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> CMP<span class="op">(</span><span class="at">const</span> <span class="dt">Path_t</span> <span class="op">&amp;</span> A<span class="op">,</span> <span class="at">const</span> <span class="dt">Path_t</span> <span class="op">&amp;</span> B<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> A<span class="op">.</span>w <span class="op">&lt;</span> B<span class="op">.</span>w<span class="op">;</span> <span class="op">}</span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> <span class="dt">Q_t</span><span class="op">{</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> type<span class="op">,</span> a<span class="op">,</span> b<span class="op">;</span></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Q_t</span><span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> z<span class="op">)</span> <span class="op">{</span> type <span class="op">=</span> x<span class="op">;</span> a <span class="op">=</span> y<span class="op">;</span> b <span class="op">=</span> z<span class="op">;</span> <span class="op">}</span></span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Q_t</span><span class="op">()</span> <span class="op">{}</span></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>Q<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> nowv<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">Path_t</span><span class="op">&gt;</span> P<span class="op">;</span></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> Pv<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dis<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> v<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> dep<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> dep<span class="op">[</span>v<span class="op">]</span> <span class="op">-</span> <span class="op">(</span>dep<span class="op">[</span>LCA<span class="op">(</span>u<span class="op">,</span> v<span class="op">)]</span> <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> cross<span class="op">(</span><span class="dt">int</span> u0<span class="op">,</span> <span class="dt">int</span> v0<span class="op">,</span> <span class="dt">int</span> u1<span class="op">,</span> <span class="dt">int</span> v1<span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> t0 <span class="op">=</span> LCA<span class="op">(</span>u0<span class="op">,</span> v0<span class="op">);</span></span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> t1 <span class="op">=</span> LCA<span class="op">(</span>u0<span class="op">,</span> u1<span class="op">);</span></span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> t2 <span class="op">=</span> LCA<span class="op">(</span>u0<span class="op">,</span> v1<span class="op">);</span></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> t3 <span class="op">=</span> LCA<span class="op">(</span>v0<span class="op">,</span> u1<span class="op">);</span></span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> t4 <span class="op">=</span> LCA<span class="op">(</span>v0<span class="op">,</span> v1<span class="op">);</span></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> target0 <span class="op">=</span> t0<span class="op">;</span> <span class="co">// t0 t1 t3 </span></span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>dep<span class="op">[</span>target0<span class="op">]</span> <span class="op">&lt;</span> dep<span class="op">[</span>t1<span class="op">])</span> target0 <span class="op">=</span> t1<span class="op">;</span></span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>dep<span class="op">[</span>target0<span class="op">]</span> <span class="op">&lt;</span> dep<span class="op">[</span>t3<span class="op">])</span> target0 <span class="op">=</span> t3<span class="op">;</span></span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> target1 <span class="op">=</span> t0<span class="op">;</span> <span class="co">// t0 t2 t4</span></span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>dep<span class="op">[</span>target1<span class="op">]</span> <span class="op">&lt;</span> dep<span class="op">[</span>t2<span class="op">])</span> target1 <span class="op">=</span> t2<span class="op">;</span></span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>dep<span class="op">[</span>target1<span class="op">]</span> <span class="op">&lt;</span> dep<span class="op">[</span>t4<span class="op">])</span> target1 <span class="op">=</span> t4<span class="op">;</span></span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>target1 <span class="op">==</span> target0 <span class="op">&amp;&amp;</span> dis<span class="op">(</span>target1<span class="op">,</span> u1<span class="op">)</span> <span class="op">+</span> dis<span class="op">(</span>target1<span class="op">,</span> v1<span class="op">)</span> <span class="op">!=</span> dis<span class="op">(</span>u1<span class="op">,</span> v1<span class="op">))</span> <span class="cf">return</span> make_pair<span class="op">(-</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">return</span> make_pair<span class="op">(</span>target0<span class="op">,</span> target1<span class="op">);</span></span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> crossx<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> v<span class="op">,</span> <span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>u <span class="op">==</span> <span class="op">-</span><span class="dv">1</span> <span class="op">||</span> v <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span>  <span class="cf">return</span> dis<span class="op">(</span>u<span class="op">,</span> v<span class="op">)</span> <span class="op">==</span> dis<span class="op">(</span>u<span class="op">,</span> x<span class="op">)</span> <span class="op">+</span> dis<span class="op">(</span>v<span class="op">,</span> x<span class="op">);</span> <span class="op">}</span></span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> SegmentTree<span class="op">{</span> <span class="co">// To maintain the merge path</span></span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> <span class="dt">Node_t</span><span class="op">{</span></span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u<span class="op">,</span> v<span class="op">;</span></span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> isDel<span class="op">,</span> isNul<span class="op">;</span></span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a>        <span class="dt">void</span> clear<span class="op">(){</span></span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a>            isDel <span class="op">=</span> <span class="kw">false</span><span class="op">;</span> isNul <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> u <span class="op">=</span> v <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">1e6</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ch<span class="op">[</span>_<span class="op">][</span><span class="dv">2</span><span class="op">],</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="dt">Node_t</span> v<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define ls</span><span class="op">(</span>o<span class="op">)</span><span class="pp"> </span><span class="op">(</span>ch<span class="op">[</span>o<span class="op">][</span><span class="dv">0</span><span class="op">])</span></span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define rs</span><span class="op">(</span>o<span class="op">)</span><span class="pp"> </span><span class="op">(</span>ch<span class="op">[</span>o<span class="op">][</span><span class="dv">1</span><span class="op">])</span></span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a>    <span class="pp">#define make </span><span class="op">(</span>tot<span class="op">++,</span><span class="pp"> </span>ch<span class="op">[</span>tot<span class="op">][</span><span class="dv">0</span><span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span>ch<span class="op">[</span>tot<span class="op">][</span><span class="dv">1</span><span class="op">]</span><span class="pp"> </span><span class="op">=</span><span class="pp"> </span><span class="dv">0</span><span class="op">,</span><span class="pp"> </span>v<span class="op">[</span>tot<span class="op">].</span>clear<span class="op">(),</span><span class="pp"> </span>tot<span class="op">)</span></span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> Groot<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> make<span class="op">;</span> <span class="op">}</span></span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> maintain<span class="op">(</span><span class="dt">int</span> o<span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a>        v<span class="op">[</span>o<span class="op">].</span>isDel <span class="op">=</span> <span class="op">(</span>v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>isDel <span class="op">&amp;&amp;</span> v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>isDel<span class="op">);</span></span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a>        v<span class="op">[</span>o<span class="op">].</span>isNul <span class="op">=</span> <span class="op">(</span>v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>isNul <span class="op">||</span> v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>isNul<span class="op">);</span></span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>v<span class="op">[</span>o<span class="op">].</span>isDel <span class="op">&amp;&amp;</span> <span class="op">!</span>v<span class="op">[</span>o<span class="op">].</span>isNul<span class="op">){</span></span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>isDel <span class="op">&amp;&amp;</span> <span class="op">!</span>v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>isDel<span class="op">)</span> v<span class="op">[</span>o<span class="op">].</span>u <span class="op">=</span> v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>u<span class="op">,</span> v<span class="op">[</span>o<span class="op">].</span>v <span class="op">=</span> v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>v<span class="op">;</span></span>
<span id="cb40-93"><a href="#cb40-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>isDel <span class="op">&amp;&amp;</span> <span class="op">!</span>v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>isDel<span class="op">)</span> v<span class="op">[</span>o<span class="op">].</span>u <span class="op">=</span> v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>u<span class="op">,</span> v<span class="op">[</span>o<span class="op">].</span>v <span class="op">=</span> v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>v<span class="op">;</span></span>
<span id="cb40-94"><a href="#cb40-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb40-95"><a href="#cb40-95" aria-hidden="true" tabindex="-1"></a>                pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> R <span class="op">=</span> cross<span class="op">(</span>v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>u<span class="op">,</span> v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>v<span class="op">,</span> v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>u<span class="op">,</span> v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>v<span class="op">);</span></span>
<span id="cb40-96"><a href="#cb40-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span><span class="op">(</span>R<span class="op">.</span>first <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-97"><a href="#cb40-97" aria-hidden="true" tabindex="-1"></a>                    v<span class="op">[</span>o<span class="op">].</span>isNul <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb40-98"><a href="#cb40-98" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span> </span>
<span id="cb40-99"><a href="#cb40-99" aria-hidden="true" tabindex="-1"></a>                v<span class="op">[</span>o<span class="op">].</span>u <span class="op">=</span> R<span class="op">.</span>first<span class="op">;</span> v<span class="op">[</span>o<span class="op">].</span>v <span class="op">=</span> R<span class="op">.</span>second<span class="op">;</span></span>
<span id="cb40-100"><a href="#cb40-100" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb40-101"><a href="#cb40-101" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb40-102"><a href="#cb40-102" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-103"><a href="#cb40-103" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> build<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">){</span></span>
<span id="cb40-104"><a href="#cb40-104" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>L <span class="op">==</span> R<span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-105"><a href="#cb40-105" aria-hidden="true" tabindex="-1"></a>            v<span class="op">[</span>o<span class="op">].</span>isNul <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb40-106"><a href="#cb40-106" aria-hidden="true" tabindex="-1"></a>            v<span class="op">[</span>o<span class="op">].</span>isDel <span class="op">=</span> <span class="op">(</span>P<span class="op">[</span>L <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>ver <span class="op">!=</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb40-107"><a href="#cb40-107" aria-hidden="true" tabindex="-1"></a>            v<span class="op">[</span>o<span class="op">].</span>u     <span class="op">=</span> P<span class="op">[</span>L <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>u<span class="op">;</span></span>
<span id="cb40-108"><a href="#cb40-108" aria-hidden="true" tabindex="-1"></a>            v<span class="op">[</span>o<span class="op">].</span>v     <span class="op">=</span> P<span class="op">[</span>L <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>v<span class="op">;</span></span>
<span id="cb40-109"><a href="#cb40-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">;</span></span>
<span id="cb40-110"><a href="#cb40-110" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> ls<span class="op">(</span>o<span class="op">)</span> <span class="op">=</span> make<span class="op">;</span> rs<span class="op">(</span>o<span class="op">)</span> <span class="op">=</span> make<span class="op">;</span></span>
<span id="cb40-111"><a href="#cb40-111" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb40-112"><a href="#cb40-112" aria-hidden="true" tabindex="-1"></a>        build<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> L<span class="op">,</span> mid<span class="op">);</span> build<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb40-113"><a href="#cb40-113" aria-hidden="true" tabindex="-1"></a>        maintain<span class="op">(</span>o<span class="op">);</span>  </span>
<span id="cb40-114"><a href="#cb40-114" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-115"><a href="#cb40-115" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> update<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> p<span class="op">,</span> <span class="dt">bool</span> V<span class="op">){</span></span>
<span id="cb40-116"><a href="#cb40-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>nowl <span class="op">==</span> nowr<span class="op">)</span> <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">)(</span>v<span class="op">[</span>o<span class="op">].</span>isDel <span class="op">=</span> V<span class="op">);</span></span>
<span id="cb40-117"><a href="#cb40-117" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb40-118"><a href="#cb40-118" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>p <span class="op">&lt;=</span> mid<span class="op">)</span> update<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> p<span class="op">,</span> V<span class="op">);</span></span>
<span id="cb40-119"><a href="#cb40-119" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>p  <span class="op">&gt;</span> mid<span class="op">)</span> update<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> p<span class="op">,</span> V<span class="op">);</span></span>
<span id="cb40-120"><a href="#cb40-120" aria-hidden="true" tabindex="-1"></a>        maintain<span class="op">(</span>o<span class="op">);</span></span>
<span id="cb40-121"><a href="#cb40-121" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-122"><a href="#cb40-122" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> query<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> nowl<span class="op">,</span> <span class="dt">int</span> nowr<span class="op">,</span> <span class="dt">int</span> x<span class="op">){</span></span>
<span id="cb40-123"><a href="#cb40-123" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>v<span class="op">[</span>o<span class="op">].</span>isNul <span class="op">&amp;&amp;</span> <span class="op">!</span>v<span class="op">[</span>o<span class="op">].</span>isDel <span class="op">&amp;&amp;</span> crossx<span class="op">(</span>v<span class="op">[</span>o<span class="op">].</span>u<span class="op">,</span> v<span class="op">[</span>o<span class="op">].</span>v<span class="op">,</span> x<span class="op">))</span> <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb40-124"><a href="#cb40-124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>nowl <span class="op">==</span> nowr<span class="op">)</span> <span class="cf">return</span> P<span class="op">[</span>nowl <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>w<span class="op">;</span></span>
<span id="cb40-125"><a href="#cb40-125" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> r0 <span class="op">=</span> <span class="op">!(</span>v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>isNul <span class="op">||</span> <span class="op">!</span>crossx<span class="op">(</span>v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>u<span class="op">,</span> v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>v<span class="op">,</span> x<span class="op">))</span> <span class="op">||</span> v<span class="op">[</span>ls<span class="op">(</span>o<span class="op">)].</span>isDel<span class="op">;</span></span>
<span id="cb40-126"><a href="#cb40-126" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> r1 <span class="op">=</span> <span class="op">!(</span>v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>isNul <span class="op">||</span> <span class="op">!</span>crossx<span class="op">(</span>v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>u<span class="op">,</span> v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>v<span class="op">,</span> x<span class="op">))</span> <span class="op">||</span> v<span class="op">[</span>rs<span class="op">(</span>o<span class="op">)].</span>isDel<span class="op">;</span></span>
<span id="cb40-127"><a href="#cb40-127" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>nowl <span class="op">+</span> nowr<span class="op">)</span> <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb40-128"><a href="#cb40-128" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>r0<span class="op">)</span> <span class="cf">return</span> query<span class="op">(</span>ls<span class="op">(</span>o<span class="op">),</span> nowl<span class="op">,</span> mid<span class="op">,</span> x<span class="op">);</span> <span class="cf">else</span> <span class="cf">if</span><span class="op">(!</span>r1<span class="op">)</span> <span class="cf">return</span> query<span class="op">(</span>rs<span class="op">(</span>o<span class="op">),</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> nowr<span class="op">,</span> x<span class="op">);</span> <span class="cf">else</span> <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb40-129"><a href="#cb40-129" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-130"><a href="#cb40-130" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>  <span class="kw">using</span> SegmentTree<span class="op">::</span>build<span class="op">;</span> <span class="kw">using</span> SegmentTree<span class="op">::</span>Groot<span class="op">;</span></span>
<span id="cb40-131"><a href="#cb40-131" aria-hidden="true" tabindex="-1"></a>   <span class="kw">using</span> SegmentTree<span class="op">::</span>query<span class="op">;</span> <span class="kw">using</span> SegmentTree<span class="op">::</span>update<span class="op">;</span></span>
<span id="cb40-132"><a href="#cb40-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-133"><a href="#cb40-133" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span> freopen<span class="op">(</span><span class="st">&quot;in.txt&quot;</span><span class="op">,</span> <span class="st">&quot;r&quot;</span><span class="op">,</span> stdin<span class="op">);</span></span>
<span id="cb40-134"><a href="#cb40-134" aria-hidden="true" tabindex="-1"></a>    Read<span class="op">(</span>n<span class="op">)(</span>k<span class="op">)(</span>q<span class="op">);</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> u<span class="op">,</span> v<span class="op">;</span> Read<span class="op">(</span>u<span class="op">)(</span>v<span class="op">);</span> add<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span> add<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span> <span class="op">}</span> InitQuery<span class="op">();</span></span>
<span id="cb40-135"><a href="#cb40-135" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> k<span class="op">){</span></span>
<span id="cb40-136"><a href="#cb40-136" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u<span class="op">,</span> v<span class="op">,</span> w<span class="op">;</span> Read<span class="op">(</span>u<span class="op">)(</span>v<span class="op">)(</span>w<span class="op">);</span></span>
<span id="cb40-137"><a href="#cb40-137" aria-hidden="true" tabindex="-1"></a>        P<span class="op">.</span>push_back<span class="op">(</span><span class="dt">Path_t</span><span class="op">(</span>i<span class="op">,</span> u<span class="op">,</span> v<span class="op">,</span> w<span class="op">,</span> <span class="dv">1</span><span class="op">));</span> nowv<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb40-138"><a href="#cb40-138" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-139"><a href="#cb40-139" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> q<span class="op">){</span></span>
<span id="cb40-140"><a href="#cb40-140" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> type<span class="op">,</span> a<span class="op">,</span> b<span class="op">;</span> Read<span class="op">(</span>type<span class="op">)(</span>a<span class="op">);</span></span>
<span id="cb40-141"><a href="#cb40-141" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>type <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> Read<span class="op">(</span>b<span class="op">),</span> Q<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dt">Q_t</span><span class="op">(</span>type<span class="op">,</span> a<span class="op">,</span> b<span class="op">);</span></span>
<span id="cb40-142"><a href="#cb40-142" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> Q<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dt">Q_t</span><span class="op">(</span>type<span class="op">,</span> a<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb40-143"><a href="#cb40-143" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-144"><a href="#cb40-144" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> q<span class="op">){</span></span>
<span id="cb40-145"><a href="#cb40-145" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Q_t</span> <span class="op">&amp;</span>now <span class="op">=</span> Q<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb40-146"><a href="#cb40-146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>now<span class="op">.</span>type <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> P<span class="op">.</span>push_back<span class="op">(</span><span class="dt">Path_t</span><span class="op">(</span>now<span class="op">.</span>a<span class="op">,</span> P<span class="op">[</span>now<span class="op">.</span>a <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>u<span class="op">,</span> P<span class="op">[</span>now<span class="op">.</span>a <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>v<span class="op">,</span> now<span class="op">.</span>b<span class="op">,</span> <span class="op">++</span>nowv<span class="op">[</span>now<span class="op">.</span>a<span class="op">]));</span></span>
<span id="cb40-147"><a href="#cb40-147" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-148"><a href="#cb40-148" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-149"><a href="#cb40-149" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> k<span class="op">)</span> Pv<span class="op">[</span>i<span class="op">].</span>resize<span class="op">(</span>nowv<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb40-150"><a href="#cb40-150" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>P<span class="op">.</span>begin<span class="op">(),</span> P<span class="op">.</span>end<span class="op">(),</span> CMP<span class="op">);</span></span>
<span id="cb40-151"><a href="#cb40-151" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> P<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> Pv<span class="op">[</span>P<span class="op">[</span>i<span class="op">].</span>id<span class="op">][</span>P<span class="op">[</span>i<span class="op">].</span>ver<span class="op">]</span> <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb40-152"><a href="#cb40-152" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> root <span class="op">=</span> Groot<span class="op">(),</span> U<span class="op">;</span> U <span class="op">=</span> P<span class="op">.</span>size<span class="op">();</span> build<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> U<span class="op">);</span> </span>
<span id="cb40-153"><a href="#cb40-153" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> k<span class="op">)</span> nowv<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb40-154"><a href="#cb40-154" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> q<span class="op">){</span></span>
<span id="cb40-155"><a href="#cb40-155" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Q_t</span> <span class="op">&amp;</span>now <span class="op">=</span> Q<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb40-156"><a href="#cb40-156" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>now<span class="op">.</span>type <span class="op">==</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb40-157"><a href="#cb40-157" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> Pl <span class="op">=</span> Pv<span class="op">[</span>now<span class="op">.</span>a<span class="op">][</span>nowv<span class="op">[</span>now<span class="op">.</span>a<span class="op">]];</span></span>
<span id="cb40-158"><a href="#cb40-158" aria-hidden="true" tabindex="-1"></a>            update<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> U<span class="op">,</span> Pl<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb40-159"><a href="#cb40-159" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>now<span class="op">.</span>type <span class="op">==</span> <span class="dv">2</span><span class="op">){</span></span>
<span id="cb40-160"><a href="#cb40-160" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> Pl0 <span class="op">=</span> Pv<span class="op">[</span>now<span class="op">.</span>a<span class="op">][</span>  nowv<span class="op">[</span>now<span class="op">.</span>a<span class="op">]];</span></span>
<span id="cb40-161"><a href="#cb40-161" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> Pl1 <span class="op">=</span> Pv<span class="op">[</span>now<span class="op">.</span>a<span class="op">][++</span>nowv<span class="op">[</span>now<span class="op">.</span>a<span class="op">]];</span></span>
<span id="cb40-162"><a href="#cb40-162" aria-hidden="true" tabindex="-1"></a>            update<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> U<span class="op">,</span> Pl0<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb40-163"><a href="#cb40-163" aria-hidden="true" tabindex="-1"></a>            update<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> U<span class="op">,</span> Pl1<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb40-164"><a href="#cb40-164" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span> </span>
<span id="cb40-165"><a href="#cb40-165" aria-hidden="true" tabindex="-1"></a>            printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> query<span class="op">(</span>root<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> U<span class="op">,</span> now<span class="op">.</span>a<span class="op">));</span></span>
<span id="cb40-166"><a href="#cb40-166" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb40-167"><a href="#cb40-167" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-168"><a href="#cb40-168" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb40-169"><a href="#cb40-169" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="ÂÅöÊ≥ï‰∏âcdq-ÂàÜÊ≤ª">ÂÅöÊ≥ï‰∏âÔºöCDQ ÂàÜÊ≤ª</h4>
<p>Â≠¶‰∫ÜÂÜçËØ¥„ÄÇ</p>
<p>QAQ /kel</p>
                                    </div>

                                    <!-- Article Footer -->
                                    <div class="article-footer">
                                                                            
                                        <section class="post-history">
                                            <div class="history-header">
                                                <h2>üìö Version History</h2>
                                                <span class="history-desc">Source Code Change History</span>
                                            </div>
                                            <div class="version-list">
                                                
                                                    <div class="version-item">
                                                        <div class="version-header">
                                                            <span class="version-badge">v1</span>
                                                            <time class="version-time" datetime="2020-12-01 09:16:52">
                                                                üìÖ 2020-12-01 09:16:52
                                                            </time>
                                                        </div>
                                                        <div class="version-hash-container">
                                                            <span class="hash-label">üîó Source Hash:</span>
                                                            <code class="version-hash" title="Source Code Hash (122bdbf2c96c059dc61391e3b3045b878f7deaecb376950bc53a8ef1eadc229d)">122bdbf2c96c059dc61391e3b3045b878f7deaecb376950bc53a8ef1eadc229d</code>
                                                        </div>
                                                    </div>
                                                
                                            </div>
                                        </section>
                    

                    
                                            <details class="build-logs">
                                                <summary>Build Logs</summary>
                                                <pre class="logs-content">Build Log - Filtered
================================================

üìã Information:
‚Ä¢ Path information has been filtered for privacy protection
‚Ä¢ File names are preserved for debugging purposes  
‚Ä¢ All build status and error messages are kept intact

üîç Filter Rules:
‚Ä¢ /absolute/path/file.ext ‚Üí .../file.ext
‚Ä¢ /home/username ‚Üí .../[user]
‚Ä¢ /tmp/files ‚Üí .../[temp]
‚Ä¢ /usr/share/packages ‚Üí .../[system]

================================================

html log:
CMD: ['pandoc', '-s', 'cache/oi-blog_„ÄåÂ≠¶‰π†ÊÄªÁªì„ÄçÊ∏ÖÂåóÂ≠¶Â†Ç-ÂçÅËøûÊµã.md', '--filter', 'pandoc-crossref', '--filter', 'pandoc-katex', '--template=cache/pandoc_html_template.html', '-o', 'cache.../oi-blog_„ÄåÂ≠¶‰π†ÊÄªÁªì„ÄçÊ∏ÖÂåóÂ≠¶Â†Ç-ÂçÅËøûÊµã.md.html', '--metadata', '--verbose', '--highlight-style=tango']
STDOUT: 
STDERR: WARNING: pandoc-crossref was compiled with pandoc 3.6.2 but is being run through 3.6.4. This is not supported. Strange things may (and likely will) happen silently.

====================================================================================================
pdf log:
CMD: ['pandoc', '-s', 'cache.../379bd1829a.pdf.md', '-o', 'cache/379bd1829a.pdf', '-H', 'static/pandoc.header.tex', '--pdf-engine=xelatex', '--verbose']
STDOUT: 
STDERR: [INFO] Loaded static.../pandoc.header.tex from static.../pandoc.header.tex
[WARNING] Could not fetch resource /post_images/qbxt_Round0_C.png: /post_images/qbxt_Round0_C.png: withBinaryFile: does not exist (No such file or directory)
  Replacing image with description.
[INFO] Not rendering RawInline (Format "html") "<!-- more -->"
[INFO] Not rendering RawInline (Format "html") "<del>"
[INFO] Not rendering RawInline (Format "html") "</del>"
[INFO] Not rendering RawInline (Format "html") "<del>"
[INFO] Not rendering RawInline (Format "html") "</del>"
[INFO] Not rendering RawInline (Format "html") "<del>"
[INFO] Not rendering RawInline (Format "html") "</del>"
[INFO] [makePDF] Temp dir:
  .../[temp]
[INFO] [makePDF] Command line:
  xelatex "-halt-on-error" "-interaction" "nonstopmode" "-output-directory" ".../[temp] ".../[temp]
[INFO] [makePDF] Relevant environment variables:
  ("TEXINPUTS",".../[temp]
  ("TEXMFOUTPUT",".../[temp]
  ("SHELL","/bin/bash")
  ("PWD",".../[user]/projects/blog")
  ("HOME",".../[user]
  ("LANG","zh_CN.UTF-8")
  ("PATH",".../[user]/.local/bin:.../[user]/.cargo/bin:.../[user]/miniconda3/envs/myblog/bin:.../[user]/miniconda3/condabin:.../[temp]
[INFO] [makePDF] Source:
  % Options for packages loaded elsewhere
  \PassOptionsToPackage{unicode}{hyperref}
  \PassOptionsToPackage{hyphens}{url}
  \PassOptionsToPackage{space}{xeCJK}
  \documentclass[
  ]{article}
  \usepackage{xcolor}
  \usepackage[a4paper,margin=2cm]{geometry}
  \usepackage{amsmath,amssymb}
  \setcounter{secnumdepth}{-\maxdimen} % remove section numbering
  \usepackage{iftex}
  \ifPDFTeX
    \usepackage[T1]{fontenc}
    \usepackage[utf8]{inputenc}
    \usepackage{textcomp} % provide euro and other symbols
  \else % if luatex or xetex
    \usepackage{unicode-math} % this also loads fontspec
    \defaultfontfeatures{Scale=MatchLowercase}
    \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
  \fi
  \usepackage{lmodern}
  \ifPDFTeX\else
    % xetex/luatex font selection
    \setmainfont[]{Latin Modern Roman}
    \ifXeTeX
      \usepackage{xeCJK}
      \setCJKmainfont[]{AR PL UKai CN}
    \fi
    \ifLuaTeX
      \usepackage[]{luatexja-fontspec}
      \setmainjfont[]{AR PL UKai CN}
    \fi
  \fi
  % Use upquote if available, for straight quotes in verbatim environments
  \IfFileExists{upquote.sty}{\usepackage{upquote}}{}
  \IfFileExists{microtype.sty}{% use microtype if available
    \usepackage[]{microtype}
    \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
  }{}
  \usepackage{setspace}
  \makeatletter
  \@ifundefined{KOMAClassName}{% if non-KOMA class
    \IfFileExists{parskip.sty}{%
      \usepackage{parskip}
    }{% else
      \setlength{\parindent}{0pt}
      \setlength{\parskip}{6pt plus 2pt minus 1pt}}
  }{% if KOMA class
    \KOMAoptions{parskip=half}}
  \makeatother
  \usepackage{color}
  \usepackage{fancyvrb}
  \newcommand{\VerbBar}{|}
  \newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
  \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
  % Add ',fontsize=\small' for more characters per line
  \newenvironment{Shaded}{}{}
  \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
  \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
  \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.50,0.00}{#1}}
  \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{#1}}}
  \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
  \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
  \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{#1}}
  \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
  \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
  \newcommand{\ExtensionTok}[1]{#1}
  \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{#1}}
  \newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.50,0.00}{\textbf{#1}}}
  \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
  \newcommand{\NormalTok}[1]{#1}
  \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
  \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{#1}}
  \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
  \newcommand{\RegionMarkerTok}[1]{#1}
  \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
  \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
  \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \setlength{\emergencystretch}{3em} % prevent overfull lines
  \providecommand{\tightlist}{%
    \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
  % \usepackage{xeCJK}
  % \setCJKmainfont{AR PL UKai CN}
  % \usepackage{unicode-math}
  
  \setmathfont{Latin Modern Math}
  \usepackage{bookmark}
  \IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
  \urlstyle{same}
  \hypersetup{
    pdftitle={„ÄåÂ≠¶‰π†ÊÄªÁªì„ÄçÊ∏ÖÂåóÂ≠¶Â†Ç ÂçÅËøûÊµã},
    pdfauthor={Jiayi Su (ShuYuMo)},
    hidelinks,
    pdfcreator={LaTeX via pandoc}}
  
  \title{„ÄåÂ≠¶‰π†ÊÄªÁªì„ÄçÊ∏ÖÂåóÂ≠¶Â†Ç ÂçÅËøûÊµã}
  \author{Jiayi Su (ShuYuMo)}
  \date{2020-12-01 09:16:52}
  
  \begin{document}
  \maketitle
  
  \setstretch{1.3}
  ÊµéÂçó Ê∏ÖÂåóÂ≠¶Â†ÇÔºåNOIPËÄÉÂâçÂçÅËøûÊµãÔºåÈ¢òÁõÆÊï¥ÁêÜ„ÄÇ \# Ê∏ÖÂåóÂ≠¶Â†Ç 10 ËøûÊµã
  
  \subsection{Round 1}\label{round-1}
  
  \subsubsection{A. yist}\label{a.-yist}
  
  ÁªôÂá∫ \(n\) Ê±Ç \(n! \operatorname{mod} 2^{32}\)„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    A}\OperatorTok{[}\DecValTok{0}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,} \DecValTok{50}\OperatorTok{)}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]} \OperatorTok{*}\NormalTok{ i}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ T }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{T}\OperatorTok{{-}{-})\{}
          \DataTypeTok{int}\NormalTok{ x }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{x }\OperatorTok{\textless{}=} \DecValTok{50}\OperatorTok{)}\NormalTok{ printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%llu\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ A}\OperatorTok{[}\NormalTok{x}\OperatorTok{]);}
          \ControlFlowTok{else}\NormalTok{ puts}\OperatorTok{(}\StringTok{"0"}\OperatorTok{);}
      \OperatorTok{\}}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{B. ernd}\label{b.-ernd}
  
  Êúâ‰∏Ä‰∏™ \(n\times m\) ÁöÑÁΩëÊ†ºÔºåÁΩëÊ†º‰∏äÁöÑÊï∞Â≠óÈÉΩÂú® \([1,nm]\)
  ‰πãÈó¥‰∏î‰∏§‰∏§‰∏çÂêå„ÄÇ
  
  Êúâ‰∏™ÈôêÂà∂ÔºåÁõ¥ËßÇÊèèËø∞ÊòØ‰ΩçÁΩÆÂ∑¶„ÄÅ‰∏äÁöÑÊ†ºÂ≠êÂøÖÈ°ªÊØîÂè≥„ÄÅ‰∏ãÁöÑÊ†ºÂ≠êÂ∞èÔºåÁ≤æÁ°ÆÂú∞ËØ¥Ôºö\(A_{i,j} < A_{i+1,j},A_{i,j} < A_{i,j+1}\)
  ÂøÖÈ°ªÊàêÁ´ãÔºåÂ¶ÇÊûú‰∏çÁ≠âÂºè‰∏≠ÁöÑ‰∏§‰∏™‰ΩçÁΩÆÈÉΩÂú®ÁΩëÊ†ºÂÜÖÁöÑËØù„ÄÇ
  
  ‰Ω†ÊÉ≥Áü•ÈÅìÂØπ‰∫é‰∏Ä‰∏™ \(k\)ÔºåÊúâÂ§öÂ∞ë‰∏™Ê†ºÂ≠êÁöÑÂÄºÂèØ‰ª•ÊòØ
  \(k\)ÔºàÂç≥Â≠òÂú®‰∏ÄÁßçÁΩëÊ†ºÔºå‰ΩøÂæóÂÆÉÁöÑÂÄºÊòØ \(k\)Ôºâ„ÄÇ
  
  ËÄÉËôëÊØè‰∏™‰ΩçÁΩÆ \((i, j)\) ËÉΩÂ°´Âì™‰∫õÊï∞Â≠óÔºåËøô‰∏™‰ΩçÁΩÆÂà∞ \((1, 1)\)
  ÂΩ¢ÊàêÁöÑÁü©ÂΩ¢‰∏≠ÁöÑÂÄºÈÉΩË¶ÅÂ§ß‰∫é \((i, j)\) ÁöÑÂÄºÔºåËøô‰∏™‰ΩçÁΩÆÂà∞ \(n, m\) ÂêåÁêÜ„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ ans}\OperatorTok{[}\NormalTok{\_T}\OperatorTok{],}\NormalTok{ C}\OperatorTok{[}\NormalTok{\_T}\OperatorTok{];}
  \DataTypeTok{void}\NormalTok{ work}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ n}\OperatorTok{,} \DataTypeTok{int}\NormalTok{  m}\OperatorTok{)\{}
  \NormalTok{    memset}\OperatorTok{(}\NormalTok{C}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{C}\OperatorTok{));}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ m}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ L }\OperatorTok{=}\NormalTok{ i }\OperatorTok{*}\NormalTok{ j}\OperatorTok{,}\NormalTok{ R }\OperatorTok{=}\NormalTok{ n }\OperatorTok{*}\NormalTok{ m }\OperatorTok{{-}} \OperatorTok{((}\NormalTok{n }\OperatorTok{{-}}\NormalTok{ i }\OperatorTok{+} \DecValTok{1}\OperatorTok{)} \OperatorTok{*} \OperatorTok{(}\NormalTok{m }\OperatorTok{{-}}\NormalTok{ j }\OperatorTok{+} \DecValTok{1}\OperatorTok{)} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{);}
  \NormalTok{        C}\OperatorTok{[}\NormalTok{L}\OperatorTok{]++;}\NormalTok{ C}\OperatorTok{[}\NormalTok{R }\OperatorTok{+} \DecValTok{1}\OperatorTok{]{-}{-};}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ now }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n }\OperatorTok{*}\NormalTok{ m}\OperatorTok{)}\NormalTok{ now }\OperatorTok{+=}\NormalTok{ C}\OperatorTok{[}\NormalTok{i}\OperatorTok{],}\NormalTok{ ans}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ now}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ q }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{q}\OperatorTok{{-}{-})}\NormalTok{ printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{[}\NormalTok{read}\OperatorTok{()]);}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{C. sanrd}\label{c.-sanrd}
  
  Â∞èYÊúâ‰∏Ä‰∏™ÊéíÂàó \(P_{1..n}\)Ôºå‰Ωú‰∏∫Âº∫Ëø´ÁóáÊÇ£ËÄÖÔºåÂ•πÊÉ≥Ë¶ÅÊääÊéíÂàóÊéíÂ•ΩÂ∫è„ÄÇÂÖ±Êúâ 3
  ÁßçÊìç‰Ωú„ÄÇ
  
  Ëä±Ë¥π \(a\) ÁöÑ‰ª£‰ª∑‰∫§Êç¢Áõ∏ÈÇª‰∏§‰∏™Êï∞„ÄÇ
  
  Ëä±Ë¥π \(b\) ÁöÑ‰ª£‰ª∑ÁøªËΩ¨Êï¥‰∏™ÊéíÂàó„ÄÇ
  
  Ëä±Ë¥π \(c\) ÁöÑ‰ª£‰ª∑Êâì‰π±Êï¥‰∏™ÊéíÂàóÔºåÊñ∞ÊéíÂàóÈöèÊú∫ÁîüÊàê„ÄÇ
  
  Â∞èYÈúÄË¶ÅÁü•ÈÅìÔºåÂú®ÊúÄ‰ºòÁ≠ñÁï•‰∏ãÔºåÂ•πÈúÄË¶ÅËä±Ë¥πÂ§öÂ§ßÁöÑ‰ª£‰ª∑Âë¢Ôºü
  
  ÊúÄ‰ºòÁöÑÊìç‰ΩúÔºåÊòæÁÑ∂ÊòØÂÖàÊâì‰π±ÊéíÂàóÔºàÂ¶ÇÊûúÊúâÔºâÔºåÂÜçÁøªËΩ¨ÊéíÂàóÔºàÂ¶ÇÊûúÊúâÔºâÔºåÊúÄÂêé‰∫§Êç¢Áõ∏ÈÇª‰∏§‰∏™Êï∞ÔºàÂ¶ÇÊûúÊúâÔºâ„ÄÇ
  
  \paragraph{Âá†‰∏™‰∫ãÂÆû}\label{ux51e0ux4e2aux4e8bux5b9e}
  
  \begin{itemize}
  \tightlist
  \item
    \(A_i > A_j, i + 1 = j\) ÊòØ‰∫§Êç¢Áõ∏ÈÇª‰∏§‰∏™Êï∞Â≠óÁöÑÂøÖË¶ÅÊù°‰ª∂„ÄÇ
  \item
    ÊâßË°å‰∏ÄÊ¨°‰∫§Êç¢Êìç‰ΩúÈÄÜÂ∫èÂØπÊï∞Èáè‰ºöÂáèÂ∞ë‰∏î‰ªÖÂáèÂ∞ë‰∏Ä„ÄÇ
  \item
    Á≠îÊ°àÂè™‰∏éÈÄÜÂ∫èÂØπÊï∞ÈáèÊúâÂÖ≥„ÄÇ
  \item
    Êâì‰π±ÂêéÈöèÊú∫ÁîüÊàêÁöÑ‰ª£‰ª∑Â∞±ÊòØ \(c\) + ÈïøÂ∫¶‰∏∫ \(n\)
    ÁöÑÊâÄÊúâÊéíÂàóÊéíÂ•Ω‰ª£‰ª∑ÁöÑÂπ≥ÂùáÂÄº„ÄÇÂè™Ë¶Å‰ΩøÁî®ÊúÄÂêé‰∏ÄÁßçÊìç‰ΩúÔºåÈÇ£‰πà‰ªñ‰ª¨ÁöÑÁ≠îÊ°à‰∏ÄÂÆöÁõ∏Âêå„ÄÇ
  \end{itemize}
  
  ËÆæÊéíÂàó \([P]\) ÁöÑÈÄÜÂ∫èÂØπÊï∞‰∏∫ \(x\) ÔºåÂ¶ÇÊûúÂè™‰ΩøÁî®Ââç‰∏§ÁßçÊìç‰ΩúÔºå ‰ª£‰ª∑Â∞±ÊòØ
  \(\operatorname{min}\{\left(\frac{n(n - 1)}{2} - x\right) \times a + b, x \times a\}\)„ÄÇ
  Êää \([p]\)
  ÁöÑÊâÄÊúâÊéíÂàóÊåâÁÖßÂè™Áî®Ââç‰∏§ÁßçÊìç‰ΩúÁöÑËä±Ë¥πÊéíÂ•ΩÂ∫èÔºåÈÇ£‰πàÂèØËÉΩ‰ΩøÁî®ÊúÄÂêé‰∏ÄÁßçÊìç‰ΩúÁöÑ‰∏ÄÂÆöÊòØ‰∏ÄÊÆµÂêéÁºÄ„ÄÇ
  
  ‰ª• \([p]\) ÁöÑÊâÄÊúâÊéíÂàóÊåâÁÖßÂè™Áî®Ââç‰∏§ÁßçÊìç‰ΩúÁöÑËä±Ë¥πÊéíÂ•ΩÂ∫èÁöÑ‰∏ãÊ†á‰∏∫ \(x\)
  ËΩ¥Ôºå‰ª£‰ª∑‰∏∫ \(y\) ËΩ¥ÔºåÈÇ£‰πàÂè™Áî®Ââç‰∏§ÁßçÊìç‰ΩúÂ∞±ÊòØÁªøËâ≤ÁöÑÂõæÂÉè„ÄÇ
  Â¶ÇÊûúÂØπÊüê‰∫õÊéíÂàó‰ΩøÁî®Á¨¨‰∏âÁßçÊìç‰ΩúÔºåÂèØ‰ª•Áî®Ê©ôËâ≤ÁöÑÂõæÂÉèË°®Á§∫„ÄÇ {Round0\_C.png}
  ÂÖ∂‰∏≠Ë¢´ÂáΩÊï∞ÂÄºÂéãÂπ≥ÁöÑÈÉ®ÂàÜÂ∞±ÊòØ \(c\) + ÊâÄÊúâÊéíÂàó‰ª£‰ª∑ÁöÑÂπ≥ÂùáÂÄº„ÄÇ
  Êûö‰∏æÊòØÂ§öÈïøÁöÑÂêéÁºÄË¢´ÂéãÂπ≥Ôºà‰ΩøÁî®Á¨¨‰∏âÁßçÊìç‰ΩúÔºâ„ÄÇÁÑ∂ÂêéËß£ÊñπÁ®ãËß£Âá∫ÂáΩÊï∞ÂÄºÂπ≥ÂùáÂÄºÔºåÈÄâÂèñÊúÄÂ∞èÁöÑÂπ≥ÂùáÂÄºÂç≥ÂèØ„ÄÇ
  
  Â¶ÇÊûúÊéíÂàóÊï∞ÊØîËæÉÂ§öÔºåÊó†Ê≥ï‰∏Ä‰∏™‰∏Ä‰∏™ÁöÑÁÆóÂá∫Êù•ÔºåÂèØ‰ª•ÈÄöËøá dp Ê±ÇÂá∫ÈïøÂ∫¶‰∏∫ \(n\)
  ÁöÑÊéíÂàóÔºåÈÄÜÂ∫èÂØπ‰∏™Êï∞‰∏∫ \(k\)
  ÁöÑÊéíÂàóÊï∞„ÄÇÂèØ‰ª•Ê≥®ÊÑèÂà∞ÔºåÈÄÜÂ∫èÂØπÊï∞Áõ∏ÂêåÁöÑÊéíÂàóÔºåÁ≠îÊ°à‰∏ÄÂÆöÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂèØ‰ª•ÊääÈÄÜÂ∫èÂØπÊòØÁõ∏ÂêåÁöÑÊéíÂàóÊçÜÁªëËÆ°ÁÆóÔºåÈÄÜÂ∫èÂØπÊï∞‰∏ÄÂÖ±Êúâ
  \(\frac{n \times (n - 1)}{2} + 1\) ÁßçÂèñÂÄº„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \PreprocessorTok{\#include }\ImportTok{\textless{}cstdio\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}cstring\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}cmath\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}iostream\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}cmath\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}algorithm\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}climits\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}assert.h\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}vector\textgreater{}}
  \PreprocessorTok{\#define LL }\DataTypeTok{long}\PreprocessorTok{ }\DataTypeTok{long}\PreprocessorTok{ }
  \PreprocessorTok{\#define int }\DataTypeTok{long}\PreprocessorTok{ }\DataTypeTok{long}\PreprocessorTok{ }
  \PreprocessorTok{\#define rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{l}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{r}\OperatorTok{)}\PreprocessorTok{ }\ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{l}\OperatorTok{),}\PreprocessorTok{ }\NormalTok{\_\_\_}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{r}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{\textless{}=}\PreprocessorTok{ }\NormalTok{\_\_\_}\OperatorTok{;}\PreprocessorTok{ }\NormalTok{i}\OperatorTok{++)}
  \PreprocessorTok{\#define per}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{l}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{r}\OperatorTok{)}\PreprocessorTok{ }\ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{r}\OperatorTok{),}\PreprocessorTok{ }\NormalTok{\_\_\_}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{l}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{\textgreater{}=}\PreprocessorTok{ }\NormalTok{\_\_\_}\OperatorTok{;}\PreprocessorTok{ }\NormalTok{i}\OperatorTok{{-}{-})}
  \KeywordTok{using} \KeywordTok{namespace}\NormalTok{ std}\OperatorTok{;}
  \KeywordTok{struct} \DataTypeTok{Read\_t}\OperatorTok{\{}
      \KeywordTok{template}\OperatorTok{\textless{}}\KeywordTok{typename}\NormalTok{ T}\OperatorTok{\textgreater{}} \AttributeTok{const} \DataTypeTok{Read\_t} \OperatorTok{\&} \KeywordTok{operator}\OperatorTok{()} \OperatorTok{(}\NormalTok{ T }\OperatorTok{\&}\NormalTok{ target }\OperatorTok{)} \AttributeTok{const} \OperatorTok{\{}
  \NormalTok{        T x }\OperatorTok{=} \DecValTok{0}\OperatorTok{;} \DataTypeTok{int}\NormalTok{ sign }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} \DataTypeTok{char}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();}
          \ControlFlowTok{while}\OperatorTok{(}\NormalTok{c }\OperatorTok{\textless{}} \CharTok{\textquotesingle{}0\textquotesingle{}} \OperatorTok{||}\NormalTok{ c }\OperatorTok{\textgreater{}} \CharTok{\textquotesingle{}9\textquotesingle{}}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{c }\OperatorTok{==} \CharTok{\textquotesingle{}{-}\textquotesingle{}}\OperatorTok{)}\NormalTok{ sign }\OperatorTok{=} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{;}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();} \OperatorTok{\}}
          \ControlFlowTok{while}\OperatorTok{(}\NormalTok{c }\OperatorTok{\textless{}=} \CharTok{\textquotesingle{}9\textquotesingle{}} \OperatorTok{\&\&}\NormalTok{ c }\OperatorTok{\textgreater{}=} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ x }\OperatorTok{=} \OperatorTok{(}\NormalTok{x }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{)} \OperatorTok{+} \OperatorTok{(}\NormalTok{x }\OperatorTok{\textless{}\textless{}} \DecValTok{3}\OperatorTok{);}\NormalTok{ x }\OperatorTok{+=}\NormalTok{ c }\OperatorTok{{-}} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{;}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();} \OperatorTok{\}}
  \NormalTok{        target }\OperatorTok{=}\NormalTok{ x }\OperatorTok{*}\NormalTok{ sign}\OperatorTok{;} \ControlFlowTok{return} \OperatorTok{*}\KeywordTok{this}\OperatorTok{;}
      \OperatorTok{\}} 
  \OperatorTok{\}}\NormalTok{ Read}\OperatorTok{;}
  \PreprocessorTok{\#warning dont forget enable int\_64}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_N }\OperatorTok{=} \DecValTok{500}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_S }\OperatorTok{=} \DecValTok{500}\OperatorTok{;}
  \NormalTok{LL gcd}\OperatorTok{(}\NormalTok{LL a}\OperatorTok{,}\NormalTok{ LL b}\OperatorTok{)\{} \ControlFlowTok{return}\NormalTok{ b }\OperatorTok{==} \DecValTok{0} \OperatorTok{?}\NormalTok{ a }\OperatorTok{:}\NormalTok{ gcd}\OperatorTok{(}\NormalTok{b}\OperatorTok{,}\NormalTok{  a }\OperatorTok{\%}\NormalTok{ b}\OperatorTok{);} \OperatorTok{\}}
  \NormalTok{LL dp}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{][}\NormalTok{\_S}\OperatorTok{];}
  \NormalTok{LL n}\OperatorTok{,}\NormalTok{ a}\OperatorTok{,}\NormalTok{ b}\OperatorTok{,}\NormalTok{ c}\OperatorTok{,}\NormalTok{ d}\OperatorTok{;} 
  \PreprocessorTok{\#define pb }\NormalTok{push\_back}
  \PreprocessorTok{\#define mp }\NormalTok{make\_pair}
  \PreprocessorTok{\#define fi }\NormalTok{first}
  \PreprocessorTok{\#define se }\NormalTok{second}
  \NormalTok{pair}\OperatorTok{\textless{}}\NormalTok{LL}\OperatorTok{,}\NormalTok{ LL}\OperatorTok{\textgreater{}}\NormalTok{ Val}\OperatorTok{[}\NormalTok{\_S}\OperatorTok{];}
  \DataTypeTok{bool} \KeywordTok{operator} \OperatorTok{\textgreater{}} \OperatorTok{(}\NormalTok{pair}\OperatorTok{\textless{}}\NormalTok{LL}\OperatorTok{,}\NormalTok{ LL}\OperatorTok{\textgreater{}}\NormalTok{ A}\OperatorTok{,}\NormalTok{ pair}\OperatorTok{\textless{}}\NormalTok{LL}\OperatorTok{,}\NormalTok{ LL}\OperatorTok{\textgreater{}}\NormalTok{ B}\OperatorTok{)\{} \ControlFlowTok{return} \OperatorTok{(}\NormalTok{A}\OperatorTok{.}\NormalTok{fi }\OperatorTok{*}\NormalTok{ B}\OperatorTok{.}\NormalTok{se }\OperatorTok{\textgreater{}}\NormalTok{ A}\OperatorTok{.}\NormalTok{se }\OperatorTok{*}\NormalTok{ B}\OperatorTok{.}\NormalTok{fi}\OperatorTok{);} \OperatorTok{\}}
  \NormalTok{LL A}\OperatorTok{[}\NormalTok{\_S}\OperatorTok{];}
  \DataTypeTok{void}\NormalTok{ doit}\OperatorTok{()\{}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{a}\OperatorTok{)(}\NormalTok{b}\OperatorTok{)(}\NormalTok{c}\OperatorTok{)(}\NormalTok{d}\OperatorTok{);}\NormalTok{ vector}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\NormalTok{LL}\OperatorTok{,}\NormalTok{ LL}\OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}}\NormalTok{ V}\OperatorTok{;}\NormalTok{ V}\OperatorTok{.}\NormalTok{clear}\OperatorTok{();} 
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \OperatorTok{(}\NormalTok{n}\OperatorTok{)} \OperatorTok{*} \OperatorTok{(}\NormalTok{n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)} \OperatorTok{/} \DecValTok{2}\OperatorTok{)}\NormalTok{ V}\OperatorTok{.}\NormalTok{pb}\OperatorTok{(}\NormalTok{mp}\OperatorTok{(}\NormalTok{min}\OperatorTok{(}\NormalTok{i }\OperatorTok{*}\NormalTok{ a}\OperatorTok{,} \OperatorTok{((}\NormalTok{n }\OperatorTok{*} \OperatorTok{(}\NormalTok{n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)} \OperatorTok{/} \DecValTok{2}\OperatorTok{)} \OperatorTok{{-}}\NormalTok{ i}\OperatorTok{)} \OperatorTok{*}\NormalTok{ a }\OperatorTok{+}\NormalTok{ b}\OperatorTok{),}\NormalTok{ dp}\OperatorTok{[}\NormalTok{n}\OperatorTok{][}\NormalTok{i}\OperatorTok{]));}
  \NormalTok{    sort}\OperatorTok{(}\NormalTok{V}\OperatorTok{.}\NormalTok{begin}\OperatorTok{(),}\NormalTok{ V}\OperatorTok{.}\NormalTok{end}\OperatorTok{());}
      \DataTypeTok{int}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{L}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ V}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ R }\OperatorTok{=}\NormalTok{ L}\OperatorTok{;} \ControlFlowTok{while}\OperatorTok{(}\NormalTok{V}\OperatorTok{[}\NormalTok{R }\OperatorTok{+} \DecValTok{1}\OperatorTok{].}\NormalTok{fi }\OperatorTok{==}\NormalTok{ V}\OperatorTok{[}\NormalTok{L}\OperatorTok{].}\NormalTok{fi }\OperatorTok{\&\&}\NormalTok{ R }\OperatorTok{+} \DecValTok{1} \OperatorTok{\textless{}=} \OperatorTok{(}\DataTypeTok{int}\OperatorTok{)(}\NormalTok{V}\OperatorTok{.}\NormalTok{size}\OperatorTok{())} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{)}\NormalTok{ R}\OperatorTok{++;}\NormalTok{ LL sum }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{)}\NormalTok{ sum }\OperatorTok{+=}\NormalTok{ V}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{se}\OperatorTok{;}
  
  \NormalTok{        V}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{fi }\OperatorTok{=}\NormalTok{ V}\OperatorTok{[}\NormalTok{L}\OperatorTok{].}\NormalTok{fi}\OperatorTok{;}\NormalTok{ V}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{se }\OperatorTok{=}\NormalTok{ sum}\OperatorTok{;}
  \NormalTok{        tot}\OperatorTok{++;}
  \NormalTok{        L }\OperatorTok{=}\NormalTok{ R}\OperatorTok{;}
      \OperatorTok{\}}\NormalTok{ LL S }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ tot }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)}\NormalTok{ S }\OperatorTok{+=}\NormalTok{ V}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{se}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ tot }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)\{}
  \NormalTok{        LL cnt }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,}\NormalTok{ i}\OperatorTok{,}\NormalTok{ tot }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)}\NormalTok{ cnt }\OperatorTok{+=}\NormalTok{ V}\OperatorTok{[}\NormalTok{j}\OperatorTok{].}\NormalTok{se}\OperatorTok{;}
  \NormalTok{        LL A }\OperatorTok{=}\NormalTok{ cnt }\OperatorTok{*}\NormalTok{ c}\OperatorTok{;}\NormalTok{  rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)}\NormalTok{ A }\OperatorTok{+=}\NormalTok{ V}\OperatorTok{[}\NormalTok{j}\OperatorTok{].}\NormalTok{fi }\OperatorTok{*}\NormalTok{ V}\OperatorTok{[}\NormalTok{j}\OperatorTok{].}\NormalTok{se}\OperatorTok{;}
  \NormalTok{        LL B }\OperatorTok{=}\NormalTok{ S }\OperatorTok{{-}}\NormalTok{ cnt}\OperatorTok{;}
  \NormalTok{        LL g }\OperatorTok{=}\NormalTok{ gcd}\OperatorTok{(}\NormalTok{A}\OperatorTok{,}\NormalTok{ B}\OperatorTok{);}\NormalTok{ Val}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ mp}\OperatorTok{(}\NormalTok{A }\OperatorTok{/}\NormalTok{ g}\OperatorTok{,}\NormalTok{ B }\OperatorTok{/}\NormalTok{ g}\OperatorTok{);}
      \OperatorTok{\}}
      
      \DataTypeTok{int}\NormalTok{ Mid }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ tot }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{Val}\OperatorTok{[}\NormalTok{Mid}\OperatorTok{]} \OperatorTok{\textgreater{}}\NormalTok{ Val}\OperatorTok{[}\NormalTok{i}\OperatorTok{])}\NormalTok{ Mid }\OperatorTok{=}\NormalTok{ i}\OperatorTok{;}
  \NormalTok{    pair}\OperatorTok{\textless{}}\NormalTok{LL}\OperatorTok{,}\NormalTok{ LL}\OperatorTok{\textgreater{}}\NormalTok{ MAns }\OperatorTok{=}\NormalTok{ Val}\OperatorTok{[}\NormalTok{Mid}\OperatorTok{];}\NormalTok{ MAns}\OperatorTok{.}\NormalTok{fi }\OperatorTok{+=}\NormalTok{ MAns}\OperatorTok{.}\NormalTok{se }\OperatorTok{*}\NormalTok{ c}\OperatorTok{;}\NormalTok{ LL g }\OperatorTok{=}\NormalTok{ gcd}\OperatorTok{(}\NormalTok{MAns}\OperatorTok{.}\NormalTok{fi}\OperatorTok{,}\NormalTok{ MAns}\OperatorTok{.}\NormalTok{se}\OperatorTok{);}\NormalTok{ MAns}\OperatorTok{.}\NormalTok{fi }\OperatorTok{/=}\NormalTok{ g}\OperatorTok{;}\NormalTok{ MAns}\OperatorTok{.}\NormalTok{se }\OperatorTok{/=}\NormalTok{ g}\OperatorTok{;}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{d}\OperatorTok{{-}{-})\{}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ Read}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
  \NormalTok{        LL ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,}\NormalTok{ i }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{+=} \OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{\textgreater{}}\NormalTok{ A}\OperatorTok{[}\NormalTok{j}\OperatorTok{]);}
  \NormalTok{        ans }\OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{ans }\OperatorTok{*}\NormalTok{ a}\OperatorTok{,}\NormalTok{ b }\OperatorTok{+}\NormalTok{ a }\OperatorTok{*} \OperatorTok{((}\NormalTok{n }\OperatorTok{*} \OperatorTok{(}\NormalTok{n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)} \OperatorTok{/} \DecValTok{2}\OperatorTok{)} \OperatorTok{{-}}\NormalTok{ ans}\OperatorTok{));}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{ans }\OperatorTok{*}\NormalTok{ MAns}\OperatorTok{.}\NormalTok{se }\OperatorTok{\textless{}}\NormalTok{ MAns}\OperatorTok{.}\NormalTok{fi}\OperatorTok{)}\NormalTok{ printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld}\StringTok{/1}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}
          \ControlFlowTok{else}\NormalTok{ printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld}\StringTok{/}\SpecialCharTok{\%lld\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ MAns}\OperatorTok{.}\NormalTok{fi}\OperatorTok{,}\NormalTok{ MAns}\OperatorTok{.}\NormalTok{se}\OperatorTok{);} \OtherTok{assert}\OperatorTok{(}\NormalTok{MAns}\OperatorTok{.}\NormalTok{fi }\OperatorTok{\textgreater{}} \DecValTok{0}\OperatorTok{);}  \OtherTok{assert}\OperatorTok{(}\NormalTok{MAns}\OperatorTok{.}\NormalTok{se }\OperatorTok{\textgreater{}} \DecValTok{0}\OperatorTok{);} 
      \OperatorTok{\}}
  \OperatorTok{\}}
  \DataTypeTok{void}\NormalTok{ Init}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ n}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{    dp}\OperatorTok{[}\DecValTok{1}\OperatorTok{][}\DecValTok{0}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{2}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \OperatorTok{((}\NormalTok{i}\OperatorTok{)} \OperatorTok{*} \OperatorTok{(}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{))} \OperatorTok{/} \DecValTok{2}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{            LL }\OperatorTok{\&}\NormalTok{ans }\OperatorTok{=}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{            rep}\OperatorTok{(}\NormalTok{k}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ min}\OperatorTok{(}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{,}\NormalTok{ j}\OperatorTok{))}\NormalTok{ ans }\OperatorTok{+=}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{j }\OperatorTok{{-}}\NormalTok{ k}\OperatorTok{];}
          \OperatorTok{\}}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \DataTypeTok{signed}\NormalTok{ main}\OperatorTok{()\{}\NormalTok{ freopen}\OperatorTok{(}\StringTok{"in.txt"}\OperatorTok{,} \StringTok{"r"}\OperatorTok{,}\NormalTok{ stdin}\OperatorTok{);}
  \NormalTok{    Init}\OperatorTok{(}\DecValTok{17}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ T}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{T}\OperatorTok{);}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{T}\OperatorTok{{-}{-})}\NormalTok{ doit}\OperatorTok{();}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \PreprocessorTok{\#include }\ImportTok{\textless{}bits/stdc++.h\textgreater{}}
  \PreprocessorTok{\#define fi }\NormalTok{first}
  \PreprocessorTok{\#define se }\NormalTok{second}
  \PreprocessorTok{\#define pb }\NormalTok{push\_back}
  \PreprocessorTok{\#define mp }\NormalTok{make\_pair}
  \PreprocessorTok{\#define SZ}\OperatorTok{(}\NormalTok{x}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{((}\DataTypeTok{int}\OperatorTok{)}\NormalTok{x}\OperatorTok{.}\NormalTok{size}\OperatorTok{())}
  \PreprocessorTok{\#define ALL}\OperatorTok{(}\NormalTok{x}\OperatorTok{)}\PreprocessorTok{ }\NormalTok{x}\OperatorTok{.}\NormalTok{begin}\OperatorTok{(),}\PreprocessorTok{ }\NormalTok{x}\OperatorTok{.}\NormalTok{end}\OperatorTok{()}
  \PreprocessorTok{\#define L}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{u}\OperatorTok{)}\PreprocessorTok{ }\ControlFlowTok{for}\PreprocessorTok{ }\OperatorTok{(}\AttributeTok{register}\PreprocessorTok{ }\DataTypeTok{int}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{head}\OperatorTok{[}\NormalTok{u}\OperatorTok{];}\PreprocessorTok{ }\NormalTok{i}\OperatorTok{;}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{nxt}\OperatorTok{[}\NormalTok{i}\OperatorTok{])}
  \PreprocessorTok{\#define rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{a}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{b}\OperatorTok{)}\PreprocessorTok{ }\ControlFlowTok{for}\PreprocessorTok{ }\OperatorTok{(}\AttributeTok{register}\PreprocessorTok{ }\DataTypeTok{int}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{a}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{\textless{}=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{b}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\OperatorTok{++)}
  \PreprocessorTok{\#define per}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{a}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{b}\OperatorTok{)}\PreprocessorTok{ }\ControlFlowTok{for}\PreprocessorTok{ }\OperatorTok{(}\AttributeTok{register}\PreprocessorTok{ }\DataTypeTok{int}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{a}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{\textgreater{}=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{b}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\OperatorTok{{-}{-})}
  \KeywordTok{using} \KeywordTok{namespace}\NormalTok{ std}\OperatorTok{;}
  \KeywordTok{typedef} \DataTypeTok{long} \DataTypeTok{double}\NormalTok{ ld}\OperatorTok{;}
  \KeywordTok{typedef} \DataTypeTok{long} \DataTypeTok{long}\NormalTok{ ll}\OperatorTok{;}
  \KeywordTok{typedef} \DataTypeTok{unsigned} \DataTypeTok{int}\NormalTok{ ui}\OperatorTok{;}
  \KeywordTok{typedef}\NormalTok{ pair}\OperatorTok{\textless{}}\NormalTok{ll}\OperatorTok{,}\NormalTok{ ll}\OperatorTok{\textgreater{}}\NormalTok{ Pll}\OperatorTok{;}
  \KeywordTok{typedef}\NormalTok{ vector}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ Vi}\OperatorTok{;}
  \KeywordTok{template} \OperatorTok{\textless{}}\KeywordTok{class}\NormalTok{ T}\OperatorTok{\textgreater{}}
  \KeywordTok{inline} \DataTypeTok{void}\NormalTok{ read}\OperatorTok{(}\NormalTok{T }\OperatorTok{\&}\NormalTok{x}\OperatorTok{)\{}\NormalTok{x }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\DataTypeTok{char}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();}\DataTypeTok{int}\NormalTok{ f }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} \ControlFlowTok{while} \OperatorTok{(!}\NormalTok{isdigit}\OperatorTok{(}\NormalTok{c}\OperatorTok{))} \OperatorTok{\{} \ControlFlowTok{if} \OperatorTok{(}\NormalTok{c }\OperatorTok{==} \CharTok{\textquotesingle{}{-}\textquotesingle{}}\OperatorTok{)}\NormalTok{ f }\OperatorTok{=} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{;}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();} \OperatorTok{\}} \ControlFlowTok{while} \OperatorTok{(}\NormalTok{isdigit}\OperatorTok{(}\NormalTok{c}\OperatorTok{))} \OperatorTok{\{}\NormalTok{ x }\OperatorTok{=}\NormalTok{ x }\OperatorTok{*} \DecValTok{10} \OperatorTok{+}\NormalTok{ c }\OperatorTok{{-}} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{;}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();} \OperatorTok{\}}\NormalTok{ x }\OperatorTok{*=}\NormalTok{ f}\OperatorTok{;} \OperatorTok{\}}
  \KeywordTok{template} \OperatorTok{\textless{}}\KeywordTok{class}\NormalTok{ T}\OperatorTok{\textgreater{}}
  \NormalTok{T gcd}\OperatorTok{(}\NormalTok{T a}\OperatorTok{,}\NormalTok{ T b}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return} \OperatorTok{!}\NormalTok{b }\OperatorTok{?}\NormalTok{ a }\OperatorTok{:}\NormalTok{ gcd}\OperatorTok{(}\NormalTok{b}\OperatorTok{,}\NormalTok{ a }\OperatorTok{\%}\NormalTok{ b}\OperatorTok{);} \OperatorTok{\}}
  \KeywordTok{template} \OperatorTok{\textless{}}\KeywordTok{class}\NormalTok{ T}\OperatorTok{\textgreater{}}
  \KeywordTok{inline} \DataTypeTok{void}\NormalTok{ umin}\OperatorTok{(}\NormalTok{T }\OperatorTok{\&}\NormalTok{x}\OperatorTok{,}\NormalTok{ T y}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ x }\OperatorTok{=}\NormalTok{ x }\OperatorTok{\textless{}}\NormalTok{ y }\OperatorTok{?}\NormalTok{ x }\OperatorTok{:}\NormalTok{ y}\OperatorTok{;} \OperatorTok{\}}
  \KeywordTok{template} \OperatorTok{\textless{}}\KeywordTok{class}\NormalTok{ T}\OperatorTok{\textgreater{}}
  \KeywordTok{inline} \DataTypeTok{void}\NormalTok{ umax}\OperatorTok{(}\NormalTok{T }\OperatorTok{\&}\NormalTok{x}\OperatorTok{,}\NormalTok{ T y}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ x }\OperatorTok{=}\NormalTok{ x }\OperatorTok{\textgreater{}}\NormalTok{ y }\OperatorTok{?}\NormalTok{ x }\OperatorTok{:}\NormalTok{ y}\OperatorTok{;} \OperatorTok{\}}
  \NormalTok{ll dp}\OperatorTok{[}\DecValTok{1} \OperatorTok{\textless{}\textless{}} \DecValTok{16} \OperatorTok{|} \DecValTok{3}\OperatorTok{][}\DecValTok{141}\OperatorTok{];}
  \KeywordTok{struct}\NormalTok{ Yzr}
  \OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ n}\OperatorTok{;}
  \NormalTok{    ll gs}\OperatorTok{[}\DecValTok{141}\OperatorTok{];}
      \DataTypeTok{void}\NormalTok{ ini}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ nn}\OperatorTok{)}
      \OperatorTok{\{}
  \NormalTok{        n }\OperatorTok{=}\NormalTok{ nn}\OperatorTok{;}
  \NormalTok{        memset}\OperatorTok{(}\NormalTok{dp}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{dp}\OperatorTok{));}
  \NormalTok{        dp}\OperatorTok{[}\DecValTok{0}\OperatorTok{][}\DecValTok{0}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{s}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \OperatorTok{(}\DecValTok{1} \OperatorTok{\textless{}\textless{}}\NormalTok{ n}\OperatorTok{)} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)} \ControlFlowTok{if} \OperatorTok{(\textasciitilde{}}\NormalTok{s }\OperatorTok{\textgreater{}\textgreater{}}\NormalTok{ i }\OperatorTok{{-}} \DecValTok{1} \OperatorTok{\&} \DecValTok{1}\OperatorTok{)}
          \OperatorTok{\{}
              \DataTypeTok{int}\NormalTok{ del }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ cnt }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{            rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,}\NormalTok{ i }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ del }\OperatorTok{+=}\NormalTok{ s }\OperatorTok{\textgreater{}\textgreater{}}\NormalTok{ j }\OperatorTok{{-}} \DecValTok{1} \OperatorTok{\&} \DecValTok{1}\OperatorTok{;}
  \NormalTok{            rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ cnt }\OperatorTok{+=}\NormalTok{ s }\OperatorTok{\textgreater{}\textgreater{}}\NormalTok{ j }\OperatorTok{{-}} \DecValTok{1} \OperatorTok{\&} \DecValTok{1}\OperatorTok{;}
  \NormalTok{            rep}\OperatorTok{(}\NormalTok{k}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ cnt }\OperatorTok{*} \OperatorTok{(}\NormalTok{cnt }\OperatorTok{+} \DecValTok{1}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{)}\NormalTok{ dp}\OperatorTok{[}\NormalTok{s }\OperatorTok{|} \DecValTok{1} \OperatorTok{\textless{}\textless{}}\NormalTok{ i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{k }\OperatorTok{+}\NormalTok{ del}\OperatorTok{]} \OperatorTok{+=}\NormalTok{ dp}\OperatorTok{[}\NormalTok{s}\OperatorTok{][}\NormalTok{k}\OperatorTok{];}
          \OperatorTok{\}}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{k}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ n }\OperatorTok{*} \OperatorTok{(}\NormalTok{n }\OperatorTok{+} \DecValTok{1}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{)}\NormalTok{ gs}\OperatorTok{[}\NormalTok{k}\OperatorTok{]} \OperatorTok{=}\NormalTok{ dp}\OperatorTok{[(}\DecValTok{1} \OperatorTok{\textless{}\textless{}}\NormalTok{ n}\OperatorTok{)} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{k}\OperatorTok{];}
      \OperatorTok{\}}
  \OperatorTok{\}}\NormalTok{ yzr}\OperatorTok{[}\DecValTok{17}\OperatorTok{];}
  \DataTypeTok{bool}\NormalTok{ cmp}\OperatorTok{(}\NormalTok{Pll a}\OperatorTok{,}\NormalTok{ Pll b}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return} \OperatorTok{(}\NormalTok{ld}\OperatorTok{)}\NormalTok{a}\OperatorTok{.}\NormalTok{fi }\OperatorTok{/}\NormalTok{ a}\OperatorTok{.}\NormalTok{se }\OperatorTok{\textless{}} \OperatorTok{(}\NormalTok{ld}\OperatorTok{)}\NormalTok{b}\OperatorTok{.}\NormalTok{fi }\OperatorTok{/}\NormalTok{ b}\OperatorTok{.}\NormalTok{se}\OperatorTok{;} \OperatorTok{\}}
  \NormalTok{ll n}\OperatorTok{,}\NormalTok{ a}\OperatorTok{,}\NormalTok{ b}\OperatorTok{,}\NormalTok{ c}\OperatorTok{,}\NormalTok{ d}\OperatorTok{,}\NormalTok{ qz}\OperatorTok{[}\DecValTok{141}\OperatorTok{],}\NormalTok{ p}\OperatorTok{[}\DecValTok{166}\OperatorTok{];}
  \NormalTok{Pll s}\OperatorTok{[}\DecValTok{166}\OperatorTok{];}
  \NormalTok{ll calc}\OperatorTok{(}\NormalTok{ll x}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return}\NormalTok{ min}\OperatorTok{(}\NormalTok{x }\OperatorTok{*}\NormalTok{ a}\OperatorTok{,} \OperatorTok{(}\NormalTok{n }\OperatorTok{*} \OperatorTok{(}\NormalTok{n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)} \OperatorTok{/} \DecValTok{2} \OperatorTok{{-}}\NormalTok{ x}\OperatorTok{)} \OperatorTok{*}\NormalTok{ a }\OperatorTok{+}\NormalTok{ b}\OperatorTok{);} \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()}
  \OperatorTok{\{}
  \NormalTok{    freopen}\OperatorTok{(}\StringTok{"in.txt"}\OperatorTok{,} \StringTok{"r"}\OperatorTok{,}\NormalTok{ stdin}\OperatorTok{);}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{n}\OperatorTok{,} \DecValTok{2}\OperatorTok{,} \DecValTok{16}\OperatorTok{)}\NormalTok{ yzr}\OperatorTok{[}\NormalTok{n}\OperatorTok{].}\NormalTok{ini}\OperatorTok{(}\NormalTok{n}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ T}\OperatorTok{;}
  \NormalTok{    read}\OperatorTok{(}\NormalTok{T}\OperatorTok{);}
      \ControlFlowTok{while} \OperatorTok{(}\NormalTok{T}\OperatorTok{{-}{-})}
      \OperatorTok{\{}
  \NormalTok{        read}\OperatorTok{(}\NormalTok{n}\OperatorTok{);}\NormalTok{ read}\OperatorTok{(}\NormalTok{a}\OperatorTok{);}\NormalTok{ read}\OperatorTok{(}\NormalTok{b}\OperatorTok{);}\NormalTok{ read}\OperatorTok{(}\NormalTok{c}\OperatorTok{);}\NormalTok{ read}\OperatorTok{(}\NormalTok{d}\OperatorTok{);}
  \NormalTok{        Pll res}\OperatorTok{(}\FloatTok{1e18}\OperatorTok{,} \DecValTok{1}\OperatorTok{);}
  \NormalTok{        ll tot }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ tot }\OperatorTok{*=}\NormalTok{ i}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ len }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ n }\OperatorTok{*} \OperatorTok{(}\NormalTok{n }\OperatorTok{+} \DecValTok{1}\OperatorTok{)} \OperatorTok{/} \DecValTok{2}\OperatorTok{)} \ControlFlowTok{if} \OperatorTok{(}\NormalTok{yzr}\OperatorTok{[}\NormalTok{n}\OperatorTok{].}\NormalTok{gs}\OperatorTok{[}\NormalTok{i}\OperatorTok{])}\NormalTok{ s}\OperatorTok{[++}\NormalTok{len}\OperatorTok{]} \OperatorTok{=}\NormalTok{ mp}\OperatorTok{(}\NormalTok{calc}\OperatorTok{(}\NormalTok{i}\OperatorTok{),}\NormalTok{ yzr}\OperatorTok{[}\NormalTok{n}\OperatorTok{].}\NormalTok{gs}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
  \NormalTok{        sort}\OperatorTok{(}\NormalTok{s }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ s }\OperatorTok{+}\NormalTok{ len }\OperatorTok{+} \DecValTok{1}\OperatorTok{);}
          \AttributeTok{static}\NormalTok{ ll qz}\OperatorTok{[}\DecValTok{166}\OperatorTok{],}\NormalTok{ hz}\OperatorTok{[}\DecValTok{166}\OperatorTok{];}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ len}\OperatorTok{)}\NormalTok{ qz}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ qz}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]} \OperatorTok{+}\NormalTok{ s}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{fi }\OperatorTok{*}\NormalTok{ s}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{se}\OperatorTok{;}
  \NormalTok{        hz}\OperatorTok{[}\NormalTok{len }\OperatorTok{+} \DecValTok{1}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{        per}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\NormalTok{ len}\OperatorTok{,} \DecValTok{1}\OperatorTok{)}\NormalTok{ hz}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ hz}\OperatorTok{[}\NormalTok{i }\OperatorTok{+} \DecValTok{1}\OperatorTok{]} \OperatorTok{+}\NormalTok{ s}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{se}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ len}\OperatorTok{)}
          \OperatorTok{\{}
  \NormalTok{            Pll cur }\OperatorTok{=}\NormalTok{ mp}\OperatorTok{(}\NormalTok{qz}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{+}\NormalTok{ hz}\OperatorTok{[}\NormalTok{i }\OperatorTok{+} \DecValTok{1}\OperatorTok{]} \OperatorTok{*}\NormalTok{ c}\OperatorTok{,}\NormalTok{ tot }\OperatorTok{{-}}\NormalTok{ hz}\OperatorTok{[}\NormalTok{i }\OperatorTok{+} \DecValTok{1}\OperatorTok{]);}
              \ControlFlowTok{if} \OperatorTok{(}\NormalTok{cmp}\OperatorTok{(}\NormalTok{cur}\OperatorTok{,}\NormalTok{ res}\OperatorTok{))}
  \NormalTok{                res }\OperatorTok{=}\NormalTok{ cur}\OperatorTok{;}
          \OperatorTok{\}}
  \NormalTok{        pair}\OperatorTok{\textless{}}\NormalTok{ll}\OperatorTok{,}\NormalTok{ ll}\OperatorTok{\textgreater{}}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ mp}\OperatorTok{(}\NormalTok{res}\OperatorTok{.}\NormalTok{fi }\OperatorTok{+}\NormalTok{ c }\OperatorTok{*}\NormalTok{ res}\OperatorTok{.}\NormalTok{se}\OperatorTok{,}\NormalTok{ res}\OperatorTok{.}\NormalTok{se}\OperatorTok{);}
  \NormalTok{        cerr }\OperatorTok{\textless{}\textless{}} \StringTok{"N = "} \OperatorTok{\textless{}\textless{}}\NormalTok{ n }\OperatorTok{\textless{}\textless{}}\NormalTok{ endl}\OperatorTok{;}
  \NormalTok{        cout }\OperatorTok{\textless{}\textless{}}\NormalTok{ ans}\OperatorTok{.}\NormalTok{fi }\OperatorTok{\textless{}\textless{}} \StringTok{" "} \OperatorTok{\textless{}\textless{}}\NormalTok{ ans}\OperatorTok{.}\NormalTok{se }\OperatorTok{\textless{}\textless{}}\NormalTok{ endl}\OperatorTok{;}
          \ControlFlowTok{while} \OperatorTok{(}\NormalTok{d}\OperatorTok{{-}{-})}
          \OperatorTok{\{}
  \NormalTok{            rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ read}\OperatorTok{(}\NormalTok{p}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
              \DataTypeTok{int}\NormalTok{ nx }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{            rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,}\NormalTok{ i }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ nx }\OperatorTok{+=}\NormalTok{ p}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{\textgreater{}}\NormalTok{ p}\OperatorTok{[}\NormalTok{j}\OperatorTok{];}
  \NormalTok{            Pll ans }\OperatorTok{=}\NormalTok{ mp}\OperatorTok{(}\NormalTok{calc}\OperatorTok{(}\NormalTok{nx}\OperatorTok{),} \DecValTok{1}\OperatorTok{);}
              \ControlFlowTok{if} \OperatorTok{(}\NormalTok{cmp}\OperatorTok{(}\NormalTok{mp}\OperatorTok{(}\NormalTok{res}\OperatorTok{.}\NormalTok{fi }\OperatorTok{+}\NormalTok{ c }\OperatorTok{*}\NormalTok{ res}\OperatorTok{.}\NormalTok{se}\OperatorTok{,}\NormalTok{ res}\OperatorTok{.}\NormalTok{se}\OperatorTok{),}\NormalTok{ ans}\OperatorTok{))}
  \NormalTok{                ans }\OperatorTok{=}\NormalTok{ mp}\OperatorTok{(}\NormalTok{res}\OperatorTok{.}\NormalTok{fi }\OperatorTok{+}\NormalTok{ c }\OperatorTok{*}\NormalTok{ res}\OperatorTok{.}\NormalTok{se}\OperatorTok{,}\NormalTok{ res}\OperatorTok{.}\NormalTok{se}\OperatorTok{);}
  \NormalTok{            ll g }\OperatorTok{=}\NormalTok{ gcd}\OperatorTok{(}\NormalTok{ans}\OperatorTok{.}\NormalTok{fi}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{.}\NormalTok{se}\OperatorTok{);}
  \NormalTok{            ans}\OperatorTok{.}\NormalTok{fi }\OperatorTok{/=}\NormalTok{ g}\OperatorTok{;}
  \NormalTok{            ans}\OperatorTok{.}\NormalTok{se }\OperatorTok{/=}\NormalTok{ g}\OperatorTok{;}
  \NormalTok{            printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld}\StringTok{/}\SpecialCharTok{\%lld\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{.}\NormalTok{fi}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{.}\NormalTok{se}\OperatorTok{);}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{D. sith}\label{d.-sith}
  
  ‰Ω†Êúâ \(k\) Ê£µÁÇπÊï∞Âùá‰∏∫ \(n\) ÁöÑÊ†ë
  
  ÂØπ‰∫éÊØèÂØπÁÇπ \(i,j\)Ôºå‰Ω†ÈÉΩÈúÄË¶ÅÊ±ÇÂá∫ÔºåÊúâÂ§öÂ∞ë‰∏™ÁÇπ \(x\)ÔºåÊª°Ë∂≥Âú®ÊâÄÊúâÊ†ë‰∏≠ÈÉΩÂú®
  \(i\leftrightarrow j\) ÁöÑÊ†ëÈìæ‰∏äÔºàÊ†ëÈìæÂåÖÂê´Á´ØÁÇπÂç≥ \(i,j\)Ôºâ„ÄÇ
  
  ÂÆö‰πâÂáΩÊï∞ \(\operatorname{dis_t}(x, y)\) ‰∏∫ \(x\)Ôºå\(y\) Ëøô‰∏§‰∏™ÁªìÁÇπÂú®Ê†ë
  \(t\) ‰∏äÁöÑÊúÄÁü≠Ë∑ùÁ¶ªÔºàÁÆÄÂçïË∑ØÂæÑÈïøÂ∫¶Ôºâ„ÄÇ
  
  ÂØπ‰∫é‰∏ÄÊ£µÊ†ë \(t\)
  Ôºå‚Äú\(\operatorname{dis_t}(i, j) = \operatorname{dis_t}(i, x) + \operatorname{dis_t}(x, j)\)‚Äù
  ‰∏∫ ‚ÄúÁÇπ \(x\) Âú® ÁÇπ\(i\) \(\leftrightarrow\) ÁÇπ \(j\) ÁöÑÊ†ëÈìæ‰∏ä‚Äù
  ÁöÑÂÖÖË¶ÅÊù°‰ª∂„ÄÇ
  
  Êâ©Â±ï‰∏Ä‰∏ãÂèØ‰ª•ÂèëÁé∞
  
  ÂØπ‰∫éÊ£ÆÊûó
  \(T\)Ôºå‚Äú\(\sum_{t \in T}\limits{\operatorname{dis_t}(i, j)} = \sum_{t \in T}\limits{\operatorname{dis_t}(i, x)} + \sum_{t \in T}\limits{\operatorname{dis_t}(x, j)}\)‚Äù
  ‰∏∫ ‚ÄúÂØπ‰∫éÊØèÊ£µÊ†ë ÁÇπ \(x\) Âú® ÁÇπ\(i\) \(\leftrightarrow\) ÁÇπ \(j\)
  ÁöÑÊ†ëÈìæ‰∏ä‚Äù ÁöÑÂÖÖË¶ÅÊù°‰ª∂„ÄÇ
  
  ËøôÊ†∑Â∞±ÂèØ‰ª•ÂàÜÂºÄÁÆó‰∫ÜÔºåÈöè‰æøÂÅöÂ∞±Â•Ω‰∫Ü„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \PreprocessorTok{\#include }\ImportTok{\textless{}bits/stdc++.h\textgreater{}}
  \PreprocessorTok{\#define fi }\NormalTok{first}
  \PreprocessorTok{\#define se }\NormalTok{second}
  \PreprocessorTok{\#define pb }\NormalTok{push\_back}
  \PreprocessorTok{\#define mp }\NormalTok{make\_pair}
  \PreprocessorTok{\#define SZ}\OperatorTok{(}\NormalTok{x}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{((}\DataTypeTok{int}\OperatorTok{)}\NormalTok{x}\OperatorTok{.}\NormalTok{size}\OperatorTok{())}
  \PreprocessorTok{\#define ALL}\OperatorTok{(}\NormalTok{x}\OperatorTok{)}\PreprocessorTok{ }\NormalTok{x}\OperatorTok{.}\NormalTok{begin}\OperatorTok{(),}\PreprocessorTok{ }\NormalTok{x}\OperatorTok{.}\NormalTok{end}\OperatorTok{()}
  \PreprocessorTok{\#define L}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{u}\OperatorTok{)}\PreprocessorTok{ }\ControlFlowTok{for}\PreprocessorTok{ }\OperatorTok{(}\AttributeTok{register}\PreprocessorTok{ }\DataTypeTok{int}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{head}\OperatorTok{[}\NormalTok{u}\OperatorTok{];}\PreprocessorTok{ }\NormalTok{i}\OperatorTok{;}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{nxt}\OperatorTok{[}\NormalTok{i}\OperatorTok{])}
  \PreprocessorTok{\#define rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{a}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{b}\OperatorTok{)}\PreprocessorTok{ }\ControlFlowTok{for}\PreprocessorTok{ }\OperatorTok{(}\AttributeTok{register}\PreprocessorTok{ }\DataTypeTok{int}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{a}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{\textless{}=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{b}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\OperatorTok{++)}
  \PreprocessorTok{\#define per}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{a}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{b}\OperatorTok{)}\PreprocessorTok{ }\ControlFlowTok{for}\PreprocessorTok{ }\OperatorTok{(}\AttributeTok{register}\PreprocessorTok{ }\DataTypeTok{int}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{a}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{\textgreater{}=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{b}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\OperatorTok{{-}{-})}
  \KeywordTok{using} \KeywordTok{namespace}\NormalTok{ std}\OperatorTok{;}
  \KeywordTok{typedef} \DataTypeTok{long} \DataTypeTok{double}\NormalTok{ ld}\OperatorTok{;}
  \KeywordTok{typedef} \DataTypeTok{long} \DataTypeTok{long}\NormalTok{ ll}\OperatorTok{;}
  \KeywordTok{typedef} \DataTypeTok{unsigned} \DataTypeTok{int}\NormalTok{ ui}\OperatorTok{;}
  \KeywordTok{typedef}\NormalTok{ pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ Pii}\OperatorTok{;}
  \KeywordTok{typedef}\NormalTok{ vector}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ Vi}\OperatorTok{;}
  \KeywordTok{template} \OperatorTok{\textless{}}\KeywordTok{class}\NormalTok{ T}\OperatorTok{\textgreater{}}
  \KeywordTok{inline} \DataTypeTok{void}\NormalTok{ read}\OperatorTok{(}\NormalTok{T }\OperatorTok{\&}\NormalTok{x}\OperatorTok{)\{}\NormalTok{x }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\DataTypeTok{char}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();}\DataTypeTok{int}\NormalTok{ f }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\ControlFlowTok{while} \OperatorTok{(!}\NormalTok{isdigit}\OperatorTok{(}\NormalTok{c}\OperatorTok{))\{}\ControlFlowTok{if} \OperatorTok{(}\NormalTok{c }\OperatorTok{==} \CharTok{\textquotesingle{}{-}\textquotesingle{}}\OperatorTok{)}\NormalTok{f }\OperatorTok{=} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{;}\NormalTok{c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();\}}\ControlFlowTok{while} \OperatorTok{(}\NormalTok{isdigit}\OperatorTok{(}\NormalTok{c}\OperatorTok{))\{}\NormalTok{x }\OperatorTok{=}\NormalTok{ x }\OperatorTok{*} \DecValTok{10} \OperatorTok{+}\NormalTok{ c }\OperatorTok{{-}} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{;}\NormalTok{c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();\}}\NormalTok{x }\OperatorTok{*=}\NormalTok{ f}\OperatorTok{;\}}
  \KeywordTok{template} \OperatorTok{\textless{}}\KeywordTok{class}\NormalTok{ T}\OperatorTok{\textgreater{}}
  \NormalTok{T gcd}\OperatorTok{(}\NormalTok{T a}\OperatorTok{,}\NormalTok{ T b}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return} \OperatorTok{!}\NormalTok{b }\OperatorTok{?}\NormalTok{ a }\OperatorTok{:}\NormalTok{ gcd}\OperatorTok{(}\NormalTok{b}\OperatorTok{,}\NormalTok{ a }\OperatorTok{\%}\NormalTok{ b}\OperatorTok{);} \OperatorTok{\}}
  \KeywordTok{template} \OperatorTok{\textless{}}\KeywordTok{class}\NormalTok{ T}\OperatorTok{\textgreater{}}
  \KeywordTok{inline} \DataTypeTok{void}\NormalTok{ umin}\OperatorTok{(}\NormalTok{T }\OperatorTok{\&}\NormalTok{x}\OperatorTok{,}\NormalTok{ T y}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ x }\OperatorTok{=}\NormalTok{ x }\OperatorTok{\textless{}}\NormalTok{ y }\OperatorTok{?}\NormalTok{ x }\OperatorTok{:}\NormalTok{ y}\OperatorTok{;} \OperatorTok{\}}
  \KeywordTok{template} \OperatorTok{\textless{}}\KeywordTok{class}\NormalTok{ T}\OperatorTok{\textgreater{}}
  \KeywordTok{inline} \DataTypeTok{void}\NormalTok{ umax}\OperatorTok{(}\NormalTok{T }\OperatorTok{\&}\NormalTok{x}\OperatorTok{,}\NormalTok{ T y}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ x }\OperatorTok{=}\NormalTok{ x }\OperatorTok{\textgreater{}}\NormalTok{ y }\OperatorTok{?}\NormalTok{ x }\OperatorTok{:}\NormalTok{ y}\OperatorTok{;} \OperatorTok{\}}
  \KeywordTok{template} \OperatorTok{\textless{}}\KeywordTok{class}\NormalTok{ T}\OperatorTok{\textgreater{}}
  \KeywordTok{inline}\NormalTok{ T Abs}\OperatorTok{(}\AttributeTok{const}\NormalTok{ T }\OperatorTok{\&}\NormalTok{x}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return}\NormalTok{ x }\OperatorTok{\textgreater{}} \DecValTok{0} \OperatorTok{?}\NormalTok{ x }\OperatorTok{:} \OperatorTok{{-}}\NormalTok{x}\OperatorTok{;} \OperatorTok{\}}
  \KeywordTok{inline}\NormalTok{ ui R}\OperatorTok{()}
  \OperatorTok{\{}
      \AttributeTok{static}\NormalTok{ ui seed }\OperatorTok{=} \DecValTok{613}\OperatorTok{;}
      \ControlFlowTok{return}\NormalTok{ seed }\OperatorTok{\^{}=}\NormalTok{ seed }\OperatorTok{\textgreater{}\textgreater{}} \DecValTok{5}\OperatorTok{,}\NormalTok{ seed }\OperatorTok{\^{}=}\NormalTok{ seed }\OperatorTok{\textless{}\textless{}} \DecValTok{17}\OperatorTok{,}\NormalTok{ seed }\OperatorTok{\^{}=}\NormalTok{ seed }\OperatorTok{\textgreater{}\textgreater{}} \DecValTok{13}\OperatorTok{;}
  \OperatorTok{\}}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ N }\OperatorTok{=} \DecValTok{505}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ k}\OperatorTok{,}\NormalTok{ dis}\OperatorTok{[}\NormalTok{N}\OperatorTok{][}\NormalTok{N}\OperatorTok{];}
  \NormalTok{Vi e}\OperatorTok{[}\NormalTok{N}\OperatorTok{];}
  \DataTypeTok{void}\NormalTok{ dfs}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ s}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ u}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ fa}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ dep}\OperatorTok{)}
  \OperatorTok{\{}
  \NormalTok{    dis}\OperatorTok{[}\NormalTok{s}\OperatorTok{][}\NormalTok{u}\OperatorTok{]} \OperatorTok{+=}\NormalTok{ dep}\OperatorTok{;}
      \ControlFlowTok{for} \OperatorTok{(}\DataTypeTok{int}\NormalTok{ v }\OperatorTok{:}\NormalTok{ e}\OperatorTok{[}\NormalTok{u}\OperatorTok{])}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{v }\OperatorTok{!=}\NormalTok{ fa}\OperatorTok{)}
  \NormalTok{            dfs}\OperatorTok{(}\NormalTok{s}\OperatorTok{,}\NormalTok{ v}\OperatorTok{,}\NormalTok{ u}\OperatorTok{,}\NormalTok{ dep }\OperatorTok{+} \DecValTok{1}\OperatorTok{);}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()}
  \OperatorTok{\{}
  \NormalTok{    read}\OperatorTok{(}\NormalTok{n}\OperatorTok{);}\NormalTok{read}\OperatorTok{(}\NormalTok{k}\OperatorTok{);}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{tt}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ k}\OperatorTok{)\{}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ e}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{clear}\OperatorTok{();}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)\{}
              \DataTypeTok{int}\NormalTok{ u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{;}\NormalTok{read}\OperatorTok{(}\NormalTok{u}\OperatorTok{);}\NormalTok{read}\OperatorTok{(}\NormalTok{v}\OperatorTok{);}
  \NormalTok{            e}\OperatorTok{[}\NormalTok{u}\OperatorTok{].}\NormalTok{pb}\OperatorTok{(}\NormalTok{v}\OperatorTok{);}\NormalTok{e}\OperatorTok{[}\NormalTok{v}\OperatorTok{].}\NormalTok{pb}\OperatorTok{(}\NormalTok{u}\OperatorTok{);}
          \OperatorTok{\}}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ dfs}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\NormalTok{ i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \DecValTok{0}\OperatorTok{);}
      \OperatorTok{\}}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{x}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{+=}\NormalTok{ dis}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{x}\OperatorTok{]} \OperatorTok{+}\NormalTok{ dis}\OperatorTok{[}\NormalTok{j}\OperatorTok{][}\NormalTok{x}\OperatorTok{]} \OperatorTok{==}\NormalTok{ dis}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{];}
  \NormalTok{        printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d\%c}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{,}\NormalTok{ j }\OperatorTok{\textless{}}\NormalTok{ n }\OperatorTok{?} \CharTok{\textquotesingle{} \textquotesingle{}} \OperatorTok{:} \CharTok{\textquotesingle{}}\SpecialCharTok{\textbackslash{}n}\CharTok{\textquotesingle{}}\OperatorTok{);}
      \OperatorTok{\}}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsection{Round 2}\label{round-2}
  
  \subsubsection{A. one}\label{a.-one}
  
  Áªô‰Ω†‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ \(n\)
  ÁöÑÊï∞ÁªÑÔºå‰Ω†ÈúÄË¶ÅÂ∞ÜÂÖ∂ÂàíÂàÜ‰∏∫Ëã•Âπ≤‰∏™ËøûÁª≠ÊÆµ„ÄÇÂØπ‰∫é‰∏ÄÁßçÂàíÂàÜÔºåÂÆö‰πâÂÖ∂ÊùÉÂÄº‰∏∫ÔºåÊ±ÇÂá∫ÊØèÊÆµÁöÑÊÆµÂÜÖÊâÄÊúâÂÖÉÁ¥†
  xor ÂÄºÔºåÂÜçÊääÊâÄÊúâÊÆµÁöÑ xor ÂÄºÁõ∏Âä†Âç≥‰∏∫ÊùÉÂÄº„ÄÇ
  
  ‰Ω†ÈúÄË¶ÅËÆ°ÁÆóÂØπ‰∫éÊâÄÊúâÂàíÂàÜÔºåËøô‰∏™ÊùÉÂÄºÁöÑÊúÄÂ∞è„ÄÅÊúÄÂ§ßÂÄºÂàÜÂà´ÊòØÂ§öÂ∞ë„ÄÇ
  \(n \le 10^6\)
  
  \(A \operatorname{xor} B \le A + B\)
  
  \(A \ \And B \le A\ |\ B \le A + B\)
  
  ÂÖ®ÈÉ®ÊãÜÂºÄÊúÄÂ§ßÔºåÂÖ®ÈÉ®ÂêàÂπ∂ÊúÄÂ∞è„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
      \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ MIN }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ LL MAX }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{);}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)} \OperatorTok{\{} \DataTypeTok{int}\NormalTok{ x}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{x}\OperatorTok{);}\NormalTok{ MIN }\OperatorTok{\^{}=}\NormalTok{ x}\OperatorTok{;}\NormalTok{ MAX }\OperatorTok{+=}\NormalTok{ x}\OperatorTok{;} \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{ }\SpecialCharTok{\%lld}\StringTok{"}\OperatorTok{,}\NormalTok{ MIN}\OperatorTok{,}\NormalTok{ MAX}\OperatorTok{);}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{B. two}\label{b.-two}
  
  Êúâ‰∏Ä‰∏™ \(1..n\) ‰æùÊ¨°ËøûÊàêÁöÑÁéØÔºåÊúâ‰∏Ä‰∏™‰ªé \(1\)
  ÂºÄÂßãÁßªÂä®ÁöÑÊåáÈíàÔºåÊØèÊ¨°ÊåáÈíàÊâÄÂú®‰ΩçÁΩÆÊúâ\(p\)ÁöÑÊ¶ÇÁéáÊ∂àÂ§±Âπ∂Â∞ÜËøô‰∏™‰ΩçÁΩÆÂØπÂ∫îÁöÑ‰∏ãÊ†áÔºàÂú®
  \(1..n\) ‰∏≠ÔºâÊèíÂÖ•Â∫èÂàó \(B\) ÁöÑÊú´Â∞æÔºåÁÑ∂ÂêéÊåáÈíàÁßªÂä®‰∏ÄÊ†ºÔºà \(1\) ÁßªÂà∞
  \(2\)Ôºå\(n\) ÁßªÂà∞ \(1\)
  ËøôÊ†∑Ôºå‰∏Ä‰∏™‰ΩçÁΩÆËã•Â∑≤ÁªèÊ∂àÂ§±Âàô‰∏ç‰ºöË¢´ÁßªÂä®Âà∞Ôºâ„ÄÇÊâÄÊúâ‰ΩçÁΩÆÈÉΩÊ∂àÂ§±Êó∂Ê∏∏ÊàèÁªìÊùü„ÄÇÊúÄÂêé
  \(B\) ‰ºöÊòØ‰∏Ä‰∏™ÊéíÂàó„ÄÇ
  
  ËøôÈÅìÈ¢òË∑üÂ∫èÂàó \(B\) Ê≤°‰ªÄ‰πàÂÖ≥Á≥ªÔºå‰Ω†Âè™ÈúÄË¶ÅÊ±ÇÂá∫Ê∏∏ÊàèÊúüÊúõËøõË°åÂá†ËΩÆÔºåÁ≠îÊ°àÂØπ
  \(998244353\) ÂèñÊ®°„ÄÇ
  
  ËØªÂÖ•ÊèèËø∞Ôºö ‰∏ÄË°å‰∏â‰∏™Êï¥Êï∞ \(n,x,y\)„ÄÇÊ¶ÇÁéá \(p=\frac x y\)
  
  ËÆæ \(f[n]\) ‰∏∫ ÈïøÂ∫¶‰∏∫ \(n\) ËøòÈúÄË¶ÅËøõË°åÂ§öÂ∞ëËΩÆ„ÄÇ
  
  ÊòìÁü• \(f[n] = 1 + p \times f[n - 1] + \left(1 - p \right) \times f[n]\)
  
  ÁßªÈ°πÂæó \(f[n] = n \times \frac{1}{p}\)
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{x}\OperatorTok{)(}\NormalTok{y}\OperatorTok{);}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{(}\NormalTok{n }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ y }\OperatorTok{\%}\NormalTok{ MOD }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ inv}\OperatorTok{(}\NormalTok{x}\OperatorTok{,}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{));}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{C. three}\label{c.-three}
  
  Â∞èYÊã•Êúâ‰∏Ä‰∏™Â∫èÂàó\(a_i\)Ôºà‰ªé0ÂºÄÂßãÊ†áÂè∑Ôºâ„ÄÇ
  
  Â∞èYÊÉ≥Ë¶ÅÂØπÂ∫èÂàóËøõË°å\(Q\)Ê¨°Êìç‰ΩúÔºåÊìç‰ΩúÊúâ‰∏ãÈù¢Âá†ÁßçÔºö
  
  \begin{itemize}
  \tightlist
  \item
    \(t=0\)ÔºöÂØπÂå∫Èó¥\([l,r]\)ÊâßË°å\(a_i=a_i+x\)
  \item
    \(t=1\)ÔºöÂØπÂå∫Èó¥\([l,r]\)ÊâßË°å\(a_i=\lfloor \frac {a_i} {x} \rfloor\)
  \item
    \(t=2\)ÔºöÊü•ËØ¢Âå∫Èó¥\([l,r]\)ÁöÑ\(\max {a_i}\)
  \item
    \(t=3\)ÔºöÊääÂå∫Èó¥\([l,r]\)ÁöÑ\(a_i\)ÊÅ¢Â§ç‰∏∫ÂàùÂßãÁªôÂá∫ÁöÑ\(a_i\)
    \(a_i \le 10^8; n, Q \le 10^5\)
  \end{itemize}
  
  \paragraph{ÂÆö‰πâ‰∏ÄÁ±ªÁâπÊÆäÊ†áËÆ∞}\label{ux5b9aux4e49ux4e00ux7c7bux7279ux6b8aux6807ux8bb0}
  
  ËÆ∞ÂΩïÊ†áËÆ∞ \(a, b, c\) Ë°®Á§∫ \(x\) ÂèòÊàê
  \(\lfloor \frac{x + a}{b} \rfloor + c\)„ÄÇ ÂÖ∂‰∏≠Ë¶ÅÊ±Ç \(a < b\)„ÄÇ -
  ÂØπ‰∫éÂä†Ê≥ïÊìç‰Ωú \(c += x\) Âç≥ÂèØ„ÄÇ - ÂØπ‰∫éÈô§Ê≥ïÊìç‰ΩúÂ¶ÇÊûúÊòØÈô§ \(d\)
  Ôºö\(\lfloor \frac{ \lfloor \frac{x + a}{b} \rfloor + c}{d} \rfloor = \lfloor \frac{ \lfloor \frac{x + a + bc}{b} \rfloor}{d} \rfloor = \lfloor \frac{x + a + bc}{bd} \rfloor\)
  ÁÑ∂Âêé‰ºòÂåñ‰∏Ä‰∏ã \(x + a + bc\) ‰øùÊåÅ
  \(a' < b'\)ÔºåÁ±ª‰ºº‰∫éÂÅáÂàÜÊï∞Êç¢ÁÆóÂ∏¶ÂàÜÊï∞Ôºå‰øùËØÅ‰∏ç‰ºöÁàÜ\texttt{long\ long}„ÄÇ
  
  ÂØπ‰∫éÂ§ÑÁêÜÈô§Êï∞ËøáÂ§ßÁöÑÊÉÖÂÜµÔºö
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \ControlFlowTok{if} \OperatorTok{(}\NormalTok{fm }\OperatorTok{\textgreater{}}\NormalTok{ inf}\OperatorTok{)}\NormalTok{ fz }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{,}\NormalTok{ fz }\OperatorTok{+} \OperatorTok{(}\NormalTok{inf }\OperatorTok{{-}}\NormalTok{ fm}\OperatorTok{)),}\NormalTok{ fm }\OperatorTok{=}\NormalTok{ inf}\OperatorTok{;}
  \end{Highlighting}
  \end{Shaded}
  
  Â¶ÇÊûúÂàÜÊØç \(> \operatorname{inf}\)ÔºåÈÇ£‰πà
  \(\lfloor \frac{x + a}{b} \rfloor + c\) Á≠â‰ª∑‰∫é \([x \ge b - a] + c\)
  ÂΩìÂàÜÊØçÂæàÂ§ßÊó∂ÔºåÂèØ‰ª•‰ΩøÂæó \(a, b\) ÂêåÊó∂ÂáèÂéª‰∏Ä‰∏™Â∏∏Êï∞‰ΩøÂæó \(b\)
  ‰∏ç‰ºöÊ∫¢Âá∫ÔºåÂØπ‰∫é \([x \ge b - a] + c\) ‰∏çÂΩ±ÂìçÂèñÂÄº„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \PreprocessorTok{\#include }\ImportTok{\textless{}bits/stdc++.h\textgreater{}}
  \PreprocessorTok{\#define fi }\NormalTok{first}
  \PreprocessorTok{\#define se }\NormalTok{second}
  \PreprocessorTok{\#define pb }\NormalTok{push\_back}
  \PreprocessorTok{\#define mp }\NormalTok{make\_pair}
  \PreprocessorTok{\#define SZ}\OperatorTok{(}\NormalTok{x}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{((}\DataTypeTok{int}\OperatorTok{)}\NormalTok{x}\OperatorTok{.}\NormalTok{size}\OperatorTok{())}
  \PreprocessorTok{\#define ALL}\OperatorTok{(}\NormalTok{x}\OperatorTok{)}\PreprocessorTok{ }\NormalTok{x}\OperatorTok{.}\NormalTok{begin}\OperatorTok{(),}\PreprocessorTok{ }\NormalTok{x}\OperatorTok{.}\NormalTok{end}\OperatorTok{()}
  \PreprocessorTok{\#define L}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{u}\OperatorTok{)}\PreprocessorTok{ }\ControlFlowTok{for}\PreprocessorTok{ }\OperatorTok{(}\AttributeTok{register}\PreprocessorTok{ }\DataTypeTok{int}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{head}\OperatorTok{[}\NormalTok{u}\OperatorTok{];}\PreprocessorTok{ }\NormalTok{i}\OperatorTok{;}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{nxt}\OperatorTok{[}\NormalTok{i}\OperatorTok{])}
  \PreprocessorTok{\#define rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{a}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{b}\OperatorTok{)}\PreprocessorTok{ }\ControlFlowTok{for}\PreprocessorTok{ }\OperatorTok{(}\AttributeTok{register}\PreprocessorTok{ }\DataTypeTok{int}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{a}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{\textless{}=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{b}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\OperatorTok{++)}
  \PreprocessorTok{\#define per}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{a}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{b}\OperatorTok{)}\PreprocessorTok{ }\ControlFlowTok{for}\PreprocessorTok{ }\OperatorTok{(}\AttributeTok{register}\PreprocessorTok{ }\DataTypeTok{int}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{a}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{\textgreater{}=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{b}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\OperatorTok{{-}{-})}
  \KeywordTok{using} \KeywordTok{namespace}\NormalTok{ std}\OperatorTok{;}
  \KeywordTok{typedef} \DataTypeTok{long} \DataTypeTok{double}\NormalTok{ ld}\OperatorTok{;}
  \KeywordTok{typedef} \DataTypeTok{long} \DataTypeTok{long}\NormalTok{ ll}\OperatorTok{;}
  \KeywordTok{typedef} \DataTypeTok{unsigned} \DataTypeTok{int}\NormalTok{ ui}\OperatorTok{;}
  \KeywordTok{typedef}\NormalTok{ pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ Pii}\OperatorTok{;}
  \KeywordTok{typedef}\NormalTok{ vector}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ Vi}\OperatorTok{;}
  \KeywordTok{template} \OperatorTok{\textless{}}\KeywordTok{class}\NormalTok{ T}\OperatorTok{\textgreater{}}
  \NormalTok{T gcd}\OperatorTok{(}\NormalTok{T a}\OperatorTok{,}\NormalTok{ T b}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return} \OperatorTok{!}\NormalTok{b }\OperatorTok{?}\NormalTok{ a }\OperatorTok{:}\NormalTok{ gcd}\OperatorTok{(}\NormalTok{b}\OperatorTok{,}\NormalTok{ a }\OperatorTok{\%}\NormalTok{ b}\OperatorTok{);} \OperatorTok{\}}
  \KeywordTok{template} \OperatorTok{\textless{}}\KeywordTok{class}\NormalTok{ T}\OperatorTok{\textgreater{}}
  \KeywordTok{inline} \DataTypeTok{void}\NormalTok{ umin}\OperatorTok{(}\NormalTok{T }\OperatorTok{\&}\NormalTok{x}\OperatorTok{,}\NormalTok{ T y}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ x }\OperatorTok{=}\NormalTok{ x }\OperatorTok{\textless{}}\NormalTok{ y }\OperatorTok{?}\NormalTok{ x }\OperatorTok{:}\NormalTok{ y}\OperatorTok{;} \OperatorTok{\}}
  \KeywordTok{template} \OperatorTok{\textless{}}\KeywordTok{class}\NormalTok{ T}\OperatorTok{\textgreater{}}
  \KeywordTok{inline} \DataTypeTok{void}\NormalTok{ umax}\OperatorTok{(}\NormalTok{T }\OperatorTok{\&}\NormalTok{x}\OperatorTok{,}\NormalTok{ T y}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ x }\OperatorTok{=}\NormalTok{ x }\OperatorTok{\textgreater{}}\NormalTok{ y }\OperatorTok{?}\NormalTok{ x }\OperatorTok{:}\NormalTok{ y}\OperatorTok{;} \OperatorTok{\}}
  \KeywordTok{inline}\NormalTok{ ui R}\OperatorTok{()}
  \OperatorTok{\{}
      \AttributeTok{static}\NormalTok{ ui seed }\OperatorTok{=} \DecValTok{416}\OperatorTok{;}
      \ControlFlowTok{return}\NormalTok{ seed }\OperatorTok{\^{}=}\NormalTok{ seed }\OperatorTok{\textgreater{}\textgreater{}} \DecValTok{5}\OperatorTok{,}\NormalTok{ seed }\OperatorTok{\^{}=}\NormalTok{ seed }\OperatorTok{\textless{}\textless{}} \DecValTok{17}\OperatorTok{,}\NormalTok{ seed }\OperatorTok{\^{}=}\NormalTok{ seed }\OperatorTok{\textgreater{}\textgreater{}} \DecValTok{13}\OperatorTok{;}
  \OperatorTok{\}}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ N }\OperatorTok{=} \DecValTok{233333}\OperatorTok{,}\NormalTok{ inf }\OperatorTok{=} \FloatTok{2e9} \OperatorTok{+} \FloatTok{1e8}\OperatorTok{;}
  \KeywordTok{struct}\NormalTok{ node}
  \OperatorTok{\{}
  \NormalTok{    ll ans}\OperatorTok{;}
      \DataTypeTok{bool}\NormalTok{ emp}\OperatorTok{;}
  \NormalTok{    ll a}\OperatorTok{,}\NormalTok{ b}\OperatorTok{,}\NormalTok{ c}\OperatorTok{,}\NormalTok{ mx}\OperatorTok{;} \CommentTok{//(x+a)/b+c (a\textless{}b\textless{}=inf)}
  \NormalTok{    node}\OperatorTok{()} \OperatorTok{\{}\NormalTok{ b }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} \OperatorTok{\}}
  \OperatorTok{\}}\NormalTok{ tree}\OperatorTok{[}\NormalTok{N }\OperatorTok{\textless{}\textless{}} \DecValTok{2}\OperatorTok{];}
  \KeywordTok{inline} \DataTypeTok{void}\NormalTok{ pushadd}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ k}\OperatorTok{,}\NormalTok{ ll x}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{    tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{ans }\OperatorTok{+=}\NormalTok{ x}\OperatorTok{;}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{c }\OperatorTok{+=}\NormalTok{ x}\OperatorTok{;}
  \OperatorTok{\}}
  \KeywordTok{inline} \DataTypeTok{void}\NormalTok{ pushdiv}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ k}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ d}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{    tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{ans }\OperatorTok{/=}\NormalTok{ d}\OperatorTok{;}
  \NormalTok{    ll fm }\OperatorTok{=} \DecValTok{1}\BuiltInTok{ll} \OperatorTok{*}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{b }\OperatorTok{*}\NormalTok{ d}\OperatorTok{,}\NormalTok{ tmp }\OperatorTok{=} \OperatorTok{(}\NormalTok{tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{a }\OperatorTok{+} \DecValTok{1}\BuiltInTok{ll} \OperatorTok{*}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{b }\OperatorTok{*}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{c}\OperatorTok{)} \OperatorTok{/}\NormalTok{ fm}\OperatorTok{;}
  \NormalTok{    ll fz }\OperatorTok{=} \OperatorTok{(}\NormalTok{tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{a }\OperatorTok{+} \DecValTok{1}\BuiltInTok{ll} \OperatorTok{*}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{b }\OperatorTok{*}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{c}\OperatorTok{)} \OperatorTok{{-}}\NormalTok{ fm }\OperatorTok{*}\NormalTok{ tmp}\OperatorTok{;}
  \NormalTok{    tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{c }\OperatorTok{=}\NormalTok{ tmp}\OperatorTok{;}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{fm }\OperatorTok{\textgreater{}}\NormalTok{ inf}\OperatorTok{)}\NormalTok{ fz }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{,}\NormalTok{ fz }\OperatorTok{+} \OperatorTok{(}\NormalTok{inf }\OperatorTok{{-}}\NormalTok{ fm}\OperatorTok{)),}\NormalTok{ fm }\OperatorTok{=}\NormalTok{ inf}\OperatorTok{;}
  \NormalTok{    tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{a }\OperatorTok{=}\NormalTok{ fz}\OperatorTok{,}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{b }\OperatorTok{=}\NormalTok{ fm}\OperatorTok{;}
      \CommentTok{//  printf("\%d:\%lld \%lld \%lld\textbackslash{}n",k,tree[k].a,tree[k].b,tree[k].c);}
  \OperatorTok{\}}
  \KeywordTok{inline} \DataTypeTok{void}\NormalTok{ pushemp}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ k}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{    tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{emp }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{a }\OperatorTok{=}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{c }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{b }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{ans }\OperatorTok{=}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{mx}\OperatorTok{;}
  \OperatorTok{\}}
  \KeywordTok{inline} \DataTypeTok{void}\NormalTok{ pushdown}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ k}\OperatorTok{)} \OperatorTok{\{}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{emp}\OperatorTok{)}\NormalTok{ pushemp}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{),}\NormalTok{ pushemp}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{),}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{emp }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{a}\OperatorTok{)}\NormalTok{ pushadd}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{,}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{a}\OperatorTok{),}\NormalTok{ pushadd}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{,}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{a}\OperatorTok{),}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{a }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{b }\OperatorTok{!=} \DecValTok{1}\OperatorTok{)}\NormalTok{ pushdiv}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{,}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{b}\OperatorTok{),}\NormalTok{ pushdiv}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{,}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{b}\OperatorTok{),}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{b }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{c}\OperatorTok{)}\NormalTok{ pushadd}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{,}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{c}\OperatorTok{),}\NormalTok{ pushadd}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{,}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{c}\OperatorTok{),}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{c }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \KeywordTok{inline} \DataTypeTok{void}\NormalTok{ upd}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ k}\OperatorTok{)\{}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{ans }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{tree}\OperatorTok{[}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{].}\NormalTok{ans}\OperatorTok{,}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{].}\NormalTok{ans}\OperatorTok{);} \OperatorTok{\}}
  \DataTypeTok{void}\NormalTok{ mdy1}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ k}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ l}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ r}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ x}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\{}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{l }\OperatorTok{==}\NormalTok{ L }\OperatorTok{\&\&}\NormalTok{ r }\OperatorTok{==}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ pushadd}\OperatorTok{(}\NormalTok{k}\OperatorTok{,}\NormalTok{ x}\OperatorTok{);} \ControlFlowTok{return}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{L }\OperatorTok{+}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    pushdown}\OperatorTok{(}\NormalTok{k}\OperatorTok{);}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{r }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ mdy1}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}
      \ControlFlowTok{else} \ControlFlowTok{if} \OperatorTok{(}\NormalTok{l }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ mdy1}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
      \ControlFlowTok{else}\NormalTok{ mdy1}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{),}\NormalTok{ mdy1}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{,}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
  \NormalTok{    upd}\OperatorTok{(}\NormalTok{k}\OperatorTok{);}
  \OperatorTok{\}}
  \DataTypeTok{void}\NormalTok{ mdy2}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ k}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ l}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ r}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ x}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\{}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{l }\OperatorTok{==}\NormalTok{ L }\OperatorTok{\&\&}\NormalTok{ r }\OperatorTok{==}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ pushdiv}\OperatorTok{(}\NormalTok{k}\OperatorTok{,}\NormalTok{ x}\OperatorTok{);} \ControlFlowTok{return}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{L }\OperatorTok{+}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    pushdown}\OperatorTok{(}\NormalTok{k}\OperatorTok{);}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{r }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ mdy2}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}
      \ControlFlowTok{else} \ControlFlowTok{if} \OperatorTok{(}\NormalTok{l }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ mdy2}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
      \ControlFlowTok{else}\NormalTok{ mdy2}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{),}\NormalTok{ mdy2}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{,}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
  \NormalTok{    upd}\OperatorTok{(}\NormalTok{k}\OperatorTok{);}
  \OperatorTok{\}}
  \DataTypeTok{void}\NormalTok{ mdy3}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ k}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ l}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ r}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ x}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\{}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{l }\OperatorTok{==}\NormalTok{ L }\OperatorTok{\&\&}\NormalTok{ r }\OperatorTok{==}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ pushemp}\OperatorTok{(}\NormalTok{k}\OperatorTok{);} \ControlFlowTok{return}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{L }\OperatorTok{+}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    pushdown}\OperatorTok{(}\NormalTok{k}\OperatorTok{);}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{r }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ mdy3}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}
      \ControlFlowTok{else} \ControlFlowTok{if} \OperatorTok{(}\NormalTok{l }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ mdy3}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
      \ControlFlowTok{else}\NormalTok{ mdy3}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{),}\NormalTok{ mdy3}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{,}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
  \NormalTok{    upd}\OperatorTok{(}\NormalTok{k}\OperatorTok{);}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ qry}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ k}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ l}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ r}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ x}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)}
  \OperatorTok{\{}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{l }\OperatorTok{==}\NormalTok{ L }\OperatorTok{\&\&}\NormalTok{ r }\OperatorTok{==}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{ans}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{L }\OperatorTok{+}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    pushdown}\OperatorTok{(}\NormalTok{k}\OperatorTok{);}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{r }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}
          \ControlFlowTok{return}\NormalTok{ qry}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}
      \ControlFlowTok{else} \ControlFlowTok{if} \OperatorTok{(}\NormalTok{l }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}
          \ControlFlowTok{return}\NormalTok{ qry}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
      \ControlFlowTok{return}\NormalTok{ max}\OperatorTok{(}\NormalTok{qry}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{),}\NormalTok{ qry}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{,}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{));}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ q}\OperatorTok{,}\NormalTok{ a}\OperatorTok{[}\NormalTok{N}\OperatorTok{];}
  \DataTypeTok{void}\NormalTok{ build}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ k}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ l}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ r}\OperatorTok{)}
  \OperatorTok{\{}
      \ControlFlowTok{if} \OperatorTok{(}\NormalTok{l }\OperatorTok{==}\NormalTok{ r}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{mx }\OperatorTok{=}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{ans }\OperatorTok{=}\NormalTok{ a}\OperatorTok{[}\NormalTok{l}\OperatorTok{];} \ControlFlowTok{return}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{l }\OperatorTok{+}\NormalTok{ r}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    build}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}
  \NormalTok{    build}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{,}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ r}\OperatorTok{);}
  \NormalTok{    tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{mx }\OperatorTok{=}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{ans }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{tree}\OperatorTok{[}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{].}\NormalTok{mx}\OperatorTok{,}\NormalTok{ tree}\OperatorTok{[}\NormalTok{k }\OperatorTok{\textless{}\textless{}} \DecValTok{1} \OperatorTok{|} \DecValTok{1}\OperatorTok{].}\NormalTok{mx}\OperatorTok{);}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()}
  \OperatorTok{\{}
  \NormalTok{    read}\OperatorTok{(}\NormalTok{n}\OperatorTok{);}\NormalTok{ read}\OperatorTok{(}\NormalTok{q}\OperatorTok{);}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)}\NormalTok{ read}\OperatorTok{(}\NormalTok{a}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
  \NormalTok{    build}\OperatorTok{(}\DecValTok{1}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{);}
      \ControlFlowTok{while} \OperatorTok{(}\NormalTok{q}\OperatorTok{{-}{-})}
      \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ op}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{;}
  \NormalTok{        read}\OperatorTok{(}\NormalTok{op}\OperatorTok{);}\NormalTok{ read}\OperatorTok{(}\NormalTok{l}\OperatorTok{);}\NormalTok{ read}\OperatorTok{(}\NormalTok{r}\OperatorTok{);}\NormalTok{ read}\OperatorTok{(}\NormalTok{x}\OperatorTok{);}
          \ControlFlowTok{if} \OperatorTok{(}\NormalTok{op }\OperatorTok{==} \DecValTok{0}\OperatorTok{)}\NormalTok{ mdy1}\OperatorTok{(}\DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{);}
          \ControlFlowTok{else} \ControlFlowTok{if} \OperatorTok{(}\NormalTok{op }\OperatorTok{==} \DecValTok{1}\OperatorTok{)}\NormalTok{ mdy2}\OperatorTok{(}\DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{);}
          \ControlFlowTok{else} \ControlFlowTok{if} \OperatorTok{(}\NormalTok{op }\OperatorTok{==} \DecValTok{2}\OperatorTok{)}\NormalTok{ printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ qry}\OperatorTok{(}\DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{));}
          \ControlFlowTok{else}\NormalTok{ mdy3}\OperatorTok{(}\DecValTok{1}\OperatorTok{,}\NormalTok{ l}\OperatorTok{,}\NormalTok{ r}\OperatorTok{,}\NormalTok{ x}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{);}
      \OperatorTok{\}}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \paragraph{ÊµÆÁÇπÊï∞ËøêÁÆóÊéßÂà∂Á≤æÂ∫¶}\label{ux6d6eux70b9ux6570ux8fd0ux7b97ux63a7ux5236ux7cbeux5ea6}
  
  Áõ¥Êé•ÂÖ®ÈÉ®ËΩ¨ÂåñÊàêÊµÆÁÇπÊï∞ËøêÁÆóÔºå‰∏âÊ†áËÆ∞Á∫øÊÆµÊ†ë„ÄÇ
  
  ËÄÉËôëÂà∞ÊµÆÁÇπÊï∞Ëá™Â∏¶Á≤æÂ∫¶ÊçüÂ§±ÔºåÂØπ‰∫éËæÉÂ§ßÁöÑÈô§Êï∞ÔºåËá™Âä®‰ΩøÂæóÂéüÊï∞ÂèòÊàêÈõ∂Ôºå\texttt{long\ double}
  ÁöÑÁ≤æÂ∫¶ÂèØ‰ª•ÊîØÊåÅ„ÄÇ
  
  ÁàÜÈõ∂Â∞èÊäÄÂ∑ßÔºö\texttt{ST}Ë°®Á©∫Èó¥ÂºÄ‰∏ÄÂÄç
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ ST}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\NormalTok{LOG }\OperatorTok{+} \DecValTok{3}\OperatorTok{],}\NormalTok{ Log}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{void}\NormalTok{ init\_query}\OperatorTok{()\{}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ ST}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\DecValTok{0}\OperatorTok{]} \OperatorTok{=}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ LOG}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ ST}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{ST}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{],}\NormalTok{ ST}\OperatorTok{[}\NormalTok{i }\OperatorTok{+} \OperatorTok{(}\DecValTok{1} \OperatorTok{\textless{}\textless{}} \OperatorTok{(}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{))][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]);} \CommentTok{// ST[i + (1 \textless{}\textless{} (j {-} 1))][j {-} 1] ‰ºöËÆøÈóÆ O( 2 * N )}
  \NormalTok{    Log}\OperatorTok{[}\DecValTok{1}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{2}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ Log}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ Log}\OperatorTok{[}\NormalTok{i }\OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{]} \OperatorTok{+} \DecValTok{1}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{2e5} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ q}\OperatorTok{;}\NormalTok{ LL A}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \KeywordTok{namespace}\NormalTok{ Acceptable\_Solution}\OperatorTok{\{}
      \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{2e5} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
      \AttributeTok{const} \DataTypeTok{int}\NormalTok{ LOG }\OperatorTok{=} \DecValTok{17}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ ST}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\NormalTok{LOG }\OperatorTok{+} \DecValTok{3}\OperatorTok{],}\NormalTok{ Log}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
      \DataTypeTok{void}\NormalTok{ init\_query}\OperatorTok{()\{}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ ST}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\DecValTok{0}\OperatorTok{]} \OperatorTok{=}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ LOG}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ ST}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{ST}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{],}\NormalTok{ ST}\OperatorTok{[}\NormalTok{i }\OperatorTok{+} \OperatorTok{(}\DecValTok{1} \OperatorTok{\textless{}\textless{}} \OperatorTok{(}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{))][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]);}
  \NormalTok{        Log}\OperatorTok{[}\DecValTok{1}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{2}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ Log}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ Log}\OperatorTok{[}\NormalTok{i }\OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{]} \OperatorTok{+} \DecValTok{1}\OperatorTok{;}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ Query\_Max}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\{} \DataTypeTok{int}\NormalTok{ Lg }\OperatorTok{=}\NormalTok{ Log}\OperatorTok{[}\NormalTok{R }\OperatorTok{{-}}\NormalTok{ L }\OperatorTok{+} \DecValTok{1}\OperatorTok{];} \DataTypeTok{int}\NormalTok{ Len }\OperatorTok{=} \OperatorTok{(}\DecValTok{1} \OperatorTok{\textless{}\textless{}}\NormalTok{ Lg}\OperatorTok{);} \ControlFlowTok{return}\NormalTok{ max}\OperatorTok{(}\NormalTok{ST}\OperatorTok{[}\NormalTok{L}\OperatorTok{][}\NormalTok{Lg}\OperatorTok{],}\NormalTok{ ST}\OperatorTok{[}\NormalTok{R }\OperatorTok{{-}}\NormalTok{ Len }\OperatorTok{+} \DecValTok{1}\OperatorTok{][}\NormalTok{Lg}\OperatorTok{]);} \OperatorTok{\}}
      \PreprocessorTok{\#define LB }\DataTypeTok{long}\PreprocessorTok{ }\DataTypeTok{double}\PreprocessorTok{ }
  \NormalTok{    LB eps}\OperatorTok{;}
      \DataTypeTok{void}\NormalTok{ print}\OperatorTok{(}\NormalTok{LB x}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%.20Lf\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ x}\OperatorTok{);} \OperatorTok{\}}
      \KeywordTok{namespace}\NormalTok{ SegmentTree}\OperatorTok{\{}
          \DataTypeTok{bool}\NormalTok{ same}\OperatorTok{(}\NormalTok{LB x}\OperatorTok{,}\NormalTok{ LB y}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return}\NormalTok{ fabs}\OperatorTok{(}\NormalTok{x }\OperatorTok{{-}}\NormalTok{ y}\OperatorTok{)} \OperatorTok{\textless{}=} \FloatTok{1e{-}12}\OperatorTok{;} \OperatorTok{\}}
          \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{6e5} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ ch}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\DecValTok{2}\OperatorTok{],}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{        LB v}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ tag\_add}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ tag\_mul}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
          \DataTypeTok{bool}\NormalTok{ tag\_ret}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
          \PreprocessorTok{\#define ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{ch}\OperatorTok{[}\NormalTok{o}\OperatorTok{][}\DecValTok{0}\OperatorTok{])}
          \PreprocessorTok{\#define rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{ch}\OperatorTok{[}\NormalTok{o}\OperatorTok{][}\DecValTok{1}\OperatorTok{])}
          \PreprocessorTok{\#define maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{max}\OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)],}\PreprocessorTok{ }\NormalTok{v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)]))}
          \PreprocessorTok{\#define make }\OperatorTok{(}\NormalTok{tot}\OperatorTok{++,}\PreprocessorTok{ }\NormalTok{ch}\OperatorTok{[}\NormalTok{tot}\OperatorTok{][}\DecValTok{0}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{ch}\OperatorTok{[}\NormalTok{tot}\OperatorTok{][}\DecValTok{1}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\DecValTok{0}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{tag\_add}\OperatorTok{[}\NormalTok{tot}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\DecValTok{0}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{tag\_mul}\OperatorTok{[}\NormalTok{tot}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\DecValTok{1}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{tag\_ret}\OperatorTok{[}\NormalTok{tot}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\DecValTok{0}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{tot}\OperatorTok{)}
          \DataTypeTok{int}\NormalTok{ Groot}\OperatorTok{()\{} \ControlFlowTok{return}\NormalTok{ make}\OperatorTok{;} \OperatorTok{\}}
          \DataTypeTok{void}\NormalTok{ build}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{==}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{(}\DataTypeTok{void}\OperatorTok{)(}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=}\NormalTok{ A}\OperatorTok{[}\NormalTok{L}\OperatorTok{]);}
              \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{L }\OperatorTok{+}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}\NormalTok{ ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)} \OperatorTok{=}\NormalTok{ make}\OperatorTok{;}\NormalTok{ rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)} \OperatorTok{=}\NormalTok{ make}\OperatorTok{;}
  \NormalTok{            build}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}\NormalTok{ build}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
  \NormalTok{            maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
          \OperatorTok{\}}
          \DataTypeTok{void}\NormalTok{ tar\_ret}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
  \NormalTok{            v}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=}\NormalTok{ Query\_Max}\OperatorTok{(}\NormalTok{L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
  \NormalTok{            tag\_add}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ tag\_mul}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{            tag\_ret}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
          \OperatorTok{\}}
          \DataTypeTok{void}\NormalTok{ push\_ret}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{tag\_ret}\OperatorTok{[}\NormalTok{o}\OperatorTok{])} \ControlFlowTok{return} \OperatorTok{;}
              \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{L }\OperatorTok{+}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{            tar\_ret}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}\NormalTok{ tar\_ret}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
  \NormalTok{            tag\_ret}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}
          \OperatorTok{\}}
          \DataTypeTok{void}\NormalTok{ tar\_add}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,}\NormalTok{ LB Val}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
  \NormalTok{            push\_ret}\OperatorTok{(}\NormalTok{o}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);} 
  \NormalTok{            v}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{+=}\NormalTok{ Val}\OperatorTok{;}
  \NormalTok{            tag\_add}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{+=}\NormalTok{ Val}\OperatorTok{;}
          \OperatorTok{\}}
          \DataTypeTok{void}\NormalTok{ tar\_mul}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,}\NormalTok{ LB Val}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{            push\_ret}\OperatorTok{(}\NormalTok{o}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);} 
  \NormalTok{            v}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{*=}\NormalTok{ Val}\OperatorTok{;} 
  \NormalTok{            tag\_mul}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{*=}\NormalTok{ Val}\OperatorTok{;}
  \NormalTok{            tag\_add}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{*=}\NormalTok{ Val}\OperatorTok{;}
          \OperatorTok{\}}
          \DataTypeTok{void}\NormalTok{ push}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
  \NormalTok{            push\_ret}\OperatorTok{(}\NormalTok{o}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
              \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{L }\OperatorTok{+}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{same}\OperatorTok{(}\NormalTok{tag\_mul}\OperatorTok{[}\NormalTok{o}\OperatorTok{],} \DecValTok{1}\OperatorTok{))} \OperatorTok{\{}
  \NormalTok{                tar\_mul}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ tag\_mul}\OperatorTok{[}\NormalTok{o}\OperatorTok{],}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}
  \NormalTok{                tar\_mul}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ tag\_mul}\OperatorTok{[}\NormalTok{o}\OperatorTok{],}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
  \NormalTok{                tag\_mul}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
              \OperatorTok{\}}
              \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{same}\OperatorTok{(}\NormalTok{tag\_add}\OperatorTok{[}\NormalTok{o}\OperatorTok{],} \DecValTok{0}\OperatorTok{))\{}
  \NormalTok{                tar\_add}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ tag\_add}\OperatorTok{[}\NormalTok{o}\OperatorTok{],}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}
  \NormalTok{                tar\_add}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ tag\_add}\OperatorTok{[}\NormalTok{o}\OperatorTok{],}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
  \NormalTok{                tag\_add}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}
              \OperatorTok{\}}
          \OperatorTok{\}}
          \DataTypeTok{void}\NormalTok{ update\_add}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ Val}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ nowl }\OperatorTok{\&\&}\NormalTok{ nowr }\OperatorTok{\textless{}=}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ tar\_add}\OperatorTok{(}\NormalTok{o}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{,}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{);}
              \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{            push}\OperatorTok{(}\NormalTok{o}\OperatorTok{,}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{);}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update\_add}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{);}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R  }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update\_add}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{);}
  \NormalTok{            maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
          \OperatorTok{\}}
          \DataTypeTok{void}\NormalTok{ update\_mul}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{,}\NormalTok{ LB Val}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ nowl }\OperatorTok{\&\&}\NormalTok{ nowr }\OperatorTok{\textless{}=}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ tar\_mul}\OperatorTok{(}\NormalTok{o}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{,}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{);}
              \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{            push}\OperatorTok{(}\NormalTok{o}\OperatorTok{,}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{);}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update\_mul}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{);}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R  }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update\_mul}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{);}
  \NormalTok{            maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
          \OperatorTok{\}}
          \DataTypeTok{void}\NormalTok{ update\_ret}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ nowl }\OperatorTok{\&\&}\NormalTok{ nowr }\OperatorTok{\textless{}=}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ tar\_ret}\OperatorTok{(}\NormalTok{o}\OperatorTok{,}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{);}
              \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{            push}\OperatorTok{(}\NormalTok{o}\OperatorTok{,}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{);}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update\_ret}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R  }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update\_ret}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
  \NormalTok{            maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
          \OperatorTok{\}}
  \NormalTok{        LB query}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ nowl }\OperatorTok{\&\&}\NormalTok{ nowr }\OperatorTok{\textless{}=}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}
              \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{            push}\OperatorTok{(}\NormalTok{o}\OperatorTok{,}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{);}
  \NormalTok{            LB ans }\OperatorTok{=}\NormalTok{ LLONG\_MIN}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ query}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{));}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R  }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ query}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{));}
              \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;}
          \OperatorTok{\}} 
      \OperatorTok{\}}\KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{build}\OperatorTok{;}       \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{query}\OperatorTok{;}       \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{update\_add}\OperatorTok{;}
       \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{update\_mul}\OperatorTok{;}  \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{update\_ret}\OperatorTok{;}  \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{Groot}\OperatorTok{;}
      \DataTypeTok{void}\NormalTok{ work}\OperatorTok{()\{}
  \NormalTok{        init\_query}\OperatorTok{();}
          \DataTypeTok{int}\NormalTok{ root }\OperatorTok{=}\NormalTok{ Groot}\OperatorTok{();}\NormalTok{ build}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{);}\NormalTok{ LB one }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}
          \ControlFlowTok{while}\OperatorTok{(}\NormalTok{q}\OperatorTok{{-}{-})} \OperatorTok{\{}
              \DataTypeTok{int}\NormalTok{ t}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ x}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{t}\OperatorTok{)(}\NormalTok{L}\OperatorTok{)(}\NormalTok{R}\OperatorTok{)(}\NormalTok{x}\OperatorTok{);}\NormalTok{ L }\OperatorTok{++,}\NormalTok{ R }\OperatorTok{++;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{t }\OperatorTok{==} \DecValTok{0}\OperatorTok{)}\NormalTok{ update\_add}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ x}\OperatorTok{);}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{t }\OperatorTok{==} \DecValTok{1}\OperatorTok{)}\NormalTok{ update\_mul}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ one }\OperatorTok{/}\NormalTok{ x}\OperatorTok{);}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{t }\OperatorTok{==} \DecValTok{2}\OperatorTok{)}\NormalTok{ printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld\textbackslash{}n}\StringTok{"}\OperatorTok{,} \OperatorTok{(}\DataTypeTok{long} \DataTypeTok{long}\OperatorTok{)(}\NormalTok{query}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{)} \OperatorTok{+} \FloatTok{1e{-}10}\OperatorTok{));}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{t }\OperatorTok{==} \DecValTok{3}\OperatorTok{)}\NormalTok{ update\_ret}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
          \OperatorTok{\}}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{} \CommentTok{//freopen("in.txt", "r", stdin);}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{q}\OperatorTok{);}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ Read}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);} 
  \NormalTok{    Acceptable\_Solution}\OperatorTok{::}\NormalTok{work}\OperatorTok{();}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{D. four}\label{d.-four}
  
  ‰Ω†Êúâ \(1..2n\) ÂÖ± \(2n\) ‰∏™Êï∞ÔºåÊúâ \(n\)
  ‰∏™‰∫∫Ôºå‰Ω†‰ºöÁªôÊØè‰∏™‰∫∫ÂàÜ‰∏§‰∏™ÈöèÊú∫ÁöÑÊï∞ÔºåËøôÊ†∑Â∞±Êää \(2n\)
  ‰∏™Êï∞ÂàÜÂÆå‰∫ÜÔºåÊØè‰∏™‰∫∫Ëé∑ÂæóÁöÑÊÄªÊï∞Â∞±ÊòØËøô‰∏§‰∏™Êï∞Áõ∏Âä†„ÄÇËøô‰∏™ÈöèÊú∫ËøáÁ®ãÂèØ‰ª•ËÆ§‰∏∫ÊòØÔºåÂÖàÊää
  \(2n\)
  ‰∏™Êï∞ÈöèÊú∫ÊéíÂàóÔºåÂ∞ÜÂâç2‰∏™Êï∞ÂàÜÁªôÁ¨¨‰∏Ä‰∏™‰∫∫ÔºåÂ∞ÜÊé•‰∏ãÊù•Ââç2‰∏™Êï∞ÂàÜÁªôÁ¨¨‰∫å‰∏™‰∫∫‚Ä¶‚Ä¶‰∏çÈöæÁúãÂá∫Ëøô‰∏™ËøáÁ®ãÊòØÊ≤°ÊúâÊ≠ß‰πâÁöÑ
  
  ‰Ω†ÊÉ≥Áü•ÈÅìÊúâÂ§öÂ§ßÊ¶ÇÁéáÔºå‰ΩøÂæóÊÄªÂíåÊúÄÂ§ßÁöÑ‰∫∫ÂîØ‰∏ÄÔºà‰∏çÂ≠òÂú®‰∏§‰∏™Áõ∏ÂêåÁöÑÊúÄÂ§ßÂÄºÔºâÔºåÁ≠îÊ°àÊ®°
  \(998244353\)
  
  Ê≤°Âê¨ÊáÇ‚Ä¶„ÄÇ
  
  \subsection{Round 3}\label{round-3}
  
  \subsubsection{A. diyiti}\label{a.-diyiti}
  
  Êúâ \(n\) ‰∏™Áâ©ÂìÅÔºåÊØè‰∏™Áâ©ÂìÅ‰ª∑Ê†º \(A_i\) ÔºåÊî∂Áõä‰∏∫ \(B_i\)
  ÔºåÁî±‰∫é‰∏Ä‰∫õÂ••Â¶ôÈáçÈáçÁöÑÂéüÂõ†ÔºåÂΩì‰Ω†‰π∞‰∫Ü‰∏Ä‰∫õÁâ©ÂìÅÔºåÊÄª‰ª∑Ê†º‰∏∫ÈÄâÊã©ÁöÑ \(A_i\)
  ÁöÑÊåâ‰ΩçÊàñËÄå‰∏çÊòØ‰ª£Êï∞Áõ∏Âä†!
  
  ‰Ω†Ë∫´‰∏äÂè™Êúâ \(k\) ÂÖÉÈí±Ôºå‰Ω†Â∏åÊúõÈÄâÊã©ÊÄª‰ª∑Ê†º‰∏çË∂ÖËøá \(k\)
  ÁöÑ‰∏Ä‰∫õÁâ©ÂìÅÔºåÊù•Ëé∑ÂæóÊúÄÂ§ßÁöÑÊî∂Áõä„ÄÇ
  
  ÂØπ‰∫éÊâÄÊúâÊï∞ÊçÆÔºå\(1\leq n\leq 10^5,0\leq k < 2^{30},0 \leq A_i < 2^{30},0 \leq B_i \leq 10^9\)„ÄÇ
  
  ‰∏ÄÁßçÂ§©ÁÑ∂ÁöÑÊÉ≥Ê≥ïÂ∞±ÊòØËÄÉËôëÊûö‰∏æÔºåÊØè‰∏Ä‰∏™ \(i \le k\)
  ÁÑ∂ÂêéÁ¥ØÂä†ÊâÄÊúâÂèØ‰ª•Ë¢´ÈÄâÁöÑÁâ©ÂìÅÊ±ÇÊúÄÂ§ßÂÄºÔºåÊòæÁÑ∂ËÉΩ‰øùËØÅÊ≠£Á°ÆÊÄß„ÄÇÂæóÂà∞‰∏Ä‰∏™
  \(\mathcal{O}(k n)\) ÁöÑ‰ºòÁßÄÂÅöÊ≥ï„ÄÇ ÂèëÁé∞ËøôÊ†∑Êûö‰∏æÁöÑÊØè‰∏Ä‰∏™ \(i\)
  ÊúâÂæàÂ§öÊ≤°ÊúâÂøÖË¶ÅÁöÑÊûö‰∏æ„ÄÇ
  
  ÂÖ∂ÂÆûÂèØ‰ª•Êûö‰∏æÊîæÂºÉ \(k\) ÁöÑÂì™‰∏Ä‰Ωç \texttt{1}„ÄÇ
  
  ‰æãÂ¶Ç: Ëã• \(k = (1001101001)_2\) ÈÇ£‰πàÊúâÊÑè‰πâÁöÑ \(i\) Â∞±ÂèØËÉΩÊòØÔºö -
  \((0111111111)_2\) - \((1000111111)_2\) - \((1001011111)_2\) -
  \((1001100111)_2\) - \((1001101001)_2\)
  
  ‰πüÂ∞±ÊòØÊûö‰∏æÊüê‰∏Ä‰Ωç \(1\) ÊääËøô‰∏™ \(1\) ÂèòÊàê
  \(0\)ÔºåÁÑ∂ÂêéÊääËøôÂêéÈù¢ÁöÑÊâÄÊúâÊï∞Â≠óÂèòÊàê \(1\)„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ k}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ Lim}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ Pr}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \NormalTok{LL calc}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ x}\OperatorTok{)\{}
  \NormalTok{    LL ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)} \ControlFlowTok{if}\OperatorTok{((}\NormalTok{x }\OperatorTok{|}\NormalTok{ Lim}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \OperatorTok{==}\NormalTok{ x}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{+=}\NormalTok{ Pr}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
      \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{k}\OperatorTok{);}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ Read}\OperatorTok{(}\NormalTok{Lim}\OperatorTok{[}\NormalTok{i}\OperatorTok{])(}\NormalTok{Pr}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
  \NormalTok{    LL ans }\OperatorTok{=}\NormalTok{ calc}\OperatorTok{(}\NormalTok{k}\OperatorTok{);}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{30}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textgreater{}=} \DecValTok{0}\OperatorTok{;}\NormalTok{ i}\OperatorTok{{-}{-})\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{k }\OperatorTok{\&} \OperatorTok{(}\DecValTok{1} \OperatorTok{\textless{}\textless{}}\NormalTok{ i}\OperatorTok{))} \OperatorTok{;} \ControlFlowTok{else} \ControlFlowTok{continue}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ Lit }\OperatorTok{=}\NormalTok{ k}\OperatorTok{;}
  \NormalTok{        Lit }\OperatorTok{\^{}=} \OperatorTok{(}\DecValTok{1} \OperatorTok{\textless{}\textless{}}\NormalTok{ i}\OperatorTok{);}\NormalTok{ Lit }\OperatorTok{|=} \OperatorTok{((}\DecValTok{1} \OperatorTok{\textless{}\textless{}}\NormalTok{ i}\OperatorTok{)} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{);}
  \NormalTok{        ans }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{calc}\OperatorTok{(}\NormalTok{Lit}\OperatorTok{),}\NormalTok{ ans}\OperatorTok{);}
      \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{B. dierti}\label{b.-dierti}
  
  Áªô‰Ω†‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ \(n\) ÁöÑÊï∞ÁªÑ \(a_n\)Ôºå‰Ω†ÈúÄË¶ÅÊ±ÇÂá∫‰∏Ä‰∏™ÊúÄÈïøÁöÑÂ≠êÂ∫èÂàó
  \(C\)Ôºå‰ΩøÂæóÂÖ∂Áõ∏ÈÇª‰∏§È°πÊåâ‰Ωç‰∏éÁöÑÁªìÊûúÂùáÈùûÈõ∂
  \(( \forall\ i,\ C_i\ \And \  C_{i+1} > 0)\)„ÄÇ
  
  ËøôÊØîÁ¨¨‰∏ÄÈ¢òÂ•ΩÊÉ≥Â§ö‰∫ÜÂêß„ÄÇ ËÄÉËôë \(dp[n]\) Ë°®Á§∫ \([1, n]\) ‰∏≠Âº∫Âà∂ \(n\)
  ‰∏ÄÂÆöÈÄâ Á¨¶ÂêàË¶ÅÊ±ÇÁöÑÊúÄÈïøÂ≠êÂ∫èÂàóÔºåÂèØ‰ª•ËÄÉËôëÊûö‰∏æ \([1..n - 1]\)
  ‰∏≠‰∏ä‰∏Ä‰∏™ÈÄâÊã©ÁöÑÊòØÂì™‰∏Ä‰∏™ÔºåÂç≥
  \(dp[n] = 1 + \max_{i = 1}^{n - 1}\limits{dp[i][C_i \And C_n > 0]}\)
  ËøôÊ†∑ÁöÑÂ§çÊùÇÂ∫¶ÊòØ \(\mathcal{O}(n^2)\) ÁöÑ„ÄÇ
  
  ËÄÉËôëÂ¶ÇÊûúÊª°Ë∂≥ \(C_i \And C_j > 0\) ÈÇ£‰πàÈúÄË¶Å \(C_i, C_j\)
  Ëá≥Â∞ë‰∏Ä‰∏™‰∫åËøõÂà∂‰ΩçÁΩÆÁõ∏Âêå„ÄÇÈÇ£Â∞±Áª¥Êä§‰∏Ä‰∏™Êï∞ÁªÑÔºå\(Bmax[i]\) Ë°®Á§∫ \(C\) ÁöÑÁ¨¨
  \(i\) ‰Ωç‰∏∫ \(1\) ÁöÑÊâÄÊúâ \(C_j\) ÊúÄÂ§ßÁöÑ \(dp[j]\)ÔºåÂç≥ÂèØÂÆûÁé∞
  \(\mathcal{O}(\log C_{max})\) ËΩ¨Áßª„ÄÇÂêåÊó∂ÈúÄË¶Å
  \(\mathcal{O}(\log C_{max})\) Áª¥Êä§Êï∞ÁªÑ \(Bmax\)„ÄÇ
  
  ÊÄªÂ§çÊùÇÂ∫¶ \(\mathcal{O}(n\log C_{max} )\)„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ A}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ Bmax}\OperatorTok{[}\DecValTok{60}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ dp}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    n }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ Read}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
  \NormalTok{    dp}\OperatorTok{[}\DecValTok{1}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \DecValTok{30}\OperatorTok{)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\DecValTok{1}\OperatorTok{]} \OperatorTok{\&} \OperatorTok{(}\DecValTok{1} \OperatorTok{\textless{}\textless{}}\NormalTok{ j}\OperatorTok{))}\NormalTok{ Bmax}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{Bmax}\OperatorTok{[}\NormalTok{j}\OperatorTok{],}\NormalTok{ dp}\OperatorTok{[}\DecValTok{1}\OperatorTok{]);}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{2}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \DecValTok{30}\OperatorTok{)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{\&} \OperatorTok{(}\DecValTok{1} \OperatorTok{\textless{}\textless{}}\NormalTok{ j}\OperatorTok{))}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ Bmax}\OperatorTok{[}\NormalTok{j}\OperatorTok{]);}
  \NormalTok{        dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ ans }\OperatorTok{+} \DecValTok{1}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \DecValTok{30}\OperatorTok{)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{\&} \OperatorTok{(}\DecValTok{1} \OperatorTok{\textless{}\textless{}}\NormalTok{ j}\OperatorTok{))}\NormalTok{ Bmax}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{Bmax}\OperatorTok{[}\NormalTok{j}\OperatorTok{],}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}\NormalTok{ cerr }\OperatorTok{\textless{}\textless{}} \StringTok{"std\textquotesingle{}s ans = "} \OperatorTok{\textless{}\textless{}}\NormalTok{ ans }\OperatorTok{\textless{}\textless{}}\NormalTok{ endl}\OperatorTok{;}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{C. disanti}\label{c.-disanti}
  
  \paragraph{statement}\label{statement}
  
  ‰Ω†Êúâ \(n\) ‰∏™ \(10\) ËøõÂà∂‰∏ãÁöÑ‰ΩçÊï∞‰∏∫ \(m\) ÁöÑÊï∞
  
  Êúâ‰∫õÊï∞Â≠óË¢´ÊäπÂéª‰∫ÜÔºåÂõ†Ê≠§ÂèñÂÄº‰ªªÊÑè„ÄÇ
  
  ‰Ω†Â∏åÊúõËøô \(n\) ‰∏™Êï∞ÂçïË∞ÉÈÄíÂ¢ûÔºåËØ∑Ê±ÇÂá∫ÊâÄÊúâÊª°Ë∂≥Ëøô‰∏™Êù°‰ª∂ÁöÑÊñπÊ°à‰∏ãÔºåËøô \(n\)
  ‰∏™Êï∞‰πãÂíåÁöÑÊÄªÂíå„ÄÇ
  
  Á≠îÊ°àÂØπ \(998244353\) ÂèñÊ®°„ÄÇ
  
  \(n,m\leq 30\) \#\#\#\# input
  
  Á¨¨‰∏ÄË°å‰∏§‰∏™Êï¥Êï∞ \(n,m(1\leq n,m\leq 50)\)
  
  Êé•‰∏ãÊù• \(n\) Ë°åÔºåÊØèË°å \(m\) ‰∏™Â≠óÁ¨¶ÔºåÂ≠óÁ¨¶‰∏∫ \(0..9\)
  ÁöÑÊï∞Â≠óÊàñËÄÖ\texttt{?}„ÄÇ
  
  \begin{verbatim}
  INPUT0:
  4 1
  0
  ?
  4
  8
  OUTPUT0:
  42
  \end{verbatim}
  
  \begin{verbatim}
  INPUT1:
  5 5
  ?1234
  23333
  ???66
  ??666
  ?233?
  OUTPUT1:
  819525655
  \end{verbatim}
  
  Ê≤°Âê¨ÊáÇ‚Ä¶ ÂæÖË°•„ÄÇ
  
  \subsubsection{D. disiti}\label{d.-disiti}
  
  ‰Ω†Êúâ‰∏ÄÂ†Ü\(n\)‰∏™Áü≥Â≠êÁöÑÁü≥Â≠êÂ†ÜÔºå‰Ω†ÊÉ≥Ë¶ÅÊääÁü≥Â≠êÂ†ÜË£ÇÊàê\(n\)‰∏™Â§ßÂ∞è‰∏∫\(1\)ÁöÑÁü≥Â≠êÂ†Ü„ÄÇ‰∏∫‰∫ÜËææÊàêËøô‰∏™ÁõÆÁöÑÔºå‰Ω†ÊØèÊ¨°ÂèØ‰ª•ËøõË°åÂ¶Ç‰∏ãÊìç‰ΩúÔºöÂÅáËÆæÁé∞Âú®Êúâ\(k\)Â†ÜÁü≥Â≠êÔºåÂ§ßÂ∞èÂàÜÂà´‰∏∫\(a_1, a_2, ... ,a_k\)Ôºå‰Ω†ÂèØ‰ª•ÊåáÂÆö‰∏Ä‰∏™ÈùûË¥üÊï¥Êï∞Â∫èÂàó\(b_1, b_2, ... ,b_k\)ÔºåÊª°Ë∂≥\(\sum b_i\leq m\)ÔºåÊØèÂ†ÜÁü≥Â≠êÂ∞±‰ºöÂàÜË£ÇÊàê‰∏§Â†Ü\(b_i, a_i-b_i\)ÔºàÂ¶ÇÊûú‰∏∫\(0\)Â∞±ËÆ§‰∏∫‰∏çÂ≠òÂú®ÔºåÊòæÁÑ∂ËøòÈúÄË¶ÅÊª°Ë∂≥\(b_i \leq a_i\)Ôºâ„ÄÇ‰Ω†ÊÉ≥Ë¶ÅÁü•ÈÅìÊúÄÂ∞ëÂá†Ê¨°Êìç‰ΩúÂèØ‰ª•ËææÊàêÁõÆÁöÑ„ÄÇ
  ÂØπ‰∫éÊâÄÊúâÊï∞ÊçÆÔºå\(T\leq 1000,1\leq m\leq n\leq 10^9\)
  
  Ê≤°Âê¨ÊáÇ‚Ä¶ ÂæÖË°•„ÄÇ
  
  \subsection{Round 4}\label{round-4}
  
  \subsubsection{A. ‰∏Ä}\label{a.-ux4e00}
  
  ‰Ω†ÊòØËÉΩÁúãÂà∞Á¨¨‰∏ÄÈ¢òÁöÑfriendsÂë¢„ÄÇ ‚Äî‚Äîhja
  ‰ºóÊâÄÂë®Áü•ÔºåÂ∞èËë±ÂêåÂ≠¶ÊìÖÈïøËÆ°ÁÆóÔºåÂ∞§ÂÖ∂ÊìÖÈïøËÆ°ÁÆóÁªÑÂêàÊï∞Ôºå‰ΩÜËøô‰∏™È¢òÂíåÁªÑÂêàÊï∞Ê≤°‰ªÄ‰πàÂÖ≥Á≥ª„ÄÇ
  
  Áé∞Âú®Êàë‰ª¨Ë¶ÅÊâßË°åËã•Âπ≤‰ª£Á†ÅÔºå‰ª£Á†Å‰∏∫ÂØπ‰∫éÂèòÈáèÁöÑÊìç‰ΩúÔºåÂåÖÂê´‰ª•‰∏ã‰∏âÁßçÔºö -
  1„ÄÅÂèòÈáèÂêç=ÂèòÈáèÂÄºÔºåÂèòÈáèÂêçÁî±Â∞èÂÜôÂ≠óÊØçÁªÑÊàêÔºåÂèòÈáèÂÄºÊúâÂèØËÉΩÊòØÊ≠£Êï¥Êï∞ÊàñËÄÖÂ≠óÁ¨¶‰∏≤ÔºàÂ∞èÂÜôÂ≠óÊØçÊàñËÄÖÊï∞Â≠óÔºâÔºå‰æãÂ¶ÇÔºöa=3,b=‚Äú233‚Äù„ÄÇ
  - 2„ÄÅÂèòÈáèÂêçÔºå‰ª£Ë°®ËØ¢ÈóÆËØ•ÂèòÈáèÁöÑÂÄºÔºåÂ¶ÇÊûúËØ•ÂèòÈáèÊú™ËµãÂÄºÔºåÂàôËæìÂá∫no„ÄÇ -
  3„ÄÅÂèòÈáèÂêç+=ÂÄºÔºåÂ¶ÇÊûúËØ•ÂèòÈáèÊú™ÂÆö‰πâÔºåÁõ¥Êé•Ë∑≥ËøáËØ•Ê¨°Êìç‰Ωú„ÄÇËÆæËØ•ÂèòÈáèÁöÑÂÄº‰∏∫xÔºåÂä†‰∏äÁöÑÂÄº‰∏∫yÔºåÂ¶ÇÊûú‰∏§ËÄÖÂùá‰∏∫Êï¥Êï∞Áõ¥Êé•Áõ∏Âä†ÔºõÂ¶ÇÊûúxÊòØÊï¥Êï∞y‰∏∫Â≠óÁ¨¶‰∏≤ÂàôË∑≥ËøáÊ≠§Ê¨°Êìç‰ΩúÔºõÂ¶ÇÊûúxÊòØÂ≠óÁ¨¶‰∏≤yÊòØÊï¥Êï∞ÂàôÂ∞ÜyËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤ËøõË°åÂ≠óÁ¨¶‰∏≤ÊãºÊé•ÔºõÂ¶ÇÊûú‰∏§ËÄÖÂùá‰∏∫Â≠óÁ¨¶‰∏≤Áõ¥Êé•ËøõË°åÂ≠óÁ¨¶‰∏≤ÊãºÊé•„ÄÇ
  -
  
  ÂÖ®Á®ã STL„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \NormalTok{map}\OperatorTok{\textless{}}\NormalTok{string }\OperatorTok{,}\NormalTok{ string}\OperatorTok{\textgreater{}}\NormalTok{ M}\OperatorTok{;}
  \NormalTok{map}\OperatorTok{\textless{}}\NormalTok{string }\OperatorTok{,} \DataTypeTok{bool} \OperatorTok{\textgreater{}}\NormalTok{ Type}\OperatorTok{;} \CommentTok{// true for string , false for int}
  \NormalTok{string tmp}\OperatorTok{;}
  \NormalTok{pair}\OperatorTok{\textless{}}\NormalTok{string }\OperatorTok{,}\NormalTok{ string}\OperatorTok{\textgreater{}}\NormalTok{ Res}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ split}\OperatorTok{(}\NormalTok{string S}\OperatorTok{)\{}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{S}\OperatorTok{.}\NormalTok{find}\OperatorTok{(}\CharTok{\textquotesingle{}=\textquotesingle{}}\OperatorTok{)} \OperatorTok{\textgreater{}=}\NormalTok{ S}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{||}\NormalTok{ S}\OperatorTok{.}\NormalTok{find}\OperatorTok{(}\CharTok{\textquotesingle{}=\textquotesingle{}}\OperatorTok{)} \OperatorTok{\textless{}} \DecValTok{0}\OperatorTok{)\{} \CommentTok{// }\AlertTok{TODO}\CommentTok{: check}
          \ControlFlowTok{return} \DecValTok{2}\OperatorTok{;}
      \OperatorTok{\}} \ControlFlowTok{else} \OperatorTok{\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{S}\OperatorTok{.}\NormalTok{find}\OperatorTok{(}\CharTok{\textquotesingle{}+\textquotesingle{}}\OperatorTok{)} \OperatorTok{\textless{}}\NormalTok{ S}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{\&\&}\NormalTok{ S}\OperatorTok{.}\NormalTok{find}\OperatorTok{(}\CharTok{\textquotesingle{}+\textquotesingle{}}\OperatorTok{)} \OperatorTok{\textgreater{}=} \DecValTok{0}\OperatorTok{)\{}
  \NormalTok{            Res }\OperatorTok{=}\NormalTok{ make\_pair}\OperatorTok{(}\NormalTok{S}\OperatorTok{.}\NormalTok{substr}\OperatorTok{(}\DecValTok{0}\OperatorTok{,}\NormalTok{ S}\OperatorTok{.}\NormalTok{find}\OperatorTok{(}\CharTok{\textquotesingle{}+\textquotesingle{}}\OperatorTok{)),}\NormalTok{ S}\OperatorTok{.}\NormalTok{substr}\OperatorTok{(}\NormalTok{S}\OperatorTok{.}\NormalTok{find}\OperatorTok{(}\CharTok{\textquotesingle{}=\textquotesingle{}}\OperatorTok{)} \OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ S}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}}\NormalTok{ S}\OperatorTok{.}\NormalTok{find}\OperatorTok{(}\CharTok{\textquotesingle{}=\textquotesingle{}}\OperatorTok{)} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{));}
              \ControlFlowTok{return} \DecValTok{3}\OperatorTok{;}
          \OperatorTok{\}} \ControlFlowTok{else} \OperatorTok{\{}
  \NormalTok{            Res }\OperatorTok{=}\NormalTok{ make\_pair}\OperatorTok{(}\NormalTok{S}\OperatorTok{.}\NormalTok{substr}\OperatorTok{(}\DecValTok{0}\OperatorTok{,}\NormalTok{ S}\OperatorTok{.}\NormalTok{find}\OperatorTok{(}\CharTok{\textquotesingle{}=\textquotesingle{}}\OperatorTok{)),}\NormalTok{ S}\OperatorTok{.}\NormalTok{substr}\OperatorTok{(}\NormalTok{S}\OperatorTok{.}\NormalTok{find}\OperatorTok{(}\CharTok{\textquotesingle{}=\textquotesingle{}}\OperatorTok{)} \OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ S}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}}\NormalTok{ S}\OperatorTok{.}\NormalTok{find}\OperatorTok{(}\CharTok{\textquotesingle{}=\textquotesingle{}}\OperatorTok{)} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{));}
              \ControlFlowTok{return} \DecValTok{1}\OperatorTok{;}
          \OperatorTok{\}}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \NormalTok{string calc}\OperatorTok{(}\NormalTok{string A}\OperatorTok{,}\NormalTok{ string B}\OperatorTok{)\{}
      \DataTypeTok{long} \DataTypeTok{long}\NormalTok{ ResA }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ A}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{)\{}
  \NormalTok{        ResA }\OperatorTok{*=} \DecValTok{10}\OperatorTok{;}
  \NormalTok{        ResA }\OperatorTok{+=}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{{-}} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{;}
      \OperatorTok{\}}
      \DataTypeTok{long} \DataTypeTok{long}\NormalTok{ ResB }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ B}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{)\{}
  \NormalTok{        ResB }\OperatorTok{*=} \DecValTok{10}\OperatorTok{;}
  \NormalTok{        ResB }\OperatorTok{+=}\NormalTok{ B}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{{-}} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{;}
      \OperatorTok{\}}
  \NormalTok{    ResA }\OperatorTok{+=}\NormalTok{ ResB}\OperatorTok{;}
  \NormalTok{    string Res}\OperatorTok{,}\NormalTok{ ans }\OperatorTok{;}\NormalTok{ Res }\OperatorTok{=} \StringTok{""}\OperatorTok{;}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{ResA}\OperatorTok{)}\NormalTok{ Res}\OperatorTok{.}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{ResA }\OperatorTok{\%} \DecValTok{10} \OperatorTok{+} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{),}\NormalTok{ ResA }\OperatorTok{/=} \DecValTok{10}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ Res}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textgreater{}=} \DecValTok{0}\OperatorTok{;}\NormalTok{ i}\OperatorTok{{-}{-})}\NormalTok{ ans}\OperatorTok{.}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{Res}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
      \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{bool}\NormalTok{ pdType}\OperatorTok{(}\NormalTok{string }\OperatorTok{\&}\NormalTok{S}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return}\NormalTok{ S}\OperatorTok{[}\DecValTok{0}\OperatorTok{]} \OperatorTok{==} \CharTok{\textquotesingle{}"\textquotesingle{}}\OperatorTok{;} \OperatorTok{\}} \CommentTok{// true for string}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{} \CommentTok{//freopen("in.txt", "r", stdin); freopen("out.txt", "w", stdout);}
  \NormalTok{    ios}\OperatorTok{::}\NormalTok{sync\_with\_stdio}\OperatorTok{(}\KeywordTok{false}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ q}\OperatorTok{;}\NormalTok{ cin }\OperatorTok{\textgreater{}\textgreater{}}\NormalTok{ q}\OperatorTok{;}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{q}\OperatorTok{{-}{-})\{}
  \NormalTok{        cin }\OperatorTok{\textgreater{}\textgreater{}}\NormalTok{ tmp}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ r }\OperatorTok{=}\NormalTok{ split}\OperatorTok{(}\NormalTok{tmp}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{r }\OperatorTok{==} \DecValTok{1}\OperatorTok{)\{}
              \DataTypeTok{int}\NormalTok{ re }\OperatorTok{=}\NormalTok{ pdType}\OperatorTok{(}\NormalTok{Res}\OperatorTok{.}\NormalTok{second}\OperatorTok{);} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{re}\OperatorTok{)}\NormalTok{ Res}\OperatorTok{.}\NormalTok{second }\OperatorTok{=} \OperatorTok{(}\NormalTok{Res}\OperatorTok{.}\NormalTok{second}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{==} \DecValTok{2} \OperatorTok{?}\NormalTok{ string}\OperatorTok{(}\StringTok{""}\OperatorTok{)} \OperatorTok{:}\NormalTok{ Res}\OperatorTok{.}\NormalTok{second}\OperatorTok{.}\NormalTok{substr}\OperatorTok{(}\DecValTok{1}\OperatorTok{,}\NormalTok{ Res}\OperatorTok{.}\NormalTok{second}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}} \DecValTok{2}\OperatorTok{));}
  \NormalTok{            M}\OperatorTok{[}\NormalTok{Res}\OperatorTok{.}\NormalTok{first}\OperatorTok{]} \OperatorTok{=}\NormalTok{ Res}\OperatorTok{.}\NormalTok{second}\OperatorTok{;}
  \NormalTok{            Type}\OperatorTok{[}\NormalTok{Res}\OperatorTok{.}\NormalTok{first}\OperatorTok{]} \OperatorTok{=}\NormalTok{ re}\OperatorTok{;}
          \OperatorTok{\}} \ControlFlowTok{else} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{r }\OperatorTok{==} \DecValTok{2}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{M}\OperatorTok{.}\NormalTok{count}\OperatorTok{(}\NormalTok{tmp}\OperatorTok{))}\NormalTok{  cout }\OperatorTok{\textless{}\textless{}}\NormalTok{ M}\OperatorTok{[}\NormalTok{tmp}\OperatorTok{]} \OperatorTok{\textless{}\textless{}}\NormalTok{ endl}\OperatorTok{;}
              \ControlFlowTok{else}\NormalTok{ cout }\OperatorTok{\textless{}\textless{}} \StringTok{"no"} \OperatorTok{\textless{}\textless{}}\NormalTok{ endl}\OperatorTok{;}
          \OperatorTok{\}} \ControlFlowTok{else} \OperatorTok{\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{M}\OperatorTok{.}\NormalTok{count}\OperatorTok{(}\NormalTok{Res}\OperatorTok{.}\NormalTok{first}\OperatorTok{))} \OperatorTok{;} \ControlFlowTok{else} \ControlFlowTok{continue}\OperatorTok{;}
              \DataTypeTok{int} \DataTypeTok{ex\_t} \OperatorTok{=}\NormalTok{ pdType}\OperatorTok{(}\NormalTok{Res}\OperatorTok{.}\NormalTok{second}\OperatorTok{);} \ControlFlowTok{if}\OperatorTok{(}\DataTypeTok{ex\_t}\OperatorTok{)}\NormalTok{ Res}\OperatorTok{.}\NormalTok{second }\OperatorTok{=}\NormalTok{ Res}\OperatorTok{.}\NormalTok{second}\OperatorTok{.}\NormalTok{substr}\OperatorTok{(}\DecValTok{1}\OperatorTok{,}\NormalTok{ Res}\OperatorTok{.}\NormalTok{second}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}} \DecValTok{2}\OperatorTok{);}
              \DataTypeTok{int} \DataTypeTok{no\_t} \OperatorTok{=}\NormalTok{ Type}\OperatorTok{[}\NormalTok{Res}\OperatorTok{.}\NormalTok{first}\OperatorTok{];}
              \ControlFlowTok{if}\OperatorTok{(} \DataTypeTok{ex\_t} \OperatorTok{\&\&}  \DataTypeTok{no\_t}\OperatorTok{)}\NormalTok{ M}\OperatorTok{[}\NormalTok{Res}\OperatorTok{.}\NormalTok{first}\OperatorTok{]} \OperatorTok{=}\NormalTok{ M}\OperatorTok{[}\NormalTok{Res}\OperatorTok{.}\NormalTok{first}\OperatorTok{]} \OperatorTok{+}\NormalTok{ Res}\OperatorTok{.}\NormalTok{second}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(} \DataTypeTok{ex\_t} \OperatorTok{\&\&} \OperatorTok{!}\DataTypeTok{no\_t}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{continue}\OperatorTok{;} \OperatorTok{\}}
              \ControlFlowTok{if}\OperatorTok{(!}\DataTypeTok{ex\_t} \OperatorTok{\&\&}  \DataTypeTok{no\_t}\OperatorTok{)}\NormalTok{ M}\OperatorTok{[}\NormalTok{Res}\OperatorTok{.}\NormalTok{first}\OperatorTok{]} \OperatorTok{=}\NormalTok{ M}\OperatorTok{[}\NormalTok{Res}\OperatorTok{.}\NormalTok{first}\OperatorTok{]} \OperatorTok{+}\NormalTok{ Res}\OperatorTok{.}\NormalTok{second}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(!}\DataTypeTok{ex\_t} \OperatorTok{\&\&} \OperatorTok{!}\DataTypeTok{no\_t}\OperatorTok{)}\NormalTok{ M}\OperatorTok{[}\NormalTok{Res}\OperatorTok{.}\NormalTok{first}\OperatorTok{]} \OperatorTok{=}\NormalTok{ calc}\OperatorTok{(}\NormalTok{M}\OperatorTok{[}\NormalTok{Res}\OperatorTok{.}\NormalTok{first}\OperatorTok{],}\NormalTok{ Res}\OperatorTok{.}\NormalTok{second}\OperatorTok{);}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{B. ‰∫å}\label{b.-ux4e8c}
  
  ‰Ω†ÊòØËÉΩÁúãÂà∞Á¨¨‰∫åÈ¢òÁöÑfriendsÂë¢„ÄÇ ‚Äî‚Äîaoao
  
  ‰ºóÊâÄÂë®Áü•ÔºåÂ∞èËë±ÂêåÂ≠¶ÊìÖÈïøËÆ°ÁÆóÔºåÂ∞§ÂÖ∂ÊìÖÈïøËÆ°ÁÆóÁªÑÂêàÊï∞Ôºå‰ΩÜËøô‰∏™È¢òÂíåÁªÑÂêàÊï∞Ê≤°‰ªÄ‰πàÂÖ≥Á≥ª„ÄÇ
  \(N\) ‰∏™Â∞èÂÜôÂ≠óÊØçÂ≠óÁ¨¶‰∏≤Ôºå Alice Âíå Bob ÊåâÁÖßÂ¶Ç‰∏ãÊñπÊ≥ïÁé©Ê∏∏ÊàèÔºö -
  1„ÄÅAliceÈÄâÊã©‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂπ∂ÈáçÊñ∞ÂÆö‰πâ \(26\)
  ‰∏™Â≠óÊØçÁöÑÂ≠óÂÖ∏Â∫èÔºåÁÑ∂ÂêéÂÜçÂ∞ÜËøô‰∏™Â≠óÁ¨¶‰∏≤ÂÜÖÈÉ®Â≠óÁ¨¶ÊåâÁÖß‰ªªÊÑèÈ°∫Â∫èÈáçÊéí„ÄÇ -
  2„ÄÅBob‰ªéÂâ©‰∏ãÁöÑÂ≠óÁ¨¶‰∏≤‰∏≠ÈÄâÊã©‰∏Ä‰∏™ÔºåÂπ∂Â∞ÜËøô‰∏™Â≠óÁ¨¶‰∏≤ÂÜÖÈÉ®Â≠óÁ¨¶ÊåâÁÖß‰ªªÊÑèÈ°∫Â∫èÈáçÊéí„ÄÇ
  ‰ªñ‰ª¨ÁöÑÁõÆÊ†áÊòØ‰ΩøÂæóËá™Â∑±Â≠óÁ¨¶‰∏≤ÁöÑÂ≠óÂÖ∏Â∫èÊØîÂØπÈù¢Â∞èÔºåË∞ÅÁöÑÂ≠óÁ¨¶‰∏≤Â≠óÂÖ∏Â∫èÊõ¥Â∞èË∞ÅÂ∞±Ëµ¢‰∫Ü„ÄÇÈóÆ
  Alice ÊúâÂ§öÂ∞ë‰∏™ÂèØ‰ª•ÈÄâÊã©ÁöÑÂ≠óÁ¨¶‰∏≤ËÉΩÂ§ü‰ΩøÂæóËá™Â∑±Ëé∑ËÉúÔºü \(N \le 1000\)
  
  Âõ†‰∏∫ÂèØ‰ª•ÈáçÊñ∞ÊéíÂàóÂ≠óÁ¨¶‰∏≤ÔºåÊâÄ‰ª•ÂØπ‰∫éÊØè‰∏™Â≠óÁ¨¶‰∏≤Êù•ËØ¥ÔºåÊúâÁî®ÁöÑ‰ø°ÊÅØÂ∞±ÊòØÊØè‰∏™Â≠óÁ¨¶‰∏≤‰∏≠ÊØè‰∏™Â≠óÁ¨¶ÁöÑÂá∫Áé∞Ê¨°Êï∞„ÄÇ
  
  ÂèØ‰ª•ËÄÉËôëÂÖàÊûö‰∏æ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÁÑ∂ÂêéÂà§Êñ≠Ëøô‰∏™Â≠óÁ¨¶‰∏≤ÊòØÂê¶ËÉΩË¢´ Alice
  ÈÄâ„ÄÇÁÑ∂ÂêéËÄÉËôëÁ°ÆÂÆöÂ≠óÂÖ∏Â∫èÔºåÂèØ‰ª•‰ª•Ê≠§ËÄÉËôëÂ≠óÂÖ∏Â∫èÊúÄÂ∞èÁöÑÂ∫îËØ•ÊòØÂì™‰∏™Â≠óÁ¨¶ÔºåÁ°ÆÂÆö‰∫ÜÂ≠óÂÖ∏Â∫èÊúÄÂ∞èÁöÑÂ≠óÁ¨¶‰πãÂêéÔºåÂèØ‰ª•ÊéíÈô§Êéâ‰∏Ä‰∫õÂ≠óÁ¨¶‰∏≤ÔºàÂ≠óÂÖ∏Â∫èÊúÄÂ∞èÁöÑÂ≠óÁ¨¶Âú®Ëøô‰∫õ‰∏≤‰∏≠ÁöÑÂá∫Áé∞Ê¨°Êï∞
  \(<\) Âú®Êûö‰∏æ‰∏≤‰∏≠ÁöÑÂá∫Áé∞Ê¨°Êï∞ÔºâÔºåÁÑ∂ÂêéÂèàËΩ¨ÂåñÊàêÂéüÊù•Áõ∏ÂêåÁöÑÈóÆÈ¢ò„ÄÇ
  
  ÂÖ≥ÈîÆÂú®‰∫éÂ¶Ç‰ΩïÁ°ÆÂÆöÂΩìÂâçÊÉÖÂÜµ‰∏ãÂ≠óÂÖ∏Â∫èÊúÄÂ∞èÁöÑÂ≠óÁ¨¶„ÄÇÊòæÁÑ∂ÔºåÁêÜÊÉ≥ÁöÑÂ≠óÂÖ∏Â∫èÊúÄÂ∞èÁöÑÂ≠óÁ¨¶
  Âú®ÂΩìÂâçÊûö‰∏æÂà∞ÁöÑÂ≠óÁ¨¶‰∏≤‰∏≠ÁöÑÂá∫Áé∞Ê¨°Êï∞‰∏ÄÂÆö‰∏çÂ∞ë‰∫éÂú®ÂÖ∂‰ªñ‰∏≤‰∏≠ÁöÑÂá∫Áé∞Ê¨°Êï∞„ÄÇ‰ΩÜÊòØËøôÊ†∑ÁöÑÂ≠óÁ¨¶ÂèØËÉΩÊúâÂ§ö‰∏™ÔºåÂ∫îËØ•ÈÄâÂì™‰∏™Ôºü
  
  ÂÖ∂ÂÆûÈÄâÂì™‰∏™ÊïàÊûú‰∏ÄÊ†∑ÔºåÊú¨Ë¥®‰∏äÂè™ÊòØ‰ª•Ê≠§ÈÄâÊã©ÂΩìÂâçÊÉÖÂÜµ‰∏ãÂ≠óÂÖ∏Â∫èÊúÄÂ∞èÁöÑÂ≠óÁ¨¶ÔºåÁÑ∂ÂêéÂâîÈô§‰∏Ä‰∫õÂ≠óÁ¨¶‰∏≤Ôºå‰ΩÜÊòØÂâîÈô§Â≠óÁ¨¶‰∏≤ÁöÑÊù°‰ª∂ÂíåÂâîÈô§È°∫Â∫èÊó†ÂÖ≥„ÄÇ
  
  ÊúÄÂêéÂà§Êñ≠ÊòØÂê¶ÊâÄÊúâÂ≠óÁ¨¶‰∏≤ÈÉΩË¢´ÂâîÈô§ÊéâÂç≥ÂèØ„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \PreprocessorTok{\#include }\ImportTok{\textless{}cstdio\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}cstring\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}iostream\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}cmath\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}cstring\textgreater{}}
  \PreprocessorTok{\#include }\ImportTok{\textless{}algorithm\textgreater{}}
  \PreprocessorTok{\#define rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{l}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{r}\OperatorTok{)}\PreprocessorTok{ }\ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{l}\OperatorTok{),}\PreprocessorTok{ }\NormalTok{\_\_}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{r}\OperatorTok{);}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{\textless{}=}\PreprocessorTok{ }\NormalTok{\_\_}\OperatorTok{;}\PreprocessorTok{ }\NormalTok{i}\OperatorTok{++)}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \DecValTok{1010}\OperatorTok{;}
  \KeywordTok{using} \KeywordTok{namespace}\NormalTok{ std}\OperatorTok{;}
  \KeywordTok{inline} \DataTypeTok{int}\NormalTok{ idx}\OperatorTok{(}\DataTypeTok{char}\NormalTok{ c}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return}\NormalTok{ c }\OperatorTok{{-}} \CharTok{\textquotesingle{}a\textquotesingle{}} \OperatorTok{+} \DecValTok{1}\OperatorTok{;} \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ ch}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\DecValTok{30}\OperatorTok{];} \DataTypeTok{int}\NormalTok{ n}\OperatorTok{;} 
  \DataTypeTok{char}\NormalTok{ S}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{bool}\NormalTok{ book}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{bool}\NormalTok{ bch}\OperatorTok{[}\DecValTok{200}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    scanf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,} \OperatorTok{\&}\NormalTok{n}\OperatorTok{);}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ scanf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%s}\StringTok{"}\OperatorTok{,}\NormalTok{ S }\OperatorTok{+} \DecValTok{1}\OperatorTok{);} \DataTypeTok{int}\NormalTok{ k }\OperatorTok{=}\NormalTok{ strlen}\OperatorTok{(}\NormalTok{S }\OperatorTok{+} \DecValTok{1}\OperatorTok{);}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ k}\OperatorTok{)}\NormalTok{ ch}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{idx}\OperatorTok{(}\NormalTok{S}\OperatorTok{[}\NormalTok{j}\OperatorTok{])]} \OperatorTok{++;} \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)\{}
  \NormalTok{        memset}\OperatorTok{(}\NormalTok{book}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{book}\OperatorTok{));}\NormalTok{ memset}\OperatorTok{(}\NormalTok{bch}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{bch}\OperatorTok{));}\NormalTok{ book}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,} \DecValTok{26}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{            rep}\OperatorTok{(}\NormalTok{k}\OperatorTok{,} \CharTok{\textquotesingle{}a\textquotesingle{}}\OperatorTok{,} \CharTok{\textquotesingle{}z\textquotesingle{}}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{bch}\OperatorTok{[}\NormalTok{k}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;} 
                  \DataTypeTok{bool}\NormalTok{ pass }\OperatorTok{=} \KeywordTok{true}\OperatorTok{;}
  \NormalTok{                rep}\OperatorTok{(}\NormalTok{l}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)} \OperatorTok{\{}
                      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{book}\OperatorTok{[}\NormalTok{l}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
                      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{ch}\OperatorTok{[}\NormalTok{l}\OperatorTok{][}\NormalTok{idx}\OperatorTok{(}\NormalTok{k}\OperatorTok{)]} \OperatorTok{\textgreater{}}\NormalTok{ ch}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{idx}\OperatorTok{(}\NormalTok{k}\OperatorTok{)])} \OperatorTok{\{}\NormalTok{ pass }\OperatorTok{=} \KeywordTok{false}\OperatorTok{;} \ControlFlowTok{break}\OperatorTok{;} \OperatorTok{\}}
                  \OperatorTok{\}}
                  \ControlFlowTok{if}\OperatorTok{(}\NormalTok{pass}\OperatorTok{)\{}
  \NormalTok{                    bch}\OperatorTok{[}\NormalTok{k}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{                    rep}\OperatorTok{(}\NormalTok{l}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{ch}\OperatorTok{[}\NormalTok{l}\OperatorTok{][}\NormalTok{idx}\OperatorTok{(}\NormalTok{k}\OperatorTok{)]} \OperatorTok{\textless{}}\NormalTok{ ch}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{idx}\OperatorTok{(}\NormalTok{k}\OperatorTok{)])}\NormalTok{ book}\OperatorTok{[}\NormalTok{l}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
                      \ControlFlowTok{break}\OperatorTok{;}
                  \OperatorTok{\}}
              \OperatorTok{\}}
          \OperatorTok{\}}
          \DataTypeTok{bool}\NormalTok{ pass }\OperatorTok{=} \KeywordTok{true}\OperatorTok{;}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{book}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{!=} \DecValTok{1}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ pass }\OperatorTok{=} \KeywordTok{false}\OperatorTok{;} \ControlFlowTok{break}\OperatorTok{;} \OperatorTok{\}}
  \NormalTok{        ans }\OperatorTok{+=}\NormalTok{ pass}\OperatorTok{;}
      \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{C. ‰∏â}\label{c.-ux4e09}
  
  ‰Ω†ÊòØËÉΩÁúãÂà∞Á¨¨‰∏âÈ¢òÁöÑfriendsÂë¢„ÄÇ ‚Äî‚Äîlaekov
  ‰ºóÊâÄÂë®Áü•ÔºåÂ∞èËë±ÂêåÂ≠¶ÊìÖÈïøËÆ°ÁÆóÔºåÂ∞§ÂÖ∂ÊìÖÈïøËÆ°ÁÆóÁªÑÂêàÊï∞Ôºå‰ΩÜËøô‰∏™È¢òÂíåÁªÑÂêàÊï∞Ê≤°‰ªÄ‰πàÂÖ≥Á≥ª„ÄÇ
  
  ÁªôÂÆö\(N\)‰∏™Êï∞ÔºåËÆæÊÄªÂÖ±Êúâ\(M\)‰∏™Âå∫Èó¥\(p_1=[l_1,r_1],p_2=[l_2,r_2 ],\cdots,p_M=[l_m,r_m]\)ÁöÑÈÄÜÂ∫èÂØπÊï∞Èáè‰∏çÂ∞ë‰∫é\(K\)‰∏™„ÄÇÂÆö‰πâÂáΩÊï∞\(f(p_i,p_j)\)‰∏∫ËÆ°ÁÆó‰∏§‰∏™Âå∫Èó¥ÁöÑ‰∫§ÈõÜÂ§ßÂ∞èÁöÑÂáΩÊï∞ÔºàÂç≥ÂÖ±ÂêåË¶ÜÁõñ‰∫ÜÂ§öÂ∞ë‰∏™Êï∞Ôºâ„ÄÇÊ±Ç
  \(\sum_{i=1}^M\sum_{j=i+1}^M f(p_i,p_j)\) \(N \le 10^6\)
  
  ËÄÉËôëÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑË¥°ÁåÆÔºå‰∏çÈöæÂèëÁé∞ÔºåÂÖÉÁ¥†ÁöÑË¥°ÁåÆ‰∏∫
  \(\binom{Ë¢´Ë¶ÜÁõñÁöÑÂå∫Èó¥Êï∞}{2}\) ÔºåÈóÆÈ¢òËΩ¨Âåñ‰∏∫ÊÄé‰πàÊ±ÇÊØè‰∏™ÂÖÉÁ¥†Ë¢´Ë¶ÜÁõñÁöÑÊ¨°Êï∞„ÄÇ
  
  ËÄÉËôëÂØπ‰∫éÊØè‰∏Ä‰∏™Â∑¶Á´ØÁÇπ \(L\)ÔºåÂêàÊ≥ïÁöÑÂè≥Á´ØÁÇπÂèñÂÄº‰∏ÄÂÆöÊòØ‰∏ÄÊÆµËøûÁª≠ÁöÑÂå∫Èó¥Ôºå‰∏î
  Â¶ÇÊûúÂ≠òÂú®‰∏äÁïå‰∏ÄÂÆöÊòØ \(n\)
  ÔºåÂØπ‰∫éÊØè‰∏™Â∑¶Á´ØÁÇπÔºåÊ±ÇÂá∫ÂÖ∂ÂØπÂ∫îÁöÑÊúÄÂ∞èÁöÑÂè≥Á´ØÁÇπÔºåËøôÈáåÂèØ‰ª•‰ΩøÁî®
  \texttt{two-point} „ÄÇÂÄºÂüüÊ†ëÁä∂Êï∞ÁªÑÁªüËÆ°ÈÄÜÂ∫èÂØπÊï∞„ÄÇ
  
  ËÄÉËôëÊØè‰∏™Â∑¶Á´ØÁÇπ‰∏∫ \(L\)
  ÁöÑÂå∫Èó¥ÂØπÂÖÉÁ¥†Ë¶ÜÁõñÊï∞ÁöÑË¥°ÁåÆÔºåÂèëÁé∞‰∏ÄÂÆöÊòØ‰∏ÄÊù°Âπ≥Áõ¥Á∫øÂíå‰∏Ä‰∏™‰∏ãÈôçÁõ¥Á∫øÔºåÂèØ‰ª•ÂØπÂ∑ÆÂàÜÊï∞ÁªÑÁöÑÂ∑ÆÂàÜÊï∞ÁªÑÂÅö‰øÆÊîπÔºåÁÑ∂Âêé‰∏§Ê¨°ÂâçÁºÄÂíåËøòÂéüÂá∫ÂéüÂ∫èÂàó„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{2e6} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ inv2 }\OperatorTok{=} \DecValTok{500000004}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ k}\OperatorTok{,}\NormalTok{ A}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \KeywordTok{namespace}\NormalTok{ BIT}\OperatorTok{\{}
      \PreprocessorTok{\#define lowbit}\OperatorTok{(}\NormalTok{x}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{x}\PreprocessorTok{ }\OperatorTok{\&}\PreprocessorTok{ }\OperatorTok{({-}}\NormalTok{x}\OperatorTok{))}
      \DataTypeTok{int}\NormalTok{ C}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
      \DataTypeTok{void}\NormalTok{ add}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ p}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ x}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{p }\OperatorTok{==} \DecValTok{0}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{;} \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ p}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i }\OperatorTok{+=}\NormalTok{ lowbit}\OperatorTok{(}\NormalTok{i}\OperatorTok{))}\NormalTok{ C}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{+=}\NormalTok{ x}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{  query}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ p}\OperatorTok{)} \OperatorTok{\{} \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;} \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ p}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textgreater{}=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{{-}=}\NormalTok{ lowbit}\OperatorTok{(}\NormalTok{i}\OperatorTok{))}\NormalTok{ ans }\OperatorTok{+=}\NormalTok{ C}\OperatorTok{[}\NormalTok{i}\OperatorTok{];} \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;} \OperatorTok{\}}
  \OperatorTok{\}} \KeywordTok{using}\NormalTok{ BIT}\OperatorTok{::}\NormalTok{add}\OperatorTok{;} \KeywordTok{using}\NormalTok{ BIT}\OperatorTok{::}\NormalTok{query}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ L }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ R }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ Rp}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ C}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{k}\OperatorTok{);}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ Read}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
  \NormalTok{    LL ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{L}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{{-}} \DecValTok{1} \OperatorTok{\textgreater{}} \DecValTok{0}\OperatorTok{)}\NormalTok{ add}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{L }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{],} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{{-}} \DecValTok{1} \OperatorTok{\textgreater{}} \DecValTok{0}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{{-}=}\NormalTok{ query}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{L }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{);}
          \ControlFlowTok{while}\OperatorTok{((}\NormalTok{R }\OperatorTok{\textless{}}\NormalTok{ L}\OperatorTok{)} \OperatorTok{||} \OperatorTok{(}\NormalTok{ans }\OperatorTok{\textless{}}\NormalTok{ k }\OperatorTok{\&\&}\NormalTok{ R }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{))} \OperatorTok{\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R }\OperatorTok{==}\NormalTok{ n}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ R}\OperatorTok{++;} \ControlFlowTok{break}\OperatorTok{;} \OperatorTok{\};}\NormalTok{ add}\OperatorTok{(}\NormalTok{A}\OperatorTok{[++}\NormalTok{R}\OperatorTok{],} \DecValTok{1}\OperatorTok{);}\NormalTok{ ans }\OperatorTok{+=}\NormalTok{ query}\OperatorTok{(}\NormalTok{n}\OperatorTok{)} \OperatorTok{{-}}\NormalTok{ query}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{R}\OperatorTok{]);} \OperatorTok{\}}
  \NormalTok{        Rp}\OperatorTok{[}\NormalTok{L}\OperatorTok{]} \OperatorTok{=}\NormalTok{ R}\OperatorTok{;}
      \OperatorTok{\}}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{L}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{Rp}\OperatorTok{[}\NormalTok{L}\OperatorTok{]} \OperatorTok{\textgreater{}}\NormalTok{ n}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;} \DataTypeTok{int}\NormalTok{ cnt }\OperatorTok{=} \OperatorTok{(}\NormalTok{n }\OperatorTok{{-}}\NormalTok{ Rp}\OperatorTok{[}\NormalTok{L}\OperatorTok{]} \OperatorTok{+} \DecValTok{1}\OperatorTok{);}
  \NormalTok{        C}\OperatorTok{[}\NormalTok{L}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{C}\OperatorTok{[}\NormalTok{L}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ cnt}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}\NormalTok{ C}\OperatorTok{[}\NormalTok{L }\OperatorTok{+} \DecValTok{1}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{C}\OperatorTok{[}\NormalTok{L }\OperatorTok{+} \DecValTok{1}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+} \OperatorTok{(}\NormalTok{MOD }\OperatorTok{{-}}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{{-}}\NormalTok{ cnt}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
  \NormalTok{        C}\OperatorTok{[}\NormalTok{Rp}\OperatorTok{[}\NormalTok{L}\OperatorTok{]} \OperatorTok{+} \DecValTok{1}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{C}\OperatorTok{[}\NormalTok{Rp}\OperatorTok{[}\NormalTok{L}\OperatorTok{]} \OperatorTok{+} \DecValTok{1}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ MOD }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
      \OperatorTok{\}}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ C}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{C}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ C}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ C}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{C}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ C}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
  \NormalTok{    ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+} \OperatorTok{(}\NormalTok{C}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*} \OperatorTok{(}\NormalTok{C}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ inv2 }\OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{))} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{D. Âõõ}\label{d.-ux56db}
  
  ‰Ω†ÊòØËÉΩÁúãÂà∞Á¨¨ÂõõÈ¢òÁöÑ friends Âë¢„ÄÇ ‚Äî‚Äîlaekov
  
  ‰ºóÊâÄÂë®Áü•ÔºåÂ∞èËë±ÂêåÂ≠¶ÊìÖÈïøËÆ°ÁÆóÔºåÂ∞§ÂÖ∂ÊìÖÈïøËÆ°ÁÆóÁªÑÂêàÊï∞Ôºå‰ΩÜËøô‰∏™È¢òÂíåÁªÑÂêàÊï∞Ê≤°‰ªÄ‰πàÂÖ≥Á≥ª„ÄÇ
  
  ‰ªäÂ§©‰πüÊòØÁöÆÂÖãÊïè‰ª¨ÊâìÂ∑•ÁöÑ‰∏ÄÂ§©Ôºå‰Ω†Êúâ \(N\)
  Âè™ÁöÆÂÖãÊïèÔºåÊØèÂè™ÁöÆÂÖãÊïèÊúâ‰∏ÄÈ¢óÁÇ∏Âºπ„ÄÇÁé∞Âú®Êúâ‰∏ÄÈ¢ó \(N\)
  ‰∏™ÁÇπÁöÑÊ†ëÔºåÂêåÊó∂ÁöÆÂÖãÊïè‰ª¨ÂèØ‰ª•‰ªé \(p_1\) ÊàñËÄÖ \(p_2\)
  ‰∏§‰∏™ÁÇπ‰∏≠ÁöÑ‰ªªÊÑè‰∏Ä‰∏™ËøõÂÖ•Ê†ë„ÄÇÊØèÊ¨°‰Ω†ÈúÄË¶ÅÊ¥æ‰∏ÄÂè™ÁöÆÂÖãÊïèÂéªÂà∞Êüê‰∏™ÁÇπÔºåÁÑ∂ÂêéÂ∞ÜÁÇ∏ÂºπËøûÂêåÁöÆÂÖãÊïèÂíåËøô‰∏™ÁÇπ‰∏ÄËµ∑ÁÇ∏Êéâ„ÄÇ‰∏Ä‰∏™ÁÇπË¢´ÁÇ∏Êéâ‰∫Ü‰πãÂêéÁöÆÂÖãÊïèÂ∞±ÂÜç‰πü‰∏çËÉΩÈÄöËøá‰∫Ü„ÄÇÁé∞Âú®‰Ω†ÈúÄË¶ÅÂÜ≥ÂÆöÁöÆÂÖãÊïè‰ª¨ÁÇ∏ÁÇπÁöÑÈ°∫Â∫èÔºåÈóÆ
  \(n!\) ÁßçÁÇ∏ÁÇπÊñπÊ°à‰∏≠ÊúâÂ§öÂ∞ëÁßçËÉΩÁÇ∏ÊéâÊâÄÊúâÁÇπ„ÄÇ \(N \le 1000\)
  
  ËÄÉËôë \texttt{DP} „ÄÇ
  
  È¶ñÂÖàËÄÉËôë‰∏Ä‰∏™Â≠êÊ†ëÔºàÂ≠êÊ†ëÂÜÖÊ≤°Êúâ
  \(p_1, p_2\)ÔºâÂÖ®ÈÉ®Ë¢´Ê∏ÖÁ©∫Â∫îËØ•ÊòØ‰ªÄ‰πàÈ°∫Â∫èÔºå‰∏ÄÂÆöÊòØÊØè‰∏™ÂÑøÂ≠êÁöÑÂ≠êÊ†ëÂÖàË¢´Ê∏ÖÁ©∫ÁÑ∂ÂêéÊ∏ÖÊ•öÂΩìÂâçÁÇπ„ÄÇ
  ËøôÈáåÂèØ‰ª•‰ΩøÁî®Ê†ëÂΩ¢ dp Â§ÑÁêÜ„ÄÇ
  
  ÂÖàËÄÉËôë \(p_1 \leftrightarrow p_2\)
  Ëøô‰∏ÄÊù°Èìæ‰∏äÁöÑÁÇπÂ∫îËØ•ÊòØÊåâÁÖß‰ªÄ‰πàÈ°∫Â∫èË¢´Ê∏ÖÁ©∫Ôºå‰ªªÊÑèÊó∂ÂàªÔºåË¢´Ê∏ÖÁ©∫ÁöÑÁÇπ‰∏ÄÂÆöÊòØÈìæ‰∏äÁöÑËøûÁª≠ÁöÑ‰∏ÄÊÆµÔºåËøôÈáåÂèØ‰ª•Âå∫Èó¥
  \(dp\)
  ÁªüËÆ°Á≠îÊ°àÔºåËΩ¨ÁßªËÄÉËôëÊúÄÂêé‰∏ÄÊ¨°Âà†Èô§ÊòØÂà†Âπ≤ÂáÄ‰∫ÜÈìæ‰∏äÊúÄÂè≥ËæπÁöÑÁÇπËøòÊòØÊúÄÂ∑¶ËæπÁöÑÁÇπ„ÄÇ
  
  ÁÑ∂ÂêéÂíå \(p_1, p_2\) ÁöÑÊØè‰∏™‰∏çÂú®Èìæ‰∏äÁöÑÂÑøÂ≠êÂêàÂπ∂Á≠îÊ°àÔºåÊúÄÂêéÂÜ≥Á≠ñÂÖàÂà†Èô§ \(p_1\)
  ËøòÊòØ \(p_2\)„ÄÇ ‰ª£Á†ÅËøòÊ≤°ÂÜô„ÄÇ
  
  \subsection{Round 5}\label{round-5}
  
  \subsubsection{A. ‰∏Ä}\label{a.-ux4e00-1}
  
  Áé∞Âú®ÊúâÂõõÁßçÈ¢úËâ≤ÁöÑ‰∏úË•øÔºåÂêÑÊúâ\(n_1,n_2,n_3,n_4\)‰∏™„ÄÇ‰Ω†ÈúÄË¶ÅÊää‰ªñ‰ª¨ÊîæÂà∞‰∏ÄÊéíÈáåÈù¢ÔºåÂπ∂‰∏î‰øùËØÅÁõ∏ÈÇªÁöÑ‰∏úË•øÈ¢úËâ≤‰∏çÂêåÔºåÈóÆÊñπÊ°àÊï∞„ÄÇ
  ÂØπ‰∫é\(80\%\)ÁöÑÊï∞ÊçÆÔºå\(n_1+n_2+n_3+n_4\leq 10\)„ÄÇ
  ÂØπ‰∫éÂè¶Â§ñ\(10\%\)ÁöÑÊï∞ÊçÆÔºå\(n_1=0,n_2,n_3,n_4\leq 50\)„ÄÇ
  ÂØπ‰∫é\(100\%\)ÁöÑÊï∞ÊçÆÔºå\(0\leq n_1,n_2\leq 200,0\leq n_3,n_4\leq50000\)„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \KeywordTok{namespace}\NormalTok{ subtask1}\OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ dp}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\NormalTok{\_}\OperatorTok{][}\NormalTok{\_}\OperatorTok{][}\NormalTok{\_}\OperatorTok{][}\DecValTok{5}\OperatorTok{];}
      \DataTypeTok{void}\NormalTok{ work}\OperatorTok{()\{}
  \NormalTok{        memset}\OperatorTok{(}\NormalTok{dp}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{dp}\OperatorTok{));}
  \NormalTok{        dp}\OperatorTok{[}\DecValTok{1}\OperatorTok{][}\DecValTok{0}\OperatorTok{][}\DecValTok{0}\OperatorTok{][}\DecValTok{0}\OperatorTok{][}\DecValTok{1}\OperatorTok{]} \OperatorTok{=}\NormalTok{ dp}\OperatorTok{[}\DecValTok{0}\OperatorTok{][}\DecValTok{1}\OperatorTok{][}\DecValTok{0}\OperatorTok{][}\DecValTok{0}\OperatorTok{][}\DecValTok{2}\OperatorTok{]} \OperatorTok{=}\NormalTok{ dp}\OperatorTok{[}\DecValTok{0}\OperatorTok{][}\DecValTok{0}\OperatorTok{][}\DecValTok{1}\OperatorTok{][}\DecValTok{0}\OperatorTok{][}\DecValTok{3}\OperatorTok{]} \OperatorTok{=}\NormalTok{ dp}\OperatorTok{[}\DecValTok{0}\OperatorTok{][}\DecValTok{0}\OperatorTok{][}\DecValTok{0}\OperatorTok{][}\DecValTok{1}\OperatorTok{][}\DecValTok{4}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ A}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ B}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{k}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ C}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{l}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ D}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{i }\OperatorTok{+}\NormalTok{ j }\OperatorTok{+}\NormalTok{ k }\OperatorTok{+}\NormalTok{ l }\OperatorTok{==} \DecValTok{1}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{i }\OperatorTok{\textgreater{}} \DecValTok{0}\OperatorTok{)}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\NormalTok{l}\OperatorTok{][}\DecValTok{1}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{dp}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\NormalTok{l}\OperatorTok{][}\DecValTok{2}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\NormalTok{l}\OperatorTok{][}\DecValTok{3}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{  dp}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\NormalTok{l}\OperatorTok{][}\DecValTok{4}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{j }\OperatorTok{\textgreater{}} \DecValTok{0}\OperatorTok{)}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\NormalTok{l}\OperatorTok{][}\DecValTok{2}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\NormalTok{l}\OperatorTok{][}\DecValTok{1}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\NormalTok{l}\OperatorTok{][}\DecValTok{3}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{  dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\NormalTok{l}\OperatorTok{][}\DecValTok{4}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textgreater{}} \DecValTok{0}\OperatorTok{)}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\NormalTok{l}\OperatorTok{][}\DecValTok{3}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{l}\OperatorTok{][}\DecValTok{2}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{l}\OperatorTok{][}\DecValTok{1}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{  dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{l}\OperatorTok{][}\DecValTok{4}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{l }\OperatorTok{\textgreater{}} \DecValTok{0}\OperatorTok{)}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\NormalTok{l}\OperatorTok{][}\DecValTok{4}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\NormalTok{l }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\DecValTok{2}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\NormalTok{l }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\DecValTok{3}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{  dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\NormalTok{l }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\DecValTok{1}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
          \OperatorTok{\}}
  \NormalTok{        printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ ans1 }\OperatorTok{=} \DataTypeTok{int}\OperatorTok{((}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ dp}\OperatorTok{[}\NormalTok{A}\OperatorTok{][}\NormalTok{B}\OperatorTok{][}\NormalTok{C}\OperatorTok{][}\NormalTok{D}\OperatorTok{][}\DecValTok{1}\OperatorTok{]} \OperatorTok{+}\NormalTok{  dp}\OperatorTok{[}\NormalTok{A}\OperatorTok{][}\NormalTok{B}\OperatorTok{][}\NormalTok{C}\OperatorTok{][}\NormalTok{D}\OperatorTok{][}\DecValTok{2}\OperatorTok{]} \OperatorTok{+}\NormalTok{  dp}\OperatorTok{[}\NormalTok{A}\OperatorTok{][}\NormalTok{B}\OperatorTok{][}\NormalTok{C}\OperatorTok{][}\NormalTok{D}\OperatorTok{][}\DecValTok{3}\OperatorTok{]} \OperatorTok{+}\NormalTok{  dp}\OperatorTok{[}\NormalTok{A}\OperatorTok{][}\NormalTok{B}\OperatorTok{][}\NormalTok{C}\OperatorTok{][}\NormalTok{D}\OperatorTok{][}\DecValTok{4}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{));}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \KeywordTok{namespace}\NormalTok{ subtask2}\OperatorTok{\{}
      \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \DecValTok{53}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ dp}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\NormalTok{\_}\OperatorTok{][}\NormalTok{\_}\OperatorTok{][}\DecValTok{4}\OperatorTok{];}
      \DataTypeTok{void}\NormalTok{ work}\OperatorTok{()\{}
  \NormalTok{        memset}\OperatorTok{(}\NormalTok{dp}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{dp}\OperatorTok{));}
  \NormalTok{        dp}\OperatorTok{[}\DecValTok{1}\OperatorTok{][}\DecValTok{0}\OperatorTok{][}\DecValTok{0}\OperatorTok{][}\DecValTok{1}\OperatorTok{]} \OperatorTok{=}\NormalTok{ dp}\OperatorTok{[}\DecValTok{0}\OperatorTok{][}\DecValTok{1}\OperatorTok{][}\DecValTok{0}\OperatorTok{][}\DecValTok{2}\OperatorTok{]} \OperatorTok{=}\NormalTok{ dp}\OperatorTok{[}\DecValTok{0}\OperatorTok{][}\DecValTok{0}\OperatorTok{][}\DecValTok{1}\OperatorTok{][}\DecValTok{3}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ B}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ C}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{k}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ D}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{i }\OperatorTok{+}\NormalTok{ j }\OperatorTok{+}\NormalTok{ k }\OperatorTok{==} \DecValTok{1}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{i }\OperatorTok{\textgreater{}} \DecValTok{0}\OperatorTok{)}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\DecValTok{1}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{dp}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\DecValTok{2}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\DecValTok{3}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{j }\OperatorTok{\textgreater{}} \DecValTok{0}\OperatorTok{)}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\DecValTok{2}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\DecValTok{1}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\DecValTok{3}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{k }\OperatorTok{\textgreater{}} \DecValTok{0}\OperatorTok{)}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k}\OperatorTok{][}\DecValTok{3}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\DecValTok{2}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{][}\NormalTok{k }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\DecValTok{1}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
          \OperatorTok{\}}
  \NormalTok{        printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ ans2 }\OperatorTok{=} \DataTypeTok{int}\OperatorTok{((}\NormalTok{ dp}\OperatorTok{[}\NormalTok{B}\OperatorTok{][}\NormalTok{C}\OperatorTok{][}\NormalTok{D}\OperatorTok{][}\DecValTok{1}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ dp}\OperatorTok{[}\NormalTok{B}\OperatorTok{][}\NormalTok{C}\OperatorTok{][}\NormalTok{D}\OperatorTok{][}\DecValTok{2}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ dp}\OperatorTok{[}\NormalTok{B}\OperatorTok{][}\NormalTok{C}\OperatorTok{][}\NormalTok{D}\OperatorTok{][}\DecValTok{3}\OperatorTok{]} \OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{));}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{B. ‰∫å}\label{b.-ux4e8c-1}
  
  \(N\)‰∏™‰∫åÂÖÉÁªÑ\((a_i,b_i)\)ÔºåÂÆö‰πâ\(c_1=a_1+b_1,c_i=b_i+max‚Å°(c_{i-1},\sum_{j=1}^ia_j)\)„ÄÇÁé∞Âú®‰Ω†ÂèØ‰ª•ÈöèÊÑèÈáçÊéíËøô\(N\)‰∏™‰∫åÂÖÉÁªÑÔºåÊ±Ç\(c_N\)ÁöÑÊúÄÂ∞èÂÄº
  \(N \le 10^6; A, B \le N\)
  
  ËÄÉËôëÁõ∏ÈÇª‰∏§‰∏™‰∫åÂÖÉÁªÑ \((a_1, b_1) (a_2, b_2)\) Â∫îËØ•ÊÄé‰πàÊØîËæÉÂ§ßÂ∞è„ÄÇ ÂàÜÂà´ÂàóÂá∫
  \((a_1, b_1)\) Âú® \((a_2, b_2)\) ‰πãÂâçÁöÑÁ≠îÊ°àÂíå‰∫§Êç¢‰πãÂêéÁöÑÁ≠îÊ°à„ÄÇ
  
  Â¶ÇÊûú \((a_1, b_1)\) Âú® \((a_2, b_2)\)
  ‰πãÂâçÔºöËÆæËøô‰∏§‰∏™‰∫åÂÖÉÁªÑ‰πãÂâçÊâÄÊúâ‰∫åÂÖÉÁªÑ‰∏≠ \(a\) ÁöÑÂíå‰∏∫
  \(x\)ÔºåËÆæ‰∏ä‰∏Ä‰∏™‰∫åÂÖÉÁªÑÁöÑ \(C\) ÂÄº‰∏∫ \(y\)„ÄÇ Ê†πÊçÆÂÆö‰πâ
  \(C_1 = b_1 + \max(y, a_1 + x)\)Ôºå\(C_2 = b_2 + max(C_1, x + a_1 + a_2)\)
  ÂåñÁÆÄÂêéÂæóÂà∞
  \(C_2 = \max(y + b_1 + b_2, x + a_1 + b_1 + b_2, x + a_1 + a_2 + b_2)\)
  ÊòìÁü• ‰∫§Êç¢Âêé
  \(C_2' = \max(y + b_1 + b_2, x + a_2 + b_1 + b_2, x + a_1 + a_2 + b_1)\)
  Áé∞Âú®ÈúÄË¶ÅÊØîËæÉ \(C_2\) Âíå \(C_2'\) ÁöÑÂ§ßÂ∞è„ÄÇÁõ∏ÂΩì‰∫éÂØπ \(6\)
  ‰∏™ÂºèÂ≠êÂèñÊúÄÂ§ßÂÄºÔºåÁúãÊúÄÂ§ßÂÄºÂá∫Áé∞Âú®Âì™Ëæπ„ÄÇÁõ∏ÂêåÁöÑÈ°π \(y + b_1 + b_2\)
  ÂèØ‰ª•Ê∂àÂéªÔºåÂ¶ÇÊûúÂÖ∂‰∏∫ÊúÄÂ§ßÂÄºÔºåÈÇ£‰πà‰∏§‰∏™ÂºèÂ≠êË∞ÅÂú®ÂâçË∞ÅÂú®ÂêéÊó†ÊâÄË∞ìÔºåÂ¶ÇÊûúÂÖ∂‰∏çÊòØÊúÄÂ§ßÂÄºÔºåÈÇ£‰πà‰πüÊ≤°ÊúâÂΩ±Âìç„ÄÇ
  Ê∂àÂéªÊØè‰∏ÄÈ°π‰∏≠Áõ∏ÂêåÁöÑ \(x\)„ÄÇ
  
  \(C_2 = \max(a_1 + b_1 + b_2, a_1 + a_2 + b_2)\)
  
  \(C_2' = \max(a_2 + b_1 + b_2, a_1 + a_2 + b_1)\)
  
  ÊèêÂá∫ÂÖ±ÂêåÁöÑÈ°πÔºö \(C_2 = a_1 + b_2 + \max(b_1,a_2)\)
  
  \(C_2' = a_2 + b_1 + \max(b_2, a_1)\)
  
  ÂÅáËÆæ \(C_2 < C_2'\)
  
  Âàô \(a_1 + b_2 + \max(b_1,a_2) < a_2 + b_1 + \max(b_2, a_1)\)
  
  ÁßªÈ°πÂæó \(a_1 + b_2 - \max(b_2,a_1) < a_2 + b_1 - \max(b_1, a_2)\)
  
  ÂæóÂá∫ \(\min(a_1, b_2) < \min(a_2, b_1)\)
  
  ‰∏ÄÁßçÁâπÊÆäÊÉÖÂÜµÊòØÂèñÁ≠âÁöÑÊó∂ÂÄôÔºö‰∏æÂá†‰∏™Ê†óÂ≠êÂæóÂá∫ ÁªìËÆ∫ÊòØÂèñÁ≠âÊó∂ÊØîËæÉ
  \(a_1 < a_2\)„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{bool}\NormalTok{ CMP}\OperatorTok{(}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ x}\OperatorTok{,}\NormalTok{ pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}}\NormalTok{ y}\OperatorTok{)\{}
      \DataTypeTok{int}\NormalTok{ r0 }\OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{x}\OperatorTok{.}\NormalTok{first}\OperatorTok{,}\NormalTok{ y}\OperatorTok{.}\NormalTok{second}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ r1 }\OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{y}\OperatorTok{.}\NormalTok{first}\OperatorTok{,}\NormalTok{ x}\OperatorTok{.}\NormalTok{second}\OperatorTok{);}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{r0 }\OperatorTok{!=}\NormalTok{ r1}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ r0 }\OperatorTok{\textless{}}\NormalTok{ r1}\OperatorTok{;}
      \ControlFlowTok{return}\NormalTok{ x}\OperatorTok{.}\NormalTok{first }\OperatorTok{\textless{}}\NormalTok{ y}\OperatorTok{.}\NormalTok{first}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{C. ‰∏â}\label{c.-ux4e09-1}
  
  ÁªôÂÆö \(N\) ‰∏™Êï∞Ôºå\(M\) Ê¨°Êìç‰ΩúÔºåÊìç‰ΩúÊúâ‰ª•‰∏ãÂõõÁßçÔºö - 1„ÄÅÂå∫Èó¥Âä†‰∏Ä‰∏™Êï∞„ÄÇ -
  2„ÄÅÂå∫Èó¥‰πò‰∏Ä‰∏™Êï∞„ÄÇ - 3„ÄÅÂå∫Èó¥ÂèòÊàê‰∏Ä‰∏™Êï∞„ÄÇ -
  4„ÄÅÊ±ÇÊâÄÊúâÂ≠êÂå∫Èó¥ÁöÑÂπ≥ÂùáÂÄºÁöÑÂíå(\(MOD = 10^9 + 7\))„ÄÇ \(a_i, N,Q \le 10^5\)
  
  \(Ans = \sum_{i=1}^{n}\limits{\sum_{j=i}^{n}\limits{\frac{\sum_{k=i}^{j}\limits{a_k}}{j-i+1}}}\)
  ËÄÉËôëÊØè‰∏™Êï∞Â≠óÁöÑË¥°ÁåÆ
  \(Ans = \sum_{k=1}^{n}\limits{a_k \times \sum_{i=1}^{n}\limits{\sum_{j=i}^{n}\limits{\frac{1}{j-i+1}}}}\)
  ÁÆóÂá∫Ë¥°ÁåÆÔºåÁ∫øÊÆµÊ†ëÁª¥Êä§Âç≥ÂèØ„ÄÇÂèØ‰ª•ËÄÉËôë \(k\) ÊØèÂ¢ûÂä† 1
  Ë¥°ÁåÆ‰ºöÂèòÂåñÂ§öÂ∞ë„ÄÇ‰πüÂèØ‰ª•ÂèëÁé∞Ë¥°ÁåÆÁ±ª‰ºº‰∫é‰∏Ä‰∏™Ê¢ØÂΩ¢ÔºåÂèØ‰ª•Áõ¥Êé•ÁÆó„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{void}\NormalTok{ work}\OperatorTok{()\{}\NormalTok{ cerr }\OperatorTok{\textless{}\textless{}} \StringTok{"FUCK"} \OperatorTok{\textless{}\textless{}}\NormalTok{ endl}\OperatorTok{;}
  \NormalTok{    S}\OperatorTok{[}\DecValTok{1}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{2}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ S}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{S}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ inv}\OperatorTok{(}\NormalTok{i}\OperatorTok{))} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ dp }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ last }\OperatorTok{=}\NormalTok{ i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{;}\NormalTok{ dp }\OperatorTok{=} \OperatorTok{(}\NormalTok{dp }\OperatorTok{{-}}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{{-}}\NormalTok{ S}\OperatorTok{[}\NormalTok{last}\OperatorTok{]} \OperatorTok{+}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
  \NormalTok{        dp }\OperatorTok{=} \OperatorTok{(}\NormalTok{dp }\OperatorTok{{-}}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{{-}} \OperatorTok{(}\NormalTok{S}\OperatorTok{[}\NormalTok{n}\OperatorTok{]} \OperatorTok{{-}}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{{-}}\NormalTok{ S}\OperatorTok{[}\NormalTok{n }\OperatorTok{{-}}\NormalTok{ last}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
  \NormalTok{        dp }\OperatorTok{=} \OperatorTok{(}\NormalTok{dp }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+} \OperatorTok{(}\NormalTok{S}\OperatorTok{[}\NormalTok{n}\OperatorTok{]} \OperatorTok{{-}}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{{-}}\NormalTok{ S}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
  \NormalTok{        dp }\OperatorTok{=} \OperatorTok{(}\NormalTok{ dp }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ S}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;} \CommentTok{// ËøôÈáåÁöÑ dp Â∞±ÊòØ‰ΩçÁΩÆ‰∏∫ i ÁöÑÊï∞Â≠óÂØπÁ≠îÊ°àË¥°ÁåÆÁöÑÁ≥ªÊï∞„ÄÇ}
  \NormalTok{        ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ dp }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
      \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{D. Âõõ}\label{d.-ux56db-1}
  
  ‰ºóÊâÄÂë®Áü•ÔºåÂ∞èËë±ÂêåÂ≠¶ÊìÖÈïøËÆ°ÁÆóÔºåÂ∞§ÂÖ∂ÊìÖÈïøËÆ°ÁÆóÁªÑÂêàÊï∞Ôºå‰ΩÜËøô‰∏™È¢òÂíåÁªÑÂêàÊï∞Ê≤°‰ªÄ‰πàÂÖ≥Á≥ª„ÄÇ
  
  ÁöÆÂÖãÊïè‰ª¨ÊâìÂÆåÂ∑•‰∫ÜÔºåÊòØÊó∂ÂÄôÂ∞ÜÊâÄÊúâÁöÆÂÖãÊïèÂ§ÑÁêÜÊéâ‰∫Ü„ÄÇÁé∞Âú®ÁöÆÂÖãÊïè‰ª¨Ë∫≤Âú®‰∏ÄÊ£µÊ†ë‰∏äÔºàÁÇπÂíåËæπÁöÑ‰ªªÊÑè‰ΩçÁΩÆÈÉΩÊúâÂèØËÉΩÔºâÔºå‰Ω†ÂèØ‰ª•ÈÄâÊã©Ëã•Âπ≤Âè∂Â≠êËäÇÁÇπÈáäÊîæÊØíÊ∞îÔºåÊØíÊ∞î‰ºö‰ª•ÊØèÂçï‰ΩçÊó∂Èó¥‰∏ÄÂçï‰ΩçÁöÑË∑ùÁ¶ªÊ≤øÁùÄËæπËîìÂª∂ÂºÄÊù•„ÄÇ‰∏∫‰∫ÜËÉΩÂ§üÁÅ≠ÁªùÁöÆÂÖãÊïèÔºå‰Ω†ÈúÄË¶Å‰øùËØÅÊ†ë‰∏äÊØè‰∏™‰ΩçÁΩÆÈÉΩÂÖÖÊª°‰∫ÜÊØíÊ∞î„ÄÇ‰ΩÜÊòØ‰ªÖ‰ªÖÊòØÊ±Ç‰∏Ä‰∏™ÊúÄÂ∞èÁöÑÁÅ≠ÁªùÁöÆÂÖãÊïèÁöÑÊó∂Èó¥ÂÆûÂú®Â§™Êó†Ë∂£‰∫ÜÔºå‰Ω†ÊÉ≥Ë¶ÅÁü•ÈÅì‰Ω†ÊúâÂ§öÂ∞ëÁßç‰∏çÂêåÁöÑÊñπÊ≥ïËÉΩÂ§üÁÅ≠ÁªùÁöÆÂÖãÊïèÔºå‰∏§‰∏™ÊñπÊ≥ï‰∏çÂêåÂΩì‰∏î‰ªÖÂΩì‰∏§ÁßçÊñπÊ≥ïÁÅ≠ÁªùÊâÄÊúâÁöÆÂÖãÊïèÁöÑÊó∂Èó¥‰∏çÂêå„ÄÇ
  
  \(N \le 200\) Á¨¨‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞ \(N\) ‰ª£Ë°®Ê†ë‰∏äÁÇπÁöÑ‰∏™Êï∞„ÄÇ
  
  Êé•‰∏ãÊù• \(N‚àí1\) Ë°åÊØèË°å‰∏â‰∏™Êï¥Êï∞ \(s,e,d\) ‰ª£Ë°®‰∏ÄÊù°ËæπÁöÑ‰∏§Á´ØÂíåÈïøÂ∫¶„ÄÇ
  
  Á≠îÊ°àÂè™ËÉΩÊòØÊüê‰∏§‰∏™Âè∂Â≠ê‰πãÈó¥ÁöÑË∑ùÁ¶ªÊàñËÄÖË∑ùÁ¶ª \$ / 2\$ „ÄÇ Êûö‰∏æ‰∏§‰∏™Âè∂Â≠êÔºåÊää -
  Ëøô‰∏™Âè∂Â≠ê‰πãÈó¥ÁöÑË∑ùÁ¶ªÔºàÂè™Âú®‰∏ÄËæπÊîæÊØíÊ∞îÔºâÔºàÂ¶ÇÊûúËÉΩÊàê‰∏∫Á≠îÊ°àÔºâ -
  ‰∏§‰∏™Âè∂Â≠ê‰πãÈó¥Ë∑ùÁ¶ª \$ / 2\$Ôºà‰∏§‰∏™Âè∂Â≠ê‰∏äÈÉΩÊîæÊØíÊ∞îÔºâÔºàÂ¶ÇÊûúËÉΩÊàê‰∏∫Á≠îÊ°àÔºâ
  Âä†ÂÖ•Á≠îÊ°àÈõÜÂêà„ÄÇ ÊúÄÂêéËæìÂá∫Á≠îÊ°àÈõÜÂêàÁöÑÂ§ßÂ∞è„ÄÇ
  
  Êûö‰∏æ‰∏§‰∏™Âè∂Â≠êÔºåÂà§Êñ≠ÂÖ∂Ë∑ùÁ¶ªÊòØÂê¶ËÉΩÊàê‰∏∫Á≠îÊ°à„ÄÇËÄÉËôëÂì™‰∫õÂÖ∂‰ªñÂè∂Â≠êÊîæÊØíÊ∞îËÉΩËÆ©Ëøô‰∏™Ë∑ùÁ¶ªÂ∞ΩÂèØËÉΩÊàê‰∏∫Á≠îÊ°àÔºåÂ∞±ÊòØÈÇ£‰∫õÊîæ‰∏äÊØíÊ∞î‰∏ç‰ºöÂΩ±ÂìçËøô‰∏§‰∏™Êûö‰∏æÁöÑÂè∂Â≠ê‰πãÈó¥ÊØíÊ∞î‰º†Êí≠Êó∂Èó¥ÁöÑÂè∂Â≠êÈÉΩÊîæ‰∏äÊØíÊ∞îÔºåÁÑ∂ÂêéË∑ë‰∏ÄÈÅçÊúÄÁü≠Ë∑ØÔºåÁÆóÂÖ®Ê†ëË¢´ÊØíÊ∞îË¶ÜÁõñÁöÑÊó∂Èó¥ÊòØÂê¶Á≠â‰∫éÂΩìÂâçÊûö‰∏æÁöÑÂè∂Â≠ê„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \DecValTok{510}\OperatorTok{;}
  \NormalTok{pair}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{},} \DataTypeTok{int} \OperatorTok{\textgreater{}}\NormalTok{ E}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ m}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ M}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\NormalTok{\_}\OperatorTok{];}
  \NormalTok{set}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ Ans}\OperatorTok{;}
  \NormalTok{queue}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{Q}\OperatorTok{;} \DataTypeTok{bool}\NormalTok{ inQ}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ SPFA}\OperatorTok{()\{}
      \AttributeTok{static} \DataTypeTok{int}\NormalTok{ dis}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}\NormalTok{ memset}\OperatorTok{(}\NormalTok{dis}\OperatorTok{,} \BaseNTok{0x3f}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{dis}\OperatorTok{));}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{inQ}\OperatorTok{[}\NormalTok{i}\OperatorTok{])}\NormalTok{ dis}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{while}\OperatorTok{(!}\NormalTok{Q}\OperatorTok{.}\NormalTok{empty}\OperatorTok{())\{}
          \DataTypeTok{int}\NormalTok{ now }\OperatorTok{=}\NormalTok{ Q}\OperatorTok{.}\NormalTok{front}\OperatorTok{();}\NormalTok{ Q}\OperatorTok{.}\NormalTok{pop}\OperatorTok{();}\NormalTok{ inQ}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{ i }\OperatorTok{;}\NormalTok{i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
              \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;} 
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{dis}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{+}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{w }\OperatorTok{\textless{}}\NormalTok{ dis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])} \OperatorTok{\{}
  \NormalTok{                dis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{]} \OperatorTok{=}\NormalTok{ dis}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{+}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{w}\OperatorTok{;}
                  \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{inQ}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])}\NormalTok{ Q}\OperatorTok{.}\NormalTok{push}\OperatorTok{(}\NormalTok{ex}\OperatorTok{),}\NormalTok{ inQ}\OperatorTok{[}\NormalTok{ex}\OperatorTok{]} \OperatorTok{=} \KeywordTok{true}\OperatorTok{;}
              \OperatorTok{\}}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ MAX }\OperatorTok{=}\NormalTok{ INT\_MIN}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{        pair}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{},} \DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ now }\OperatorTok{=}\NormalTok{ E}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
          \DataTypeTok{int}\NormalTok{ T }\OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{dis}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{first}\OperatorTok{.}\NormalTok{first}\OperatorTok{]} \OperatorTok{+}\NormalTok{ now}\OperatorTok{.}\NormalTok{second}\OperatorTok{,}\NormalTok{ dis}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{first}\OperatorTok{.}\NormalTok{second}\OperatorTok{]} \OperatorTok{+}\NormalTok{ now}\OperatorTok{.}\NormalTok{second}\OperatorTok{,} \OperatorTok{(}\NormalTok{dis}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{first}\OperatorTok{.}\NormalTok{first}\OperatorTok{]} \OperatorTok{+}\NormalTok{ dis}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{first}\OperatorTok{.}\NormalTok{second}\OperatorTok{]} \OperatorTok{+}\NormalTok{ now}\OperatorTok{.}\NormalTok{second}\OperatorTok{)} \OperatorTok{/} \DecValTok{2}\OperatorTok{);}
  \NormalTok{        MAX }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{MAX}\OperatorTok{,}\NormalTok{ T}\OperatorTok{);}
      \OperatorTok{\}}
      \ControlFlowTok{return}\NormalTok{ MAX}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ ind}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{bool}\NormalTok{ work1}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ x}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ y}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ D}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{    Q}\OperatorTok{.}\NormalTok{push}\OperatorTok{(}\NormalTok{x}\OperatorTok{);}\NormalTok{ inQ}\OperatorTok{[}\NormalTok{x}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{i }\OperatorTok{==}\NormalTok{ x }\OperatorTok{||}\NormalTok{ i }\OperatorTok{==}\NormalTok{ y}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{M}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{y}\OperatorTok{]} \OperatorTok{\textgreater{}=}\NormalTok{ D }\OperatorTok{\&\&}\NormalTok{ ind}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{==} \DecValTok{1}\OperatorTok{)}\NormalTok{ Q}\OperatorTok{.}\NormalTok{push}\OperatorTok{(}\NormalTok{i}\OperatorTok{),}\NormalTok{ inQ}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;} \OperatorTok{\}}
      \ControlFlowTok{return}\NormalTok{ SPFA}\OperatorTok{()} \OperatorTok{==}\NormalTok{ D}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{bool}\NormalTok{ work2}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ x}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ y}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ D}\OperatorTok{)\{}
  \NormalTok{    Q}\OperatorTok{.}\NormalTok{push}\OperatorTok{(}\NormalTok{x}\OperatorTok{);}\NormalTok{ Q}\OperatorTok{.}\NormalTok{push}\OperatorTok{(}\NormalTok{y}\OperatorTok{);}\NormalTok{ inQ}\OperatorTok{[}\NormalTok{x}\OperatorTok{]} \OperatorTok{=}\NormalTok{ inQ}\OperatorTok{[}\NormalTok{y}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{x }\OperatorTok{==}\NormalTok{ i }\OperatorTok{||}\NormalTok{ y }\OperatorTok{==}\NormalTok{ i}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{max}\OperatorTok{(}\NormalTok{M}\OperatorTok{[}\NormalTok{x}\OperatorTok{][}\NormalTok{i}\OperatorTok{],}\NormalTok{ M}\OperatorTok{[}\NormalTok{y}\OperatorTok{][}\NormalTok{i}\OperatorTok{])} \OperatorTok{/} \DecValTok{2} \OperatorTok{\textgreater{}=}\NormalTok{ D }\OperatorTok{\&\&}\NormalTok{ ind}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{==} \DecValTok{1}\OperatorTok{)}\NormalTok{ Q}\OperatorTok{.}\NormalTok{push}\OperatorTok{(}\NormalTok{i}\OperatorTok{),}\NormalTok{ inQ}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
      \OperatorTok{\}}
      \ControlFlowTok{return}\NormalTok{ SPFA}\OperatorTok{()} \OperatorTok{==}\NormalTok{ D}\OperatorTok{;}
  \OperatorTok{\}}
  
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    memset}\OperatorTok{(}\NormalTok{M}\OperatorTok{,} \BaseNTok{0x3f}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{M}\OperatorTok{));}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ M}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;} 
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{);}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)} \OperatorTok{\{} \DataTypeTok{int}\NormalTok{ u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{,}\NormalTok{ w}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{u}\OperatorTok{)(}\NormalTok{v}\OperatorTok{)(}\NormalTok{w}\OperatorTok{);}\NormalTok{ ind}\OperatorTok{[}\NormalTok{u}\OperatorTok{]} \OperatorTok{++;}\NormalTok{ ind}\OperatorTok{[}\NormalTok{v}\OperatorTok{]++;}\NormalTok{ w }\OperatorTok{\textless{}\textless{}=} \DecValTok{1}\OperatorTok{;}\NormalTok{ add}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{,}\NormalTok{ w}\OperatorTok{);}\NormalTok{ add}\OperatorTok{(}\NormalTok{v}\OperatorTok{,}\NormalTok{ u}\OperatorTok{,}\NormalTok{ w}\OperatorTok{);}\NormalTok{ M}\OperatorTok{[}\NormalTok{u}\OperatorTok{][}\NormalTok{v}\OperatorTok{]} \OperatorTok{=}\NormalTok{ M}\OperatorTok{[}\NormalTok{v}\OperatorTok{][}\NormalTok{u}\OperatorTok{]} \OperatorTok{=}\NormalTok{ w}\OperatorTok{;}\NormalTok{ E}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ make\_pair}\OperatorTok{(}\NormalTok{make\_pair}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{),}\NormalTok{ w}\OperatorTok{);} \OperatorTok{\}}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{k}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ M}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{=}\NormalTok{ M}\OperatorTok{[}\NormalTok{j}\OperatorTok{][}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{M}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{],}\NormalTok{ M}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{k}\OperatorTok{]} \OperatorTok{+}\NormalTok{ M}\OperatorTok{[}\NormalTok{k}\OperatorTok{][}\NormalTok{j}\OperatorTok{]);}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{i }\OperatorTok{==}\NormalTok{ j}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{ind}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{!=} \DecValTok{1} \OperatorTok{||}\NormalTok{ ind}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{!=} \DecValTok{1}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{Ans}\OperatorTok{.}\NormalTok{count}\OperatorTok{(}\NormalTok{M}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{])}      \OperatorTok{\&\&}\NormalTok{ work1}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\NormalTok{ j}\OperatorTok{,}\NormalTok{ M}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]))}\NormalTok{      Ans}\OperatorTok{.}\NormalTok{insert}\OperatorTok{(}\NormalTok{M}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]);}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{Ans}\OperatorTok{.}\NormalTok{count}\OperatorTok{(}\NormalTok{M}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{)} \OperatorTok{\&\&}\NormalTok{ work2}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\NormalTok{ j}\OperatorTok{,}\NormalTok{ M}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{))}\NormalTok{ Ans}\OperatorTok{.}\NormalTok{insert}\OperatorTok{(}\NormalTok{M}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{);}
          
      \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{(}\NormalTok{Ans}\OperatorTok{.}\NormalTok{size}\OperatorTok{()));}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsection{Round 6}\label{round-6}
  
  \subsubsection{A. ‰∏Ä}\label{a.-ux4e00-2}
  
  Áé∞Âú®Êàë‰ª¨Êúâ‰∏§ÈòüÁöÆÂÖãÊïèÔºå‰∏™Êï∞ÂàÜÂà´‰∏∫\(n_1,n_2\)ÔºåÁé∞Âú®Êàë‰ª¨Ë¶ÅÊùÄÊéâËøô‰∫õÁöÆÂÖãÊïèÔºåÊåâÁÖßÂ¶Ç‰∏ãËßÑÂàôÊìç‰ΩúÔºöÂØπ‰∫éÁ¨¨\(i\)ËΩÆÊùÄÁöÆÂÖãÊïèÁöÑÊìç‰ΩúÔºåÊàë‰ª¨È¶ñÂÖàÈÄâÊã©ÁöÆÂÖãÊïèËæÉÂ§öÁöÑÈÇ£‰∏ÄÈòüÔºåÂ¶ÇÊûú‰∏ÄÊ†∑Â∞±ÈÄâÊã©Á¨¨‰∏ÄÈòüÔºåÁÑ∂ÂêéÊùÄÊéâËøôÈòü‰∏≠ÁöÑ\(i\)‰∏™ÁöÆÂÖãÊïèÔºåÂ¶ÇÊûú‰∏çÂ§üÔºåÊ∏∏ÊàèÁªìÊùüÔºåËÆ∞ÂÅöÊ∏∏ÊàèÂú®Á¨¨\(i\)ËΩÆÁªìÊùü„ÄÇÈóÆÊúÄÂêé‰∏§ÈòüÂêÑÂâ©‰∏ãÂ§öÂ∞ë‰∏™ÁöÆÂÖãÊïèÔºü
  \(n \le 10^{16}\)
  
  ÂàÜÊàê‰∏§Èò∂ÊÆµÔºå‰∏ÄÈò∂ÊÆµÊòØÂè™ÊùÄÂ§öÁöÑÈÇ£ÈòüÔºåÁõ¥Âà∞ÊØîÂè¶‰∏ÄÈòüÂ∞ë„ÄÇ‰∫åÈò∂ÊÆµÊòØ‰∏§Èòü‰∫§ÊõøÁùÄÊùÄÔºåÂèØ‰ª•ËØÅÊòéÔºåÂ¶ÇÊûúÁªèËøá‰∫ÜÁ¨¨‰∏ÄÈò∂ÊÆµÔºåÈÇ£‰πàÁ¨¨‰∫åÈò∂ÊÆµ‰∏ÄÂÆöÊòØ‰∫§ÊõøÁùÄÊùÄ„ÄÇ
  ÊùÄÂ∞±ÂÆå‰∫Ü„ÄÇ ÂàÜÂà´‰∫åÂàÜÂç≥ÂèØÔºåÂΩìÁÑ∂Á¨¨‰∏ÄÊ≠•‰πüÂèØ‰ª•Áõ¥Êé•Ëß£ÊñπÁ®ã„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \NormalTok{LL A}\OperatorTok{,}\NormalTok{ B}\OperatorTok{;}
  \KeywordTok{inline}\NormalTok{ LL check}\OperatorTok{(}\NormalTok{LL x}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return}\NormalTok{ x }\OperatorTok{*} \OperatorTok{(}\NormalTok{x }\OperatorTok{+} \DecValTok{1}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;} \OperatorTok{\}}
  \NormalTok{LL Get}\OperatorTok{(}\NormalTok{LL res}\OperatorTok{)\{}
  \NormalTok{    LL L }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ R }\OperatorTok{=} \FloatTok{1e9}\OperatorTok{,}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;} 
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}}\NormalTok{ R}\OperatorTok{)\{}
  \NormalTok{        LL mid }\OperatorTok{=}\NormalTok{ L }\OperatorTok{+} \OperatorTok{((}\NormalTok{R }\OperatorTok{{-}}\NormalTok{ L }\OperatorTok{+} \DecValTok{1}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{check}\OperatorTok{(}\NormalTok{mid}\OperatorTok{)} \OperatorTok{\textless{}=}\NormalTok{ res}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ L }\OperatorTok{=}\NormalTok{ mid}\OperatorTok{;}
          \ControlFlowTok{else}\NormalTok{ R }\OperatorTok{=}\NormalTok{ mid }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{;}
      \OperatorTok{\}}
      \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;}
  \OperatorTok{\}}
  \NormalTok{LL Start }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ LL tA}\OperatorTok{,}\NormalTok{ tB}\OperatorTok{;}
  \DataTypeTok{bool}\NormalTok{ check0}\OperatorTok{(}\NormalTok{LL Round}\OperatorTok{,}\NormalTok{ LL A}\OperatorTok{,}\NormalTok{ LL B}\OperatorTok{)\{}
  \NormalTok{    LL dA}\OperatorTok{,}\NormalTok{ dB}\OperatorTok{;} \DataTypeTok{bool}\NormalTok{ sf }\OperatorTok{=} \KeywordTok{false}\OperatorTok{;}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{A }\OperatorTok{\textless{}}\NormalTok{ B}\OperatorTok{)}\NormalTok{ sf }\OperatorTok{=} \KeywordTok{true}\OperatorTok{,}\NormalTok{ swap}\OperatorTok{(}\NormalTok{A}\OperatorTok{,}\NormalTok{ B}\OperatorTok{);}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{Round }\OperatorTok{\&} \DecValTok{1}\OperatorTok{)} \OperatorTok{\{} 
  \NormalTok{        dA }\OperatorTok{=} \OperatorTok{(}\NormalTok{Start }\OperatorTok{+} \OperatorTok{(}\NormalTok{Start }\OperatorTok{+}\NormalTok{ Round }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{))} \OperatorTok{*} \OperatorTok{(}\NormalTok{Round }\OperatorTok{/} \DecValTok{2} \OperatorTok{+} \DecValTok{1}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;} 
  \NormalTok{        dB }\OperatorTok{=} \OperatorTok{(}\NormalTok{Start }\OperatorTok{+} \DecValTok{1} \OperatorTok{+} \OperatorTok{(}\NormalTok{Start }\OperatorTok{+}\NormalTok{ Round }\OperatorTok{{-}} \DecValTok{2}\OperatorTok{))} \OperatorTok{*} \OperatorTok{(}\NormalTok{Round }\OperatorTok{/} \DecValTok{2}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
      \OperatorTok{\}} \ControlFlowTok{else} \OperatorTok{\{}
  \NormalTok{        dA }\OperatorTok{=} \OperatorTok{(}\NormalTok{Start }\OperatorTok{+} \OperatorTok{(}\NormalTok{Start }\OperatorTok{+}\NormalTok{ Round }\OperatorTok{{-}} \DecValTok{2}\OperatorTok{))} \OperatorTok{*} \OperatorTok{(}\NormalTok{Round }\OperatorTok{/} \DecValTok{2}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;} 
  \NormalTok{        dB }\OperatorTok{=} \OperatorTok{(}\NormalTok{Start }\OperatorTok{+} \DecValTok{1} \OperatorTok{+} \OperatorTok{(}\NormalTok{Start }\OperatorTok{+}\NormalTok{ Round }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{))} \OperatorTok{*} \OperatorTok{(}\NormalTok{Round }\OperatorTok{/} \DecValTok{2}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
      \OperatorTok{\}}\NormalTok{ A }\OperatorTok{{-}=}\NormalTok{ dA}\OperatorTok{;}\NormalTok{ B }\OperatorTok{{-}=}\NormalTok{ dB}\OperatorTok{;} 
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{sf}\OperatorTok{)}\NormalTok{ swap}\OperatorTok{(}\NormalTok{A}\OperatorTok{,}\NormalTok{ B}\OperatorTok{);}
  \NormalTok{    tA }\OperatorTok{=}\NormalTok{ A}\OperatorTok{;}\NormalTok{ tB }\OperatorTok{=}\NormalTok{ B}\OperatorTok{;}
      \ControlFlowTok{return}\NormalTok{ A }\OperatorTok{\textgreater{}=} \DecValTok{0} \OperatorTok{\&\&}\NormalTok{ B }\OperatorTok{\textgreater{}=} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{void}\NormalTok{ doit}\OperatorTok{()\{}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{A}\OperatorTok{)(}\NormalTok{B}\OperatorTok{);}
  \NormalTok{    LL d }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{A}\OperatorTok{,}\NormalTok{ B}\OperatorTok{)} \OperatorTok{{-}}\NormalTok{ min}\OperatorTok{(}\NormalTok{A}\OperatorTok{,}\NormalTok{ B}\OperatorTok{);}
  \NormalTok{    LL Round }\OperatorTok{=}\NormalTok{ Get}\OperatorTok{(}\NormalTok{d}\OperatorTok{);}\NormalTok{ LL del }\OperatorTok{=}\NormalTok{ check}\OperatorTok{(}\NormalTok{Round}\OperatorTok{);}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{A }\OperatorTok{\textless{}}\NormalTok{ B}\OperatorTok{)}\NormalTok{ B }\OperatorTok{{-}=}\NormalTok{ del}\OperatorTok{;} \ControlFlowTok{else}\NormalTok{ A }\OperatorTok{{-}=}\NormalTok{ del}\OperatorTok{;} 
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{A }\OperatorTok{==}\NormalTok{ B}\OperatorTok{)} \OperatorTok{\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{A }\OperatorTok{\textless{}}\NormalTok{ Round }\OperatorTok{+} \DecValTok{1}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{(}\DataTypeTok{void}\OperatorTok{)}\NormalTok{printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld}\StringTok{ }\SpecialCharTok{\%lld}\StringTok{ }\SpecialCharTok{\%lld\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ Round }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ A}\OperatorTok{,}\NormalTok{ B}\OperatorTok{);}
          \ControlFlowTok{else}\NormalTok{ Round }\OperatorTok{++,}\NormalTok{ A }\OperatorTok{{-}=}\NormalTok{ Round}\OperatorTok{;}
      \OperatorTok{\}} \ControlFlowTok{else} \OperatorTok{\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{max}\OperatorTok{(}\NormalTok{A}\OperatorTok{,}\NormalTok{ B}\OperatorTok{)} \OperatorTok{\textless{}}\NormalTok{ Round }\OperatorTok{+} \DecValTok{1}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{(}\DataTypeTok{void}\OperatorTok{)}\NormalTok{printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld}\StringTok{ }\SpecialCharTok{\%lld}\StringTok{ }\SpecialCharTok{\%lld\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ Round }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ A}\OperatorTok{,}\NormalTok{ B}\OperatorTok{);}
          \ControlFlowTok{else}\NormalTok{ Round }\OperatorTok{++,} \OperatorTok{(}\NormalTok{A }\OperatorTok{\textgreater{}}\NormalTok{ B }\OperatorTok{?}\NormalTok{ A }\OperatorTok{{-}=}\NormalTok{ Round }\OperatorTok{:}\NormalTok{ B }\OperatorTok{{-}=}\NormalTok{ Round}\OperatorTok{);}
      \OperatorTok{\}}
  \NormalTok{    LL L }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ R }\OperatorTok{=} \FloatTok{1e9}\OperatorTok{,}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ Start }\OperatorTok{=}\NormalTok{ Round }\OperatorTok{+} \DecValTok{1}\OperatorTok{;}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{        LL mid }\OperatorTok{=}\NormalTok{ L }\OperatorTok{+} \OperatorTok{((}\NormalTok{R }\OperatorTok{{-}}\NormalTok{ L }\OperatorTok{+} \DecValTok{1}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{check0}\OperatorTok{(}\NormalTok{mid}\OperatorTok{,}\NormalTok{ A}\OperatorTok{,}\NormalTok{ B}\OperatorTok{))}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ L }\OperatorTok{=}\NormalTok{ mid}\OperatorTok{;}
          \ControlFlowTok{else}\NormalTok{ R }\OperatorTok{=}\NormalTok{ mid }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{;}
      \OperatorTok{\}}\NormalTok{ check0}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ A}\OperatorTok{,}\NormalTok{ B}\OperatorTok{);}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld}\StringTok{ }\SpecialCharTok{\%lld}\StringTok{ }\SpecialCharTok{\%lld\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ ans }\OperatorTok{+}\NormalTok{ Round }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ tA}\OperatorTok{,}\NormalTok{ tB}\OperatorTok{);}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
      \DataTypeTok{int}\NormalTok{ T }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}\NormalTok{ cerr }\OperatorTok{\textless{}\textless{}} \StringTok{"std\textquotesingle{}s T = "} \OperatorTok{\textless{}\textless{}}\NormalTok{ T }\OperatorTok{\textless{}\textless{}}\NormalTok{ endl}\OperatorTok{;}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{T}\OperatorTok{{-}{-})}\NormalTok{ doit}\OperatorTok{();}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{B. ‰∫å}\label{b.-ux4e8c-2}
  
  Áé∞Âú®Êúâ‰∏âÁªÑN‰∏™Êï∞ËÆ∞ÂÅö\(A,B,C\)ÔºåÂÆö‰πâÂáΩÊï∞\(f(A,B)=\sum_{i=1}^NA_i\times B_i\)„ÄÇÁé∞Âú®ÁªôÂÆö\(A,B\)ÔºåÂπ∂ÂëäËØâ‰Ω†\(f(A,C)=x\)ÔºåÁé∞Âú®ÊÉ≥Ê±ÇÂú®Êª°Ë∂≥\(‚àë_{i=1}^NC_i=1,0\leq C_i\leq1\)ÁöÑÊÉÖÂÜµ‰∏ã\(f(B,C)\)ÁöÑÊúÄÂ§ßÂÄº„ÄÇ
  ÂØπ‰∫é\(100\%\)ÁöÑÊï∞ÊçÆÔºå\(1\leq N,M\leq 100,1\leq A_i,B_i\leq100\)
  
  {[}skip{]} ÁªìËÆ∫ÊòØÂè™Êúâ‰∏§‰∏™ÁÇπÊúâÁî®ÔºåÂè™Êûö‰∏æ‰∏§‰∏™ÁÇπÂç≥ÂèØ„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{C. ‰∏â}\label{c.-ux4e09-2}
  
  ‰ºóÊâÄÂë®Áü•ÔºåÂ∞èËë±ÂêåÂ≠¶ÊìÖÈïøËÆ°ÁÆóÔºåÂ∞§ÂÖ∂ÊìÖÈïøËÆ°ÁÆóÁªÑÂêàÊï∞Ôºå‰ΩÜËøô‰∏™È¢òÂíåÁªÑÂêàÊï∞Ê≤°‰ªÄ‰πàÂÖ≥Á≥ª„ÄÇ
  
  Áé∞Âú®Êúâ‰∏Ä‰∏™ \(N\)
  ÁöÑÊéíÂàóÔºåÂ∞ÜÂÖ∂ÊØè‰∏™Êï∞ÁúãÂÅö‰∏Ä‰∏™ÈõÜÂêà„ÄÇÂÆö‰πâ‰∏ÄÁßçÂØπ‰∏§‰∏™ÈõÜÂêàÁöÑËøêÁÆó‰∏∫Ôºö\(f(s_1,s_2 )=\sum_{x\in s_1}[\exists y\in s_2,y < x]\)
  ‰πüÂèØ‰ª•Áî®ËøôÊ†∑‰∏ÄÊÆµ‰º™‰ª£Á†ÅÂéªÁêÜËß£Ôºö
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \NormalTok{Ans}\OperatorTok{=}\DecValTok{0}
  \NormalTok{For x }\KeywordTok{in}\NormalTok{ s1:}
  \NormalTok{    Able }\OperatorTok{=} \VariableTok{False}
  \NormalTok{    For y }\KeywordTok{in}\NormalTok{ s2:}
  \NormalTok{        If y}\OperatorTok{\textless{}}\NormalTok{x:}
  \NormalTok{            Able}\OperatorTok{=}\VariableTok{True}
  \NormalTok{    If Able:}
  \NormalTok{        Ans}\OperatorTok{++}
  \NormalTok{Return Ans}
  \end{Highlighting}
  \end{Shaded}
  
  Áé∞Âú®‰Ω†ÊØèÊ¨°ÂèØ‰ª•ÂêàÂπ∂‰∏§‰∏™Áõ∏ÈÇªÁöÑÈõÜÂêàÂ∞ÜÂÖ∂Âèò‰∏∫‰∏§‰∏™ÈõÜÂêàÁöÑÂπ∂ÈõÜÔºåÂÖ∂‰ª£‰ª∑‰∏∫\(f(s_1,s_2)+f(s_2,s_1)\)„ÄÇÊ±ÇÊúÄÂ∞è‰ª£‰ª∑ÔºåÂ∞ÜÊâÄÊúâÈõÜÂêàÂêàÂπ∂‰∏∫‰∏Ä‰∏™ÈõÜÂêà„ÄÇ
  \(N \le 10^2\)
  
  ÂáΩÊï∞ \(f(A, B)\) ÂÖ∂ÂÆûÂ∞±ÊòØ \(A\) ‰∏≠ÊúâÂ§öÂ∞ëÂÖÉÁ¥†Â§ß‰∫é \(\min{B_i}\)
  „ÄÇÊåâÁÖßÂÆö‰πâÂå∫Èó¥ dp Âç≥ÂèØÔºåÁî±‰∫éÊòØÂ∞è‰∫é \(\mathcal{O}(n^2)\)
  Á∫ßÂà´ÁöÑ‰∫åÁª¥Êï∞ÁÇπÔºåÂèØ‰ª•‰ΩøÁî®‰∫åÁª¥ÂâçÁºÄÂíå„ÄÇ Êü•ËØ¢ÊúÄÂ∞èÂÄºÈöèÊâãÈ¢ÑÂ§ÑÁêÜ‰∏Ä‰∏ã
  \texttt{ST} Ë°®Âç≥ÂèØ„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \DecValTok{600}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ dp}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ S}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ A}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ query}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ up}\OperatorTok{)\{} \CommentTok{// how many elements in range[L, R] which is \textgreater{} up }
      \ControlFlowTok{return}\NormalTok{ S}\OperatorTok{[}\NormalTok{n}\OperatorTok{][}\NormalTok{R}\OperatorTok{]} \OperatorTok{{-}}\NormalTok{ S}\OperatorTok{[}\NormalTok{up}\OperatorTok{][}\NormalTok{R}\OperatorTok{]} \OperatorTok{{-}}\NormalTok{ S}\OperatorTok{[}\NormalTok{n}\OperatorTok{][}\NormalTok{L }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]} \OperatorTok{+}\NormalTok{ S}\OperatorTok{[}\NormalTok{up}\OperatorTok{][}\NormalTok{L }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{];}
  \OperatorTok{\}}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_S }\OperatorTok{=} \DecValTok{4000}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ LOG }\OperatorTok{=} \DecValTok{10}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ ST}\OperatorTok{[}\NormalTok{\_S}\OperatorTok{][}\NormalTok{LOG }\OperatorTok{+} \DecValTok{2}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ Log}\OperatorTok{[}\NormalTok{\_S}\OperatorTok{];}
  \DataTypeTok{void}\NormalTok{ initQuery}\OperatorTok{()\{}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ ST}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\DecValTok{0}\OperatorTok{]} \OperatorTok{=}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ LOG}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ ST}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{ST}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{],}\NormalTok{ ST}\OperatorTok{[}\NormalTok{i }\OperatorTok{+} \OperatorTok{(}\DecValTok{1} \OperatorTok{\textless{}\textless{}} \OperatorTok{(}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{))][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]);}
  \NormalTok{    Log}\OperatorTok{[}\DecValTok{1}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{2}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ Log}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ Log}\OperatorTok{[}\NormalTok{i }\OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{]} \OperatorTok{+} \DecValTok{1}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ RMQ}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
      \DataTypeTok{int}\NormalTok{ Ln }\OperatorTok{=}\NormalTok{ Log}\OperatorTok{[}\NormalTok{R }\OperatorTok{{-}}\NormalTok{ L }\OperatorTok{+} \DecValTok{1}\OperatorTok{];}
      \ControlFlowTok{return}\NormalTok{ min}\OperatorTok{(}\NormalTok{ST}\OperatorTok{[}\NormalTok{L}\OperatorTok{][}\NormalTok{Ln}\OperatorTok{],}\NormalTok{ ST}\OperatorTok{[}\NormalTok{R }\OperatorTok{{-}} \OperatorTok{(}\DecValTok{1} \OperatorTok{\textless{}\textless{}}\NormalTok{ Ln}\OperatorTok{)} \OperatorTok{+} \DecValTok{1}\OperatorTok{][}\NormalTok{Ln}\OperatorTok{]);}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ calc}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ L0}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R0}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L1}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R1}\OperatorTok{)\{}
      \DataTypeTok{int}\NormalTok{ min0 }\OperatorTok{=}\NormalTok{ RMQ}\OperatorTok{(}\NormalTok{L0}\OperatorTok{,}\NormalTok{ R0}\OperatorTok{),}\NormalTok{ min1 }\OperatorTok{=}\NormalTok{ RMQ}\OperatorTok{(}\NormalTok{L1}\OperatorTok{,}\NormalTok{ R1}\OperatorTok{);}
      \ControlFlowTok{return}\NormalTok{ query}\OperatorTok{(}\NormalTok{L0}\OperatorTok{,}\NormalTok{ R0}\OperatorTok{,}\NormalTok{ min1}\OperatorTok{)} \OperatorTok{+}\NormalTok{ query}\OperatorTok{(}\NormalTok{L1}\OperatorTok{,}\NormalTok{ R1}\OperatorTok{,}\NormalTok{ min0}\OperatorTok{);}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{);}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ Read}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}\NormalTok{ initQuery}\OperatorTok{();}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ S}\OperatorTok{[}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]][}\NormalTok{i}\OperatorTok{]++;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ S}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{+=}\NormalTok{ S}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{+}\NormalTok{ S}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]} \OperatorTok{{-}}\NormalTok{ S}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{];}
  \NormalTok{    memset}\OperatorTok{(}\NormalTok{dp}\OperatorTok{,} \BaseNTok{0x3f}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{dp}\OperatorTok{));}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{Len}\OperatorTok{,} \DecValTok{2}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)\{}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{L}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)\{}
              \DataTypeTok{int}\NormalTok{ R }\OperatorTok{=}\NormalTok{ L }\OperatorTok{+}\NormalTok{ Len }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{;} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R }\OperatorTok{\textgreater{}}\NormalTok{ n}\OperatorTok{)} \ControlFlowTok{break}\OperatorTok{;}
              \DataTypeTok{int} \OperatorTok{\&}\NormalTok{ans }\OperatorTok{=}\NormalTok{ dp}\OperatorTok{[}\NormalTok{L}\OperatorTok{][}\NormalTok{R}\OperatorTok{];}
  \NormalTok{            rep}\OperatorTok{(}\NormalTok{k}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ dp}\OperatorTok{[}\NormalTok{L}\OperatorTok{][}\NormalTok{k}\OperatorTok{]} \OperatorTok{+}\NormalTok{ dp}\OperatorTok{[}\NormalTok{k }\OperatorTok{+} \DecValTok{1}\OperatorTok{][}\NormalTok{R}\OperatorTok{]} \OperatorTok{+}\NormalTok{ calc}\OperatorTok{(}\NormalTok{L}\OperatorTok{,}\NormalTok{ k}\OperatorTok{,}\NormalTok{ k }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{));}
          \OperatorTok{\}}
      \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,}\NormalTok{ dp}\OperatorTok{[}\DecValTok{1}\OperatorTok{][}\NormalTok{n}\OperatorTok{]);}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{D. Âõõ}\label{d.-ux56db-2}
  
  ÁªôÂÆö \(1-N\) ÁöÑÊéíÂàó‰ΩÜÂÖ∂‰∏≠ \(M\) ‰∏™‰ΩçÁΩÆÁöÑÂÄºË¢´Âà†Âéª‰∫ÜÔºàÁî® \(0\)
  Ë°®Á§∫ÔºâÔºåÁé∞Âú®‰Ω†ÈúÄË¶ÅÂ∞ÜÂÖ∂Â§çÂéüÔºåÈóÆÊúâÂ§öÂ∞ëÁßçÊñπÊ°àËÉΩÂ§ü‰ΩøÂæóÂ§çÂéüÁöÑÂ∫èÂàóÁöÑÈÄÜÂ∫èÂØπ‰∏™Êï∞Âú®
  \([L,R]\) ‰πãÈó¥
  
  ÊäòÂçäÊêúÁ¥¢Ôºå‰∏≠Èó¥ \(\mathcal{O}(n^2)\) ÂêàÂπ∂„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  
  \end{Highlighting}
  \end{Shaded}
  
  \subsection{Round 7}\label{round-7}
  
  AK„ÄÇ \#\#\# A. ‰∏Ä
  
  Êúâ‰∏Ä‰∏™\(n\times n\)ÁöÑÁü©ÈòµÔºåÁü©Èòµ‰∏≠ÁöÑÊØè‰∏™Êï∞ÈÉΩÊòØÊï¥Êï∞„ÄÇÁé∞Âú®Ë¶Å‰ªéÁü©Èòµ‰∏≠Âèñ\(m\)‰∏™Êï∞ÔºåË¶ÅÊ±ÇÊØè‰∏ÄË°åÊúÄÂ§öÂèñ‰∏Ä‰∏™Êï∞ÔºåÊØè‰∏ÄÂàó‰πüÊúÄÂ§öÂèñ‰∏Ä‰∏™Êï∞„ÄÇËøô\(m\)‰∏™Êï∞ÁöÑÂíåÊúÄÂ§ßËÉΩÊòØÂ§öÂ∞ëÔºü
  \(n \le 15, m \le 3, A_{i,j} \le 10^5\)
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \DecValTok{20}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ m}\OperatorTok{,}\NormalTok{ A}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{m}\OperatorTok{);}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ Read}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]);}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{m }\OperatorTok{==} \DecValTok{1}\OperatorTok{)} \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ MAX }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ MAX }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{MAX}\OperatorTok{,}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]);}
  \NormalTok{        printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,}\NormalTok{ MAX}\OperatorTok{);}
      \OperatorTok{\}} \ControlFlowTok{else} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{m }\OperatorTok{==} \DecValTok{2}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ MAX }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{a}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{b}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{c}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{d}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{a }\OperatorTok{==}\NormalTok{ c }\OperatorTok{||}\NormalTok{ b }\OperatorTok{==}\NormalTok{ d}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{            MAX }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{MAX}\OperatorTok{,}\NormalTok{ A}\OperatorTok{[}\NormalTok{a}\OperatorTok{][}\NormalTok{b}\OperatorTok{]} \OperatorTok{+}\NormalTok{ A}\OperatorTok{[}\NormalTok{c}\OperatorTok{][}\NormalTok{d}\OperatorTok{]);}
          \OperatorTok{\}}
  \NormalTok{        printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,}\NormalTok{ MAX}\OperatorTok{);}
      \OperatorTok{\}} \ControlFlowTok{else} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{m }\OperatorTok{==} \DecValTok{3}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ MAX }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{a}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{b}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{c}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{d}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{e}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{f}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{a }\OperatorTok{==}\NormalTok{ c }\OperatorTok{||}\NormalTok{ c }\OperatorTok{==}\NormalTok{ e }\OperatorTok{||}\NormalTok{ a }\OperatorTok{==}\NormalTok{ e }\OperatorTok{||}\NormalTok{ b }\OperatorTok{==}\NormalTok{ d }\OperatorTok{||}\NormalTok{ d }\OperatorTok{==}\NormalTok{ f }\OperatorTok{||}\NormalTok{ b }\OperatorTok{==}\NormalTok{ f}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{            MAX }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{MAX}\OperatorTok{,}\NormalTok{ A}\OperatorTok{[}\NormalTok{a}\OperatorTok{][}\NormalTok{b}\OperatorTok{]} \OperatorTok{+}\NormalTok{ A}\OperatorTok{[}\NormalTok{c}\OperatorTok{][}\NormalTok{d}\OperatorTok{]} \OperatorTok{+}\NormalTok{ A}\OperatorTok{[}\NormalTok{e}\OperatorTok{][}\NormalTok{f}\OperatorTok{]);}
          \OperatorTok{\}}
  \NormalTok{        printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,}\NormalTok{ MAX}\OperatorTok{);}
      \OperatorTok{\}}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{B. ‰∫å}\label{b.-ux4e8c-3}
  
  ÊúâÂ§öÂ∞ëÊï¥Êï∞Â§ß‰∫éÁ≠â‰∫é\(x\)ÔºåÂ∞è‰∫éÁ≠â‰∫é\(y\)ÔºåËÄå‰∏îÊòØ7ÁöÑÂÄçÊï∞ÔºåÂèà‰∏çÊòØ2,3,5ÁöÑÂÄçÊï∞Âë¢Ôºü
  \(x,y \le 10^{18}\)
  
  ÂÆπÊñ•ÂéüÁêÜ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \NormalTok{LL calc}\OperatorTok{(}\NormalTok{LL R}\OperatorTok{)\{}
  \NormalTok{    LL ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    ans }\OperatorTok{+=}\NormalTok{ R }\OperatorTok{/} \DecValTok{7}\OperatorTok{;}\NormalTok{ ans }\OperatorTok{{-}=}\NormalTok{ R }\OperatorTok{/} \DecValTok{14}\OperatorTok{;}\NormalTok{ ans }\OperatorTok{{-}=}\NormalTok{ R }\OperatorTok{/} \DecValTok{21}\OperatorTok{;}\NormalTok{ ans }\OperatorTok{{-}=}\NormalTok{ R }\OperatorTok{/} \DecValTok{35}\OperatorTok{;}\NormalTok{ ans }\OperatorTok{+=}\NormalTok{ R }\OperatorTok{/} \DecValTok{42}\OperatorTok{;}\NormalTok{ ans }\OperatorTok{+=}\NormalTok{ R }\OperatorTok{/} \DecValTok{70}\OperatorTok{;}\NormalTok{ ans }\OperatorTok{+=}\NormalTok{ R }\OperatorTok{/} \DecValTok{105}\OperatorTok{;}\NormalTok{ ans }\OperatorTok{{-}=}\NormalTok{ R }\OperatorTok{/} \DecValTok{210}\OperatorTok{;}
      \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    LL L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{L}\OperatorTok{)(}\NormalTok{R}\OperatorTok{);}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld}\StringTok{"}\OperatorTok{,}\NormalTok{ calc}\OperatorTok{(}\NormalTok{R}\OperatorTok{)} \OperatorTok{{-}}\NormalTok{ calc}\OperatorTok{(}\NormalTok{L }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{));}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{C. ‰∏â}\label{c.-ux4e09-3}
  
  ÁªôÂá∫‰∏Ä‰∏™\(n\)‰∏™ÁÇπ\(m\)Êù°ËæπÁöÑÂõæ„ÄÇ
  
  Áé∞Âú®ÊÉ≥Ë¶ÅÈÄâÊã©‰∏§‰∏™Êï¥Êï∞\(a\)Âíå\(b\)ÔºåÊª°Ë∂≥\(1 \leq a < b < n\)ÔºåÁÑ∂ÂêéÊääÁºñÂè∑Âú®Âå∫Èó¥\([1,a]\)‰∏≠ÁöÑÁÇπÊüìÊàêËìùËâ≤ÔºåÊääÁºñÂè∑Âú®Âå∫Èó¥\([a+1,b]\)‰∏≠ÁöÑÁÇπÊüìÊàêÁ∫¢Ëâ≤ÔºåÁºñÂè∑Âú®Âå∫Èó¥\([b+1,n]\)‰∏≠ÁöÑÁÇπÊüìÊàêËìùËâ≤„ÄÇ
  
  Â¶ÇÊûú‰∏ÄÊù°ËæπÁöÑ‰∏§‰∏™Á´ØÁÇπÈ¢úËâ≤‰∏çÂêåÔºåÊàë‰ª¨Áß∞ËøôÊù°Ëæπ‰∏∫ÂèåËâ≤ËæπÔºåÂê¶ÂàôÁß∞‰πã‰∏∫ÂçïËâ≤Ëæπ„ÄÇ
  
  Â¶Ç‰ΩïÈÄâÊã©\(a,b\)ÔºåËÉΩÂ§üÊúÄÂ∞èÂåñÂèåËâ≤ËæπÁöÑÊï∞ÈáèÔºü \(n, m \le 10^5\)
  
  ÁªèÂÖ∏Â•óË∑ØÔºåÊåâÈ°∫Â∫èÊûö‰∏æ \(a\)ÔºåÁ∫øÊÆµÊ†ëÁª¥Êä§ \(b\)
  ÁöÑÊØè‰∏Ä‰∏™ÂèñÂÄºÊó∂ÁöÑÂèåËâ≤ËæπÊï∞ÈáèÔºåÊûö‰∏æ \(a\) ÁöÑËøáÁ®ã‰∏≠Áª¥Êä§ \(b\)
  ÁöÑÂèñÂÄºÔºåÊõ¥Êñ∞Á≠îÊ°àÂç≥ÂèØ„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ m}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{3e5} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
  \NormalTok{vector}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ ToL}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];} 
  \NormalTok{vector}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ ToR}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \KeywordTok{namespace}\NormalTok{ SegmentTree}\OperatorTok{\{}  \CommentTok{// maintain the number of double{-}color edge;}
                          \CommentTok{// the min number ;}
      \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{2e6} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ ch}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\DecValTok{2}\OperatorTok{],}\NormalTok{ v}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ tag\_add}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \PreprocessorTok{\#define ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{ch}\OperatorTok{[}\NormalTok{o}\OperatorTok{][}\DecValTok{0}\OperatorTok{])}
      \PreprocessorTok{\#define rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{ch}\OperatorTok{[}\NormalTok{o}\OperatorTok{][}\DecValTok{1}\OperatorTok{])}
      \PreprocessorTok{\#define maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{min}\OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)],}\PreprocessorTok{ }\NormalTok{v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)]))}
      \PreprocessorTok{\#define make }\OperatorTok{(}\NormalTok{tot}\OperatorTok{++,}\PreprocessorTok{ }\NormalTok{ch}\OperatorTok{[}\NormalTok{tot}\OperatorTok{][}\DecValTok{0}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{ch}\OperatorTok{[}\NormalTok{tot}\OperatorTok{][}\DecValTok{1}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{v}\OperatorTok{[}\NormalTok{tot}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{tag\_add}\OperatorTok{[}\NormalTok{tot}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\DecValTok{0}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{tot}\OperatorTok{)}
      \DataTypeTok{int}\NormalTok{ Groot}\OperatorTok{()\{} \ControlFlowTok{return}\NormalTok{ make}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ build}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{==}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{(}\DataTypeTok{void}\OperatorTok{)(}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{);} \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{L }\OperatorTok{+}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{        ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)} \OperatorTok{=}\NormalTok{ make}\OperatorTok{;}\NormalTok{ rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)} \OperatorTok{=}\NormalTok{ make}\OperatorTok{;}
  \NormalTok{        build}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}\NormalTok{ build}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
  \NormalTok{        maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
      \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ tar}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ \_v}\OperatorTok{)\{}\NormalTok{ tag\_add}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{+=}\NormalTok{ \_v}\OperatorTok{;}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{+=}\NormalTok{ \_v}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ push}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{tag\_add}\OperatorTok{[}\NormalTok{o}\OperatorTok{])} \ControlFlowTok{return} \OperatorTok{;}\NormalTok{ tar}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ tag\_add}\OperatorTok{[}\NormalTok{o}\OperatorTok{]);}\NormalTok{ tar}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ tag\_add}\OperatorTok{[}\NormalTok{o}\OperatorTok{]);}\NormalTok{ tag\_add}\OperatorTok{[}\NormalTok{o}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ update}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ Val}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ nowl }\OperatorTok{\&\&}\NormalTok{ nowr }\OperatorTok{\textless{}=}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ tar}\OperatorTok{(}\NormalTok{o}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{);}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}\NormalTok{ push}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R  }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{);}
  \NormalTok{        maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ query}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ nowl }\OperatorTok{\&\&}\NormalTok{ nowr }\OperatorTok{\textless{}=}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{];}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}\NormalTok{ push}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
          \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ INT\_MAX}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ query}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{));}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R  }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ query}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{));}
          \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;}
      \OperatorTok{\}}
  \OperatorTok{\}}   \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{update}\OperatorTok{;}  \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{build}\OperatorTok{;} 
      \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{query}\OperatorTok{;}   \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{Groot}\OperatorTok{;} 
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{} 
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{m}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ root }\OperatorTok{=}\NormalTok{ Groot}\OperatorTok{();}\NormalTok{ build}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{);} \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ INT\_MAX}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ m}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{u}\OperatorTok{)(}\NormalTok{v}\OperatorTok{);} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{u }\OperatorTok{\textgreater{}}\NormalTok{ v}\OperatorTok{)}\NormalTok{ swap}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{);}
  \NormalTok{        ToL}\OperatorTok{[}\NormalTok{v}\OperatorTok{].}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{u}\OperatorTok{);}\NormalTok{ ToR}\OperatorTok{[}\NormalTok{u}\OperatorTok{].}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{v}\OperatorTok{);}\NormalTok{ update}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ u}\OperatorTok{,}\NormalTok{ v }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{,} \DecValTok{1}\OperatorTok{);}
      \OperatorTok{\}}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{2}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{        update}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ i }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{,} \OperatorTok{{-}}\DataTypeTok{int}\OperatorTok{(}\NormalTok{ToL}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{size}\OperatorTok{()));}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ ToR}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{)}\NormalTok{ update}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ i}\OperatorTok{,}\NormalTok{ ToR}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{,} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{),}\NormalTok{ update}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ ToR}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{],}\NormalTok{ n}\OperatorTok{,} \DecValTok{1}\OperatorTok{);}
  \NormalTok{        ans }\OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ query}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ i }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{));}
      \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{D. Âõõ}\label{d.-ux56db-3}
  
  \(n\)‰∏™Â∞è‰ºô‰º¥ÔºàÁºñÂè∑‰ªé0Âà∞\(n‚àí1\)ÔºâÂõ¥Âùê‰∏ÄÂúàÁé©Ê∏∏Êàè„ÄÇÊåâÁÖßÈ°∫Êó∂ÈíàÊñπÂêëÁªô\(n\)‰∏™‰ΩçÁΩÆÁºñÂè∑Ôºå‰ªé0Âà∞\(n‚àí1\)„ÄÇÊúÄÂàùÔºåÁ¨¨0Âè∑Â∞è‰ºô‰º¥Âú®Á¨¨0Âè∑‰ΩçÁΩÆÔºåÁ¨¨1Âè∑Â∞è‰ºô‰º¥Âú®Á¨¨1Âè∑‰ΩçÁΩÆÔºå\(\dots\)Ôºå‰æùÊ≠§Á±ªÊé®„ÄÇÊ∏∏ÊàèËßÑÂàôÂ¶Ç‰∏ãÔºö
  -
  Êúâ‰∏Ä‰∏™Â∫èÂàó\(A=\{a_1,\dots,a_m\}\)ÔºåÂÖ∂‰∏≠ÊØè‰∏™Êï∞‰∫í‰∏çÁõ∏ÂêåÔºå‰∏îÈÉΩÊòØ\([1,n-1]\)‰∏≠ÁöÑÊ≠£Êï¥Êï∞„ÄÇ
  -
  ÊØè‰∏ÄËΩÆ‰ªé\(A\)‰∏≠ÈÄâÊã©‰∏Ä‰∏™Êï∞\(a\)ÔºåÁ¨¨0Âè∑‰ΩçÁΩÆ‰∏äÁöÑÂ∞è‰ºô‰º¥È°∫Êó∂ÈíàËµ∞Âà∞Á¨¨\(a\)Âè∑‰ΩçÁΩÆÔºåÁ¨¨1Âè∑‰ΩçÁΩÆÂ∞è‰ºô‰º¥Ëµ∞Âà∞Á¨¨\(a+1\)Âè∑‰ΩçÁΩÆ„ÄÇ‰æùÊ≠§Á±ªÊé®ÔºåÁ¨¨\(n-a\)Âè∑‰ΩçÁΩÆ‰∏äÁöÑÂ∞è‰ºô‰º¥Ëµ∞Âà∞Á¨¨0Âè∑‰ΩçÁΩÆÔºåÁ¨¨\(n-a+1\)Âè∑‰ΩçÁΩÆ‰∏äÁöÑÂ∞è‰ºô‰º¥Ëµ∞Âà∞Á¨¨1Âè∑‰ΩçÁΩÆÔºå\(\dots\)ÔºåÁ¨¨\(n-1\)Âè∑‰ΩçÁΩÆ‰∏äÁöÑÂ∞è‰ºô‰º¥È°∫Êó∂ÈíàËµ∞Âà∞Á¨¨\(a-1\)Âè∑‰ΩçÁΩÆ„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÁ¨¨\(i\)Âè∑‰ΩçÁΩÆ‰∏äÁöÑÂ∞è‰ºô‰º¥Ëµ∞Âà∞Á¨¨\((i+a)\mod\ n\)Âè∑‰ΩçÁΩÆ
  
  Ê∏∏ÊàèËøõË°å\(t\)ËΩÆ„ÄÇÁî±‰∫éÊØè‰∏ÄËΩÆÈÉΩÈúÄË¶Å‰ªé\(A\)‰∏≠ÁöÑ\(m\)‰∏™Êï∞‰∏≠ÈÄâ‰∏Ä‰∏™Êï∞ÔºåÊâÄ‰ª•Ê∏∏ÊàèÂÖ±Êúâ\(m^t\)ÁßçÁé©Ê≥ï„ÄÇÂÖ∂‰∏≠ÊúâÂ§öÂ∞ëÁßçÁé©Ê≥ïËÉΩÂ§ü‰ΩøÂæóÊ∏∏ÊàèÁªìÊùüÊó∂ÔºåÁ¨¨0Âè∑Â∞è‰ºô‰º¥ÊâÄÂú®ÁöÑ‰ΩçÁΩÆÁºñÂè∑ÊòØ\(d\)ÁöÑÂÄçÊï∞ÔºüÔºà0‰πüÊòØ\(d\)ÁöÑÂÄçÊï∞Ôºâ„ÄÅ
  ÂØπ \(10^9 + 7\)ÂèñÊ®°„ÄÇ
  \(1\le m \le n \le 1000, 1 \le t \le 10^9, 1 \le d \le n\)„ÄÇ
  
  ËÆæ \(dp[i]\) ‰∏∫ËøõË°åËã•Âπ≤ËΩÆ‰πãÂêéÂú®‰ΩçÁΩÆ \(i\) ÁöÑÊñπÊ°àÊï∞„ÄÇ ËΩ¨ÁßªÊòæÁÑ∂ÊòØÂç∑ÁßØ„ÄÇ
  ÂåÖË£Ö‰∫ÜÂæ™ÁéØÂç∑ÁßØÁöÑÂÆö‰πâ„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \KeywordTok{namespace}\NormalTok{ subtask\_acceptable\_solution}\OperatorTok{\{}
      \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \DecValTok{1500}\OperatorTok{;}
      \KeywordTok{struct}\NormalTok{ Matrix}\OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ dp}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \NormalTok{        Matrix }\OperatorTok{()\{}\NormalTok{ memset}\OperatorTok{(}\NormalTok{dp}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{dp}\OperatorTok{));} \OperatorTok{\}}
  \NormalTok{        Matrix }\KeywordTok{operator} \OperatorTok{*} \OperatorTok{(}\AttributeTok{const}\NormalTok{ Matrix }\OperatorTok{\&}\NormalTok{ rhs}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{            Matrix Res}\OperatorTok{;} 
  \NormalTok{            rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)}\NormalTok{ Res}\OperatorTok{.}\NormalTok{dp}\OperatorTok{[(}\NormalTok{i }\OperatorTok{+}\NormalTok{ j}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ n}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{Res}\OperatorTok{.}\NormalTok{dp}\OperatorTok{[(}\NormalTok{i }\OperatorTok{+}\NormalTok{ j}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ n}\OperatorTok{]} \OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ rhs}\OperatorTok{.}\NormalTok{dp}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
              \ControlFlowTok{return}\NormalTok{ Res}\OperatorTok{;}
          \OperatorTok{\}}
      \OperatorTok{\};}
  \NormalTok{    Matrix pow}\OperatorTok{(}\NormalTok{Matrix a}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ b}\OperatorTok{)\{}
  \NormalTok{        Matrix ans }\OperatorTok{=}\NormalTok{ a}\OperatorTok{;}\NormalTok{ b}\OperatorTok{{-}{-};}
          \ControlFlowTok{while}\OperatorTok{(}\NormalTok{b}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{b }\OperatorTok{\&} \DecValTok{1}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ ans }\OperatorTok{*}\NormalTok{ a}\OperatorTok{;}
  \NormalTok{            a }\OperatorTok{=}\NormalTok{ a }\OperatorTok{*}\NormalTok{ a}\OperatorTok{;}
  \NormalTok{            b }\OperatorTok{\textgreater{}\textgreater{}=} \DecValTok{1}\OperatorTok{;}
          \OperatorTok{\}}
          \ControlFlowTok{return}\NormalTok{ ans}\OperatorTok{;}
      \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ work}\OperatorTok{()\{}
  \NormalTok{        Matrix a}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ m}\OperatorTok{)}\NormalTok{ a}\OperatorTok{.}\NormalTok{dp}\OperatorTok{[}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]]} \OperatorTok{++;}
  \NormalTok{        Matrix Ans }\OperatorTok{=}\NormalTok{ pow}\OperatorTok{(}\NormalTok{a}\OperatorTok{,}\NormalTok{ t}\OperatorTok{);}
          \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i }\OperatorTok{+=}\NormalTok{ d}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ Ans}\OperatorTok{.}\NormalTok{dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
  \NormalTok{        printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{} \CommentTok{//freopen("in.txt", "r", stdin);}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{m}\OperatorTok{)(}\NormalTok{t}\OperatorTok{)(}\NormalTok{d}\OperatorTok{);}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ m}\OperatorTok{)}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ read}\OperatorTok{()} \OperatorTok{\%}\NormalTok{ n}\OperatorTok{;}
  \NormalTok{    subtask\_acceptable\_solution}\OperatorTok{::}\NormalTok{work}\OperatorTok{();}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsection{Round 8}\label{round-8}
  
  \subsubsection{A. ÂèåÊåÇ}\label{a.-ux53ccux6302}
  
  ‰ªäÂπ¥Êúü‰∏≠ËÄÉËØïËÄÉ‰∫Ü„ÄäÁ®ãÂ∫èËÆæËÆ°„Äã„ÄÅ„ÄäÁÆóÊ≥ïËÆæËÆ°„ÄãÂíå„ÄäÊï∞ÊçÆÁªìÊûÑ„ÄãÂÖ±‰∏âÈó®ËØæ„ÄÇÁî±‰∫éËÄÉËØïÂ§™Èöæ‰∫ÜÔºåÂ•ΩÂ§öÂêåÂ≠¶ÈÉΩÊåÇÁßë‰∫Ü„ÄÇÁè≠Èáå‰∏ÄÂÖ±\(n\)‰∏™‰∫∫ÔºåÂÖ∂‰∏≠\(a\)‰∏™‰∫∫ÊåÇ‰∫Ü„ÄäÁ®ãÂ∫èËÆæËÆ°„ÄãÔºå\(b\)‰∏™‰∫∫ÊåÇ‰∫Ü„ÄäÁÆóÊ≥ïËÆæËÆ°„ÄãÔºå\(c\)‰∏™‰∫∫ÊåÇ‰∫Ü„ÄäÊï∞ÊçÆÁªìÊûÑ„Äã„ÄÇ
  
  Â¶ÇÊûú‰∏Ä‰∏™ÂêåÂ≠¶ÊåÇ‰∫ÜÊÅ∞Â•Ω‰∏§Èó®ËØæÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ËØ¥‰ªñ‚ÄúÂèåÊåÇ‚Äù‰∫Ü„ÄÇ
  ÁªôÂá∫\(n,a,b,c\)ÔºåÈóÆÊúÄÂ∞ëÊúâÂ§öÂ∞ëÂêåÂ≠¶‚ÄúÂèåÊåÇ‚Äù‰∫Ü„ÄÇ
  
  \(0 \le a, b, c \le n, n \le 10^9\)
  
  ËÆæ‰∏âÈó®ËØæÊåÇÁßëÁöÑ‰∫∫ÂØπÂ∫îÈõÜÂêàÂàÜÂà´‰∏∫ \(\mathbb{A}, \mathbb{B}, \mathbb{C}\)
  
  ÊòæÁÑ∂Âπ∂‰∏çÊòØÊâÄÊúâ‰∫∫ÈÉΩ‰ºöÊåÇÁßëÁõÆ„ÄÇ
  
  \(|\mathbb{A} \cup \mathbb{B} \cup \mathbb{C}| = |\mathbb{A}| + |\mathbb{B}| + |\mathbb{C}| - |\mathbb{A} \cap \mathbb{B}|  - |\mathbb{A} \cap \mathbb{C}| - |\mathbb{B} \cap \mathbb{C}| + |\mathbb{A} \cap \mathbb{B} \cap \mathbb{C}| \le n\)
  
  ÁßªÈ°πÂæó
  
  ‰∏∫‰∫ÜÊñπ‰æøÔºöËÆæ \(S = \mathbb{A} \cap \mathbb{B} \cap \mathbb{C}\)
  
  \(\left(|\mathbb{A} \cap \mathbb{B}| - |S|\right) + \left(|\mathbb{A} \cap \mathbb{C}| - |S|\right) + \left(|\mathbb{B} \cap \mathbb{C}| - |S|\right) \ge |\mathbb{A}| + |\mathbb{B}| + |\mathbb{C}| + |S| - n - 3|S|\)
  
  Á≠îÊ°àÂèñÂÄº‰∏∫
  \(|\mathbb{A}| + |\mathbb{B}| + |\mathbb{C}| -2|S| - n\)ÔºåÂÖ∂‰∏≠ \(|S|\)
  Ë∂äÂ§ß Á≠îÊ°àË∂äÂ∞èÔºåÂÖ∂ÊúÄÂ§ßÂèñÂÄºÂ∞±ÊòØ
  \(\max{ \{ \mathbb{A}, \mathbb{B}, \mathbb{C} \} }\)
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \NormalTok{LL n}\OperatorTok{,}\NormalTok{ a}\OperatorTok{,}\NormalTok{ b}\OperatorTok{,}\NormalTok{ c}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{a}\OperatorTok{)(}\NormalTok{b}\OperatorTok{)(}\NormalTok{c}\OperatorTok{);}
  \NormalTok{printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld}\StringTok{"}\OperatorTok{,}\NormalTok{ max}\OperatorTok{(}\DecValTok{0}\BuiltInTok{LL}\OperatorTok{,}\NormalTok{ a }\OperatorTok{+}\NormalTok{ b }\OperatorTok{+}\NormalTok{ c }\OperatorTok{{-}} \DecValTok{2} \OperatorTok{*}\NormalTok{ min}\OperatorTok{(}\NormalTok{a}\OperatorTok{,}\NormalTok{ min}\OperatorTok{(}\NormalTok{b}\OperatorTok{,}\NormalTok{ c}\OperatorTok{))} \OperatorTok{{-}}\NormalTok{ n}\OperatorTok{));}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{B. DDLÈÄâÊâã}\label{b.-ddlux9009ux624b}
  
  DDLÈÄâÊâãÊÄªÊòØÂú®ÊúÄÂêéÂÅö‰Ωú‰∏ö„ÄÇ
  
  Êúâ\(n\)‰∏™‰Ωú‰∏öÔºåÁ¨¨\(i\)‰∏™‰Ωú‰∏öÁöÑDDLÊó∂Èó¥ÊòØ\(d_i\)ÔºåÂÅöËøô‰∏™‰Ωú‰∏öÈúÄË¶Å\(t_i\)ÁöÑÊó∂Èó¥„ÄÇ
  
  ÂÅö‰Ωú‰∏öË¶Å‰∏ÄÂøÉ‰∏ÄÊÑèÔºåÊâÄ‰ª•‰∏çËÉΩÂêåÊó∂ÂÅö‰∏§‰∏™‰Ωú‰∏ö„ÄÇÂ¶ÇÊûúÁé∞Âú®ÂºÄÂßãÂÅöÁ¨¨\(i\)‰∏™‰Ωú‰∏öÔºåÈÇ£‰πàÊé•‰∏ãÊù•\(t_i\)ÁöÑÊó∂Èó¥ÈÉΩË¶ÅÂÅöËøô‰∏™‰Ωú‰∏öÔºå‰∏çËÉΩÂÅöÂà´ÁöÑ„ÄÇ
  
  DDLÈÄâÊâãÊÄªÊòØÂÖàÂÅöDDLÊó∂Èó¥Êó©ÁöÑ‰Ωú‰∏ö„ÄÇÂ¶ÇÊûú‰∏§‰∏™‰Ωú‰∏öÁöÑDDLÊó∂Èó¥‰∏ÄÊ†∑ÔºåÈÇ£‰πàDDLÈÄâÊâã‰ºöÂÖàÂÅöÂÖ∂‰∏≠ÁºñÂè∑Â∞èÁöÑ
  
  ‰∏∫DDLÈÄâÊâãËÆæËÆ°ÊØè‰∏™‰Ωú‰∏öÂºÄÂßãÂÅöÁöÑÊó∂Èó¥Ôºå‰ΩøÂæóDDLÈÄâÊâãÂÖàÂÅöDDLÊó©ÁöÑ‰Ωú‰∏öÔºàÂ¶ÇÊûú‰∏§‰∏™‰Ωú‰∏öÁöÑDDLÊó∂Èó¥‰∏ÄÊ†∑ÔºåÈÇ£‰πàÂÖàÂÅöÂÖ∂‰∏≠ÁºñÂè∑Â∞èÁöÑÔºâÔºåËÄå‰∏îÊØè‰∏™‰Ωú‰∏öÈÉΩËÉΩÂú®DDLÊó∂Èó¥‰πãÂâçÂÅöÂÆåÔºàÊó∂Èó¥ÊòØËøûÁª≠ÁöÑÔºå‚Äú‰πãÂâç‚ÄùÁöÑÊÑèÊÄùÊòØÔºåÊúÄÊôöÊÅ∞Â•ΩËøô‰∏™Êó∂Èó¥ÂÆåÊàê„ÄÇÔºâ„ÄÇÂú®‰øùËØÅÂÆåÊàêÁöÑÂâçÊèê‰∏ãÔºåÂ∞ΩÂèØËÉΩÊääÂºÄÂßãÂÅö‰Ωú‰∏öÁöÑÊó∂Èó¥ÂæÄÂêéÊé®„ÄÇÔºà‰πüÂ∞±ÊòØÂ¶ÇÊûúÊúâÂ§ö‰∏™ÊñπÊ°àÂèØ‰ª•ÂÅöÂÆå‰Ωú‰∏öÔºåÈÄâÊã©ÂºÄÂßãÊó∂Èó¥ÊúÄÊôöÁöÑÊñπÊ°à„ÄÇÂèØ‰ª•ËØÅÊòéÔºåÊúÄ‰ºòÊñπÊ°à‰∏≠ÔºåÊØè‰∏Ä‰∏™‰Ωú‰∏öÁöÑÂºÄÂßãÊó∂Èó¥ÈÉΩ‰∏çÊó©‰∫éÂÖ∂‰ªñÊñπÊ°àÁöÑÂºÄÂßãÊó∂Èó¥„ÄÇËæìÂá∫Ëøô‰∏™ÊúÄ‰ºòÊñπÊ°à„ÄÇÔºâ
  
  \(n \le 10^5, t_i \le 10^4\)
  
  ‰æùÁÖßÈ¢òÊÑèÂèçÂêëÊ®°Êãü„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{2e5} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
  \PreprocessorTok{\#define int }\DataTypeTok{long}\PreprocessorTok{ }\DataTypeTok{long}\PreprocessorTok{ }
  \KeywordTok{struct} \DataTypeTok{HomeWork\_t}\OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ d}\OperatorTok{,}\NormalTok{ t}\OperatorTok{,}\NormalTok{ id}\OperatorTok{;}
  \OperatorTok{\}}\NormalTok{H}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];} \DataTypeTok{int}\NormalTok{ n }\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ Ans}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{bool}\NormalTok{ CMP}\OperatorTok{(}\AttributeTok{const} \DataTypeTok{HomeWork\_t} \OperatorTok{\&}\NormalTok{ A}\OperatorTok{,} \AttributeTok{const} \DataTypeTok{HomeWork\_t} \OperatorTok{\&}\NormalTok{ B}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return} \OperatorTok{(}\NormalTok{A}\OperatorTok{.}\NormalTok{d }\OperatorTok{\textless{}}\NormalTok{ B}\OperatorTok{.}\NormalTok{d}\OperatorTok{)} \OperatorTok{||} \OperatorTok{(}\NormalTok{A}\OperatorTok{.}\NormalTok{d }\OperatorTok{==}\NormalTok{ B}\OperatorTok{.}\NormalTok{d }\OperatorTok{\&\&}\NormalTok{ A}\OperatorTok{.}\NormalTok{id }\OperatorTok{\textless{}}\NormalTok{ B}\OperatorTok{.}\NormalTok{id}\OperatorTok{);} \OperatorTok{\}}
  \PreprocessorTok{\#undef int }
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{);}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ Read}\OperatorTok{(}\NormalTok{H}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{d}\OperatorTok{)(}\NormalTok{H}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{t}\OperatorTok{),}\NormalTok{ H}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{id }\OperatorTok{=}\NormalTok{ i}\OperatorTok{;}
  \NormalTok{    sort}\OperatorTok{(}\NormalTok{H }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ H }\OperatorTok{+} \DecValTok{1} \OperatorTok{+}\NormalTok{ n}\OperatorTok{,}\NormalTok{ CMP}\OperatorTok{);} 
      \PreprocessorTok{\#define int }\DataTypeTok{long}\PreprocessorTok{ }\DataTypeTok{long}\PreprocessorTok{ }
      \DataTypeTok{int}\NormalTok{ Last }\OperatorTok{=}\NormalTok{ LLONG\_MAX}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textgreater{}=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i}\OperatorTok{{-}{-})\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{Last }\OperatorTok{\textgreater{}=}\NormalTok{ H}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{d}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{            Last }\OperatorTok{=}\NormalTok{ H}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{d }\OperatorTok{{-}}\NormalTok{ H}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{t}\OperatorTok{;}
  \NormalTok{            Ans}\OperatorTok{[}\NormalTok{H}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{id}\OperatorTok{]} \OperatorTok{=}\NormalTok{ Last}\OperatorTok{;}
          \OperatorTok{\}} \ControlFlowTok{else} \OperatorTok{\{}
  \NormalTok{            Last }\OperatorTok{=} \OperatorTok{(}\NormalTok{Last}\OperatorTok{)} \OperatorTok{{-}}\NormalTok{ H}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{t}\OperatorTok{;}
  \NormalTok{            Ans}\OperatorTok{[}\NormalTok{H}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{id}\OperatorTok{]} \OperatorTok{=}\NormalTok{ Last}\OperatorTok{;}
          \OperatorTok{\}}
      \OperatorTok{\}}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%lld\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ Ans}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
      \PreprocessorTok{\#undef int}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{C. Á∫¶Êï∞Èìæ}\label{c.-ux7ea6ux6570ux94fe}
  
  Â¶ÇÊûú\(n\)‰∏™Êï∞\(a_1,\dots,a_n\)Êª°Ë∂≥ÔºöÂØπ‰∫é\(1\leq i < n\)Ôºå\(a_i\)ÊòØ\(a_{i+1}\)ÁöÑÁ∫¶Êï∞ÔºåÈÇ£‰πà\(a_1,\dots,a_n\)Ë¢´Áß∞‰∏∫‰∏Ä‰∏™Á∫¶Êï∞Èìæ„ÄÇ‰∏Ä‰∏™Á∫¶Êï∞ÈìæÁöÑÊùÉÂÄºÊòØÂÆÉÊâÄÂåÖÂê´ÁöÑ\(n\)‰∏™Êï∞ÁöÑ‰πòÁßØ„ÄÇ
  
  ÁªôÂá∫\(n,m\)ÔºåÂè™ÂÖÅËÆ∏‰ΩøÁî®‰∏çË∂ÖËøá\(m\)ÁöÑÊ≠£Êï¥Êï∞ÁªÑÊàêÈïø‰∏∫\(n\)ÁöÑÁ∫¶Êï∞ÈìæÔºå‰ºöÊúâÈùûÂ∏∏Â§öÁöÑÊñπÂºè„ÄÇÊ±ÇÊâÄÊúâËøô‰∫õÊñπÂºèÂæóÂà∞ÁöÑÁ∫¶Êï∞ÈìæÁöÑÊùÉÂÄº‰πãÂíå„ÄÇ
  \(n \le 10, m \le 10^7\)
  
  ÂèØ‰ª• \textbf{dp} ‰∏Ä‰∏ãÔºåËÆæ \(dp[n][k]\) ‰∏∫ÈïøÂ∫¶‰∏∫ \(n\) ÁöÑÁ∫¶Êï∞ÈìæÔºåÁªìÂ∞æÊòØ
  \(k\) ÁöÑÊùÉÂÄºÂíå„ÄÇ ËΩ¨Áßª‰∏∫Âà∑Ë°®„ÄÇÂ§çÊùÇÂ∫¶ÂÅöÂà∞
  \(\mathcal{O}(nm\log m)\)„ÄÇÊ†πÊú¨Ëøá‰∏çÂéª„ÄÇ
  
  ËÆæ \(f_n(k) = dp[n][k]\) ÂÖ∂‰∏≠ ÂáΩÊï∞ \(f_k(x)\) ‰∏∫ÁßØÊÄßÂáΩÊï∞„ÄÇ
  
  ÂØπ‰∫é \(a \perp b\) ËÆæ \(c = a \times b\) ÂØπ‰∫é \(f_n(c)\)
  ÊâÄÁªüËÆ°ÁöÑÊñπÊ°à‰∏≠ÁöÑÊØè‰∏Ä‰∏™Êï∞Â≠óÈÉΩÂèØ‰ª•Ë¥®Âõ†Êï∞ÂàÜËß£Êàê‰∏§ÁªÑÔºå‰∏ÄÁªÑÊòØÂè™Â±û‰∫é \(a\)
  ÁöÑË¥®Âõ†Â≠êÔºåÂè¶‰∏ÄÁªÑÊòØÂè™Â±û‰∫é \(b\)
  ÁöÑË¥®Âõ†Â≠ê„ÄÇÊâã‰∏æÂá†‰∏™Ê†óÂ≠êÂ∞±ËÉΩÂèëÁé∞Á¨¶ÂêàÁßØÊÄßÂáΩÊï∞ÁöÑÊÄßË¥®„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{1e7} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ MOD }\OperatorTok{=} \FloatTok{1e9} \OperatorTok{+} \DecValTok{7}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ np}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ prime}\OperatorTok{[}\DataTypeTok{int}\OperatorTok{(}\FloatTok{1e6}\OperatorTok{)],}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ Mid}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{void}\NormalTok{ Init}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ n}\OperatorTok{)\{}
  \NormalTok{    Mid}\OperatorTok{[}\DecValTok{1}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ np}\OperatorTok{[}\DecValTok{1}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{2}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{np}\OperatorTok{[}\NormalTok{i}\OperatorTok{])}\NormalTok{ prime}\OperatorTok{[++}\NormalTok{tot}\OperatorTok{]} \OperatorTok{=}\NormalTok{ i}\OperatorTok{,}\NormalTok{ Mid}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ i}\OperatorTok{;}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ j }\OperatorTok{\textless{}=}\NormalTok{ tot }\OperatorTok{\&\&}\NormalTok{ prime}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{*}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ j}\OperatorTok{++)\{}
              \DataTypeTok{int}\NormalTok{ x }\OperatorTok{=}\NormalTok{ prime}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{*}\NormalTok{ i}\OperatorTok{;}
  \NormalTok{            np}\OperatorTok{[}\NormalTok{x}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ Mid}\OperatorTok{[}\NormalTok{x}\OperatorTok{]} \OperatorTok{=}\NormalTok{ prime}\OperatorTok{[}\NormalTok{j}\OperatorTok{];}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{i }\OperatorTok{\%}\NormalTok{ prime}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{==} \DecValTok{0}\OperatorTok{)} \ControlFlowTok{break}\OperatorTok{;}
          \OperatorTok{\}}
      \OperatorTok{\}}
      
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ m}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ dp}\OperatorTok{[}\DataTypeTok{int}\OperatorTok{(}\DecValTok{20}\OperatorTok{)][}\DataTypeTok{int}\OperatorTok{(}\DecValTok{30}\OperatorTok{)];} \DataTypeTok{int}\NormalTok{ Ans}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{long} \DataTypeTok{long}\NormalTok{ t }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{} \CommentTok{//freopen("in.txt", "r", stdin);}
  \NormalTok{    Init}\OperatorTok{(}\FloatTok{1e7} \OperatorTok{+} \DecValTok{2}\OperatorTok{);}\NormalTok{ Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{m}\OperatorTok{);} 
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{S}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ tot}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ now }\OperatorTok{=}\NormalTok{ prime}\OperatorTok{[}\NormalTok{S}\OperatorTok{];}
  \NormalTok{        memset}\OperatorTok{(}\NormalTok{dp}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{dp}\OperatorTok{));}
  \NormalTok{        t }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ t }\OperatorTok{\textless{}=}\NormalTok{ m}\OperatorTok{;}\NormalTok{ j}\OperatorTok{++,}\NormalTok{ t }\OperatorTok{*=}\NormalTok{ now}\OperatorTok{)}\NormalTok{ dp}\OperatorTok{[}\DecValTok{1}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{=}\NormalTok{ t}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{2}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)\{}
  \NormalTok{            t }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ t }\OperatorTok{\textless{}=}\NormalTok{ m}\OperatorTok{;}\NormalTok{ j}\OperatorTok{++,}\NormalTok{ t }\OperatorTok{*=}\NormalTok{ now}\OperatorTok{)} \OperatorTok{\{}
                  \DataTypeTok{int} \OperatorTok{\&}\NormalTok{ans }\OperatorTok{=}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{                rep}\OperatorTok{(}\NormalTok{k}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ j}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ dp}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{][}\NormalTok{k}\OperatorTok{]} \OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ t }\OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
              \OperatorTok{\}}
          \OperatorTok{\}}
  \NormalTok{        t }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ t }\OperatorTok{\textless{}=}\NormalTok{ m}\OperatorTok{;}\NormalTok{ j}\OperatorTok{++,}\NormalTok{ t }\OperatorTok{*=}\NormalTok{ now}\OperatorTok{)}\NormalTok{ Ans}\OperatorTok{[}\NormalTok{t}\OperatorTok{]} \OperatorTok{=}\NormalTok{ dp}\OperatorTok{[}\NormalTok{n}\OperatorTok{][}\NormalTok{j}\OperatorTok{];}
      \OperatorTok{\}}
  \NormalTok{    Ans}\OperatorTok{[}\DecValTok{1}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{2}\OperatorTok{,}\NormalTok{ m}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{Ans}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ A }\OperatorTok{=}\NormalTok{ i}\OperatorTok{,}\NormalTok{ B }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}
          \ControlFlowTok{while}\OperatorTok{(}\NormalTok{A }\OperatorTok{\%}\NormalTok{ Mid}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{==} \DecValTok{0}\OperatorTok{)}\NormalTok{ A }\OperatorTok{/=}\NormalTok{ Mid}\OperatorTok{[}\NormalTok{i}\OperatorTok{],}\NormalTok{ B }\OperatorTok{*=}\NormalTok{ Mid}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
  \NormalTok{        Ans}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{Ans}\OperatorTok{[}\NormalTok{A}\OperatorTok{]} \OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ Ans}\OperatorTok{[}\NormalTok{B}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ m}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ Ans}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}
      
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{D. ËøûÈÄö}\label{d.-ux8fdeux901a}
  
  ÁªôÂá∫‰∏ÄÂº†Êó†ÂêëÂõæÔºåÊ±ÇÊúâÂ§öÂ∞ëÁßçÊñπÊ°à‰ΩøÂæóÂà†Èô§‰∏âÊù°ËæπÔºå‰ΩøÂéüÂõæ‰∏çËøûÈÄö„ÄÇ
  
  \(n,m \le 2000\)
  
  ËÄÉËôëÊûö‰∏æÂà†Èô§ÁöÑÁ¨¨‰∏ÄÊù°ËæπÊòØÈÇ£Êù°ÔºåÁÑ∂ÂêéÈóÆÈ¢òËΩ¨ÂåñÊàê‰∫Ü
  Ê±ÇÂú®‰∏ÄÂº†Âõæ‰∏≠Âà†Èô§‰∏§Êù°Ëæπ‰ΩøÂõæ‰∏çËøûÈÄöÁöÑÊñπÊ°àÊï∞„ÄÇ
  ÂÖàÂà†Âéª‰∏ÄÊù°ËæπÔºåËÄÉËôëÂâ©‰∏ãÁöÑÂõæÁöÑÂΩ¢ÊÄÅÔºå -
  ÂõæÂ∑≤Áªè‰∏çËøûÈÄö‰∫ÜÔºåÈÇ£Á≠îÊ°àÁöÑË¥°ÁåÆÂ∞±ÊòØÊØèÊù°Ëæπ‰∏§‰∏§ÈÖçÂØπÁöÑÊñπÊ°àÊï∞ -
  ÂõæÊòØËÅîÈÄöÁöÑÔºåËÄÉËôëÂØπÂõæÂª∫‰∏Ä‰∏™ÁîüÊàêÊ†ëÔºåËÄÉËôëÂà†ËæπÁöÑÊñπÂºè - Âà†Èô§‰∏§Êù°ÈùûÊ†ëËæπ
  ‰∏ÄÂÆö‰∏çÂêàÊ≥ïÔºå‰πãÂâçÁöÑÊ†ë‰ªçÁÑ∂Â≠òÂú®Ôºå‰øùËØÅ‰∫ÜÂõæÁöÑËøûÈÄöÊÄß„ÄÇ -
  Âà†Èô§‰∏ÄÊù°Ê†ëËæπÔºå‰∏ÄÊù°ÈùûÊ†ëËæπ
  Ë¢´ËÆ°ÂÖ•Á≠îÊ°àÔºåÂΩì‰∏î‰ªÖÂΩìÔºåËøôÊù°Ê†ëËæπË¢´ËøôÊù°ÈùûÊ†ëËæπÂîØ‰∏ÄË¶ÜÁõñ„ÄÇËøôÈáåÁöÑÊ≠£Á°ÆÊÄßÊòæÁÑ∂„ÄÇ -
  Âà†Èô§‰∏§Êù°ÈùûÊ†ëËæπ Ë¢´ËÆ°ÂÖ•Á≠îÊ°àÔºåÂΩì‰∏î‰ªÖÂΩìÔºåËøô‰∏§Êù°ËæπË¢´Áõ∏ÂêåÁöÑ‰∏ÄÁªÑÈùûÊ†ëËæπË¶ÜÁõñ„ÄÇ -
  ËØÅÊòéÂèØ‰ª•ËÄÉËôëÔºåÂØπ‰∫éÂéüÊ†ëÊù•ËØ¥ÔºåÂ¶ÇÊûúÂà†Èô§‰∏§Êù°Ê†ëËæπÔºåÊñ≠Êàê‰∏â‰ªΩÔºåÂ¶ÇÊûú‰∏§Êù°ËæπË¢´Áõ∏ÂêåÁöÑ‰∏ÄÁªÑÈùûÊ†ëËæπË¶ÜÁõñÔºåÊ≤°ÊúâËæπÂèØ‰ª•ËÅîÈÄöÊñ≠ÂºÄÁöÑ‰∏≠Èó¥ÈÉ®ÂàÜ„ÄÇ
  -
  ËÄÉËôëÂ¶Ç‰ΩïÂÆûÁé∞ÔºåÂØπÊØè‰∏ÄÊù°ÈùûÊ†ëËæπËµã‰∏Ä‰∏™ÈöèÊú∫ÊùÉÂÄºÔºåÁÑ∂ÂêéÊ†ëËæπÁöÑÊùÉÂÄºÂÆö‰πâ‰∏∫Ë¶ÜÁõñÂÖ∂ÁöÑÊØè‰∏ÄÊù°ÈùûÊ†ëËæπÁöÑÊùÉÂÄºÂºÇÊàñÂíå„ÄÇÁªüËÆ°Âà†Èô§‰∏§Êù°ËæπÂêéÂõæ‰∏çËÅîÈÄöÁöÑÊñπÊ°àÊï∞ÔºåÂ∞±ËΩ¨Âåñ‰∏∫ÔºåÁªüËÆ°ÊúâÂ§öÂ∞ëÁßçÊñπÊ°àÈÄâÂá∫‰∏§Êù°ËæπÔºå‰ΩøÂÖ∂ÊùÉÂÄºÁõ∏Âêå„ÄÇ
  Ê†ë‰∏äÂ∑ÆÂàÜÂç≥ÂèØÔºåÂºÇÊàñÊúâËá™ÂèçÊÄßÔºåÂÖ∂Ê†áËÆ∞Âú® LCA Â§ÑËá™Âä®Ê∂àÂ§±„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \DecValTok{4100}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ head}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \KeywordTok{struct}\NormalTok{ edges}\OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ node}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ nxt}\OperatorTok{;}
  \OperatorTok{\}}\NormalTok{edge}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];} \DataTypeTok{int}\NormalTok{ tot }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ MOD }\OperatorTok{=} \FloatTok{1e9} \OperatorTok{+} \DecValTok{7}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ m}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ ToEid}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ ToNid}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ book}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \NormalTok{u64 tag}\OperatorTok{[}\DataTypeTok{int}\OperatorTok{(}\DecValTok{2100}\OperatorTok{)];}
  \DataTypeTok{bool}\NormalTok{ vis}\OperatorTok{[}\DataTypeTok{int}\OperatorTok{(}\DecValTok{2100}\OperatorTok{)];} 
  \NormalTok{u64 EVal}\OperatorTok{[}\DataTypeTok{int}\OperatorTok{(}\DecValTok{2100}\OperatorTok{)];}
  \DataTypeTok{void}\NormalTok{ add}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ u}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ v}\OperatorTok{)\{}
  \NormalTok{    tot}\OperatorTok{++;}
  \NormalTok{    edge}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{node }\OperatorTok{=}\NormalTok{ v}\OperatorTok{;}
  \NormalTok{    edge}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{nxt  }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{u}\OperatorTok{];}
  \NormalTok{    head}\OperatorTok{[}\NormalTok{u}\OperatorTok{]}        \OperatorTok{=}\NormalTok{ tot}\OperatorTok{;}
  \OperatorTok{\}}
  \NormalTok{u64 gen}\OperatorTok{()\{}
  \NormalTok{    u64 A }\OperatorTok{=}\NormalTok{ rand}\OperatorTok{()} \OperatorTok{*}\DecValTok{1}\BuiltInTok{ull}\OperatorTok{*}\NormalTok{ rand}\OperatorTok{()} \OperatorTok{*}\NormalTok{ rand}\OperatorTok{()} \OperatorTok{*}\DecValTok{1}\BuiltInTok{ull}\OperatorTok{*}\NormalTok{ rand}\OperatorTok{();}
  \NormalTok{    u64 B }\OperatorTok{=}\NormalTok{ rand}\OperatorTok{()} \OperatorTok{*}\DecValTok{1}\BuiltInTok{ull}\OperatorTok{*}\NormalTok{ rand}\OperatorTok{()} \OperatorTok{*}\NormalTok{ rand}\OperatorTok{()} \OperatorTok{*}\DecValTok{1}\BuiltInTok{ull}\OperatorTok{*}\NormalTok{ rand}\OperatorTok{();}
      \ControlFlowTok{return}\NormalTok{ A }\OperatorTok{+}\NormalTok{ B }\OperatorTok{+}\NormalTok{ rand}\OperatorTok{();}
  \OperatorTok{\}}
  \DataTypeTok{void}\NormalTok{ dfs0}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ now}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ f}\OperatorTok{)\{}
  \NormalTok{    vis}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{ i }\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{ex }\OperatorTok{==}\NormalTok{ f}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{book}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{vis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])}\NormalTok{ dfs0}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ now}\OperatorTok{);}
          \ControlFlowTok{else} \OperatorTok{\{} 
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{ EVal}\OperatorTok{[}\NormalTok{ToNid}\OperatorTok{[}\NormalTok{i}\OperatorTok{]])} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{            u64 g }\OperatorTok{=}\NormalTok{ EVal}\OperatorTok{[}\NormalTok{ToNid}\OperatorTok{[}\NormalTok{i}\OperatorTok{]]} \OperatorTok{=}\NormalTok{ gen}\OperatorTok{();}
  \NormalTok{            tag}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{\^{}=}\NormalTok{ g}\OperatorTok{;}\NormalTok{ tag}\OperatorTok{[}\NormalTok{ex}\OperatorTok{]} \OperatorTok{\^{}=}\NormalTok{ g}\OperatorTok{;}
          \OperatorTok{\}}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \DataTypeTok{void}\NormalTok{ dfs1}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ now}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ f}\OperatorTok{)\{}
  \NormalTok{    u64 }\OperatorTok{\&}\NormalTok{ntag }\OperatorTok{=}\NormalTok{ tag}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{ i }\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{ex }\OperatorTok{==}\NormalTok{ f}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{book}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{EVal}\OperatorTok{[}\NormalTok{ToNid}\OperatorTok{[}\NormalTok{i}\OperatorTok{]])}\NormalTok{ dfs1}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ now}\OperatorTok{),}\NormalTok{ EVal}\OperatorTok{[}\NormalTok{ToNid}\OperatorTok{[}\NormalTok{i}\OperatorTok{]]} \OperatorTok{=}\NormalTok{ tag}\OperatorTok{[}\NormalTok{ex}\OperatorTok{],}\NormalTok{ ntag }\OperatorTok{\^{}=}\NormalTok{ tag}\OperatorTok{[}\NormalTok{ex}\OperatorTok{];} 
      \OperatorTok{\}}
  \OperatorTok{\}}
  \NormalTok{map}\OperatorTok{\textless{}}\NormalTok{u64}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ M}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ inv6 }\OperatorTok{=} \DecValTok{166666668}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}\CommentTok{// freopen("in.txt", "r", stdin);}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{m}\OperatorTok{);} \DataTypeTok{int} \OperatorTok{*}\NormalTok{seed }\OperatorTok{=} \KeywordTok{new} \DataTypeTok{int}\OperatorTok{;}\NormalTok{ srand}\OperatorTok{(*}\NormalTok{seed }\OperatorTok{+}\NormalTok{ n }\OperatorTok{+}\NormalTok{ m}\OperatorTok{);}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ m}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{u}\OperatorTok{)(}\NormalTok{v}\OperatorTok{);}
  \NormalTok{        ToEid}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ tot }\OperatorTok{+} \DecValTok{1}\OperatorTok{;}\NormalTok{ ToNid}\OperatorTok{[}\NormalTok{tot }\OperatorTok{+} \DecValTok{1}\OperatorTok{]} \OperatorTok{=}\NormalTok{ ToNid}\OperatorTok{[}\NormalTok{tot }\OperatorTok{+} \DecValTok{2}\OperatorTok{]} \OperatorTok{=}\NormalTok{ i}\OperatorTok{;}
  \NormalTok{        add}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{);}\NormalTok{ add}\OperatorTok{(}\NormalTok{v}\OperatorTok{,}\NormalTok{ u}\OperatorTok{);}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ Pans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ m}\OperatorTok{)\{} 
          \DataTypeTok{int}\NormalTok{ rs }\OperatorTok{=}\NormalTok{ ToEid}\OperatorTok{[}\NormalTok{i}\OperatorTok{];} 
  \NormalTok{        book}\OperatorTok{[}\NormalTok{rs}\OperatorTok{]} \OperatorTok{=}\NormalTok{ book}\OperatorTok{[}\NormalTok{rs }\OperatorTok{\^{}} \DecValTok{1}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{        memset}\OperatorTok{(}\NormalTok{tag}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{tag}\OperatorTok{));}\NormalTok{ memset}\OperatorTok{(}\NormalTok{vis}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{vis}\OperatorTok{));}\NormalTok{ memset}\OperatorTok{(}\NormalTok{EVal}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{EVal}\OperatorTok{));}\NormalTok{ M}\OperatorTok{.}\NormalTok{clear}\OperatorTok{();}
  \NormalTok{        dfs0}\OperatorTok{(}\DecValTok{1}\OperatorTok{,} \DecValTok{1}\OperatorTok{);} 
          
          \DataTypeTok{bool}\NormalTok{ pass }\OperatorTok{=} \KeywordTok{true}\OperatorTok{;}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}  \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{vis}\OperatorTok{[}\NormalTok{j}\OperatorTok{])} \OperatorTok{\{}\NormalTok{ pass }\OperatorTok{=} \KeywordTok{false}\OperatorTok{;} \ControlFlowTok{break}\OperatorTok{;} \OperatorTok{\}}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{pass}\OperatorTok{)} \OperatorTok{\{} \DataTypeTok{int}\NormalTok{ t }\OperatorTok{=}\NormalTok{ m }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{;}\NormalTok{ Pans }\OperatorTok{=} \OperatorTok{(}\NormalTok{Pans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+} \OperatorTok{(}\NormalTok{t }\OperatorTok{*} \OperatorTok{(}\NormalTok{t }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)))} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}\NormalTok{ book}\OperatorTok{[}\NormalTok{rs}\OperatorTok{]} \OperatorTok{=}\NormalTok{ book}\OperatorTok{[}\NormalTok{rs }\OperatorTok{\^{}} \DecValTok{1}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;} \ControlFlowTok{continue}\OperatorTok{;} \OperatorTok{\}}
  \NormalTok{        dfs1}\OperatorTok{(}\DecValTok{1}\OperatorTok{,} \DecValTok{1}\OperatorTok{);}
  \NormalTok{        rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ m}\OperatorTok{)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{i }\OperatorTok{!=}\NormalTok{ j}\OperatorTok{)}\NormalTok{ M}\OperatorTok{[}\NormalTok{EVal}\OperatorTok{[}\NormalTok{j}\OperatorTok{]]} \OperatorTok{++;}
          \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
          \ControlFlowTok{for}\OperatorTok{(}\NormalTok{map}\OperatorTok{\textless{}}\NormalTok{u64}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}} \OperatorTok{::}\NormalTok{ iterator i }\OperatorTok{=}\NormalTok{ M}\OperatorTok{.}\NormalTok{begin}\OperatorTok{();}\NormalTok{ i }\OperatorTok{!=}\NormalTok{ M}\OperatorTok{.}\NormalTok{end}\OperatorTok{();}\NormalTok{ i}\OperatorTok{++)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{i}\OperatorTok{{-}\textgreater{}}\NormalTok{first }\OperatorTok{==} \DecValTok{0}\BuiltInTok{ull}\OperatorTok{)}
  \NormalTok{                ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+} \OperatorTok{(}\NormalTok{i}\OperatorTok{{-}\textgreater{}}\NormalTok{second }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*} \OperatorTok{(}\NormalTok{i}\OperatorTok{{-}\textgreater{}}\NormalTok{second }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{))} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{,}
  \NormalTok{                ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+} \OperatorTok{(((}\NormalTok{m }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)} \OperatorTok{{-}} \OperatorTok{(}\NormalTok{i}\OperatorTok{{-}\textgreater{}}\NormalTok{second}\OperatorTok{))} \OperatorTok{*}\DecValTok{2}\BuiltInTok{ll}\OperatorTok{*} \OperatorTok{(}\NormalTok{i}\OperatorTok{{-}\textgreater{}}\NormalTok{second}\OperatorTok{))} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
              \ControlFlowTok{else}
  \NormalTok{                ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+} \OperatorTok{(}\NormalTok{i}\OperatorTok{{-}\textgreater{}}\NormalTok{second }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*} \OperatorTok{(}\NormalTok{i}\OperatorTok{{-}\textgreater{}}\NormalTok{second }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{))} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
          \OperatorTok{\}}
  \NormalTok{        Pans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ Pans}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
  \NormalTok{        book}\OperatorTok{[}\NormalTok{rs}\OperatorTok{]} \OperatorTok{=}\NormalTok{ book}\OperatorTok{[}\NormalTok{rs }\OperatorTok{\^{}} \DecValTok{1}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{(}\NormalTok{Pans }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ inv6 }\OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{));}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsection{Round 9}\label{round-9}
  
  ÈôçÊô∫Âú∫„ÄÇ \#\#\# A. ÊúÄÂ§ßÂÖ¨Á∫¶Êï∞
  
  ÁªôÂá∫‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ \(n\) ÁöÑÂ∫èÂàó„ÄÇ ËÆæ
  \(k = \max_{i < j}{\operatorname{gcd}(A_i, A_j)}\)Ôºå Ê±ÇÂá∫Ôºö - \(k\) -
  \(\sum_{i < j}\limits{[\operatorname{gcd}(A_i, A_j)=k]}\) -
  \(\sum_{i < j}\limits{[\operatorname{gcd}(A_i, A_j)=k]A_i \times A_j}\)
  
  Êûö‰∏æ‰∏Ä‰∏ã \(gcd\) ÂèØËÉΩ‰ª•Ëøô‰∏™Êï∞Â≠ó‰∏∫ \(gcd\) ÁöÑ‰∏§‰∏™Êï∞Â≠ó‰∏ÄÂÆöÊòØ \(gcd\)
  ÁöÑÂÄçÊï∞„ÄÇ ‰ªéÂ§ßÂà∞Â∞èÊûö‰∏æ \(gcd\) Êü•ËØ¢ÊúâÂ§öÂ∞ëÂÄçÊï∞ÔºåÂ¶ÇÊûúÂ§ß‰∫é \(2\) ÔºåËøô‰∏™
  \(gcd\) Â∞±ÂèØ‰ª•„ÄÇ Ââ©‰ΩôÁöÑ‰∏§È°πÂú®ÂæóÂà∞ \(k\) ÁöÑÂü∫Á°Ä‰∏äÂà§Êñ≠Âç≥ÂèØ„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ MOD }\OperatorTok{=} \DecValTok{998244353}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{2e6} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ inv2 }\OperatorTok{=} \DecValTok{499122177}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ book}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ A}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ n}\OperatorTok{,}\NormalTok{ MAX }\OperatorTok{=} \DecValTok{0}\OperatorTok{;} 
  \DataTypeTok{int}\NormalTok{ K }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{);}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ Read}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]),}\NormalTok{ book}\OperatorTok{[}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]]++,}\NormalTok{ MAX }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{MAX}\OperatorTok{,}\NormalTok{ A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ MAX}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textgreater{}=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i}\OperatorTok{{-}{-})\{}
          \DataTypeTok{int}\NormalTok{ cnt }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=}\NormalTok{ i}\OperatorTok{;}\NormalTok{ j }\OperatorTok{\textless{}=}\NormalTok{ MAX}\OperatorTok{;}\NormalTok{ j }\OperatorTok{+=}\NormalTok{ i}\OperatorTok{)}\NormalTok{ cnt }\OperatorTok{+=}\NormalTok{ book}\OperatorTok{[}\NormalTok{j}\OperatorTok{];}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{cnt }\OperatorTok{\textgreater{}=} \DecValTok{2}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ K }\OperatorTok{=}\NormalTok{ i}\OperatorTok{;} \ControlFlowTok{break}\OperatorTok{;} \OperatorTok{\}}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ SUM }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ ans1 }\OperatorTok{=} \DecValTok{0}\OperatorTok{,}\NormalTok{ ans2 }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ K}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ MAX}\OperatorTok{;}\NormalTok{ i }\OperatorTok{+=}\NormalTok{ K}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{book}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        ans1 }\OperatorTok{+=}\NormalTok{ book}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}\NormalTok{ SUM }\OperatorTok{=} \OperatorTok{(}\NormalTok{SUM }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ book}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ i }\OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
      \OperatorTok{\}}
  \NormalTok{    ans1 }\OperatorTok{=} \OperatorTok{((}\NormalTok{ans1 }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*} \OperatorTok{(}\NormalTok{ans1 }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{))} \OperatorTok{\%}\NormalTok{ MOD }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ inv2}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ K}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ MAX}\OperatorTok{;}\NormalTok{ i }\OperatorTok{+=}\NormalTok{ K}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{book}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        ans2 }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans2 }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+} \OperatorTok{(} \OperatorTok{(}\NormalTok{SUM }\OperatorTok{{-}}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{{-}}\NormalTok{ i }\OperatorTok{+}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ i }\OperatorTok{\%}\NormalTok{ MOD }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ book}\OperatorTok{[}\NormalTok{i}\OperatorTok{])} \OperatorTok{\%}\NormalTok{ MOD }\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
      \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{ }\SpecialCharTok{\%d}\StringTok{ }\SpecialCharTok{\%d\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ K}\OperatorTok{,}\NormalTok{ ans1}\OperatorTok{,}\NormalTok{ ans2 }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ inv2 }\OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{);}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{B. Á¥ßÊÄ•Âá∫Âè£}\label{b.-ux7d27ux6025ux51faux53e3}
  
  Âú®‰∏Ä‰∏™Ëµ∞ÂªäÈáåÂÖ±Êúâ \(N\) ‰∏™Ê•ºÊ¢ØÔºåÂÖ∂‰∏≠ \(N\) ‰∏™Ê•ºÊ¢Ø‰πãÈó¥Êúâ \(N-1\) ‰∏™Èó¥ÈöîÔºå
  ‰∏™Èó¥Èöî‰ºöË¥¥Êúâ‰∏Ä‰∏™Á¥ßÊÄ•Âá∫Âè£ÁöÑÊåáÁ§∫ÁâåÊåáÂêëÂ∑¶‰æßÊàñËÄÖÂè≥‰æß„ÄÇ
  
  ÈóÆÂú®ÊâÄÊúâÁöÑ \(2N‚àí1\) ÁßçÊåáÁ§∫ÁâåÁöÑË¥¥Ê≥ïÂΩì‰∏≠ÔºåÊúâÂ§öÂ∞ëÁßçË¥¥Ê≥ïÊª°Ë∂≥ÊÅ∞Â•ΩÊúâ \(M\)
  ‰∏™Ê•ºÊ¢Ø(ÂåÖÊã¨ÊúÄÂ∑¶ÊúÄÂè≥)ÁöÑÂ∑¶Âè≥‰æßÁöÑÁ¥ßÊÄ•Âá∫Âè£Ê†áËØÜÈÉΩ‰∏çÊåáÂêëËá™Â∑±„ÄÇ
  
  ËæìÂá∫ÁöÑÁ≠îÊ°àÂØπ \(998244353\) ÂèñÊ®°„ÄÇ \(N \le 10^3, M \le 10^9\)
  
  \paragraph{ÂÄçÂ¢ûDP}\label{ux500dux589edp}
  
  ÂæÖÂ°´
  
  \paragraph{ÈöîÊùøÊ≥ï}\label{ux9694ux677fux6cd5}
  
  Áß∞ ‚ÄúÂ∑¶Âè≥‰æßÁöÑÁ¥ßÊÄ•Âá∫Âè£Ê†áËØÜÈÉΩ‰∏çÊåáÂêëËá™Â∑±ÁöÑÁÇπ‚Äù ‰∏∫ÂÖ≥ÈîÆÁÇπ„ÄÇ
  
  ËÄÉËôëÂ¶ÇÊûúÈÄâÂÆö‰∫Ü‰∏Ä‰∏™ÁÇπÊòØÂÖ≥ÈîÆÁÇπÔºåÈÇ£‰πà‰ªñ‰ª¨‰∏§ËæπÂ∞±ÂΩ¢Â¶Ç
  \texttt{\textless{}\ o\ \textgreater{}} ÔºåÂèØ‰ª•ÂèëÁé∞Áõ∏ÈÇªÁöÑ‰∏§‰∏™ÂÖ≥ÈîÆÁÇπ
  \(O_1, O_2\) ‰πãÈó¥Ë¥¥ÁâåÁöÑÊñπÊ°à‰∏ÄÂÆöÂΩ¢Â¶Ç
  \(...< O_1 > o > ... > o < ... < o < O_2 >...\)
  ÊòæÁÑ∂ÔºåÂÖ∂ÂÆûÊòØÊääÂéüÂ∫èÂàóÂàÜÊàêËøûÁª≠ÁöÑ \(2m\)
  ÊÆµÔºåÊØèÊÆµÂÜÖÊñπÂêëÁõ∏ÂêåÔºåÁõ∏ÈÇª‰∏§ÊÆµÊñπÂêëÁõ∏Âèç„ÄÇ ÈöîÊùøÂç≥ÂèØ„ÄÇ
  
  ËÄÉËôëÁªÑÂêàÊï∞ÁöÑÈÄöÈ°πÂÖ¨ÂºèÔºåÈ°πÊï∞Âè™Êúâ \(m\) È°π„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ m}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{m}\OperatorTok{);}\NormalTok{ printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,}\NormalTok{ C}\OperatorTok{(}\NormalTok{n}\OperatorTok{,} \DecValTok{2} \OperatorTok{*}\NormalTok{ m }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{));}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{C. ÂêàÂΩ±}\label{c.-ux5408ux5f71}
  
  ‰ºóÊâÄÂë®Áü•Ôºå ACM ICPC ÊòØ‰∏â‰∫∫ÁªÑÈòüÂèÇËµõÁöÑÊØîËµõ„ÄÇÁé∞Âú®Âú® ICPC WF2020 Áé∞Âú∫ÔºåÊúâ
  \(k\) ÊîØÂèÇËµõÈòü‰ºçË¶ÅÁ´ôÊàê‰∏ÄÊéíÊãçÁÖßÔºÅ
  
  ÊëÑÂΩ±Â∏àÂ∞èZÊÉ≥‰øÉËøõÈòü‰ºçÈó¥ÁöÑ‰∫§ÊµÅÔºå‰∫éÊòØÂ∞èZË¶ÅÊ±ÇÊØè‰∏™Èòü‰ºçÁöÑ3‰∏™ÈòüÂëò‰∏çËÉΩÈÉΩÊå®Âú®‰∏ÄËµ∑
  
  Áé∞Âú®Â∞èZÊÉ≥ÈóÆ‰∏ÄÈóÆ‰Ω†ÔºåËøô \(k\)
  ÊîØÈòü‰ºçÊúâÂ§öÂ∞ëÁßçÊãçÁÖßÊñπÂºèÂë¢ÔºüÁî±‰∫éÊï∞Â≠óÂæàÂ§ßÔºåÊâÄ‰ª•ÂØπ \(998244353\)
  ÂèñÊ®°Â∞±Â•Ω\textasciitilde{} \(k \le 10^6\)
  
  Ë¶ÅÊ±ÇÊòØÊØè‰∏ÄÈòüÁöÑ‰∏â‰∏™ÈòüÂëò‰∏çËÉΩÂÖ®ÈÉ®Êå®Âú®‰∏ÄËµ∑„ÄÇ Êó†Ê≥ïÁõ¥Êé•ÂÖ®ÈÉ®Êª°Ë∂≥ÔºåËÄÉËôëÂÆπÊñ•„ÄÇ
  
  ÂÅáÂ¶ÇÊâÄÊúâ‰∫∫Êåâ‰ªªÊÑèÈ°∫Â∫èÊéíÂàóÊúâ \((3k)!\) ÁßçÊéíÂàóÊñπÂºè„ÄÇ
  
  ÊòæÁÑ∂‰ºöÁÆóÂÖ•‰∫Ü‰∏çÂêàÊ≥ïÁöÑÊÉÖÂÜµÔºåËÄÉËôëÂéªÈô§Ëøô‰∫õ
  Èí¶ÂÆöÂì™‰∏ÄÈòüÂÖ®ÈÉ®Êå®Âú®‰∏ÄËµ∑‰∫ÜÔºåÂ¶ÇÊûúÂº∫Âà∂Êüê‰∏ÄÈòüÊå®Âú®‰∏ÄËµ∑ÂèØ‰ª•ÂêßÈÇ£‰∏ÄÈòüÊçÜÊàê‰∏Ä‰∏™‰∫∫
  ËøôÊ†∑ÁöÑÊñπÊ°àÊï∞‰∏∫ \((3k - 2)!\)ÔºåÁÆóÂÖ•Á≠îÊ°àÂ∞±ÊòØ
  \(\dbinom{k}{1}(3k - 2)!(3!)^1\) ÊúÄÂêé‰∏Ä‰∏™ÊòØÂõ†‰∏∫Âêå‰∏ÄÈòü‰∏≠ÁöÑÈòüÂëò‰πüÊúâÈ°∫Â∫è„ÄÇ
  
  ÊòæÁÑ∂‰ºöÂéªÈô§Â§ö‰∫ÜÔºåÂ¶ÇÊûúÊúâÂ§öÈòüÂêåÊó∂‰∏çÂêàÊ≥ïÔºåËøô‰∫õÊñπÊ°à‰ºöË¢´ÂéªÈô§Â§öÊ¨°ÔºåÈí¶ÂÆöÂì™‰∏§ÈòüÂÖ®ÈÉ®Êå®Âú®‰∏ÄËµ∑‰∫ÜÔºåÁÆóÂÖ•Á≠îÊ°àÂ∞±ÊòØ
  \(\dbinom{k}{2}(3k - 4)!(3!)^2\)„ÄÇ
  
  ÊòæÁÑ∂Âä†Â§ö‰∫Ü‚Ä¶‚Ä¶
  
  ÁÑ∂ÂêéÂ∞±ÊòØÂÆπÊñ•ÂéüÁêÜ‰∫Ü„ÄÇ
  
  Á≠îÊ°àÂ∫îËØ•ÊòØ
  \(\sum_{i=0}^{k}\limits{(-1)^i\dbinom{k}{i}(3k - 2i)!(3!)^i}\)
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ C}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ n}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ m}\OperatorTok{)\{} \ControlFlowTok{return}\NormalTok{ frac}\OperatorTok{[}\NormalTok{n}\OperatorTok{]} \OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ ifrac}\OperatorTok{[}\NormalTok{n }\OperatorTok{{-}}\NormalTok{ m}\OperatorTok{]} \OperatorTok{\%}\NormalTok{ MOD }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ ifrac}\OperatorTok{[}\NormalTok{m}\OperatorTok{]} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;} \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
      \DataTypeTok{int}\NormalTok{ k}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{k}\OperatorTok{);}\NormalTok{ Init}\OperatorTok{((}\NormalTok{k }\OperatorTok{+} \DecValTok{1}\OperatorTok{)} \OperatorTok{*} \DecValTok{3}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ k}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ tans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{        tans }\OperatorTok{=}\NormalTok{ C}\OperatorTok{(}\NormalTok{k}\OperatorTok{,}\NormalTok{ i}\OperatorTok{)} \OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ frac}\OperatorTok{[}\DecValTok{3} \OperatorTok{*}\NormalTok{ k }\OperatorTok{{-}} \DecValTok{2} \OperatorTok{*}\NormalTok{ i}\OperatorTok{]} \OperatorTok{\%}\NormalTok{ MOD }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ pow}\OperatorTok{(}\DecValTok{6}\OperatorTok{,}\NormalTok{ i}\OperatorTok{,}\NormalTok{ MOD}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
  \NormalTok{        tans }\OperatorTok{=} \OperatorTok{(}\NormalTok{i }\OperatorTok{\&} \DecValTok{1}\OperatorTok{)} \OperatorTok{?}\NormalTok{ MOD }\OperatorTok{{-}}\NormalTok{ tans }\OperatorTok{:}\NormalTok{ tans}\OperatorTok{;}
  \NormalTok{        ans }\OperatorTok{=} \OperatorTok{(}\NormalTok{ans }\OperatorTok{+}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{+}\NormalTok{ tans}\OperatorTok{)} \OperatorTok{\%}\NormalTok{ MOD}\OperatorTok{;}
      \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \subsubsection{D. Ë∑ØÂæÑ}\label{d.-ux8defux5f84}
  
  ÁªôÂÆö‰∏Ä‰∏™\(n\)‰∏™È°∂ÁÇπÁöÑÊó†Ê†πÊ†ëÔºåÈ°∂ÁÇπÁºñÂè∑ \(1 ~ n\)„ÄÇ
  
  ÂêåÊó∂ÁªôÂÆöÊ†ë‰∏äÁöÑ \(k\) Êù°Â∏¶ÊùÉË∑ØÂæÑÔºåË¶ÅÊ±ÇÊîØÊåÅ‰ª•‰∏ãÊìç‰Ωú:
  
  \begin{itemize}
  \tightlist
  \item
    \texttt{1\ k} ÔºåÂà†Èô§Á¨¨ \(k\) Êù°Â∏¶ÊùÉË∑ØÂæÑ„ÄÇ
  \item
    \texttt{2\ k\ v} ÔºåÂ∞ÜÁ¨¨ \(k\) Êù°Â∏¶ÊùÉË∑ØÂæÑÁöÑÊùÉÂÄº‰øÆÊîπ‰∏∫ \(v\) „ÄÇ
  \item
    \texttt{3\ p} ÔºåÁªôÂÆö‰∏Ä‰∏™Ê†ë‰∏äËäÇÁÇπ \(p\)
    ÔºåËØ¢ÈóÆÊâÄÊúâÊ≤°ÊúâË¢´Âà†ÂéªÁöÑÂ∏¶ÊùÉË∑ØÂæÑ‰∏≠Ôºå‰∏ç‰∏éËØ•ËäÇÁÇπÁõ∏‰∫§ÁöÑÊâÄÊúâË∑ØÂæÑ‰∏≠ÁöÑÊúÄÂ∞èÊùÉÂÄº„ÄÇ
    \(n, k, q \le 10^5\)
  \end{itemize}
  
  \paragraph{\texorpdfstring{ÂÅöÊ≥ï‰∏ÄÔºöÊ†ëÂâñ + \texttt{std::set} Áª¥Êä§Ê†áËÆ∞
  Ê†áËÆ∞Ê∞∏‰πÖÂåñÁ∫øÊÆµÊ†ë}{ÂÅöÊ≥ï‰∏ÄÔºöÊ†ëÂâñ + std::set Áª¥Êä§Ê†áËÆ∞ Ê†áËÆ∞Ê∞∏‰πÖÂåñÁ∫øÊÆµÊ†ë}}\label{ux505aux6cd5ux4e00ux6811ux5256-stdset-ux7ef4ux62a4ux6807ux8bb0-ux6807ux8bb0ux6c38ux4e45ux5316ux7ebfux6bb5ux6811}
  
  \(\mathcal{O}((k + q)\log_2^3{n})\) ÂÖàÊ†ëÂâñÔºåË∑ØÂæÑË°•ÈõÜ‰ªçÁÑ∂ÊòØÁ∫øÊÆµÊ†ë‰∏ä
  \(\log_2(n)\)
  ÊÆµÔºåÂèØ‰ª•Âú®Ëøô‰∫õÊÆµÈáåÈù¢Âä†ÂÖ•ÂèØÈÄâÁöÑËæπÔºå‰∏∫‰∫ÜÈò≤Ê≠¢Âà†Èô§ÈáçÂ§çÔºå\texttt{std::set}
  ÂÜÖÂ±ÇÊï∞ÊçÆÁ±ªÂûã‰∏∫ \texttt{pair\textless{}int,\ int\textgreater{}}
  ÂàÜÂà´Â≠òÂÇ®Ë∑ØÂæÑÁöÑÊùÉÂÄºÂíåÁºñÂè∑„ÄÇÁÑ∂ÂêéÂ∞±Áõ¥Êé•ÂÅöÂ∞±Â•Ω‰∫Ü„ÄÇ ÂêéËÆ∞ÔºöË¢´Âá∫È¢ò‰∫∫Âç°Êàê‰∫Ü
  \(30\) ‚Ä¶‚Ä¶„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \PreprocessorTok{\#define rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{l}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{r}\OperatorTok{)}\PreprocessorTok{ }\ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{l}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{\_\_}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{r}\OperatorTok{;}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{\textless{}=}\PreprocessorTok{ }\NormalTok{\_\_}\OperatorTok{;}\PreprocessorTok{ }\NormalTok{i}\OperatorTok{++)}
  \KeywordTok{using} \KeywordTok{namespace}\NormalTok{ std}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ k}\OperatorTok{,}\NormalTok{ p}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{2e6} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ head}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \KeywordTok{struct}\NormalTok{ edges}\OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ node}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ nxt}\OperatorTok{;}
  \OperatorTok{\}}\NormalTok{edge}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];} \DataTypeTok{int}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{void}\NormalTok{ add}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ u}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ v}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{    tot}\OperatorTok{++;}
  \NormalTok{    edge}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{node }\OperatorTok{=}\NormalTok{ v}\OperatorTok{;}
  \NormalTok{    edge}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{nxt  }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{u}\OperatorTok{];}
  \NormalTok{    head}\OperatorTok{[}\NormalTok{u}\OperatorTok{]}        \OperatorTok{=}\NormalTok{ tot}\OperatorTok{;}
  \OperatorTok{\}}
  \KeywordTok{struct}\NormalTok{ Path}\OperatorTok{\{} \DataTypeTok{int}\NormalTok{ u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{;}\NormalTok{ Path}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ a}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ b}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ c}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ u }\OperatorTok{=}\NormalTok{ a}\OperatorTok{;}\NormalTok{ v }\OperatorTok{=}\NormalTok{ b}\OperatorTok{;}\NormalTok{ Val }\OperatorTok{=}\NormalTok{ c}\OperatorTok{;} \OperatorTok{\}}\NormalTok{ Path}\OperatorTok{()\{\}} \OperatorTok{\}}\NormalTok{ P}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  
  \DataTypeTok{int}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ rnk}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ dfc}\OperatorTok{,}\NormalTok{ dep}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ top}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ fa}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ si}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ son}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{void}\NormalTok{ dfs0}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ now}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ f}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ dp}\OperatorTok{)\{}
  \NormalTok{    fa}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=}\NormalTok{ f}\OperatorTok{;}\NormalTok{  dep}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=}\NormalTok{ dp}\OperatorTok{;} \DataTypeTok{int} \OperatorTok{\&}\NormalTok{Mid }\OperatorTok{=}\NormalTok{ son}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;} \DataTypeTok{int} \OperatorTok{\&}\NormalTok{Si }\OperatorTok{=}\NormalTok{ si}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{ i }\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{ex }\OperatorTok{==}\NormalTok{ f}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        dfs0}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ now}\OperatorTok{,}\NormalTok{ dp }\OperatorTok{+} \DecValTok{1}\OperatorTok{);}\NormalTok{ Si }\OperatorTok{+=}\NormalTok{ si}\OperatorTok{[}\NormalTok{ex}\OperatorTok{];} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{si}\OperatorTok{[}\NormalTok{ex}\OperatorTok{]} \OperatorTok{\textgreater{}}\NormalTok{ si}\OperatorTok{[}\NormalTok{Mid}\OperatorTok{])}\NormalTok{ Mid }\OperatorTok{=}\NormalTok{ ex}\OperatorTok{;}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \DataTypeTok{void}\NormalTok{ dfs1}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ now}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ f}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ tp}\OperatorTok{)\{}
  \NormalTok{    dfn}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=} \OperatorTok{++}\NormalTok{dfc}\OperatorTok{;}\NormalTok{  top}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=}\NormalTok{ tp}\OperatorTok{;}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{son}\OperatorTok{[}\NormalTok{now}\OperatorTok{])}\NormalTok{ dfs1}\OperatorTok{(}\NormalTok{son}\OperatorTok{[}\NormalTok{now}\OperatorTok{],}\NormalTok{ now}\OperatorTok{,}\NormalTok{ tp}\OperatorTok{);}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{ i }\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{ex }\OperatorTok{==}\NormalTok{ f }\OperatorTok{||}\NormalTok{ ex }\OperatorTok{==}\NormalTok{ son}\OperatorTok{[}\NormalTok{now}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        dfs1}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ now}\OperatorTok{,}\NormalTok{ ex}\OperatorTok{);}
      \OperatorTok{\}}
  \OperatorTok{\}}
  
  \KeywordTok{namespace}\NormalTok{ SegmentTree}\OperatorTok{\{}
      \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{3e6} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ ch}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\DecValTok{2}\OperatorTok{];}\NormalTok{ set}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int} \OperatorTok{,}\DataTypeTok{int}\OperatorTok{\textgreater{},}\NormalTok{ less }\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int} \OperatorTok{,}\DataTypeTok{int}\OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}}\NormalTok{ v}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
      \DataTypeTok{int}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \PreprocessorTok{\#define ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{ch}\OperatorTok{[}\NormalTok{o}\OperatorTok{][}\DecValTok{0}\OperatorTok{])}
      \PreprocessorTok{\#define rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{ch}\OperatorTok{[}\NormalTok{o}\OperatorTok{][}\DecValTok{1}\OperatorTok{])}
      \PreprocessorTok{\#define make }\OperatorTok{(}\NormalTok{tot}\OperatorTok{++,}\PreprocessorTok{ }\NormalTok{ch}\OperatorTok{[}\NormalTok{tot}\OperatorTok{][}\DecValTok{0}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{ch}\OperatorTok{[}\NormalTok{tot}\OperatorTok{][}\DecValTok{1}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\DecValTok{0}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{v}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{clear}\OperatorTok{(),}\PreprocessorTok{ }\NormalTok{tot}\OperatorTok{)}
      \DataTypeTok{int}\NormalTok{ Groot}\OperatorTok{()\{} \ControlFlowTok{return}\NormalTok{ make}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ build}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{==}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{(}\DataTypeTok{void}\OperatorTok{)}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{insert}\OperatorTok{(}\NormalTok{make\_pair}\OperatorTok{(}\NormalTok{INT\_MAX}\OperatorTok{,} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{));}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{L }\OperatorTok{+}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{        ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)} \OperatorTok{=}\NormalTok{ make}\OperatorTok{;}\NormalTok{ rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)} \OperatorTok{=}\NormalTok{ make}\OperatorTok{;}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{insert}\OperatorTok{(}\NormalTok{make\_pair}\OperatorTok{(}\NormalTok{INT\_MAX}\OperatorTok{,} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{));}
  \NormalTok{        build}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}\NormalTok{ build}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
      \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ update\_add}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ V}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ id}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textgreater{}}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ nowl }\OperatorTok{\&\&}\NormalTok{ nowr }\OperatorTok{\textless{}=}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{(}\DataTypeTok{void}\OperatorTok{)}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{insert}\OperatorTok{(}\NormalTok{make\_pair}\OperatorTok{(}\NormalTok{V}\OperatorTok{,}\NormalTok{ id}\OperatorTok{));}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update\_add}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ V}\OperatorTok{,}\NormalTok{ id}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R  }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update\_add}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ V}\OperatorTok{,}\NormalTok{ id}\OperatorTok{);}
      \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ update\_del}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ V}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ id}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textgreater{}}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ nowl }\OperatorTok{\&\&}\NormalTok{ nowr }\OperatorTok{\textless{}=}\NormalTok{ R}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{(}\DataTypeTok{void}\OperatorTok{)}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{erase}\OperatorTok{(}\NormalTok{make\_pair}\OperatorTok{(}\NormalTok{V}\OperatorTok{,}\NormalTok{ id}\OperatorTok{));}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update\_del}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ V}\OperatorTok{,}\NormalTok{ id}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R  }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update\_del}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ L}\OperatorTok{,}\NormalTok{ R}\OperatorTok{,}\NormalTok{ V}\OperatorTok{,}\NormalTok{ id}\OperatorTok{);}
      \OperatorTok{\}}
  \NormalTok{    pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}}\NormalTok{ query}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ p}\OperatorTok{,}\NormalTok{ pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ make\_pair}\OperatorTok{(}\NormalTok{INT\_MAX}\OperatorTok{,} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{))\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{nowl }\OperatorTok{==}\NormalTok{ nowr}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ min}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,} \OperatorTok{*(}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{begin}\OperatorTok{()));}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ min}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,} \OperatorTok{*(}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{begin}\OperatorTok{()));}
          \ControlFlowTok{return}\NormalTok{ p }\OperatorTok{\textless{}=}\NormalTok{ mid }\OperatorTok{?}\NormalTok{ query}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ p}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{)} \OperatorTok{:}\NormalTok{ query}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ p}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}
      \OperatorTok{\}}
  \OperatorTok{\}} \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{query}\OperatorTok{;}     \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{update\_add}\OperatorTok{;} \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{Groot}\OperatorTok{;} 
    \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{build}\OperatorTok{;}     \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{update\_del}\OperatorTok{;}
  \PreprocessorTok{\#define fi }\NormalTok{first}
  \PreprocessorTok{\#define se }\NormalTok{second}
  \NormalTok{vector}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}}\NormalTok{ TMP}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ root }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{void}\NormalTok{ AddWithoutPath}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ u}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ v}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ Val}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ id}\OperatorTok{)\{}
  \NormalTok{    TMP}\OperatorTok{.}\NormalTok{clear}\OperatorTok{();}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{top}\OperatorTok{[}\NormalTok{u}\OperatorTok{]} \OperatorTok{!=}\NormalTok{ top}\OperatorTok{[}\NormalTok{v}\OperatorTok{])\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{dep}\OperatorTok{[}\NormalTok{top}\OperatorTok{[}\NormalTok{u}\OperatorTok{]]} \OperatorTok{\textless{}}\NormalTok{ dep}\OperatorTok{[}\NormalTok{top}\OperatorTok{[}\NormalTok{v}\OperatorTok{]])}\NormalTok{ swap}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{);}
  \NormalTok{        TMP}\OperatorTok{.}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{make\_pair}\OperatorTok{(}\NormalTok{dfn}\OperatorTok{[}\NormalTok{top}\OperatorTok{[}\NormalTok{u}\OperatorTok{]],}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{u}\OperatorTok{]));}\NormalTok{ u }\OperatorTok{=}\NormalTok{ fa}\OperatorTok{[}\NormalTok{top}\OperatorTok{[}\NormalTok{u}\OperatorTok{]];}
      \OperatorTok{\}}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{dep}\OperatorTok{[}\NormalTok{u}\OperatorTok{]} \OperatorTok{\textless{}}\NormalTok{ dep}\OperatorTok{[}\NormalTok{v}\OperatorTok{])}\NormalTok{ swap}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{);}
  \NormalTok{    TMP}\OperatorTok{.}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{make\_pair}\OperatorTok{(}\NormalTok{dfn}\OperatorTok{[}\NormalTok{v}\OperatorTok{],}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{u}\OperatorTok{]));}
  \NormalTok{    sort}\OperatorTok{(}\NormalTok{TMP}\OperatorTok{.}\NormalTok{begin}\OperatorTok{(),}\NormalTok{ TMP}\OperatorTok{.}\NormalTok{end}\OperatorTok{());}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ TMP}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}} \DecValTok{2}\OperatorTok{)}\NormalTok{ update\_add}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ TMP}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{se }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ TMP}\OperatorTok{[}\NormalTok{i }\OperatorTok{+} \DecValTok{1}\OperatorTok{].}\NormalTok{fi }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{,}\NormalTok{ id}\OperatorTok{);}
  \NormalTok{    update\_add}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ TMP}\OperatorTok{[}\DecValTok{0}\OperatorTok{].}\NormalTok{fi }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{,}\NormalTok{ id}\OperatorTok{);}
  \NormalTok{    update\_add}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ TMP}\OperatorTok{[}\NormalTok{TMP}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{].}\NormalTok{se }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{,}\NormalTok{ id}\OperatorTok{);}
  \OperatorTok{\}}
  \DataTypeTok{void}\NormalTok{ DelWithoutPath}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ u}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ v}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ Val}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ id}\OperatorTok{)\{}
  \NormalTok{    TMP}\OperatorTok{.}\NormalTok{clear}\OperatorTok{();}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{top}\OperatorTok{[}\NormalTok{u}\OperatorTok{]} \OperatorTok{!=}\NormalTok{ top}\OperatorTok{[}\NormalTok{v}\OperatorTok{])\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{dep}\OperatorTok{[}\NormalTok{top}\OperatorTok{[}\NormalTok{u}\OperatorTok{]]} \OperatorTok{\textless{}}\NormalTok{ dep}\OperatorTok{[}\NormalTok{top}\OperatorTok{[}\NormalTok{v}\OperatorTok{]])}\NormalTok{ swap}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{);}
  \NormalTok{        TMP}\OperatorTok{.}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{make\_pair}\OperatorTok{(}\NormalTok{dfn}\OperatorTok{[}\NormalTok{top}\OperatorTok{[}\NormalTok{u}\OperatorTok{]],}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{u}\OperatorTok{]));}\NormalTok{ u }\OperatorTok{=}\NormalTok{ fa}\OperatorTok{[}\NormalTok{top}\OperatorTok{[}\NormalTok{u}\OperatorTok{]];}
      \OperatorTok{\}}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{dep}\OperatorTok{[}\NormalTok{u}\OperatorTok{]} \OperatorTok{\textless{}}\NormalTok{ dep}\OperatorTok{[}\NormalTok{v}\OperatorTok{])}\NormalTok{ swap}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{);}
  \NormalTok{    TMP}\OperatorTok{.}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{make\_pair}\OperatorTok{(}\NormalTok{dfn}\OperatorTok{[}\NormalTok{v}\OperatorTok{],}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{u}\OperatorTok{]));}
  \NormalTok{    sort}\OperatorTok{(}\NormalTok{TMP}\OperatorTok{.}\NormalTok{begin}\OperatorTok{(),}\NormalTok{ TMP}\OperatorTok{.}\NormalTok{end}\OperatorTok{());}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ TMP}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}} \DecValTok{2}\OperatorTok{)}\NormalTok{ update\_del}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ TMP}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{se }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ TMP}\OperatorTok{[}\NormalTok{i }\OperatorTok{+} \DecValTok{1}\OperatorTok{].}\NormalTok{fi }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{,}\NormalTok{ id}\OperatorTok{);}
  \NormalTok{    update\_del}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ TMP}\OperatorTok{[}\DecValTok{0}\OperatorTok{].}\NormalTok{fi }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{,}\NormalTok{ id}\OperatorTok{);}
  \NormalTok{    update\_del}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ TMP}\OperatorTok{[}\NormalTok{TMP}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{].}\NormalTok{se }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ Val}\OperatorTok{,}\NormalTok{ id}\OperatorTok{);}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{} \CommentTok{// freopen("in.txt", "r", stdin);}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{k}\OperatorTok{)(}\NormalTok{p}\OperatorTok{);}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{u}\OperatorTok{)(}\NormalTok{v}\OperatorTok{);}
  \NormalTok{        add}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{);}\NormalTok{ add}\OperatorTok{(}\NormalTok{v}\OperatorTok{,}\NormalTok{ u}\OperatorTok{);}
      \OperatorTok{\}}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ k}\OperatorTok{)} \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ p}\OperatorTok{,}\NormalTok{ q}\OperatorTok{,}\NormalTok{ v}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{p}\OperatorTok{)(}\NormalTok{q}\OperatorTok{)(}\NormalTok{v}\OperatorTok{);}
  \NormalTok{        P}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ Path}\OperatorTok{(}\NormalTok{p}\OperatorTok{,}\NormalTok{ q}\OperatorTok{,}\NormalTok{ v}\OperatorTok{);}
      \OperatorTok{\}}
  \NormalTok{    dfs0}\OperatorTok{(}\DecValTok{1}\OperatorTok{,} \DecValTok{1}\OperatorTok{,} \DecValTok{1}\OperatorTok{);}\NormalTok{ dfs1}\OperatorTok{(}\DecValTok{1}\OperatorTok{,} \DecValTok{1}\OperatorTok{,} \DecValTok{1}\OperatorTok{);}
  \NormalTok{    root }\OperatorTok{=}\NormalTok{ Groot}\OperatorTok{();}\NormalTok{ build}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{);}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ k}\OperatorTok{)}\NormalTok{ AddWithoutPath}\OperatorTok{(}\NormalTok{P}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{u}\OperatorTok{,}\NormalTok{ P}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{v}\OperatorTok{,}\NormalTok{ P}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{Val}\OperatorTok{,}\NormalTok{ i}\OperatorTok{);}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{p}\OperatorTok{{-}{-})\{}
          \DataTypeTok{int}\NormalTok{ opt}\OperatorTok{,}\NormalTok{ k}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{opt}\OperatorTok{)(}\NormalTok{k}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{opt }\OperatorTok{==} \DecValTok{1}\OperatorTok{)\{}
  \NormalTok{            DelWithoutPath}\OperatorTok{(}\NormalTok{P}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{u}\OperatorTok{,}\NormalTok{ P}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{v}\OperatorTok{,}\NormalTok{ P}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{Val}\OperatorTok{,}\NormalTok{ k}\OperatorTok{);}
          \OperatorTok{\}} \ControlFlowTok{else} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{opt }\OperatorTok{==} \DecValTok{2}\OperatorTok{)\{}
  \NormalTok{            DelWithoutPath}\OperatorTok{(}\NormalTok{P}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{u}\OperatorTok{,}\NormalTok{ P}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{v}\OperatorTok{,}\NormalTok{ P}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{Val}\OperatorTok{,}\NormalTok{ k}\OperatorTok{);}
  \NormalTok{            Read}\OperatorTok{(}\NormalTok{P}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{Val}\OperatorTok{);}
  \NormalTok{            AddWithoutPath}\OperatorTok{(}\NormalTok{P}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{u}\OperatorTok{,}\NormalTok{ P}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{v}\OperatorTok{,}\NormalTok{ P}\OperatorTok{[}\NormalTok{k}\OperatorTok{].}\NormalTok{Val}\OperatorTok{,}\NormalTok{ k}\OperatorTok{);}
          \OperatorTok{\}} \ControlFlowTok{else} \OperatorTok{\{}
  \NormalTok{            pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}}\NormalTok{ r }\OperatorTok{=}\NormalTok{ query}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{,}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{k}\OperatorTok{]);}
  \NormalTok{            printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ r}\OperatorTok{.}\NormalTok{first }\OperatorTok{\textless{}}\NormalTok{ INT\_MAX }\OperatorTok{?}\NormalTok{ r}\OperatorTok{.}\NormalTok{first }\OperatorTok{:} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{);}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \paragraph{ÂÅöÊ≥ï‰∫åÔºöÁ∫øÊÆµÊ†ëÁª¥Êä§Ë∑ØÂæÑ‰∫§ÈõÜ +
  ‰∫åÂàÜÊúÄÂ∞èÂÄº}\label{ux505aux6cd5ux4e8cux7ebfux6bb5ux6811ux7ef4ux62a4ux8defux5f84ux4ea4ux96c6-ux4e8cux5206ux6700ux5c0fux503c}
  
  \begin{quote}
  Â∑ßÂ¶ôÁªù‰º¶ÁöÑÂÅöÊ≥ï„ÄÇ
  \end{quote}
  
  Ë¶ÅÊ±ÇÂõûÁ≠îÁöÑÊòØÔºö‰∏ç‰∏éËäÇÁÇπ \(p\) Áõ∏‰∫§ÁöÑÊâÄÊúâË∑ØÂæÑ‰∏≠ÁöÑÊúÄÂ∞èÊùÉÂÄº„ÄÇ
  
  ËÄÉËôë‰∫åÂàÜ‰∏Ä‰∏™ÊúÄÂ∞èÊùÉÂÄº \(x\)ÔºåÁÑ∂ÂêéÂà§Êñ≠ÊòØÊâÄÊúâÊùÉÂÄºÂ∞è‰∫é \(x\)
  ÁöÑË∑ØÂæÑÊòØ‰∏çÊòØÂÖ®ÈÉΩÂíåÁÇπ \(p\) Êúâ‰∫§„ÄÇ
  
  Â¶ÇÊûúÊääÊâÄÊúâË∑ØÂæÑÊåâÁÖßÊùÉÂÄºÊéíÂ∫èÔºåÈÇ£‰πàÊàê‰∏∫Á≠îÊ°àÁöÑÈÇ£Êù°Ë∑ØÂæÑ‰πãÂâçÁöÑË∑ØÂæÑ‰∏ÄÂÆöÈÉΩÂíåÁÇπ
  \(p\) Êúâ‰∫§ÔºåËøôÂ∞±ÂèØ‰ª•Áõ¥Êé•‰∫åÂàÜÁ≠îÊ°à‰∫Ü„ÄÇ
  
  ‰ΩÜÊòØË∑ØÂæÑÈúÄË¶ÅÊîØÊåÅÂà†Èô§Âíå‰øÆÊîπ„ÄÇ ÊòæÁÑ∂ÈúÄË¶ÅÊï∞ÊçÆÁªìÊûÑ„ÄÇ
  
  ‰∏Ä‰∏™ÊòæÁÑ∂ÁöÑ‰∫ãÂÆûÊòØÔºö‰∏§Êù°Ë∑ØÂæÑÁöÑ‰∫§
  ‰πüÊòØ‰∏ÄÊù°Ë∑ØÂæÑÔºàÂÆö‰πâ‰∏Ä‰∏™ÁÇπÊàñËÄÖÁ©∫ÈÉΩÂ±û‰∫éË∑ØÂæÑÔºâ„ÄÇ
  
  Á∫øÊÆµÊ†ëÂ∞±ÂèØ‰ª•Âø´ÈÄüÊ±ÇÂá∫‰∏ÄÊÆµË∑ØÂæÑÂå∫Èó¥ÂÜÖÊâÄÊúâË∑ØÂæÑÁöÑ‰∫§ÈõÜË∑ØÂæÑ„ÄÇ
  
  ÊâÄÊúâË∑ØÂæÑÊåâÁÖßÊùÉÂÄºÊéíÂ•ΩÂ∫èÂêéÁöÑ‰∏Ä‰∏™ÂâçÁºÄÂÖ®ÈÉ®ÂíåÁÇπ \(p\)
  Êúâ‰∫§ÔºåÁ≠â‰ª∑‰∫éÔºåËøô‰∏™ÂâçÁºÄÊâÄÊúâÁöÑË∑ØÂæÑÁöÑ‰∫§ÈõÜÂíåÁÇπ \(p\) Êúâ‰∫§„ÄÇ
  
  ÂØπ‰∫éÂà†Èô§Êìç‰ΩúÔºåÂèØ‰ª•ËÄÉËôëÂú®Á∫øÊÆµÊ†ëÂØπÂ∫îÊìç‰Ωú‰∏äÊâìÂà†Èô§Ê†áËÆ∞„ÄÇÂØπ‰∫é‰øÆÊîπÊìç‰ΩúÔºåÂõ†‰∏∫Ê≤°ÊúâÂº∫Âà∂Âú®Á∫øÔºåÂèØ‰ª•ËÄÉËôë‰∏ÄÂºÄÂßãÊääËøôÊù°Ë∑ØÂæÑÁöÑÊâÄÊúâÊùÉÂÄºÊéíÂ•ΩÂ∫èÂêéÂä†ÂÖ•Á∫øÊÆµÊ†ëÔºåÁÑ∂ÂêéÂØπ‰∫éÂΩìÂâçÊó†Áî®ÁöÑÁâàÊú¨ÔºåÊâì‰∏äÂà†Èô§Ê†áËÆ∞Âç≥ÂèØ„ÄÇÂØπ‰∫é‰∏ÄÊ¨°‰øÆÊîπÔºåËΩ¨ÂåñÊàê‰∏ÄÊ¨°Âà†Èô§Âíå‰∏ÄÊ¨°ÊÅ¢Â§çÊìç‰Ωú„ÄÇ
  
  ÂΩìÁÑ∂Âπ≥Ë°°Ê†ëÂèØ‰ª•ËΩªÊòìÂÆåÊàêËøôÊ†∑ÁöÑÂ∑•‰ΩúÔºåÂú®Âπ≥Ë°°Ê†ë‰∏äÁª¥Êä§Ê†ë‰∏äË∑ØÂæÑ‰∫§ÈõÜÔºåÂÜô‰∏çÂá∫Êù•Âïä‚Ä¶
  
  ËøôÊ†∑Â∞±ÂèØ‰ª•Áõ¥Êé•Áî®Á∫øÊÆµÊ†ëÊ±ÇÂá∫Êüê‰∏™ÂâçÁºÄÁöÑÊâÄÊúâË∑ØÂæÑÁöÑ‰∫§ÈõÜË∑ØÂæÑ‰∫Ü„ÄÇÁ∫øÊÆµÊ†ëÂêàÂπ∂‰ø°ÊÅØÊó∂ÔºåÈúÄË¶ÅËØ¢ÈóÆ
  \texttt{LCA}ÔºåÁÆó‰∏ä‰∫åÂàÜÔºåËøôÊ†∑ÁöÑÂçïÊ¨°ËØ¢ÈóÆÂ§çÊùÇÂ∫¶ÂèØ‰ª•ÂÅöÂà∞
  \(\mathcal{O}(\log k \log w \log n)\)ÔºàÂÄçÂ¢û \texttt{LCA}ÔºâÔºåÊàñËÄÖ
  \(\mathcal{O}(\log k \log w)\)Ôºà\(\mathcal{O}(n) - \mathcal{O}(1)\)
  \texttt{LCA}Ôºâ„ÄÇ
  
  Ê≥®ÊÑèÂà∞Á∫øÊÆµÊ†ëÊú¨Ë∫´Â∞±ÊòØ‰∏Ä‰∏™ÂàÜÊ≤ªÁöÑÁªìÊûÑÔºåÂèØ‰ª•Áõ¥Êé•Âú®Á∫øÊÆµÊ†ë‰∏ä‰∫åÂàÜÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ÂÅöÂà∞
  \(\mathcal{O}(\log k \log n)\)ÔºàÂÄçÂ¢û \texttt{LCA}ÔºâÔºåÊàñËÄÖ
  \(\mathcal{O}(\log k)\)Ôºà\(\mathcal{O}(n) - \mathcal{O}(1)\)
  \texttt{LCA}Ôºâ„ÄÇ
  
  ÊàëÁöÑÂÆûÁé∞ÊòØ ÂÄçÂ¢û \texttt{LCA} + Á∫øÊÆµÊ†ë‰∫åÂàÜÔºåÁÆó‰∏äÈ¢ÑÂ§ÑÁêÜÔºåÊÄªÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫
  \(\mathcal{O}(n\log(n) + q\log(q+k)\log n)\)
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{2e5} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ head}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \KeywordTok{struct}\NormalTok{ edges}\OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ node}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ nxt}\OperatorTok{;}
  \OperatorTok{\}}\NormalTok{edge}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{void}\NormalTok{ add}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ u}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ v}\OperatorTok{)\{}
  \NormalTok{    tot}\OperatorTok{++;}
  \NormalTok{    edge}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{node }\OperatorTok{=}\NormalTok{ v}\OperatorTok{;}
  \NormalTok{    edge}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{nxt  }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{u}\OperatorTok{];}
  \NormalTok{    head}\OperatorTok{[}\NormalTok{u}\OperatorTok{]}        \OperatorTok{=}\NormalTok{ tot}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ k}\OperatorTok{,}\NormalTok{ q}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ LOG }\OperatorTok{=} \DecValTok{18}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ fa}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\NormalTok{LOG }\OperatorTok{+} \DecValTok{2}\OperatorTok{],}\NormalTok{ dep}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{void}\NormalTok{ dfs0}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ now}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ f}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ dp}\OperatorTok{)\{}
  \NormalTok{    fa}\OperatorTok{[}\NormalTok{now}\OperatorTok{][}\DecValTok{0}\OperatorTok{]} \OperatorTok{=}\NormalTok{ f}\OperatorTok{;}\NormalTok{ dep}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=}\NormalTok{ dp}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{ i }\OperatorTok{;}\NormalTok{ i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ ex }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{ex }\OperatorTok{==}\NormalTok{ f}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        dfs0}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ now}\OperatorTok{,}\NormalTok{ dp }\OperatorTok{+} \DecValTok{1}\OperatorTok{);}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \NormalTok{map }\OperatorTok{\textless{}}\NormalTok{ pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}} \OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}}\NormalTok{  Mem}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ LCA}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ u}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ v}\OperatorTok{)\{}
  \NormalTok{    pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ P }\OperatorTok{=}\NormalTok{ make\_pair}\OperatorTok{(}\NormalTok{min}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{),}\NormalTok{ max}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{));}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{Mem}\OperatorTok{.}\NormalTok{count}\OperatorTok{(}\NormalTok{P}\OperatorTok{))} \ControlFlowTok{return}\NormalTok{ Mem}\OperatorTok{[}\NormalTok{P}\OperatorTok{];}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{dep}\OperatorTok{[}\NormalTok{u}\OperatorTok{]} \OperatorTok{\textless{}}\NormalTok{ dep}\OperatorTok{[}\NormalTok{v}\OperatorTok{])}\NormalTok{ swap}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ d }\OperatorTok{=}\NormalTok{ dep}\OperatorTok{[}\NormalTok{u}\OperatorTok{]} \OperatorTok{{-}}\NormalTok{ dep}\OperatorTok{[}\NormalTok{v}\OperatorTok{];}
      \DataTypeTok{int}\NormalTok{ x }\OperatorTok{=}\NormalTok{ u}\OperatorTok{,}\NormalTok{ y }\OperatorTok{=}\NormalTok{ v}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ LOG}\OperatorTok{)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{d }\OperatorTok{\&} \OperatorTok{(}\DecValTok{1} \OperatorTok{\textless{}\textless{}}\NormalTok{ i}\OperatorTok{))}\NormalTok{ x }\OperatorTok{=}\NormalTok{ fa}\OperatorTok{[}\NormalTok{x}\OperatorTok{][}\NormalTok{i}\OperatorTok{];}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{x }\OperatorTok{==}\NormalTok{ y}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ x}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ LOG}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textgreater{}=} \DecValTok{0}\OperatorTok{;}\NormalTok{ i}\OperatorTok{{-}{-})\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{fa}\OperatorTok{[}\NormalTok{x}\OperatorTok{][}\NormalTok{i}\OperatorTok{]} \OperatorTok{==}\NormalTok{ fa}\OperatorTok{[}\NormalTok{y}\OperatorTok{][}\NormalTok{i}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        x }\OperatorTok{=}\NormalTok{ fa}\OperatorTok{[}\NormalTok{x}\OperatorTok{][}\NormalTok{i}\OperatorTok{];}\NormalTok{ y }\OperatorTok{=}\NormalTok{ fa}\OperatorTok{[}\NormalTok{y}\OperatorTok{][}\NormalTok{i}\OperatorTok{];}
      \OperatorTok{\}}
      \ControlFlowTok{return}\NormalTok{ Mem}\OperatorTok{[}\NormalTok{P}\OperatorTok{]} \OperatorTok{=}\NormalTok{ fa}\OperatorTok{[}\NormalTok{x}\OperatorTok{][}\DecValTok{0}\OperatorTok{];}
  \OperatorTok{\}}
  
  \DataTypeTok{void}\NormalTok{ InitQuery}\OperatorTok{()\{}
  \NormalTok{    dfs0}\OperatorTok{(}\DecValTok{1}\OperatorTok{,} \DecValTok{1}\OperatorTok{,} \DecValTok{1}\OperatorTok{);}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{j}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ LOG}\OperatorTok{)}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ fa}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{=}\NormalTok{ fa}\OperatorTok{[}\NormalTok{fa}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{];}
  \OperatorTok{\}}
  \KeywordTok{struct} \DataTypeTok{Path\_t}\OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ id}\OperatorTok{,}\NormalTok{ u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{,}\NormalTok{ w}\OperatorTok{,}\NormalTok{ ver}\OperatorTok{;}
      \DataTypeTok{Path\_t}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ a}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ b}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ c}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ d}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ e}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ id }\OperatorTok{=}\NormalTok{ a}\OperatorTok{;}\NormalTok{ u }\OperatorTok{=}\NormalTok{ b}\OperatorTok{;}\NormalTok{ v }\OperatorTok{=}\NormalTok{ c}\OperatorTok{;}\NormalTok{ w }\OperatorTok{=}\NormalTok{ d}\OperatorTok{;}\NormalTok{ ver }\OperatorTok{=}\NormalTok{ e}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{Path\_t}\OperatorTok{()} \OperatorTok{\{} \OperatorTok{\}}
  \OperatorTok{\};}
  \DataTypeTok{bool}\NormalTok{ CMP}\OperatorTok{(}\AttributeTok{const} \DataTypeTok{Path\_t} \OperatorTok{\&}\NormalTok{ A}\OperatorTok{,} \AttributeTok{const} \DataTypeTok{Path\_t} \OperatorTok{\&}\NormalTok{ B}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return}\NormalTok{ A}\OperatorTok{.}\NormalTok{w }\OperatorTok{\textless{}}\NormalTok{ B}\OperatorTok{.}\NormalTok{w}\OperatorTok{;} \OperatorTok{\}}
  \KeywordTok{struct} \DataTypeTok{Q\_t}\OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ type}\OperatorTok{,}\NormalTok{ a}\OperatorTok{,}\NormalTok{ b}\OperatorTok{;}
      \DataTypeTok{Q\_t}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ x}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ y}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ z}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ type }\OperatorTok{=}\NormalTok{ x}\OperatorTok{;}\NormalTok{ a }\OperatorTok{=}\NormalTok{ y}\OperatorTok{;}\NormalTok{ b }\OperatorTok{=}\NormalTok{ z}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{Q\_t}\OperatorTok{()} \OperatorTok{\{\}}
  \OperatorTok{\}}\NormalTok{Q}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ nowv}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \NormalTok{vector}\OperatorTok{\textless{}}\DataTypeTok{Path\_t}\OperatorTok{\textgreater{}}\NormalTok{ P}\OperatorTok{;}
  \NormalTok{vector}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ Pv}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ dis}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ u}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ v}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return}\NormalTok{ dep}\OperatorTok{[}\NormalTok{u}\OperatorTok{]} \OperatorTok{+}\NormalTok{ dep}\OperatorTok{[}\NormalTok{v}\OperatorTok{]} \OperatorTok{{-}} \OperatorTok{(}\NormalTok{dep}\OperatorTok{[}\NormalTok{LCA}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{)]} \OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{);} \OperatorTok{\}}
  \NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ cross}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ u0}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ v0}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ u1}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ v1}\OperatorTok{)} \OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ t0 }\OperatorTok{=}\NormalTok{ LCA}\OperatorTok{(}\NormalTok{u0}\OperatorTok{,}\NormalTok{ v0}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ t1 }\OperatorTok{=}\NormalTok{ LCA}\OperatorTok{(}\NormalTok{u0}\OperatorTok{,}\NormalTok{ u1}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ t2 }\OperatorTok{=}\NormalTok{ LCA}\OperatorTok{(}\NormalTok{u0}\OperatorTok{,}\NormalTok{ v1}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ t3 }\OperatorTok{=}\NormalTok{ LCA}\OperatorTok{(}\NormalTok{v0}\OperatorTok{,}\NormalTok{ u1}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ t4 }\OperatorTok{=}\NormalTok{ LCA}\OperatorTok{(}\NormalTok{v0}\OperatorTok{,}\NormalTok{ v1}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ target0 }\OperatorTok{=}\NormalTok{ t0}\OperatorTok{;} \CommentTok{// t0 t1 t3 }
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{dep}\OperatorTok{[}\NormalTok{target0}\OperatorTok{]} \OperatorTok{\textless{}}\NormalTok{ dep}\OperatorTok{[}\NormalTok{t1}\OperatorTok{])}\NormalTok{ target0 }\OperatorTok{=}\NormalTok{ t1}\OperatorTok{;}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{dep}\OperatorTok{[}\NormalTok{target0}\OperatorTok{]} \OperatorTok{\textless{}}\NormalTok{ dep}\OperatorTok{[}\NormalTok{t3}\OperatorTok{])}\NormalTok{ target0 }\OperatorTok{=}\NormalTok{ t3}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ target1 }\OperatorTok{=}\NormalTok{ t0}\OperatorTok{;} \CommentTok{// t0 t2 t4}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{dep}\OperatorTok{[}\NormalTok{target1}\OperatorTok{]} \OperatorTok{\textless{}}\NormalTok{ dep}\OperatorTok{[}\NormalTok{t2}\OperatorTok{])}\NormalTok{ target1 }\OperatorTok{=}\NormalTok{ t2}\OperatorTok{;}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{dep}\OperatorTok{[}\NormalTok{target1}\OperatorTok{]} \OperatorTok{\textless{}}\NormalTok{ dep}\OperatorTok{[}\NormalTok{t4}\OperatorTok{])}\NormalTok{ target1 }\OperatorTok{=}\NormalTok{ t4}\OperatorTok{;}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{target1 }\OperatorTok{==}\NormalTok{ target0 }\OperatorTok{\&\&}\NormalTok{ dis}\OperatorTok{(}\NormalTok{target1}\OperatorTok{,}\NormalTok{ u1}\OperatorTok{)} \OperatorTok{+}\NormalTok{ dis}\OperatorTok{(}\NormalTok{target1}\OperatorTok{,}\NormalTok{ v1}\OperatorTok{)} \OperatorTok{!=}\NormalTok{ dis}\OperatorTok{(}\NormalTok{u1}\OperatorTok{,}\NormalTok{ v1}\OperatorTok{))} \ControlFlowTok{return}\NormalTok{ make\_pair}\OperatorTok{({-}}\DecValTok{1}\OperatorTok{,} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{);}
      \ControlFlowTok{else} \ControlFlowTok{return}\NormalTok{ make\_pair}\OperatorTok{(}\NormalTok{target0}\OperatorTok{,}\NormalTok{ target1}\OperatorTok{);}
  \OperatorTok{\}}
  \DataTypeTok{bool}\NormalTok{ crossx}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ u}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ v}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ x}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{u }\OperatorTok{==} \OperatorTok{{-}}\DecValTok{1} \OperatorTok{||}\NormalTok{ v }\OperatorTok{==} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{)} \ControlFlowTok{return} \KeywordTok{false}\OperatorTok{;}  \ControlFlowTok{return}\NormalTok{ dis}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{)} \OperatorTok{==}\NormalTok{ dis}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ x}\OperatorTok{)} \OperatorTok{+}\NormalTok{ dis}\OperatorTok{(}\NormalTok{v}\OperatorTok{,}\NormalTok{ x}\OperatorTok{);} \OperatorTok{\}}
  \KeywordTok{namespace}\NormalTok{ SegmentTree}\OperatorTok{\{} \CommentTok{// To maintain the merge path}
      \KeywordTok{struct} \DataTypeTok{Node\_t}\OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{;}
          \DataTypeTok{bool}\NormalTok{ isDel}\OperatorTok{,}\NormalTok{ isNul}\OperatorTok{;}
          \DataTypeTok{void}\NormalTok{ clear}\OperatorTok{()\{}
  \NormalTok{            isDel }\OperatorTok{=} \KeywordTok{false}\OperatorTok{;}\NormalTok{ isNul }\OperatorTok{=} \KeywordTok{true}\OperatorTok{;}\NormalTok{ u }\OperatorTok{=}\NormalTok{ v }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
          \OperatorTok{\}}
      \OperatorTok{\};}
      \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{1e6} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ ch}\OperatorTok{[}\NormalTok{\_}\OperatorTok{][}\DecValTok{2}\OperatorTok{],}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;} \DataTypeTok{Node\_t}\NormalTok{ v}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
      \PreprocessorTok{\#define ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{ch}\OperatorTok{[}\NormalTok{o}\OperatorTok{][}\DecValTok{0}\OperatorTok{])}
      \PreprocessorTok{\#define rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)}\PreprocessorTok{ }\OperatorTok{(}\NormalTok{ch}\OperatorTok{[}\NormalTok{o}\OperatorTok{][}\DecValTok{1}\OperatorTok{])}
      \PreprocessorTok{\#define make }\OperatorTok{(}\NormalTok{tot}\OperatorTok{++,}\PreprocessorTok{ }\NormalTok{ch}\OperatorTok{[}\NormalTok{tot}\OperatorTok{][}\DecValTok{0}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{ch}\OperatorTok{[}\NormalTok{tot}\OperatorTok{][}\DecValTok{1}\OperatorTok{]}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\DecValTok{0}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{v}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{clear}\OperatorTok{(),}\PreprocessorTok{ }\NormalTok{tot}\OperatorTok{)}
      \DataTypeTok{int}\NormalTok{ Groot}\OperatorTok{()} \OperatorTok{\{} \ControlFlowTok{return}\NormalTok{ make}\OperatorTok{;} \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ maintain}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{        v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{isDel }\OperatorTok{=} \OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{isDel }\OperatorTok{\&\&}\NormalTok{ v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{isDel}\OperatorTok{);}
  \NormalTok{        v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{isNul }\OperatorTok{=} \OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{isNul }\OperatorTok{||}\NormalTok{ v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{isNul}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{isDel }\OperatorTok{\&\&} \OperatorTok{!}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{isNul}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{isDel }\OperatorTok{\&\&} \OperatorTok{!}\NormalTok{v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{isDel}\OperatorTok{)}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{u }\OperatorTok{=}\NormalTok{ v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{v }\OperatorTok{=}\NormalTok{ v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{v}\OperatorTok{;}
              \ControlFlowTok{else} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{isDel }\OperatorTok{\&\&} \OperatorTok{!}\NormalTok{v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{isDel}\OperatorTok{)}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{u }\OperatorTok{=}\NormalTok{ v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{v }\OperatorTok{=}\NormalTok{ v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{v}\OperatorTok{;}
              \ControlFlowTok{else} \OperatorTok{\{}
  \NormalTok{                pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ R }\OperatorTok{=}\NormalTok{ cross}\OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{v}\OperatorTok{,}\NormalTok{ v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{v}\OperatorTok{);}
                  \ControlFlowTok{if}\OperatorTok{(}\NormalTok{R}\OperatorTok{.}\NormalTok{first }\OperatorTok{==} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{                    v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{isNul }\OperatorTok{=} \KeywordTok{true}\OperatorTok{;}
                  \OperatorTok{\}} 
  \NormalTok{                v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{u }\OperatorTok{=}\NormalTok{ R}\OperatorTok{.}\NormalTok{first}\OperatorTok{;}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{v }\OperatorTok{=}\NormalTok{ R}\OperatorTok{.}\NormalTok{second}\OperatorTok{;}
              \OperatorTok{\}}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ build}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ L}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ R}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{L }\OperatorTok{==}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\{}
  \NormalTok{            v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{isNul }\OperatorTok{=} \KeywordTok{false}\OperatorTok{;}
  \NormalTok{            v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{isDel }\OperatorTok{=} \OperatorTok{(}\NormalTok{P}\OperatorTok{[}\NormalTok{L }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{].}\NormalTok{ver }\OperatorTok{!=} \DecValTok{1}\OperatorTok{);}
  \NormalTok{            v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{u     }\OperatorTok{=}\NormalTok{ P}\OperatorTok{[}\NormalTok{L }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{].}\NormalTok{u}\OperatorTok{;}
  \NormalTok{            v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{v     }\OperatorTok{=}\NormalTok{ P}\OperatorTok{[}\NormalTok{L }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{].}\NormalTok{v}\OperatorTok{;}
              \ControlFlowTok{return} \OperatorTok{;}
          \OperatorTok{\}}\NormalTok{ ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)} \OperatorTok{=}\NormalTok{ make}\OperatorTok{;}\NormalTok{ rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)} \OperatorTok{=}\NormalTok{ make}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{L }\OperatorTok{+}\NormalTok{ R}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{        build}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ L}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{);}\NormalTok{ build}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ R}\OperatorTok{);}
  \NormalTok{        maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}  
      \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ update}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ p}\OperatorTok{,} \DataTypeTok{bool}\NormalTok{ V}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{nowl }\OperatorTok{==}\NormalTok{ nowr}\OperatorTok{)} \ControlFlowTok{return} \OperatorTok{(}\DataTypeTok{void}\OperatorTok{)(}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{isDel }\OperatorTok{=}\NormalTok{ V}\OperatorTok{);}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{p }\OperatorTok{\textless{}=}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ p}\OperatorTok{,}\NormalTok{ V}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{p  }\OperatorTok{\textgreater{}}\NormalTok{ mid}\OperatorTok{)}\NormalTok{ update}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ p}\OperatorTok{,}\NormalTok{ V}\OperatorTok{);}
  \NormalTok{        maintain}\OperatorTok{(}\NormalTok{o}\OperatorTok{);}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ query}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ o}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowl}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ nowr}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ x}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{isNul }\OperatorTok{\&\&} \OperatorTok{!}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{isDel }\OperatorTok{\&\&}\NormalTok{ crossx}\OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{[}\NormalTok{o}\OperatorTok{].}\NormalTok{v}\OperatorTok{,}\NormalTok{ x}\OperatorTok{))} \ControlFlowTok{return} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{nowl }\OperatorTok{==}\NormalTok{ nowr}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ P}\OperatorTok{[}\NormalTok{nowl }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{].}\NormalTok{w}\OperatorTok{;}
          \DataTypeTok{bool}\NormalTok{ r0 }\OperatorTok{=} \OperatorTok{!(}\NormalTok{v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{isNul }\OperatorTok{||} \OperatorTok{!}\NormalTok{crossx}\OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{v}\OperatorTok{,}\NormalTok{ x}\OperatorTok{))} \OperatorTok{||}\NormalTok{ v}\OperatorTok{[}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{isDel}\OperatorTok{;}
          \DataTypeTok{bool}\NormalTok{ r1 }\OperatorTok{=} \OperatorTok{!(}\NormalTok{v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{isNul }\OperatorTok{||} \OperatorTok{!}\NormalTok{crossx}\OperatorTok{(}\NormalTok{v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{v}\OperatorTok{,}\NormalTok{ x}\OperatorTok{))} \OperatorTok{||}\NormalTok{ v}\OperatorTok{[}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{)].}\NormalTok{isDel}\OperatorTok{;}
          \DataTypeTok{int}\NormalTok{ mid }\OperatorTok{=} \OperatorTok{(}\NormalTok{nowl }\OperatorTok{+}\NormalTok{ nowr}\OperatorTok{)} \OperatorTok{\textgreater{}\textgreater{}} \DecValTok{1}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{r0}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ query}\OperatorTok{(}\NormalTok{ls}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ nowl}\OperatorTok{,}\NormalTok{ mid}\OperatorTok{,}\NormalTok{ x}\OperatorTok{);} \ControlFlowTok{else} \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{r1}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ query}\OperatorTok{(}\NormalTok{rs}\OperatorTok{(}\NormalTok{o}\OperatorTok{),}\NormalTok{ mid }\OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ nowr}\OperatorTok{,}\NormalTok{ x}\OperatorTok{);} \ControlFlowTok{else} \ControlFlowTok{return} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{;}
      \OperatorTok{\}}
  \OperatorTok{\}}  \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{build}\OperatorTok{;} \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{Groot}\OperatorTok{;}
     \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{query}\OperatorTok{;} \KeywordTok{using}\NormalTok{ SegmentTree}\OperatorTok{::}\NormalTok{update}\OperatorTok{;}
  
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()} \OperatorTok{\{}\NormalTok{ freopen}\OperatorTok{(}\StringTok{"in.txt"}\OperatorTok{,} \StringTok{"r"}\OperatorTok{,}\NormalTok{ stdin}\OperatorTok{);}
  \NormalTok{    Read}\OperatorTok{(}\NormalTok{n}\OperatorTok{)(}\NormalTok{k}\OperatorTok{)(}\NormalTok{q}\OperatorTok{);}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{)} \OperatorTok{\{} \DataTypeTok{int}\NormalTok{ u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{u}\OperatorTok{)(}\NormalTok{v}\OperatorTok{);}\NormalTok{ add}\OperatorTok{(}\NormalTok{u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{);}\NormalTok{ add}\OperatorTok{(}\NormalTok{v}\OperatorTok{,}\NormalTok{ u}\OperatorTok{);} \OperatorTok{\}}\NormalTok{ InitQuery}\OperatorTok{();}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ k}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{,}\NormalTok{ w}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{u}\OperatorTok{)(}\NormalTok{v}\OperatorTok{)(}\NormalTok{w}\OperatorTok{);}
  \NormalTok{        P}\OperatorTok{.}\NormalTok{push\_back}\OperatorTok{(}\DataTypeTok{Path\_t}\OperatorTok{(}\NormalTok{i}\OperatorTok{,}\NormalTok{ u}\OperatorTok{,}\NormalTok{ v}\OperatorTok{,}\NormalTok{ w}\OperatorTok{,} \DecValTok{1}\OperatorTok{));}\NormalTok{ nowv}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
      \OperatorTok{\}}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ q}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ type}\OperatorTok{,}\NormalTok{ a}\OperatorTok{,}\NormalTok{ b}\OperatorTok{;}\NormalTok{ Read}\OperatorTok{(}\NormalTok{type}\OperatorTok{)(}\NormalTok{a}\OperatorTok{);}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{type }\OperatorTok{==} \DecValTok{2}\OperatorTok{)}\NormalTok{ Read}\OperatorTok{(}\NormalTok{b}\OperatorTok{),}\NormalTok{ Q}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \DataTypeTok{Q\_t}\OperatorTok{(}\NormalTok{type}\OperatorTok{,}\NormalTok{ a}\OperatorTok{,}\NormalTok{ b}\OperatorTok{);}
          \ControlFlowTok{else}\NormalTok{ Q}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \DataTypeTok{Q\_t}\OperatorTok{(}\NormalTok{type}\OperatorTok{,}\NormalTok{ a}\OperatorTok{,} \DecValTok{0}\OperatorTok{);}
      \OperatorTok{\}}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ q}\OperatorTok{)\{}
          \DataTypeTok{Q\_t} \OperatorTok{\&}\NormalTok{now }\OperatorTok{=}\NormalTok{ Q}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{now}\OperatorTok{.}\NormalTok{type }\OperatorTok{==} \DecValTok{2}\OperatorTok{)}\NormalTok{ P}\OperatorTok{.}\NormalTok{push\_back}\OperatorTok{(}\DataTypeTok{Path\_t}\OperatorTok{(}\NormalTok{now}\OperatorTok{.}\NormalTok{a}\OperatorTok{,}\NormalTok{ P}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{a }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{].}\NormalTok{u}\OperatorTok{,}\NormalTok{ P}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{a }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{].}\NormalTok{v}\OperatorTok{,}\NormalTok{ now}\OperatorTok{.}\NormalTok{b}\OperatorTok{,} \OperatorTok{++}\NormalTok{nowv}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{a}\OperatorTok{]));}
      \OperatorTok{\}}
      
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ k}\OperatorTok{)}\NormalTok{ Pv}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{resize}\OperatorTok{(}\NormalTok{nowv}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{+} \DecValTok{2}\OperatorTok{);}
  \NormalTok{    sort}\OperatorTok{(}\NormalTok{P}\OperatorTok{.}\NormalTok{begin}\OperatorTok{(),}\NormalTok{ P}\OperatorTok{.}\NormalTok{end}\OperatorTok{(),}\NormalTok{ CMP}\OperatorTok{);}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{0}\OperatorTok{,}\NormalTok{ P}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{)}\NormalTok{ Pv}\OperatorTok{[}\NormalTok{P}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{id}\OperatorTok{][}\NormalTok{P}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{ver}\OperatorTok{]} \OperatorTok{=}\NormalTok{ i }\OperatorTok{+} \DecValTok{1}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ root }\OperatorTok{=}\NormalTok{ Groot}\OperatorTok{(),}\NormalTok{ U}\OperatorTok{;}\NormalTok{ U }\OperatorTok{=}\NormalTok{ P}\OperatorTok{.}\NormalTok{size}\OperatorTok{();}\NormalTok{ build}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ U}\OperatorTok{);} 
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ k}\OperatorTok{)}\NormalTok{ nowv}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ q}\OperatorTok{)\{}
          \DataTypeTok{Q\_t} \OperatorTok{\&}\NormalTok{now }\OperatorTok{=}\NormalTok{ Q}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{now}\OperatorTok{.}\NormalTok{type }\OperatorTok{==} \DecValTok{1}\OperatorTok{)\{}
              \DataTypeTok{int}\NormalTok{ Pl }\OperatorTok{=}\NormalTok{ Pv}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{a}\OperatorTok{][}\NormalTok{nowv}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{a}\OperatorTok{]];}
  \NormalTok{            update}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ U}\OperatorTok{,}\NormalTok{ Pl}\OperatorTok{,} \DecValTok{1}\OperatorTok{);}
          \OperatorTok{\}} \ControlFlowTok{else} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{now}\OperatorTok{.}\NormalTok{type }\OperatorTok{==} \DecValTok{2}\OperatorTok{)\{}
              \DataTypeTok{int}\NormalTok{ Pl0 }\OperatorTok{=}\NormalTok{ Pv}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{a}\OperatorTok{][}\NormalTok{  nowv}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{a}\OperatorTok{]];}
              \DataTypeTok{int}\NormalTok{ Pl1 }\OperatorTok{=}\NormalTok{ Pv}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{a}\OperatorTok{][++}\NormalTok{nowv}\OperatorTok{[}\NormalTok{now}\OperatorTok{.}\NormalTok{a}\OperatorTok{]];}
  \NormalTok{            update}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ U}\OperatorTok{,}\NormalTok{ Pl0}\OperatorTok{,} \DecValTok{1}\OperatorTok{);}
  \NormalTok{            update}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ U}\OperatorTok{,}\NormalTok{ Pl1}\OperatorTok{,} \DecValTok{0}\OperatorTok{);}
          \OperatorTok{\}} \ControlFlowTok{else} \OperatorTok{\{} 
  \NormalTok{            printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ query}\OperatorTok{(}\NormalTok{root}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ U}\OperatorTok{,}\NormalTok{ now}\OperatorTok{.}\NormalTok{a}\OperatorTok{));}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  \paragraph{ÂÅöÊ≥ï‰∏âÔºöCDQ ÂàÜÊ≤ª}\label{ux505aux6cd5ux4e09cdq-ux5206ux6cbb}
  
  Â≠¶‰∫ÜÂÜçËØ¥„ÄÇ
  
  QAQ /kel
  
  \end{document}
[INFO] [makePDF] LaTeX run number 1
[INFO] [makePDF] LaTeX output
  This is XeTeX, Version 3.141592653-2.6-0.999995 (TeX Live 2023/Debian) (preloaded format=xelatex)
   restricted \write18 enabled.
  entering extended mode
  (.../input.tex
  LaTeX2e <2023-11-01> patch level 1
  L3 programming layer <2024-01-22>
  (.../article.cls
  Document Class: article 2023/05/17 v1.4n Standard LaTeX document class
  (.../[system]
  (.../xcolor.sty
  (.../color.cfg)
  (.../xetex.def)
  (.../[system]
  (.../geometry.sty
  (.../keyval.sty)
  (.../ifvtex.sty
  (.../iftex.sty)))
  (.../amsmath.sty
  For additional information on amsmath, use the `?' option.
  (.../amstext.sty
  (.../amsgen.sty))
  (.../amsbsy.sty)
  (.../amsopn.sty))
  (.../amssymb.sty
  (.../amsfonts.sty))
  (.../unicode-math.sty
  (.../expl3.sty
  (.../l3backend-xetex.def))
  (.../unicode-math-xetex.sty
  (.../xparse.sty)
  (.../l3keys2e.sty)
  (.../fontspec.sty
  (.../fontspec-xetex.sty
  (.../fontenc.sty)
  (.../fontspec.cfg)))
  (.../fix-cm.sty
  (.../ts1enc.def))
  (.../unicode-math-table.tex)))
  (.../lmodern.sty)
  (.../xeCJK.sty
  (.../ctexhook.sty)
  (.../xtemplate.sty)
  (.../xeCJK.cfg))
  (.../upquote.sty
  (.../textcomp.sty))
  (.../microtype.sty
  (.../etoolbox.sty)
  (.../microtype-xetex.def)
  (.../microtype.cfg))
  (.../setspace.sty)
  (.../parskip.sty
  (.../kvoptions.sty
  (.../ltxcmds.sty)
  (.../kvsetkeys.sty)))
  (.../fancyvrb.sty)
  (.../bookmark.sty
  (.../hyperref.sty
  (.../kvdefinekeys.sty)
  (.../pdfescape.sty
  (.../pdftexcmds.sty
  (.../infwarerr.sty)))
  (.../hycolor.sty)
  (.../auxhook.sty)
  (.../nameref.sty
  (.../refcount.sty)
  (.../gettitlestring.sty))
  (.../pd1enc.def)
  (.../intcalc.sty)
  (.../puenc.def)
  (.../url.sty)
  (.../bitset.sty
  (.../bigintcalc.sty))
  (.../atbegshi-ltx.sty))
  (.../hxetex.def
  (.../stringenc.sty)
  (.../rerunfilecheck.sty
  (.../atveryend-ltx.sty)
  (.../uniquecounter.sty)))
  (.../bkm-dvipdfm.def))
  (.../xurl.sty)
  No file input.aux.
  *geometry* driver: auto-detecting
  *geometry* detected driver: xetex
  (.../mt-LatinModernRoman.cfg)
  
  Package hyperref Warning: Rerun to get /PageLabels entry.
  
  (.../omllmm.fd)
  (.../umsa.fd)
  (.../mt-msa.cfg)
  (.../umsb.fd)
  (.../mt-msb.cfg)
  
  Package xeCJK Warning: Unknown CJK family `\CJKttdefault' is being ignored.
  (xeCJK)                
  (xeCJK)                Try to use `\setCJKmonofont[<...>]{<...>}' to define
  (xeCJK)                it.
  
  [1]
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/b/n' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 185.
  
  [2] [3] [4] [5] [6] [7] [8] [9] [10]
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/m/it' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 726.
  
  [11] [12] [13] [14] [15] [16] [17] [18]
  Missing character: There is no Ë¢´ (U+88AB) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;+ssty=0;!
  Missing character: There is no Ë¶Ü (U+8986) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;+ssty=0;!
  Missing character: There is no Áõñ (U+76D6) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;+ssty=0;!
  Missing character: There is no ÁöÑ (U+7684) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;+ssty=0;!
  Missing character: There is no Âå∫ (U+533A) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;+ssty=0;!
  Missing character: There is no Èó¥ (U+95F4) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;+ssty=0;!
  Missing character: There is no Êï∞ (U+6570) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;+ssty=0;!
  [19] [20] [21] [22] [23] [24] [25] [26] [27] [28] [29] [30] [31] [32] [33]
  [34]
  Overfull \hbox (9.4617pt too wide) in paragraph at lines 2056--2060
  []\TU/ARPLUKaiCN(0)/m/n/10 Áªô Âá∫ ‰∏Ä ‰∏™ Èïø Â∫¶ ‰∏∫ $[]$ ÁöÑ Â∫è Âàó„ÄÇ|  ËÆæ $[] [] [][] []$Ôºå|  Ê±Ç Âá∫
  Ôºö| \TU/LatinModernRoman(0)/m/n/10 - $[]$ - $[] []$ - $[] []$ 
  [35] [36] [37] [38] [39] [40] [41] [42] [43] [44]
  (.../input.aux)
  
  LaTeX Font Warning: Some font shapes were not available, defaults substituted.
  
  
  LaTeX Warning: Label(s) may have changed. Rerun to get cross-references right.
  
   )
  (see the transcript file for additional information)
  Output written on .../input.pdf (44 pages).
  Transcript written on .../input.log.
[INFO] [makePDF] Rerun needed
  Package hyperref Warning: Rerun to get /PageLabels entry.
  LaTeX Warning: Label(s) may have changed. Rerun to get cross-references right.
[INFO] [makePDF] LaTeX run number 2
[INFO] [makePDF] LaTeX output
  This is XeTeX, Version 3.141592653-2.6-0.999995 (TeX Live 2023/Debian) (preloaded format=xelatex)
   restricted \write18 enabled.
  entering extended mode
  (.../input.tex
  LaTeX2e <2023-11-01> patch level 1
  L3 programming layer <2024-01-22>
  (.../article.cls
  Document Class: article 2023/05/17 v1.4n Standard LaTeX document class
  (.../[system]
  (.../xcolor.sty
  (.../color.cfg)
  (.../xetex.def)
  (.../[system]
  (.../geometry.sty
  (.../keyval.sty)
  (.../ifvtex.sty
  (.../iftex.sty)))
  (.../amsmath.sty
  For additional information on amsmath, use the `?' option.
  (.../amstext.sty
  (.../amsgen.sty))
  (.../amsbsy.sty)
  (.../amsopn.sty))
  (.../amssymb.sty
  (.../amsfonts.sty))
  (.../unicode-math.sty
  (.../expl3.sty
  (.../l3backend-xetex.def))
  (.../unicode-math-xetex.sty
  (.../xparse.sty)
  (.../l3keys2e.sty)
  (.../fontspec.sty
  (.../fontspec-xetex.sty
  (.../fontenc.sty)
  (.../fontspec.cfg)))
  (.../fix-cm.sty
  (.../ts1enc.def))
  (.../unicode-math-table.tex)))
  (.../lmodern.sty)
  (.../xeCJK.sty
  (.../ctexhook.sty)
  (.../xtemplate.sty)
  (.../xeCJK.cfg))
  (.../upquote.sty
  (.../textcomp.sty))
  (.../microtype.sty
  (.../etoolbox.sty)
  (.../microtype-xetex.def)
  (.../microtype.cfg))
  (.../setspace.sty)
  (.../parskip.sty
  (.../kvoptions.sty
  (.../ltxcmds.sty)
  (.../kvsetkeys.sty)))
  (.../fancyvrb.sty)
  (.../bookmark.sty
  (.../hyperref.sty
  (.../kvdefinekeys.sty)
  (.../pdfescape.sty
  (.../pdftexcmds.sty
  (.../infwarerr.sty)))
  (.../hycolor.sty)
  (.../auxhook.sty)
  (.../nameref.sty
  (.../refcount.sty)
  (.../gettitlestring.sty))
  (.../pd1enc.def)
  (.../intcalc.sty)
  (.../puenc.def)
  (.../url.sty)
  (.../bitset.sty
  (.../bigintcalc.sty))
  (.../atbegshi-ltx.sty))
  (.../hxetex.def
  (.../stringenc.sty)
  (.../rerunfilecheck.sty
  (.../atveryend-ltx.sty)
  (.../uniquecounter.sty)))
  (.../bkm-dvipdfm.def))
  (.../xurl.sty)
  (.../input.aux)
  *geometry* driver: auto-detecting
  *geometry* detected driver: xetex
  (.../mt-LatinModernRoman.cfg)
  (.../omllmm.fd)
  (.../umsa.fd)
  (.../mt-msa.cfg)
  (.../umsb.fd)
  (.../mt-msb.cfg)
  
  Package xeCJK Warning: Unknown CJK family `\CJKttdefault' is being ignored.
  (xeCJK)                
  (xeCJK)                Try to use `\setCJKmonofont[<...>]{<...>}' to define
  (xeCJK)                it.
  
  [1]
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/b/n' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 185.
  
  [2] [3] [4] [5] [6] [7] [8] [9] [10]
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/m/it' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 726.
  
  [11] [12] [13] [14] [15] [16] [17] [18]
  Missing character: There is no Ë¢´ (U+88AB) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;+ssty=0;!
  Missing character: There is no Ë¶Ü (U+8986) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;+ssty=0;!
  Missing character: There is no Áõñ (U+76D6) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;+ssty=0;!
  Missing character: There is no ÁöÑ (U+7684) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;+ssty=0;!
  Missing character: There is no Âå∫ (U+533A) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;+ssty=0;!
  Missing character: There is no Èó¥ (U+95F4) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;+ssty=0;!
  Missing character: There is no Êï∞ (U+6570) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;+ssty=0;!
  [19] [20] [21] [22] [23] [24] [25] [26] [27] [28] [29] [30] [31] [32] [33]
  [34]
  Overfull \hbox (9.4617pt too wide) in paragraph at lines 2056--2060
  []\TU/ARPLUKaiCN(0)/m/n/10 Áªô Âá∫ ‰∏Ä ‰∏™ Èïø Â∫¶ ‰∏∫ $[]$ ÁöÑ Â∫è Âàó„ÄÇ|  ËÆæ $[] [] [][] []$Ôºå|  Ê±Ç Âá∫
  Ôºö| \TU/LatinModernRoman(0)/m/n/10 - $[]$ - $[] []$ - $[] []$ 
  [35] [36] [37] [38] [39] [40] [41] [42] [43] [44]
  (.../input.aux)
  
  LaTeX Font Warning: Some font shapes were not available, defaults substituted.
  
   )
  (see the transcript file for additional information)
  Output written on .../input.pdf (44 pages).
  Transcript written on .../input.log.
[WARNING] Missing character: There is no Ë¢´ (U+88AB) (U+88AB) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no Ë¶Ü (U+8986) (U+8986) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no Áõñ (U+76D6) (U+76D6) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no ÁöÑ (U+7684) (U+7684) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no Âå∫ (U+533A) (U+533A) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no Èó¥ (U+95F4) (U+95F4) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no Êï∞ (U+6570) (U+6570) in font LatinModernMath-Regular/OT:sc
</pre>
                                            </details>
                    
                                    </div>
                                </article>
                

                

                

                

            

                
                        </div>
                    </main>
            </div>

                <!-- Footer -->
                <footer id="footer">
                    <p>¬© 2025 ShuYuMo's Blog by Jiayi Su. All rights reserved.</p>  Powered by <b>MonoPy</b> - Single-Script Blog Generator in Python.
                </footer>
            </div>
        </div>
        
        <!-- Back to top button -->
        <button id="back-to-top" 
                aria-label="Back to top" 
                title="Back to top"
                style="display: none;">
            ‚Üë
        </button>
        
        <!-- JavaScript -->
        <script>
            // Back to top functionality
            (function() {
                const backToTopButton = document.getElementById('back-to-top');
                const scrollThreshold = 300;
                
                function toggleBackToTop() {
                    if (window.scrollY > scrollThreshold) {
                        backToTopButton.style.display = 'block';
                    } else {
                        backToTopButton.style.display = 'none';
                    }
                }
                
                function scrollToTop() {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                }
                
                window.addEventListener('scroll', toggleBackToTop);
                backToTopButton.addEventListener('click', scrollToTop);
            })();
            
            // Clean up redundant spans in code blocks
            document.querySelectorAll('pre code').forEach(codeBlock => {
                // Find all line spans
                const lineSpans = codeBlock.querySelectorAll('span[id^="cb"]');
                
                lineSpans.forEach(lineSpan => {
                    // Check if this line has nested spans that can be simplified
                    const children = Array.from(lineSpan.childNodes);
                    
                    // Skip the anchor link (first child is usually the line number anchor)
                    let contentStart = 0;
                    if (children[0] && children[0].tagName === 'A') {
                        contentStart = 1;
                    }
                    
                    // If there's only one span child after the anchor, unwrap it
                    const contentChildren = children.slice(contentStart);
                    if (contentChildren.length === 1 && contentChildren[0].tagName === 'SPAN') {
                        const spanChild = contentChildren[0];
                        // Move the span's contents directly to the line span
                        while (spanChild.firstChild) {
                            lineSpan.insertBefore(spanChild.firstChild, spanChild);
                        }
                        // Remove the now-empty span
                        spanChild.remove();
                    }
                });
            });
            
            // Code copy functionality
            document.querySelectorAll('pre code').forEach(block => {
                const button = document.createElement('button');
                button.className = 'copy-button';
                button.textContent = 'Copy';
                button.setAttribute('aria-label', 'Copy code to clipboard');
                
                button.addEventListener('click', function() {
                    navigator.clipboard.writeText(block.textContent).then(() => {
                        button.textContent = 'Copied!';
                        setTimeout(() => button.textContent = 'Copy', 2000);
                    }).catch(() => {
                        // Fallback for older browsers
                        const textArea = document.createElement('textarea');
                        textArea.value = block.textContent;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        button.textContent = 'Copied!';
                        setTimeout(() => button.textContent = 'Copy', 2000);
                    });
                });
                
                const pre = block.parentNode;
                pre.style.position = 'relative';
                pre.appendChild(button);
            });
        </script>
    </body>
</html>