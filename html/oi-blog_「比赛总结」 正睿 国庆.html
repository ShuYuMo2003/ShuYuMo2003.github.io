<!-- Academic Blog Template
MIT License - Copyright (c) 2025 Su Jiayi <sujiayi2003@gmail.com>
-->

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        
        <!-- Primary Meta Tags -->
        <title>ShuYuMo&#39;s Blog | Jiayi Su</title>
        <meta name="description" content="‰∏Ä‰∫õÂ•áÂ•áÊÄ™ÊÄ™ÁöÑ INFP ÈöèÁ¢éÁ¢éÂøµ„ÄÇ">
        <meta name="keywords" content="nb1, nb2, nb3">
        <meta name="author" content="Su Jiayi">
        
        <!-- Open Graph Meta Tags -->
        <meta property="og:type" content="website">
        <meta property="og:title" content="ShuYuMo&#39;s Blog | Jiayi Su">
        <meta property="og:description" content="‰∏Ä‰∫õÂ•áÂ•áÊÄ™ÊÄ™ÁöÑ INFP ÈöèÁ¢éÁ¢éÂøµ„ÄÇ">
        <meta property="og:image" content="../static/images/header.jpg">
        
        <!-- Stylesheets -->
        <link rel="stylesheet" type="text/css" href="../static/css/default.css">
        <link rel="stylesheet" type="text/css" href="../static/css/syntax.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
        
        <!-- Google Analytics -->
        
    </head>
    <body>
        <!-- Skip to main content for accessibility -->
        <a href="#main-content" class="skip-link">Skip to main content</a>
        
        <div id="main">
            <div class="main-container">
                <!-- Header -->
                <header id="header">
                    <div class="header-content">
                        <h1 class="header-title">
                            <a href="./">ShuYuMo&#39;s Blog</a>
                        </h1>
                        <p class="header-subtitle">‰∏Ä‰∫õÂ•áÂ•áÊÄ™ÊÄ™ÁöÑ INFP ÈöèÁ¢éÁ¢éÂøµ„ÄÇ</p>
                        <div class="header-accent"></div>
                    </div>
                </header>
                
                <!-- Content Layout -->
                <div class="content-wrapper">
                    <!-- Sidebar -->
                    <nav id="sidebar">
                        <div class="profile-section">
                            <a href="./" class="profile-avatar-link">
                                <img src="../static/images/header.jpg" alt="ShuYuMo&#39;s header" class="profile-avatar" loading="lazy" />
                            </a>
                            <div class="profile-info">
                                <h3 class="profile-name">Jiayi Su (ShuYuMo)</h3>
            </div>
            </div>

                        <div class="nav-header">
                            <h2>üß≠ Navigation</h2>
                            <span class="nav-subtitle">Explore the site</span>
                        </div>
                        <nav class="nav-menu">
                            
                            
                            <a href="./_post.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">Posts</span>
                                
                            </a>
                            
                            
                            <a href="./_archive.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">Archive</span>
                                
                            </a>
                            
                            
                            <a href="./_category.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">Category</span>
                                
                            </a>
                            
                            
                            <a href="./_about.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">üìÑ</span>
                                <span class="nav-text">About</span>
                                
                            </a>
                            
                        </nav>
                    </nav>

                    <!-- Main Content -->
                    <main id="content">
                        <div id="main-content">
                            
                                <article>
                                    <!-- Article Header with Title and Actions -->
                                    <div class="article-header">
                                        <div class="article-title-section">
                                            
                                                <h1 class="article-title">„ÄåÊØîËµõÊÄªÁªì„Äç Ê≠£Áùø ÂõΩÂ∫Ü</h1>
                                            
                                            
                                            <!-- Article Meta Information -->
                                            <div class="article-meta">
                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">üìÖ</span>
                                                        <span class="meta-label">Last Updated: </span>
                                                        <span class="meta-value">2020-11-18</span>
                                                    </div>
                                                
                                                
                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">üìä</span>
                                                        <span class="meta-label">Word Count: </span>
                                                        <span class="meta-value">118</span>
                                                    </div>
                    

                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">‚è±Ô∏è</span>
                                                        <span class="meta-label">Estimated Reading Time: </span>
                                                        <span class="meta-value">1 minutes</span>
                                                    </div>
                                                
                                            </div>
                                        </div>
                                        
                                        <div class="article-actions">
                    
                                                <a href="../pdf/oi-blog_„ÄåÊØîËµõÊÄªÁªì„Äç Ê≠£Áùø ÂõΩÂ∫Ü.pdf" 
                                                   target="_blank" 
                                                   rel="noopener"
                                                   class="action-btn pdf-btn">
                                                    üìÑ PDF
                                                </a>
                                            
                                            
                                            
                                                <a href="../src/oi-blog/„ÄåÊØîËµõÊÄªÁªì„Äç Ê≠£Áùø ÂõΩÂ∫Ü.md" 
                                                   target="_blank" 
                                                   rel="noopener"
                                                   class="action-btn source-btn">
                                                    üìù Source
                                                </a>
                                            
                                        </div>
                                    </div>

                                    <!-- Article Content -->
                                    <div class="article-content">
                                        <p><a href="http://zhengruioi.com/contest/766/problem/394">link</a></p>
<p>ÁªôÂá∫‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑ <code>01</code> ‰∏≤
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>
ÂíåÊï¥Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÔºåÊ±Ç‰∏Ä‰∏™
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>
ÊúÄÈïøÁöÑÂ≠ê‰∏≤
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>
‰ΩøÂæó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>
‰∏≠ <code>0</code> ÁöÑ‰∏™Êï∞ÊòØ <code>1</code> ÁöÑ‰∏™Êï∞ÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
ÂÄçÔºåËæìÂá∫ÊúÄÈïøÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>
ÁöÑÈïøÂ∫¶„ÄÇ</p>
<!-- more -->
<p>ËÆæ$ S_0[i]$ Ë°®Á§∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">S[1..i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">[</span><span class="mord">1..</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>‰∏≠
<code>0</code>ÁöÑÊï∞Èáè„ÄÇ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">S_1[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>
Ë°®Á§∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">S[1..i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">[</span><span class="mord">1..</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>‰∏≠
<code>1</code>ÁöÑÊï∞Èáè„ÄÇ Â≠ó‰∏≤
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">[</mo><mi>L</mi><mo separator="true">,</mo><mi>R</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">S[L, R]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">]</span></span></span></span>
Êª°Ë∂≥Êù°‰ª∂ÂΩì‰∏î‰ªÖÂΩì
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub><mo stretchy="false">[</mo><mi>R</mi><mo stretchy="false">]</mo><mo>‚àí</mo><msub><mi>S</mi><mn>0</mn></msub><mo stretchy="false">[</mo><mi>L</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>S</mi><mn>1</mn></msub><mo stretchy="false">[</mo><mi>R</mi><mo stretchy="false">]</mo><mo>‚àí</mo><msub><mi>S</mi><mn>1</mn></msub><mo stretchy="false">[</mo><mi>L</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>√ó</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">S_0[R] - S_0[L - 1] = (S_1[R] - S_1[L - 1]) \times k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">])</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>„ÄÇ
Âç≥Ôºö<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub><mo stretchy="false">[</mo><mi>R</mi><mo stretchy="false">]</mo><mo>‚àí</mo><msub><mi>S</mi><mn>1</mn></msub><mo stretchy="false">[</mo><mi>R</mi><mo stretchy="false">]</mo><mo>√ó</mo><mi>k</mi><mo>=</mo><msub><mi>S</mi><mn>0</mn></msub><mo stretchy="false">[</mo><mi>L</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">]</mo><mo>‚àí</mo><msub><mi>S</mi><mn>1</mn></msub><mo stretchy="false">[</mo><mi>L</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">]</mo><mo>√ó</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">S_0[R] - S_1[R] \times k = S_0[L - 1] - S_1[L - 1] \times k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>„ÄÇ</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define i64 </span><span class="dt">long</span><span class="pp"> </span><span class="dt">long</span><span class="pp"> </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _ <span class="op">=</span> <span class="fl">1e6</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> k<span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> S<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> S0<span class="op">[</span>_<span class="op">],</span> S1<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>map<span class="op">&lt;</span><span class="dt">long</span> <span class="dt">long</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span>M<span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    ios<span class="op">::</span>sync_with_stdio<span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    cin <span class="op">&gt;&gt;</span> n <span class="op">&gt;&gt;</span> k <span class="op">&gt;&gt;</span> <span class="op">(</span>S <span class="op">+</span> <span class="dv">1</span><span class="op">);</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> S0<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> S0<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span>S<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> <span class="ch">&#39;0&#39;</span><span class="op">),</span> S1<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> S1<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span>S<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> <span class="ch">&#39;1&#39;</span><span class="op">);</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span>  </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    M<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        i64 now <span class="op">=</span> S0<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span><span class="dv">0</span><span class="bu">ll</span><span class="op">-</span> k <span class="op">*</span><span class="dv">1</span><span class="bu">ll</span><span class="op">*</span> S1<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>M<span class="op">.</span>count<span class="op">(</span>now<span class="op">))</span> ans <span class="op">=</span> max<span class="op">(</span>ans<span class="op">,</span> i <span class="op">-</span> M<span class="op">[</span>now<span class="op">]);</span>  <span class="cf">else</span> M<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span> cerr <span class="op">&lt;&lt;</span> <span class="st">&quot;std&#39;s ans = &quot;</span> <span class="op">&lt;&lt;</span> ans <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Êúâ‰∏§‰∏™ÈïøÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÊéíÂàó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A,B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>
Ôºå‰Ω†ÊØèÊ¨°ÂèØ‰ª•ËøõË°å‰∏âÁßçÊìç‰ΩúÔºö - Âà†Èô§
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>
ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>
- Âà†Èô§
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>
ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>
- Âà†Èô§
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>
ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>
Âíå
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>
ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>
ÔºåË¶ÅÊ±Ç
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo mathvariant="normal">‚â†</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a\neq b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel">ÓÄ†</span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>
Ê±ÇÊää
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A,B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>
ÈÉΩÂà†ÂÖâÈúÄË¶ÅÁöÑÊúÄÂ∞ëÊìç‰ΩúÊ¨°Êï∞„ÄÇ</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">n \le 10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></p>
<!-- more -->
<p>ÂΩìÊï∞Âàó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A, B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>
ÁöÑÈ¶ñÈ°πÁõ∏ÂêåÁöÑÊó∂ÂÄôÔºåÁõ¥Êé•Ë¥™ÂøÉÁöÑÈÄâÊã©Êìç‰Ωú 3 „ÄÇÈúÄË¶ÅÂÜ≥Á≠ñÂΩì
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A, B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>
È¶ñÈ°πÁõ∏ÂêåÁöÑÊó∂ÂÄôÈÄâÊã©Âà†Èô§ÈÇ£ËæπÁöÑÔºåÁÑ∂ÂêéÂèàÂèØ‰ª•‰∏ÄÁõ¥Âà†ÔºåÁõ¥Âà∞È¶ñÈ°πÂÜçÊ¨°Áõ∏ÂêåÁöÑÊó∂ÂÄô
ÂÜçÂÜ≥Á≠ñÔºåÁõ¥Êé•DPÂèØËÉΩË¢´<strong>Âç°‰Ωè</strong>ÁöÑÂú∞ÊñπÂç≥ÂèØ„ÄÇ</p>
<p>ËÆæÊï∞Â≠ó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
Âú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>
‰∏≠ÁöÑ‰ΩçÁΩÆÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ÔºåÂú®
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>
‰∏≠ÁöÑ‰ΩçÁΩÆÊòØ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>ÔºåËÆ∞
Êï∞Â≠ó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
ÁöÑ‰ΩçÁΩÆ‰∏∫‰∫åÂÖÉÁªÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>„ÄÇÁî±‰∫é
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A , B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>
ÊòØ‰∏§‰∏™ÊéíÂàóÔºåÂØπ‰∫éÊï∞Â≠ó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
ÔºåÂÖ∂‰ΩçÁΩÆ‰∏ÄÂÆöÊòØÂîØ‰∏ÄÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>„ÄÇ
ËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">dp</mi><mo>‚Å°</mo><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\operatorname{dp}[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">dp</span></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>
‰∏∫ (ËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
ÁöÑ‰ΩçÁΩÆ‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>
) ÔºåÂà†ÂÖâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">A[i..n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mord">..</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>
Âíå
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo stretchy="false">[</mo><mi>j</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">B[j..n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mord">..</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>
ÁöÑ‰ª£‰ª∑„ÄÇ</p>
<p>ÂØπ‰∫éÊï∞ÂÄº
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>
ÁöÑ‰ΩçÁΩÆ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>
ËÆæ $= i - j
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>„ÄÇÁî±‰∫éÊéíÂàóÁöÑÊÄßË¥®Ôºå</mtext></mrow><annotation encoding="application/x-tex">„ÄÇÁî±‰∫éÊéíÂàóÁöÑÊÄßË¥®Ôºå</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">„ÄÇÁî±‰∫éÊéíÂàóÁöÑÊÄßË¥®Ôºå</span></span></span></span>dp[i]<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>„ÄÅ</mtext></mrow><annotation encoding="application/x-tex">„ÄÅ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">„ÄÅ</span></span></span></span>A_i$
ÁöÑ‰ΩçÁΩÆ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>Ëøô‰∫õÊòØ‰∏Ä‰∏ÄÂØπÂ∫îÁöÑ„ÄÇËÆæ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Œî</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Delta(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Œî</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>
‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span>
ÂØπÂ∫îÁöÑ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Œî</mi></mrow><annotation encoding="application/x-tex">\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Œî</span></span></span></span>„ÄÇ</p>
<p>ËΩ¨ÁßªÂ∞±ÊòØ</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mn>1</mn><mo>+</mo><munder><mrow><mi>min</mi><mo>‚Å°</mo></mrow><mrow><mi mathvariant="normal">Œî</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Œî</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">Œî</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Œî</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow></munder><mrow><mo stretchy="false">{</mo><mtext>¬†</mtext><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>+</mo><mi mathvariant="normal">dist</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext>¬†¬†</mtext><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>+</mo><mi mathvariant="normal">dist</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mtext>¬†</mtext><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">dp[i] = 1 + \min_{\Delta(x) = \Delta(i) - 1, \Delta(y) = \Delta(i) + 1}\limits{\{\ dp[x] + \operatorname{dist}(i, x),\ \ dp[y] + \operatorname{dist}(i, y)}\ \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.716em;vertical-align:-0.966em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.309em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Œî</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span><span class="mrel mtight">=</span><span class="mord mtight">Œî</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">Œî</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span><span class="mrel mtight">=</span><span class="mord mtight">Œî</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.966em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">{</span><span class="mspace">¬†</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop"><span class="mord mathrm">dist</span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace">¬†</span><span class="mspace">¬†</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop"><span class="mord mathrm">dist</span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span><span class="mspace">¬†</span><span class="mclose">}</span></span></span></span>„ÄÇ</p>
<p>‰ªéÂêéÂæÄÂâç
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">dp</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span></span></span></span>
ËÆ∞ÂΩï‰ª•‰∏ã
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Œî</mi></mrow><annotation encoding="application/x-tex">\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Œî</span></span></span></span>
Âç≥ÂèØ„ÄÇ ‰∏∫‰∫ÜÊñπ‰æøÔºåÂÖ∂‰∏≠
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Last</mi><mo>‚Å°</mo></mrow><annotation encoding="application/x-tex">\operatorname{Last}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mop"><span class="mord mathrm">Last</span></span></span></span></span>
‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Œî</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Delta()</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Œî</span><span class="mopen">(</span><span class="mclose">)</span></span></span></span>
ÁöÑÂèçÂáΩÊï∞„ÄÇ</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> A<span class="op">[</span>_<span class="op">],</span> B<span class="op">[</span>_<span class="op">],</span> POOL<span class="op">[(</span>_ <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="dv">100</span><span class="op">],</span> PosInB<span class="op">[</span>_<span class="op">],</span> <span class="op">*</span>Last <span class="op">=</span> <span class="op">&amp;</span>POOL<span class="op">[</span>_ <span class="op">+</span> <span class="dv">10</span><span class="op">];</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dp<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n <span class="op">=</span> read<span class="op">())</span> Read<span class="op">(</span>A<span class="op">[</span>i<span class="op">]);</span> rep<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> Read<span class="op">(</span>B<span class="op">[</span>i<span class="op">]),</span> PosInB<span class="op">[</span>B<span class="op">[</span>i<span class="op">]]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    clear<span class="op">(</span>dp<span class="op">,</span> <span class="bn">0x3f</span><span class="op">);</span> clear<span class="op">(</span>POOL<span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    per<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> det <span class="op">=</span> i <span class="op">-</span> PosInB<span class="op">[</span>A<span class="op">[</span>i<span class="op">]];</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>Last<span class="op">[</span>det <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> to_min<span class="op">(</span>dp<span class="op">[</span>i<span class="op">],</span> dp<span class="op">[</span>Last<span class="op">[</span>det <span class="op">+</span> <span class="dv">1</span><span class="op">]]</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> <span class="op">(</span>Last<span class="op">[</span>det <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">-</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">)));</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> to_min<span class="op">(</span>dp<span class="op">[</span>i<span class="op">],</span> <span class="dv">1</span> <span class="op">+</span> max<span class="op">(</span>n <span class="op">-</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> n <span class="op">-</span> <span class="op">(</span>PosInB<span class="op">[</span>A<span class="op">[</span>i<span class="op">]])</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">));</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>Last<span class="op">[</span>det <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> to_min<span class="op">(</span>dp<span class="op">[</span>i<span class="op">],</span> dp<span class="op">[</span>Last<span class="op">[</span>det <span class="op">-</span> <span class="dv">1</span><span class="op">]]</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> <span class="op">(</span>Last<span class="op">[</span>det <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">-</span> <span class="op">(</span>i<span class="op">)));</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> to_min<span class="op">(</span>dp<span class="op">[</span>i<span class="op">],</span> <span class="dv">1</span> <span class="op">+</span> max<span class="op">(</span>n <span class="op">-</span> <span class="op">(</span>i<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> n <span class="op">-</span> <span class="op">(</span>PosInB<span class="op">[</span>A<span class="op">[</span>i<span class="op">]]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">));</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        Last<span class="op">[</span>det<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>Last<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> ans <span class="op">=</span> n<span class="op">;</span> <span class="cf">else</span> ans <span class="op">=</span> dp<span class="op">[</span>Last<span class="op">[</span><span class="dv">0</span><span class="op">]]</span> <span class="op">+</span> Last<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>ÂØπ‰∫éÈïøÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>
ÁöÑÁΩÆÊç¢
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A,B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>
ÔºåÊ±ÇÊòØÂê¶Â≠òÂú®Ê≠£Êï¥Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>
‰ΩøÂæó
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mi>k</mi></msup><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A^k=B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></p>
<p>ÂÆö‰πâÁΩÆÊç¢ÁöÑ‰πòÊ≥ï‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo>‚ãÖ</mo><mi>B</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><msub><mi>A</mi><msub><mi>B</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">C = (A \cdot B), C_i=A_{B_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚ãÖ</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0502em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>ÂÆö‰πâ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mn>1</mn></msup><mo>=</mo><mi>A</mi><mo separator="true">,</mo><msup><mi>A</mi><mi>n</mi></msup><mo>=</mo><msup><mi>A</mi><mrow><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚ãÖ</mo><mi>A</mi><mo stretchy="false">(</mo><mi>n</mi><mo>&gt;</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A^1=A,A^n=A^{n-1} \cdot A(n &gt; 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚ãÖ</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p>
<p>Â¶ÇÊûúÂ≠òÂú® <code>k</code> ËæìÂá∫ <code>Yes</code> Âê¶ÂàôËæìÂá∫
<code>No</code> „ÄÇ</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">n \le 10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></p>
<!-- more -->
<p>ÂèØ‰ª•ËΩ¨Âåñ‰∏∫ÂØπÁ∫øÊÄßÂêå‰∫éÊñπÁ®ãÂà§Êñ≠ÊòØÂê¶ÊúâËß£ÁöÑÈóÆÈ¢ò„ÄÇ</p>
<p>ËøôÈáåÁöÑÁ∫øÊÄßÂêå‰∫éÊñπÁ®ãÁªÑÁöÑÊ®°Êï∞
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚â§</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">\le 10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span>
‰∏î‰∏ç‰∫íË¥®Ôºå<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>C</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">LCM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.10903em;">CM</span></span></span></span>
ÂæàÂ§ß Êó†Ê≥ï
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi><mi>C</mi><mi>R</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">exCRT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.13889em;">CRT</span></span></span></span>
ÂêàÂπ∂„ÄÇ</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">log</mi><mo>‚Å°</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \operatorname{log} n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em;">log</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>Ôºö
‰ªé
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mtext>¬†</mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">1 ~ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace nobreak">¬†</span><span class="mord mathnormal">n</span></span></span></span>
Êûö‰∏æ
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>
Â∞ùËØïÊ±ÇÂá∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi mathvariant="normal">mod</mi><mo>‚Å°</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">x \operatorname{mod} i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm">mod</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span></span></span></span>
ÁöÑÊï∞ÂÄºÔºåÊòìÁü• Ëøô‰∏™ÂÄºÂèØ‰ª•‰ªé
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi mathvariant="normal">mod</mi><mo>‚Å°</mo><mi>k</mi><mover accent="true"><mi>i</mi><mo>Àô</mo></mover></mrow><annotation encoding="application/x-tex">x \operatorname{mod} k \dot i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8964em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm">mod</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8964em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">i</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1389em;"><span class="mord">Àô</span></span></span></span></span></span></span></span></span></span>
ÁöÑÂÄºÂæóÂà∞ÔºåÊ£ÄÊü•ÊñπÁ®ãÁªÑ‰∏≠ÊâÄÊúâÁöÑÊñπÁ®ãÔºåÁúãÁúãÊòØÂê¶ÂÜ≤Á™ÅÂç≥ÂèØ„ÄÇÊ†πÊçÆË∞ÉÂíåÁ∫ßÊï∞ÔºåËøôÊ†∑ÂÅöÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">log</mi><mo>‚Å°</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \operatorname{log} n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em;">log</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>„ÄÇ</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define i64 </span><span class="dt">long</span><span class="pp"> </span><span class="dt">long</span><span class="pp"> </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define walk</span><span class="op">(</span>now<span class="op">,</span><span class="pp"> </span>ex<span class="op">)</span><span class="pp"> </span><span class="cf">for</span><span class="op">(</span><span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span>head<span class="op">[</span>now<span class="op">],</span><span class="pp"> </span>ex<span class="op">;</span><span class="pp"> </span>ex<span class="pp"> </span><span class="op">=</span><span class="pp"> </span>edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">,</span><span class="pp"> </span>i<span class="op">;</span><span class="pp"> </span>i<span class="pp"> </span><span class="op">=</span><span class="pp"> </span>edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> vis<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> G<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> D<span class="op">[</span>_<span class="op">],</span> SZ<span class="op">[</span>_<span class="op">],</span> BL<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> Dis<span class="op">[</span>_<span class="op">],</span> MD<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cnt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> clear<span class="op">(){</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    memset<span class="op">(</span>head<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>head<span class="op">));</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    memset<span class="op">(</span>vis<span class="op">,</span> <span class="kw">false</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>vis<span class="op">));</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> cnt<span class="op">;</span> i<span class="op">++)</span> G<span class="op">[</span>i<span class="op">].</span>clear<span class="op">();</span> cnt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> now<span class="op">,</span> <span class="dt">int</span> target<span class="op">){</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    G<span class="op">[</span>target<span class="op">].</span>push_back<span class="op">(</span>now<span class="op">);</span>  vis<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    walk<span class="op">(</span>now<span class="op">,</span> ex<span class="op">)</span> <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>vis<span class="op">[</span>ex<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span> dfs<span class="op">(</span>ex<span class="op">,</span> target<span class="op">);</span> <span class="op">}</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> CMP<span class="op">(</span><span class="at">const</span> pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> <span class="op">&amp;</span> A<span class="op">,</span> <span class="at">const</span> pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> <span class="op">&amp;</span> B<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> A<span class="op">.</span>fi <span class="op">&lt;</span> B<span class="op">.</span>fi<span class="op">;</span> <span class="op">}</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> pos<span class="op">[</span>_<span class="op">];</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> PdExist<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>Md<span class="op">,</span> <span class="dt">int</span> <span class="op">*</span>a<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> vector<span class="op">&lt;</span> pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span> <span class="op">&gt;</span> <span class="op">&gt;</span> M<span class="op">,</span> M0<span class="op">;</span> M<span class="op">.</span>clear<span class="op">();</span> M0<span class="op">.</span>clear<span class="op">();</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> M<span class="op">.</span>push_back<span class="op">(</span>make_pair<span class="op">(</span>Md<span class="op">[</span>i<span class="op">],</span> a<span class="op">[</span>i<span class="op">]));</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>M<span class="op">.</span>begin<span class="op">(),</span> M<span class="op">.</span>end<span class="op">(),</span> CMP<span class="op">);</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> M<span class="op">.</span>size<span class="op">();</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> L <span class="op">=</span> i<span class="op">,</span> R <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(</span>R <span class="op">+</span> <span class="dv">1</span> <span class="op">&lt;</span> M<span class="op">.</span>size<span class="op">()</span> <span class="op">&amp;&amp;</span> M<span class="op">[</span>L<span class="op">].</span>fi <span class="op">==</span> M<span class="op">[</span>R <span class="op">+</span> <span class="dv">1</span><span class="op">].</span>fi<span class="op">)</span> R<span class="op">++;</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> L<span class="op">;</span> j <span class="op">&lt;=</span> R<span class="op">;</span> j<span class="op">++)</span> <span class="cf">if</span><span class="op">(</span>M<span class="op">[</span>j<span class="op">].</span>se <span class="op">!=</span> M<span class="op">[</span>L<span class="op">].</span>se<span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        M0<span class="op">.</span>push_back<span class="op">(</span>M<span class="op">[</span>L<span class="op">]);</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> R<span class="op">;</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    memset<span class="op">(</span>pos<span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>pos<span class="op">));</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> MAX <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> M0<span class="op">.</span>size<span class="op">();</span> i<span class="op">++)</span> MAX <span class="op">=</span> max<span class="op">(</span>MAX<span class="op">,</span> M0<span class="op">[</span>i<span class="op">].</span>fi<span class="op">),</span> pos<span class="op">[</span>M0<span class="op">[</span>i<span class="op">].</span>fi<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> MAX<span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> tmp <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i<span class="op">;</span> j <span class="op">&lt;=</span> MAX<span class="op">;</span> j <span class="op">+=</span> i<span class="op">)</span> <span class="cf">if</span><span class="op">(</span>pos<span class="op">[</span>j<span class="op">]</span> <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>tmp <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> tmp <span class="op">=</span> M0<span class="op">[</span>pos<span class="op">[</span>j<span class="op">]].</span>se <span class="op">%</span> i<span class="op">;</span> <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>tmp <span class="op">!=</span> M0<span class="op">[</span>pos<span class="op">[</span>j<span class="op">]].</span>se <span class="op">%</span> i<span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> doit<span class="op">(){</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    clear<span class="op">();</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> add<span class="op">(</span>A<span class="op">[</span>i<span class="op">],</span> i<span class="op">);</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="cf">if</span><span class="op">(!</span>vis<span class="op">[</span>i<span class="op">])</span> dfs<span class="op">(</span>i<span class="op">,</span> <span class="op">++</span>cnt<span class="op">);</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> cnt<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> G<span class="op">[</span>i<span class="op">].</span>size<span class="op">();</span> j<span class="op">++){</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>            D<span class="op">[</span>G<span class="op">[</span>i<span class="op">][</span>j<span class="op">]]</span> <span class="op">=</span> j<span class="op">;</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>            SZ<span class="op">[</span>G<span class="op">[</span>i<span class="op">][</span>j<span class="op">]]</span> <span class="op">=</span> G<span class="op">[</span>i<span class="op">].</span>size<span class="op">();</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>            BL<span class="op">[</span>G<span class="op">[</span>i<span class="op">][</span>j<span class="op">]]</span> <span class="op">=</span> i<span class="op">;</span>    </span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="cf">if</span><span class="op">(</span>BL<span class="op">[</span>A<span class="op">[</span>i<span class="op">]]</span> <span class="op">!=</span> BL<span class="op">[</span>B<span class="op">[</span>i<span class="op">]])</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>puts<span class="op">(</span><span class="st">&quot;No&quot;</span><span class="op">);}</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> Dis<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span> D<span class="op">[</span>B<span class="op">[</span>i<span class="op">]]</span> <span class="op">-</span> D<span class="op">[</span>A<span class="op">[</span>i<span class="op">]]</span> <span class="op">+</span> SZ<span class="op">[</span>A<span class="op">[</span>i<span class="op">]]</span> <span class="op">)</span> <span class="op">%</span> SZ<span class="op">[</span>A<span class="op">[</span>i<span class="op">]];</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> MD<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> SZ<span class="op">[</span>A<span class="op">[</span>i<span class="op">]];</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> r <span class="op">=</span> PdExist<span class="op">(</span>MD<span class="op">,</span> Dis<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">)</span>puts<span class="op">(</span>r <span class="op">?</span> <span class="st">&quot;Yes&quot;</span> <span class="op">:</span> <span class="st">&quot;No&quot;</span><span class="op">);</span> </span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">)</span> <span class="op">==</span> <span class="dv">1</span><span class="op">){</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> Read<span class="op">(</span>A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> Read<span class="op">(</span>B<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>        doit<span class="op">();</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
                                    </div>

                                    <!-- Article Footer -->
                                    <div class="article-footer">
                                                                            
                                        <section class="post-history">
                                            <div class="history-header">
                                                <h2>üìö Version History</h2>
                                                <span class="history-desc">Source Code Change History</span>
                                            </div>
                                            <div class="version-list">
                                                
                                                    <div class="version-item">
                                                        <div class="version-header">
                                                            <span class="version-badge">v1</span>
                                                            <time class="version-time" datetime="2020-11-18 11:41:50">
                                                                üìÖ 2020-11-18 11:41:50
                                                            </time>
                                                        </div>
                                                        <div class="version-hash-container">
                                                            <span class="hash-label">üîó Source Hash:</span>
                                                            <code class="version-hash" title="Source Code Hash (13978c5cc684e8804494290eab88099f9899e9618a11002427b5376b8a50f24c)">13978c5cc684e8804494290eab88099f9899e9618a11002427b5376b8a50f24c</code>
                                                        </div>
                                                    </div>
                                                
                                            </div>
                                        </section>
                    

                    
                                            <details class="build-logs">
                                                <summary>Build Logs</summary>
                                                <pre class="logs-content">Build Log - Filtered
================================================

üìã Information:
‚Ä¢ Path information has been filtered for privacy protection
‚Ä¢ File names are preserved for debugging purposes  
‚Ä¢ All build status and error messages are kept intact

üîç Filter Rules:
‚Ä¢ /absolute/path/file.ext ‚Üí .../file.ext
‚Ä¢ /home/username ‚Üí .../[user]
‚Ä¢ /tmp/files ‚Üí .../[temp]
‚Ä¢ /usr/share/packages ‚Üí .../[system]

================================================

html log:
CMD: ['pandoc', '-s', 'cache/oi-blog_„ÄåÊØîËµõÊÄªÁªì„Äç Ê≠£Áùø ÂõΩÂ∫Ü.md', '--filter', 'pandoc-crossref', '--filter', 'pandoc-katex', '--template=cache/pandoc_html_template.html', '-o', 'cache/oi-blog_„ÄåÊØîËµõÊÄªÁªì„Äç Ê≠£Áùø ÂõΩÂ∫Ü.md.html', '--metadata', '--verbose', '--highlight-style=tango']
STDOUT: 
STDERR: WARNING: pandoc-crossref was compiled with pandoc 3.6.2 but is being run through 3.6.4. This is not supported. Strange things may (and likely will) happen silently.

====================================================================================================
pdf log:
CMD: ['pandoc', '-s', 'cache.../b5c286cbd1.pdf.md', '-o', 'cache/b5c286cbd1.pdf', '-H', 'static/pandoc.header.tex', '--pdf-engine=xelatex', '--verbose']
STDOUT: 
STDERR: [INFO] Loaded static.../pandoc.header.tex from static.../pandoc.header.tex
[INFO] Not rendering RawBlock (Format "html") "<!-- more -->"
[INFO] Not rendering RawBlock (Format "html") "<!-- more -->"
[INFO] Not rendering RawBlock (Format "html") "<!-- more -->"
[INFO] [makePDF] Temp dir:
  .../[temp]
[INFO] [makePDF] Command line:
  xelatex "-halt-on-error" "-interaction" "nonstopmode" "-output-directory" ".../[temp] ".../[temp]
[INFO] [makePDF] Relevant environment variables:
  ("TEXINPUTS",".../[temp]
  ("TEXMFOUTPUT",".../[temp]
  ("SHELL","/bin/bash")
  ("PWD",".../[user]/projects/blog")
  ("HOME",".../[user]
  ("LANG","zh_CN.UTF-8")
  ("PATH",".../[user]/.local/bin:.../[user]/.cargo/bin:.../[user]/miniconda3/envs/myblog/bin:.../[user]/miniconda3/condabin:.../[temp]
[INFO] [makePDF] Source:
  % Options for packages loaded elsewhere
  \PassOptionsToPackage{unicode}{hyperref}
  \PassOptionsToPackage{hyphens}{url}
  \PassOptionsToPackage{space}{xeCJK}
  \documentclass[
  ]{article}
  \usepackage{xcolor}
  \usepackage[a4paper,margin=2cm]{geometry}
  \usepackage{amsmath,amssymb}
  \setcounter{secnumdepth}{-\maxdimen} % remove section numbering
  \usepackage{iftex}
  \ifPDFTeX
    \usepackage[T1]{fontenc}
    \usepackage[utf8]{inputenc}
    \usepackage{textcomp} % provide euro and other symbols
  \else % if luatex or xetex
    \usepackage{unicode-math} % this also loads fontspec
    \defaultfontfeatures{Scale=MatchLowercase}
    \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
  \fi
  \usepackage{lmodern}
  \ifPDFTeX\else
    % xetex/luatex font selection
    \setmainfont[]{Latin Modern Roman}
    \ifXeTeX
      \usepackage{xeCJK}
      \setCJKmainfont[]{AR PL UKai CN}
    \fi
    \ifLuaTeX
      \usepackage[]{luatexja-fontspec}
      \setmainjfont[]{AR PL UKai CN}
    \fi
  \fi
  % Use upquote if available, for straight quotes in verbatim environments
  \IfFileExists{upquote.sty}{\usepackage{upquote}}{}
  \IfFileExists{microtype.sty}{% use microtype if available
    \usepackage[]{microtype}
    \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
  }{}
  \usepackage{setspace}
  \makeatletter
  \@ifundefined{KOMAClassName}{% if non-KOMA class
    \IfFileExists{parskip.sty}{%
      \usepackage{parskip}
    }{% else
      \setlength{\parindent}{0pt}
      \setlength{\parskip}{6pt plus 2pt minus 1pt}}
  }{% if KOMA class
    \KOMAoptions{parskip=half}}
  \makeatother
  \usepackage{color}
  \usepackage{fancyvrb}
  \newcommand{\VerbBar}{|}
  \newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
  \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
  % Add ',fontsize=\small' for more characters per line
  \newenvironment{Shaded}{}{}
  \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
  \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
  \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.50,0.00}{#1}}
  \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{#1}}}
  \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
  \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
  \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{#1}}
  \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
  \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
  \newcommand{\ExtensionTok}[1]{#1}
  \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{#1}}
  \newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.50,0.00}{\textbf{#1}}}
  \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
  \newcommand{\NormalTok}[1]{#1}
  \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
  \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{#1}}
  \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
  \newcommand{\RegionMarkerTok}[1]{#1}
  \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
  \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
  \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \setlength{\emergencystretch}{3em} % prevent overfull lines
  \providecommand{\tightlist}{%
    \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
  % \usepackage{xeCJK}
  % \setCJKmainfont{AR PL UKai CN}
  % \usepackage{unicode-math}
  
  \setmathfont{Latin Modern Math}
  \usepackage{bookmark}
  \IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
  \urlstyle{same}
  \hypersetup{
    pdftitle={„ÄåÊØîËµõÊÄªÁªì„Äç Ê≠£Áùø ÂõΩÂ∫Ü},
    pdfauthor={Jiayi Su (ShuYuMo)},
    hidelinks,
    pdfcreator={LaTeX via pandoc}}
  
  \title{„ÄåÊØîËµõÊÄªÁªì„Äç Ê≠£Áùø ÂõΩÂ∫Ü}
  \author{Jiayi Su (ShuYuMo)}
  \date{2020-11-18 11:41:50}
  
  \begin{document}
  \maketitle
  
  \setstretch{1.3}
  \href{http://zhengruioi.com/contest/766/problem/394}{link}
  
  ÁªôÂá∫‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ \(n\) ÁöÑ \texttt{01} ‰∏≤ \(s\) ÂíåÊï¥Êï∞ \(k\) ÔºåÊ±Ç‰∏Ä‰∏™ \(s\)
  ÊúÄÈïøÁöÑÂ≠ê‰∏≤ \(t\) ‰ΩøÂæó \(t\) ‰∏≠ \texttt{0} ÁöÑ‰∏™Êï∞ÊòØ \texttt{1} ÁöÑ‰∏™Êï∞ÁöÑ
  \(k\) ÂÄçÔºåËæìÂá∫ÊúÄÈïøÁöÑ \(t\) ÁöÑÈïøÂ∫¶„ÄÇ
  
  ËÆæ\$ S\_0{[}i{]}\$ Ë°®Á§∫ \(S[1..i]\)‰∏≠ \texttt{0}ÁöÑÊï∞Èáè„ÄÇ \(S_1[i]\) Ë°®Á§∫
  \(S[1..i]\)‰∏≠ \texttt{1}ÁöÑÊï∞Èáè„ÄÇ Â≠ó‰∏≤ \(S[L, R]\) Êª°Ë∂≥Êù°‰ª∂ÂΩì‰∏î‰ªÖÂΩì
  \(S_0[R] - S_0[L - 1] = (S_1[R] - S_1[L - 1]) \times k\)„ÄÇ
  Âç≥Ôºö\(S_0[R] - S_1[R] \times k = S_0[L - 1] - S_1[L - 1] \times k\)„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \PreprocessorTok{\#define i64 }\DataTypeTok{long}\PreprocessorTok{ }\DataTypeTok{long}\PreprocessorTok{ }
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_ }\OperatorTok{=} \FloatTok{1e6} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ k}\OperatorTok{;}
  \DataTypeTok{char}\NormalTok{ S}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ S0}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ S1}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \NormalTok{map}\OperatorTok{\textless{}}\DataTypeTok{long} \DataTypeTok{long}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}}\NormalTok{M}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{} 
  \NormalTok{    ios}\OperatorTok{::}\NormalTok{sync\_with\_stdio}\OperatorTok{(}\KeywordTok{false}\OperatorTok{);}
  \NormalTok{    cin }\OperatorTok{\textgreater{}\textgreater{}}\NormalTok{ n }\OperatorTok{\textgreater{}\textgreater{}}\NormalTok{ k }\OperatorTok{\textgreater{}\textgreater{}} \OperatorTok{(}\NormalTok{S }\OperatorTok{+} \DecValTok{1}\OperatorTok{);} 
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ S0}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ S0}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]} \OperatorTok{+} \OperatorTok{(}\NormalTok{S}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{==} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{),}\NormalTok{ S1}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ S1}\OperatorTok{[}\NormalTok{i }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]} \OperatorTok{+} \OperatorTok{(}\NormalTok{S}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{==} \CharTok{\textquotesingle{}1\textquotesingle{}}\OperatorTok{);}
      \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}  
  \NormalTok{    M}\OperatorTok{[}\DecValTok{0}\OperatorTok{]} \OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
  \NormalTok{        i64 now }\OperatorTok{=}\NormalTok{ S0}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{{-}}\DecValTok{0}\BuiltInTok{ll}\OperatorTok{{-}}\NormalTok{ k }\OperatorTok{*}\DecValTok{1}\BuiltInTok{ll}\OperatorTok{*}\NormalTok{ S1}\OperatorTok{[}\NormalTok{i}\OperatorTok{];}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{M}\OperatorTok{.}\NormalTok{count}\OperatorTok{(}\NormalTok{now}\OperatorTok{))}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ i }\OperatorTok{{-}}\NormalTok{ M}\OperatorTok{[}\NormalTok{now}\OperatorTok{]);}  \ControlFlowTok{else}\NormalTok{ M}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=}\NormalTok{ i}\OperatorTok{;}
      \OperatorTok{\}}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d\textbackslash{}n}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}\NormalTok{ cerr }\OperatorTok{\textless{}\textless{}} \StringTok{"std\textquotesingle{}s ans = "} \OperatorTok{\textless{}\textless{}}\NormalTok{ ans }\OperatorTok{\textless{}\textless{}}\NormalTok{ endl}\OperatorTok{;}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  Êúâ‰∏§‰∏™ÈïøÂ∫¶‰∏∫ \(n\) ÁöÑÊéíÂàó \(A,B\) Ôºå‰Ω†ÊØèÊ¨°ÂèØ‰ª•ËøõË°å‰∏âÁßçÊìç‰ΩúÔºö - Âà†Èô§
  \(A\) ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥† \(a\) - Âà†Èô§ \(B\) ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥† \(b\) - Âà†Èô§ \(A\)
  ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥† \(a\) Âíå \(B\) ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥† \(b\) ÔºåË¶ÅÊ±Ç \(a\neq b\) Ê±ÇÊää
  \(A,B\) ÈÉΩÂà†ÂÖâÈúÄË¶ÅÁöÑÊúÄÂ∞ëÊìç‰ΩúÊ¨°Êï∞„ÄÇ
  
  \(n \le 10^6\)
  
  ÂΩìÊï∞Âàó \(A, B\) ÁöÑÈ¶ñÈ°πÁõ∏ÂêåÁöÑÊó∂ÂÄôÔºåÁõ¥Êé•Ë¥™ÂøÉÁöÑÈÄâÊã©Êìç‰Ωú 3 „ÄÇÈúÄË¶ÅÂÜ≥Á≠ñÂΩì
  \(A, B\)
  È¶ñÈ°πÁõ∏ÂêåÁöÑÊó∂ÂÄôÈÄâÊã©Âà†Èô§ÈÇ£ËæπÁöÑÔºåÁÑ∂ÂêéÂèàÂèØ‰ª•‰∏ÄÁõ¥Âà†ÔºåÁõ¥Âà∞È¶ñÈ°πÂÜçÊ¨°Áõ∏ÂêåÁöÑÊó∂ÂÄô
  ÂÜçÂÜ≥Á≠ñÔºåÁõ¥Êé•DPÂèØËÉΩË¢´\textbf{Âç°‰Ωè}ÁöÑÂú∞ÊñπÂç≥ÂèØ„ÄÇ
  
  ËÆæÊï∞Â≠ó \(x\) Âú® \(A\) ‰∏≠ÁöÑ‰ΩçÁΩÆÊòØ \(i\)ÔºåÂú® \(B\) ‰∏≠ÁöÑ‰ΩçÁΩÆÊòØ \(j\)ÔºåËÆ∞
  Êï∞Â≠ó \(x\) ÁöÑ‰ΩçÁΩÆ‰∏∫‰∫åÂÖÉÁªÑ \((i, j)\)„ÄÇÁî±‰∫é \(A , B\)
  ÊòØ‰∏§‰∏™ÊéíÂàóÔºåÂØπ‰∫éÊï∞Â≠ó \(x\) ÔºåÂÖ∂‰ΩçÁΩÆ‰∏ÄÂÆöÊòØÂîØ‰∏ÄÁöÑ \((i, j)\)„ÄÇ ËÆæ
  \(\operatorname{dp}[i]\) ‰∏∫ (ËÆæ \(A_i\) ÁöÑ‰ΩçÁΩÆ‰∏∫ \((i, j)\) ) ÔºåÂà†ÂÖâ
  \(A[i..n]\) Âíå \(B[j..n]\) ÁöÑ‰ª£‰ª∑„ÄÇ
  
  ÂØπ‰∫éÊï∞ÂÄº \(x\) ÁöÑ‰ΩçÁΩÆ \((i, j)\) ËÆæ \$\Delta = i - j
  \(„ÄÇÁî±‰∫éÊéíÂàóÁöÑÊÄßË¥®Ôºå\)dp{[}i{]}\(„ÄÅ\)A\_i\$ ÁöÑ‰ΩçÁΩÆ
  \((i, j)\)Ëøô‰∫õÊòØ‰∏Ä‰∏ÄÂØπÂ∫îÁöÑ„ÄÇËÆæ \(\Delta(x)\) ‰∏∫ \(dp[x]\) ÂØπÂ∫îÁöÑ
  \(\Delta\)„ÄÇ
  
  ËΩ¨ÁßªÂ∞±ÊòØ
  
  \(dp[i] = 1 + \min_{\Delta(x) = \Delta(i) - 1, \Delta(y) = \Delta(i) + 1}\limits{\{\ dp[x] + \operatorname{dist}(i, x),\ \ dp[y] + \operatorname{dist}(i, y)}\ \}\)„ÄÇ
  
  ‰ªéÂêéÂæÄÂâç \(dp\) ËÆ∞ÂΩï‰ª•‰∏ã \(\Delta\) Âç≥ÂèØ„ÄÇ ‰∏∫‰∫ÜÊñπ‰æøÔºåÂÖ∂‰∏≠
  \(\operatorname{Last}\) ‰∏∫ \(\Delta()\) ÁöÑÂèçÂáΩÊï∞„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ A}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ B}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ POOL}\OperatorTok{[(}\NormalTok{\_ }\OperatorTok{\textless{}\textless{}} \DecValTok{1}\OperatorTok{)} \OperatorTok{+} \DecValTok{100}\OperatorTok{],}\NormalTok{ PosInB}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],} \OperatorTok{*}\NormalTok{Last }\OperatorTok{=} \OperatorTok{\&}\NormalTok{POOL}\OperatorTok{[}\NormalTok{\_ }\OperatorTok{+} \DecValTok{10}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ dp}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
  \NormalTok{    rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n }\OperatorTok{=}\NormalTok{ read}\OperatorTok{())}\NormalTok{ Read}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}\NormalTok{ rep}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)}\NormalTok{ Read}\OperatorTok{(}\NormalTok{B}\OperatorTok{[}\NormalTok{i}\OperatorTok{]),}\NormalTok{ PosInB}\OperatorTok{[}\NormalTok{B}\OperatorTok{[}\NormalTok{i}\OperatorTok{]]} \OperatorTok{=}\NormalTok{ i}\OperatorTok{;}
  \NormalTok{    clear}\OperatorTok{(}\NormalTok{dp}\OperatorTok{,} \BaseNTok{0x3f}\OperatorTok{);}\NormalTok{ clear}\OperatorTok{(}\NormalTok{POOL}\OperatorTok{,} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{);}
  \NormalTok{    per}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \DecValTok{1}\OperatorTok{,}\NormalTok{ n}\OperatorTok{)} \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ det }\OperatorTok{=}\NormalTok{ i }\OperatorTok{{-}}\NormalTok{ PosInB}\OperatorTok{[}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]];}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{Last}\OperatorTok{[}\NormalTok{det }\OperatorTok{+} \DecValTok{1}\OperatorTok{]} \OperatorTok{!=} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{)}\NormalTok{ to\_min}\OperatorTok{(}\NormalTok{dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{],}\NormalTok{ dp}\OperatorTok{[}\NormalTok{Last}\OperatorTok{[}\NormalTok{det }\OperatorTok{+} \DecValTok{1}\OperatorTok{]]} \OperatorTok{+} \DecValTok{1} \OperatorTok{+} \OperatorTok{(}\NormalTok{Last}\OperatorTok{[}\NormalTok{det }\OperatorTok{+} \DecValTok{1}\OperatorTok{]} \OperatorTok{{-}} \OperatorTok{(}\NormalTok{i }\OperatorTok{+} \DecValTok{1}\OperatorTok{)));}
          \ControlFlowTok{else}\NormalTok{ to\_min}\OperatorTok{(}\NormalTok{dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{],} \DecValTok{1} \OperatorTok{+}\NormalTok{ max}\OperatorTok{(}\NormalTok{n }\OperatorTok{{-}} \OperatorTok{(}\NormalTok{i }\OperatorTok{+} \DecValTok{1}\OperatorTok{)} \OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \OperatorTok{(}\NormalTok{PosInB}\OperatorTok{[}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]])} \OperatorTok{+} \DecValTok{1} \OperatorTok{));}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{Last}\OperatorTok{[}\NormalTok{det }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]} \OperatorTok{!=} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{)}\NormalTok{ to\_min}\OperatorTok{(}\NormalTok{dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{],}\NormalTok{ dp}\OperatorTok{[}\NormalTok{Last}\OperatorTok{[}\NormalTok{det }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]]} \OperatorTok{+} \DecValTok{1} \OperatorTok{+} \OperatorTok{(}\NormalTok{Last}\OperatorTok{[}\NormalTok{det }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]} \OperatorTok{{-}} \OperatorTok{(}\NormalTok{i}\OperatorTok{)));}
          \ControlFlowTok{else}\NormalTok{ to\_min}\OperatorTok{(}\NormalTok{dp}\OperatorTok{[}\NormalTok{i}\OperatorTok{],} \DecValTok{1} \OperatorTok{+}\NormalTok{ max}\OperatorTok{(}\NormalTok{n }\OperatorTok{{-}} \OperatorTok{(}\NormalTok{i}\OperatorTok{)} \OperatorTok{+} \DecValTok{1}\OperatorTok{,}\NormalTok{ n }\OperatorTok{{-}} \OperatorTok{(}\NormalTok{PosInB}\OperatorTok{[}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]]} \OperatorTok{+} \DecValTok{1}\OperatorTok{)} \OperatorTok{+} \DecValTok{1}\OperatorTok{));}
  \NormalTok{        Last}\OperatorTok{[}\NormalTok{det}\OperatorTok{]} \OperatorTok{=}\NormalTok{ i}\OperatorTok{;}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{if}\OperatorTok{(}\NormalTok{Last}\OperatorTok{[}\DecValTok{0}\OperatorTok{]} \OperatorTok{==} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ n}\OperatorTok{;} \ControlFlowTok{else}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ dp}\OperatorTok{[}\NormalTok{Last}\OperatorTok{[}\DecValTok{0}\OperatorTok{]]} \OperatorTok{+}\NormalTok{ Last}\OperatorTok{[}\DecValTok{0}\OperatorTok{]} \OperatorTok{{-}} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    printf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,}\NormalTok{ ans}\OperatorTok{);}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  ÂØπ‰∫éÈïøÂ∫¶‰∏∫ \(n\) ÁöÑÁΩÆÊç¢ \(A,B\) ÔºåÊ±ÇÊòØÂê¶Â≠òÂú®Ê≠£Êï¥Êï∞ \(k\) ‰ΩøÂæó \(A^k=B\)
  
  ÂÆö‰πâÁΩÆÊç¢ÁöÑ‰πòÊ≥ï‰∏∫ \(C = (A \cdot B), C_i=A_{B_i}\)
  
  ÂÆö‰πâ \(A^1=A,A^n=A^{n-1} \cdot A(n > 1)\)
  
  Â¶ÇÊûúÂ≠òÂú® \texttt{k} ËæìÂá∫ \texttt{Yes} Âê¶ÂàôËæìÂá∫ \texttt{No} „ÄÇ
  
  \(n \le 10^6\)
  
  ÂèØ‰ª•ËΩ¨Âåñ‰∏∫ÂØπÁ∫øÊÄßÂêå‰∫éÊñπÁ®ãÂà§Êñ≠ÊòØÂê¶ÊúâËß£ÁöÑÈóÆÈ¢ò„ÄÇ
  
  ËøôÈáåÁöÑÁ∫øÊÄßÂêå‰∫éÊñπÁ®ãÁªÑÁöÑÊ®°Êï∞ \(\le 10^6\) ‰∏î‰∏ç‰∫íË¥®Ôºå\(LCM\) ÂæàÂ§ß Êó†Ê≥ï
  \(exCRT\) ÂêàÂπ∂„ÄÇ
  
  \(O(n \operatorname{log} n)\)Ôºö ‰ªé \(1 ~ n\) Êûö‰∏æ \(i\) Â∞ùËØïÊ±ÇÂá∫
  \(x \operatorname{mod} i\) ÁöÑÊï∞ÂÄºÔºåÊòìÁü• Ëøô‰∏™ÂÄºÂèØ‰ª•‰ªé
  \(x \operatorname{mod} k \dot i\)
  ÁöÑÂÄºÂæóÂà∞ÔºåÊ£ÄÊü•ÊñπÁ®ãÁªÑ‰∏≠ÊâÄÊúâÁöÑÊñπÁ®ãÔºåÁúãÁúãÊòØÂê¶ÂÜ≤Á™ÅÂç≥ÂèØ„ÄÇÊ†πÊçÆË∞ÉÂíåÁ∫ßÊï∞ÔºåËøôÊ†∑ÂÅöÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫
  \(O(n \operatorname{log} n)\)„ÄÇ
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \PreprocessorTok{\#define i64 }\DataTypeTok{long}\PreprocessorTok{ }\DataTypeTok{long}\PreprocessorTok{ }
  \PreprocessorTok{\#define walk}\OperatorTok{(}\NormalTok{now}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{ex}\OperatorTok{)}\PreprocessorTok{ }\ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{head}\OperatorTok{[}\NormalTok{now}\OperatorTok{],}\PreprocessorTok{ }\NormalTok{ex}\OperatorTok{;}\PreprocessorTok{ }\NormalTok{ex}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{,}\PreprocessorTok{ }\NormalTok{i}\OperatorTok{;}\PreprocessorTok{ }\NormalTok{i}\PreprocessorTok{ }\OperatorTok{=}\PreprocessorTok{ }\NormalTok{edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)}
  \DataTypeTok{bool}\NormalTok{ vis}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \NormalTok{vector}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{\textgreater{}}\NormalTok{ G}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ D}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ SZ}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ BL}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ Dis}\OperatorTok{[}\NormalTok{\_}\OperatorTok{],}\NormalTok{ MD}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ cnt }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{void}\NormalTok{ clear}\OperatorTok{()\{}
  \NormalTok{    memset}\OperatorTok{(}\NormalTok{head}\OperatorTok{,} \DecValTok{0}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{head}\OperatorTok{));}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \NormalTok{    memset}\OperatorTok{(}\NormalTok{vis}\OperatorTok{,} \KeywordTok{false}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{vis}\OperatorTok{));}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ cnt}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ G}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{clear}\OperatorTok{();}\NormalTok{ cnt }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{void}\NormalTok{ dfs}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ now}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ target}\OperatorTok{)\{}
  \NormalTok{    G}\OperatorTok{[}\NormalTok{target}\OperatorTok{].}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{now}\OperatorTok{);}\NormalTok{  vis}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    walk}\OperatorTok{(}\NormalTok{now}\OperatorTok{,}\NormalTok{ ex}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{vis}\OperatorTok{[}\NormalTok{ex}\OperatorTok{])} \ControlFlowTok{continue}\OperatorTok{;}\NormalTok{ dfs}\OperatorTok{(}\NormalTok{ex}\OperatorTok{,}\NormalTok{ target}\OperatorTok{);} \OperatorTok{\}}
  \OperatorTok{\}}
  \DataTypeTok{bool}\NormalTok{ CMP}\OperatorTok{(}\AttributeTok{const}\NormalTok{ pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}} \OperatorTok{\&}\NormalTok{ A}\OperatorTok{,} \AttributeTok{const}\NormalTok{ pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}} \OperatorTok{\&}\NormalTok{ B}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{return}\NormalTok{ A}\OperatorTok{.}\NormalTok{fi }\OperatorTok{\textless{}}\NormalTok{ B}\OperatorTok{.}\NormalTok{fi}\OperatorTok{;} \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ pos}\OperatorTok{[}\NormalTok{\_}\OperatorTok{];}
  \DataTypeTok{bool}\NormalTok{ PdExist}\OperatorTok{(}\DataTypeTok{int} \OperatorTok{*}\NormalTok{Md}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{*}\NormalTok{a}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ n}\OperatorTok{)} \OperatorTok{\{}
      \AttributeTok{static}\NormalTok{ vector}\OperatorTok{\textless{}}\NormalTok{ pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int} \OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}}\NormalTok{ M}\OperatorTok{,}\NormalTok{ M0}\OperatorTok{;}\NormalTok{ M}\OperatorTok{.}\NormalTok{clear}\OperatorTok{();}\NormalTok{ M0}\OperatorTok{.}\NormalTok{clear}\OperatorTok{();}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ M}\OperatorTok{.}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{make\_pair}\OperatorTok{(}\NormalTok{Md}\OperatorTok{[}\NormalTok{i}\OperatorTok{],}\NormalTok{ a}\OperatorTok{[}\NormalTok{i}\OperatorTok{]));}
  \NormalTok{    sort}\OperatorTok{(}\NormalTok{M}\OperatorTok{.}\NormalTok{begin}\OperatorTok{(),}\NormalTok{ M}\OperatorTok{.}\NormalTok{end}\OperatorTok{(),}\NormalTok{ CMP}\OperatorTok{);}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}}\NormalTok{ M}\OperatorTok{.}\NormalTok{size}\OperatorTok{();}\NormalTok{ i}\OperatorTok{++)} \OperatorTok{\{}
          \DataTypeTok{int}\NormalTok{ L }\OperatorTok{=}\NormalTok{ i}\OperatorTok{,}\NormalTok{ R }\OperatorTok{=}\NormalTok{ i}\OperatorTok{;}
          \ControlFlowTok{while}\OperatorTok{(}\NormalTok{R }\OperatorTok{+} \DecValTok{1} \OperatorTok{\textless{}}\NormalTok{ M}\OperatorTok{.}\NormalTok{size}\OperatorTok{()} \OperatorTok{\&\&}\NormalTok{ M}\OperatorTok{[}\NormalTok{L}\OperatorTok{].}\NormalTok{fi }\OperatorTok{==}\NormalTok{ M}\OperatorTok{[}\NormalTok{R }\OperatorTok{+} \DecValTok{1}\OperatorTok{].}\NormalTok{fi}\OperatorTok{)}\NormalTok{ R}\OperatorTok{++;}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=}\NormalTok{ L}\OperatorTok{;}\NormalTok{ j }\OperatorTok{\textless{}=}\NormalTok{ R}\OperatorTok{;}\NormalTok{ j}\OperatorTok{++)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{M}\OperatorTok{[}\NormalTok{j}\OperatorTok{].}\NormalTok{se }\OperatorTok{!=}\NormalTok{ M}\OperatorTok{[}\NormalTok{L}\OperatorTok{].}\NormalTok{se}\OperatorTok{)} \ControlFlowTok{return} \KeywordTok{false}\OperatorTok{;}
  \NormalTok{        M0}\OperatorTok{.}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{M}\OperatorTok{[}\NormalTok{L}\OperatorTok{]);}
  \NormalTok{        i }\OperatorTok{=}\NormalTok{ R}\OperatorTok{;}
      \OperatorTok{\}}
  \NormalTok{    memset}\OperatorTok{(}\NormalTok{pos}\OperatorTok{,} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{,} \KeywordTok{sizeof}\OperatorTok{(}\NormalTok{pos}\OperatorTok{));}
      \DataTypeTok{int}\NormalTok{ MAX }\OperatorTok{=} \DecValTok{0}\OperatorTok{;} \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}}\NormalTok{ M0}\OperatorTok{.}\NormalTok{size}\OperatorTok{();}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ MAX }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{MAX}\OperatorTok{,}\NormalTok{ M0}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{fi}\OperatorTok{),}\NormalTok{ pos}\OperatorTok{[}\NormalTok{M0}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{fi}\OperatorTok{]} \OperatorTok{=}\NormalTok{ i}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ MAX}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)\{}
          \DataTypeTok{int}\NormalTok{ tmp }\OperatorTok{=} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{;}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=}\NormalTok{ i}\OperatorTok{;}\NormalTok{ j }\OperatorTok{\textless{}=}\NormalTok{ MAX}\OperatorTok{;}\NormalTok{ j }\OperatorTok{+=}\NormalTok{ i}\OperatorTok{)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{pos}\OperatorTok{[}\NormalTok{j}\OperatorTok{]} \OperatorTok{!=} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{tmp }\OperatorTok{==} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{)}\NormalTok{ tmp }\OperatorTok{=}\NormalTok{ M0}\OperatorTok{[}\NormalTok{pos}\OperatorTok{[}\NormalTok{j}\OperatorTok{]].}\NormalTok{se }\OperatorTok{\%}\NormalTok{ i}\OperatorTok{;} \ControlFlowTok{else} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{tmp }\OperatorTok{!=}\NormalTok{ M0}\OperatorTok{[}\NormalTok{pos}\OperatorTok{[}\NormalTok{j}\OperatorTok{]].}\NormalTok{se }\OperatorTok{\%}\NormalTok{ i}\OperatorTok{)} \ControlFlowTok{return} \KeywordTok{false}\OperatorTok{;} \OperatorTok{\}}
      \OperatorTok{\}}
      \ControlFlowTok{return} \KeywordTok{true}\OperatorTok{;}
  \OperatorTok{\}}
  
  \DataTypeTok{void}\NormalTok{ doit}\OperatorTok{()\{}
  \NormalTok{    clear}\OperatorTok{();}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ add}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{],}\NormalTok{ i}\OperatorTok{);}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)} \ControlFlowTok{if}\OperatorTok{(!}\NormalTok{vis}\OperatorTok{[}\NormalTok{i}\OperatorTok{])}\NormalTok{ dfs}\OperatorTok{(}\NormalTok{i}\OperatorTok{,} \OperatorTok{++}\NormalTok{cnt}\OperatorTok{);}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ cnt}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)} \OperatorTok{\{}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}\NormalTok{ j }\OperatorTok{\textless{}}\NormalTok{ G}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{size}\OperatorTok{();}\NormalTok{ j}\OperatorTok{++)\{}
  \NormalTok{            D}\OperatorTok{[}\NormalTok{G}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]]} \OperatorTok{=}\NormalTok{ j}\OperatorTok{;}
  \NormalTok{            SZ}\OperatorTok{[}\NormalTok{G}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]]} \OperatorTok{=}\NormalTok{ G}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{size}\OperatorTok{();}
  \NormalTok{            BL}\OperatorTok{[}\NormalTok{G}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]]} \OperatorTok{=}\NormalTok{ i}\OperatorTok{;}    
          \OperatorTok{\}}
      \OperatorTok{\}}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{BL}\OperatorTok{[}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]]} \OperatorTok{!=}\NormalTok{ BL}\OperatorTok{[}\NormalTok{B}\OperatorTok{[}\NormalTok{i}\OperatorTok{]])} \OperatorTok{\{} \ControlFlowTok{return} \OperatorTok{(}\DataTypeTok{void}\OperatorTok{)}\NormalTok{puts}\OperatorTok{(}\StringTok{"No"}\OperatorTok{);\}}
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ Dis}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=} \OperatorTok{(}\NormalTok{ D}\OperatorTok{[}\NormalTok{B}\OperatorTok{[}\NormalTok{i}\OperatorTok{]]} \OperatorTok{{-}}\NormalTok{ D}\OperatorTok{[}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]]} \OperatorTok{+}\NormalTok{ SZ}\OperatorTok{[}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]]} \OperatorTok{)} \OperatorTok{\%}\NormalTok{ SZ}\OperatorTok{[}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]];}
      
      \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ MD}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ SZ}\OperatorTok{[}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]];}
      \DataTypeTok{int}\NormalTok{ r }\OperatorTok{=}\NormalTok{ PdExist}\OperatorTok{(}\NormalTok{MD}\OperatorTok{,}\NormalTok{ Dis}\OperatorTok{,}\NormalTok{ n}\OperatorTok{);}
      \ControlFlowTok{return} \OperatorTok{(}\DataTypeTok{void}\OperatorTok{)}\NormalTok{puts}\OperatorTok{(}\NormalTok{r }\OperatorTok{?} \StringTok{"Yes"} \OperatorTok{:} \StringTok{"No"}\OperatorTok{);} 
  \OperatorTok{\}}
  
  \DataTypeTok{int}\NormalTok{ main}\OperatorTok{()\{}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{scanf}\OperatorTok{(}\StringTok{"}\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{,} \OperatorTok{\&}\NormalTok{n}\OperatorTok{)} \OperatorTok{==} \DecValTok{1}\OperatorTok{)\{}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ Read}\OperatorTok{(}\NormalTok{A}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
          \ControlFlowTok{for}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{ i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{ i}\OperatorTok{++)}\NormalTok{ Read}\OperatorTok{(}\NormalTok{B}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
  \NormalTok{        doit}\OperatorTok{();}
      \OperatorTok{\}}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
  \OperatorTok{\}}
  \end{Highlighting}
  \end{Shaded}
  
  
  \end{document}
[INFO] [makePDF] LaTeX run number 1
[INFO] [makePDF] LaTeX output
  This is XeTeX, Version 3.141592653-2.6-0.999995 (TeX Live 2023/Debian) (preloaded format=xelatex)
   restricted \write18 enabled.
  entering extended mode
  (.../input.tex
  LaTeX2e <2023-11-01> patch level 1
  L3 programming layer <2024-01-22>
  (.../article.cls
  Document Class: article 2023/05/17 v1.4n Standard LaTeX document class
  (.../[system]
  (.../xcolor.sty
  (.../color.cfg)
  (.../xetex.def)
  (.../[system]
  (.../geometry.sty
  (.../keyval.sty)
  (.../ifvtex.sty
  (.../iftex.sty)))
  (.../amsmath.sty
  For additional information on amsmath, use the `?' option.
  (.../amstext.sty
  (.../amsgen.sty))
  (.../amsbsy.sty)
  (.../amsopn.sty))
  (.../amssymb.sty
  (.../amsfonts.sty))
  (.../unicode-math.sty
  (.../expl3.sty
  (.../l3backend-xetex.def))
  (.../unicode-math-xetex.sty
  (.../xparse.sty)
  (.../l3keys2e.sty)
  (.../fontspec.sty
  (.../fontspec-xetex.sty
  (.../fontenc.sty)
  (.../fontspec.cfg)))
  (.../fix-cm.sty
  (.../ts1enc.def))
  (.../unicode-math-table.tex)))
  (.../lmodern.sty)
  (.../xeCJK.sty
  (.../ctexhook.sty)
  (.../xtemplate.sty)
  (.../xeCJK.cfg))
  (.../upquote.sty
  (.../textcomp.sty))
  (.../microtype.sty
  (.../etoolbox.sty)
  (.../microtype-xetex.def)
  (.../microtype.cfg))
  (.../setspace.sty)
  (.../parskip.sty
  (.../kvoptions.sty
  (.../ltxcmds.sty)
  (.../kvsetkeys.sty)))
  (.../fancyvrb.sty)
  (.../bookmark.sty
  (.../hyperref.sty
  (.../kvdefinekeys.sty)
  (.../pdfescape.sty
  (.../pdftexcmds.sty
  (.../infwarerr.sty)))
  (.../hycolor.sty)
  (.../auxhook.sty)
  (.../nameref.sty
  (.../refcount.sty)
  (.../gettitlestring.sty))
  (.../pd1enc.def)
  (.../intcalc.sty)
  (.../puenc.def)
  (.../url.sty)
  (.../bitset.sty
  (.../bigintcalc.sty))
  (.../atbegshi-ltx.sty))
  (.../hxetex.def
  (.../stringenc.sty)
  (.../rerunfilecheck.sty
  (.../atveryend-ltx.sty)
  (.../uniquecounter.sty)))
  (.../bkm-dvipdfm.def))
  (.../xurl.sty)
  No file input.aux.
  *geometry* driver: auto-detecting
  *geometry* detected driver: xetex
  (.../mt-LatinModernRoman.cfg)
  
  Package hyperref Warning: Rerun to get /PageLabels entry.
  
  (.../omllmm.fd)
  (.../umsa.fd)
  (.../mt-msa.cfg)
  (.../umsb.fd)
  (.../mt-msb.cfg)
  
  Package xeCJK Warning: Unknown CJK family `\CJKttdefault' is being ignored.
  (xeCJK)                
  (xeCJK)                Try to use `\setCJKmonofont[<...>]{<...>}' to define
  (xeCJK)                it.
  
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/b/n' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 159.
  
  Missing character: There is no ùõ• (U+1D6E5) in font Latin Modern Roman 10 Regula
  r/OT:script=latn;language=dflt;mapping=tex-text;!
  Missing character: There is no „ÄÇ (U+3002) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no Áî± (U+7531) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no ‰∫é (U+4E8E) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no Êéí (U+6392) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no Âàó (U+5217) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no ÁöÑ (U+7684) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no ÊÄß (U+6027) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no Ë¥® (U+8D28) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no Ôºå (U+FF0C) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no „ÄÅ (U+3001) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  [1] [2] [3] [4] (.../input.aux)
  
  LaTeX Font Warning: Some font shapes were not available, defaults substituted.
  
   )
  Output written on .../input.pdf (4 pages).
  Transcript written on .../input.log.
[INFO] [makePDF] Rerun needed
  Package hyperref Warning: Rerun to get /PageLabels entry.
[INFO] [makePDF] LaTeX run number 2
[INFO] [makePDF] LaTeX output
  This is XeTeX, Version 3.141592653-2.6-0.999995 (TeX Live 2023/Debian) (preloaded format=xelatex)
   restricted \write18 enabled.
  entering extended mode
  (.../input.tex
  LaTeX2e <2023-11-01> patch level 1
  L3 programming layer <2024-01-22>
  (.../article.cls
  Document Class: article 2023/05/17 v1.4n Standard LaTeX document class
  (.../[system]
  (.../xcolor.sty
  (.../color.cfg)
  (.../xetex.def)
  (.../[system]
  (.../geometry.sty
  (.../keyval.sty)
  (.../ifvtex.sty
  (.../iftex.sty)))
  (.../amsmath.sty
  For additional information on amsmath, use the `?' option.
  (.../amstext.sty
  (.../amsgen.sty))
  (.../amsbsy.sty)
  (.../amsopn.sty))
  (.../amssymb.sty
  (.../amsfonts.sty))
  (.../unicode-math.sty
  (.../expl3.sty
  (.../l3backend-xetex.def))
  (.../unicode-math-xetex.sty
  (.../xparse.sty)
  (.../l3keys2e.sty)
  (.../fontspec.sty
  (.../fontspec-xetex.sty
  (.../fontenc.sty)
  (.../fontspec.cfg)))
  (.../fix-cm.sty
  (.../ts1enc.def))
  (.../unicode-math-table.tex)))
  (.../lmodern.sty)
  (.../xeCJK.sty
  (.../ctexhook.sty)
  (.../xtemplate.sty)
  (.../xeCJK.cfg))
  (.../upquote.sty
  (.../textcomp.sty))
  (.../microtype.sty
  (.../etoolbox.sty)
  (.../microtype-xetex.def)
  (.../microtype.cfg))
  (.../setspace.sty)
  (.../parskip.sty
  (.../kvoptions.sty
  (.../ltxcmds.sty)
  (.../kvsetkeys.sty)))
  (.../fancyvrb.sty)
  (.../bookmark.sty
  (.../hyperref.sty
  (.../kvdefinekeys.sty)
  (.../pdfescape.sty
  (.../pdftexcmds.sty
  (.../infwarerr.sty)))
  (.../hycolor.sty)
  (.../auxhook.sty)
  (.../nameref.sty
  (.../refcount.sty)
  (.../gettitlestring.sty))
  (.../pd1enc.def)
  (.../intcalc.sty)
  (.../puenc.def)
  (.../url.sty)
  (.../bitset.sty
  (.../bigintcalc.sty))
  (.../atbegshi-ltx.sty))
  (.../hxetex.def
  (.../stringenc.sty)
  (.../rerunfilecheck.sty
  (.../atveryend-ltx.sty)
  (.../uniquecounter.sty)))
  (.../bkm-dvipdfm.def))
  (.../xurl.sty)
  (.../input.aux)
  *geometry* driver: auto-detecting
  *geometry* detected driver: xetex
  (.../mt-LatinModernRoman.cfg)
  (.../omllmm.fd)
  (.../umsa.fd)
  (.../mt-msa.cfg)
  (.../umsb.fd)
  (.../mt-msb.cfg)
  
  Package xeCJK Warning: Unknown CJK family `\CJKttdefault' is being ignored.
  (xeCJK)                
  (xeCJK)                Try to use `\setCJKmonofont[<...>]{<...>}' to define
  (xeCJK)                it.
  
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/b/n' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 159.
  
  Missing character: There is no ùõ• (U+1D6E5) in font Latin Modern Roman 10 Regula
  r/OT:script=latn;language=dflt;mapping=tex-text;!
  Missing character: There is no „ÄÇ (U+3002) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no Áî± (U+7531) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no ‰∫é (U+4E8E) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no Êéí (U+6392) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no Âàó (U+5217) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no ÁöÑ (U+7684) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no ÊÄß (U+6027) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no Ë¥® (U+8D28) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no Ôºå (U+FF0C) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  Missing character: There is no „ÄÅ (U+3001) in font LatinModernMath-Regular/OT:sc
  ript=math;language=dflt;!
  [1] [2] [3] [4] (.../input.aux)
  
  LaTeX Font Warning: Some font shapes were not available, defaults substituted.
  
   )
  Output written on .../input.pdf (4 pages).
  Transcript written on .../input.log.
[WARNING] Missing character: There is no ùõ• (U+1D6E5) (U+1D6E5) in font Latin Modern Roman 10 Regula
[WARNING] Missing character: There is no „ÄÇ (U+3002) (U+3002) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no Áî± (U+7531) (U+7531) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no ‰∫é (U+4E8E) (U+4E8E) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no Êéí (U+6392) (U+6392) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no Âàó (U+5217) (U+5217) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no ÁöÑ (U+7684) (U+7684) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no ÊÄß (U+6027) (U+6027) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no Ë¥® (U+8D28) (U+8D28) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no Ôºå (U+FF0C) (U+FF0C) in font LatinModernMath-Regular/OT:sc
[WARNING] Missing character: There is no „ÄÅ (U+3001) (U+3001) in font LatinModernMath-Regular/OT:sc
</pre>
                                            </details>
                    
                                    </div>
                                </article>
                

                

                

                

            

                
                        </div>
                    </main>
            </div>

                <!-- Footer -->
                <footer id="footer">
                    <p>¬© 2025 ShuYuMo's Blog by Jiayi Su. All rights reserved.</p>  Powered by <b>MonoPy</b> - Single-Script Blog Generator in Python.
                </footer>
            </div>
        </div>
        
        <!-- Back to top button -->
        <button id="back-to-top" 
                aria-label="Back to top" 
                title="Back to top"
                style="display: none;">
            ‚Üë
        </button>
        
        <!-- JavaScript -->
        <script>
            // Back to top functionality
            (function() {
                const backToTopButton = document.getElementById('back-to-top');
                const scrollThreshold = 300;
                
                function toggleBackToTop() {
                    if (window.scrollY > scrollThreshold) {
                        backToTopButton.style.display = 'block';
                    } else {
                        backToTopButton.style.display = 'none';
                    }
                }
                
                function scrollToTop() {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                }
                
                window.addEventListener('scroll', toggleBackToTop);
                backToTopButton.addEventListener('click', scrollToTop);
            })();
            
            // Clean up redundant spans in code blocks
            document.querySelectorAll('pre code').forEach(codeBlock => {
                // Find all line spans
                const lineSpans = codeBlock.querySelectorAll('span[id^="cb"]');
                
                lineSpans.forEach(lineSpan => {
                    // Check if this line has nested spans that can be simplified
                    const children = Array.from(lineSpan.childNodes);
                    
                    // Skip the anchor link (first child is usually the line number anchor)
                    let contentStart = 0;
                    if (children[0] && children[0].tagName === 'A') {
                        contentStart = 1;
                    }
                    
                    // If there's only one span child after the anchor, unwrap it
                    const contentChildren = children.slice(contentStart);
                    if (contentChildren.length === 1 && contentChildren[0].tagName === 'SPAN') {
                        const spanChild = contentChildren[0];
                        // Move the span's contents directly to the line span
                        while (spanChild.firstChild) {
                            lineSpan.insertBefore(spanChild.firstChild, spanChild);
                        }
                        // Remove the now-empty span
                        spanChild.remove();
                    }
                });
            });
            
            // Code copy functionality
            document.querySelectorAll('pre code').forEach(block => {
                const button = document.createElement('button');
                button.className = 'copy-button';
                button.textContent = 'Copy';
                button.setAttribute('aria-label', 'Copy code to clipboard');
                
                button.addEventListener('click', function() {
                    navigator.clipboard.writeText(block.textContent).then(() => {
                        button.textContent = 'Copied!';
                        setTimeout(() => button.textContent = 'Copy', 2000);
                    }).catch(() => {
                        // Fallback for older browsers
                        const textArea = document.createElement('textarea');
                        textArea.value = block.textContent;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        button.textContent = 'Copied!';
                        setTimeout(() => button.textContent = 'Copy', 2000);
                    });
                });
                
                const pre = block.parentNode;
                pre.style.position = 'relative';
                pre.appendChild(button);
            });
        </script>
    </body>
</html>