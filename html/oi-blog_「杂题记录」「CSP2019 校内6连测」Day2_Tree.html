<!-- Academic Blog Template
MIT License - Copyright (c) 2025 Su Jiayi <sujiayi2003@gmail.com>
-->

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        
        <!-- Primary Meta Tags -->
        <title>ShuYuMo&#39;s Blog | Jiayi Su</title>
        <meta name="description" content="一些奇奇怪怪的 INFP 随碎碎念。">
        <meta name="keywords" content="nb1, nb2, nb3">
        <meta name="author" content="Su Jiayi">
        
        <!-- Open Graph Meta Tags -->
        <meta property="og:type" content="website">
        <meta property="og:title" content="ShuYuMo&#39;s Blog | Jiayi Su">
        <meta property="og:description" content="一些奇奇怪怪的 INFP 随碎碎念。">
        <meta property="og:image" content="../static/images/header.jpg">
        
        <!-- Stylesheets -->
        <link rel="stylesheet" type="text/css" href="../static/css/default.css">
        <link rel="stylesheet" type="text/css" href="../static/css/syntax.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
        
        <!-- Google Analytics -->
        
    </head>
    <body>
        <!-- Skip to main content for accessibility -->
        <a href="#main-content" class="skip-link">Skip to main content</a>
        
        <div id="main">
            <div class="main-container">
                <!-- Header -->
                <header id="header">
                    <div class="header-content">
                        <h1 class="header-title">
                            <a href="./">ShuYuMo&#39;s Blog</a>
                        </h1>
                        <p class="header-subtitle">一些奇奇怪怪的 INFP 随碎碎念。</p>
                        <div class="header-accent"></div>
                    </div>
                </header>
                
                <!-- Content Layout -->
                <div class="content-wrapper">
                    <!-- Sidebar -->
                    <nav id="sidebar">
                        <div class="profile-section">
                            <a href="./" class="profile-avatar-link">
                                <img src="../static/images/header.jpg" alt="ShuYuMo&#39;s header" class="profile-avatar" loading="lazy" />
                            </a>
                            <div class="profile-info">
                                <h3 class="profile-name">Jiayi Su (ShuYuMo)</h3>
            </div>
            </div>

                        <div class="nav-header">
                            <h2>🧭 Navigation</h2>
                            <span class="nav-subtitle">Explore the site</span>
                        </div>
                        <nav class="nav-menu">
                            
                            
                            <a href="./_post.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">📄</span>
                                <span class="nav-text">Posts</span>
                                
                            </a>
                            
                            
                            <a href="./_archive.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">📄</span>
                                <span class="nav-text">Archive</span>
                                
                            </a>
                            
                            
                            <a href="./_category.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">📄</span>
                                <span class="nav-text">Category</span>
                                
                            </a>
                            
                            
                            <a href="./_about.html" 
                               
                               class="nav-item">
                                <span class="nav-icon">📄</span>
                                <span class="nav-text">About</span>
                                
                            </a>
                            
                        </nav>
                    </nav>

                    <!-- Main Content -->
                    <main id="content">
                        <div id="main-content">
                            
                                <article>
                                    <!-- Article Header with Title and Actions -->
                                    <div class="article-header">
                                        <div class="article-title-section">
                                            
                                                <h1 class="article-title">「CSP2019 校内6连测」Day2_Tree</h1>
                                            
                                            
                                            <!-- Article Meta Information -->
                                            <div class="article-meta">
                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">📅</span>
                                                        <span class="meta-label">Last Updated: </span>
                                                        <span class="meta-value">2019-11-10</span>
                                                    </div>
                                                
                                                
                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">📊</span>
                                                        <span class="meta-label">Word Count: </span>
                                                        <span class="meta-value">105</span>
                                                    </div>
                    

                                                
                                                    <div class="meta-item">
                                                        <span class="meta-icon">⏱️</span>
                                                        <span class="meta-label">Estimated Reading Time: </span>
                                                        <span class="meta-value">1 minutes</span>
                                                    </div>
                                                
                                            </div>
                                        </div>
                                        
                                        <div class="article-actions">
                    
                                                <a href="../pdf/oi-blog_「杂题记录」「CSP2019 校内6连测」Day2_Tree.pdf" 
                                                   target="_blank" 
                                                   rel="noopener"
                                                   class="action-btn pdf-btn">
                                                    📄 PDF
                                                </a>
                                            
                                            
                                            
                                                <a href="../src/oi-blog/「杂题记录」「CSP2019 校内6连测」Day2_Tree.md" 
                                                   target="_blank" 
                                                   rel="noopener"
                                                   class="action-btn source-btn">
                                                    📝 Source
                                                </a>
                                            
                                        </div>
                                    </div>

                                    <!-- Article Content -->
                                    <div class="article-content">
                                        <p>一道趣题。 <!-- more --></p>
<h1 id="校内6连测day2">校内6连测Day2</h1>
<h2 id="tree">Tree</h2>
<p>面向数据编程：</p>
<h3 id="subtask1">subtask1</h3>
<p>由于题目没有给定根，所以第一个想法就是枚举根，然后在每个点检查子树是否包含每一个颜色，更新答案。<br />
具体可以状压啊，（暴力统计也能过），需要注意的是状态压缩时，设置状态中<code>1 &lt;&lt; 50</code>这样的语句时不可以的。(应该为<code>1LL &lt;&lt; 50</code>)；<br />
### subtask2 只有一种颜色，找一个最长的链即可，就是树的直径。 ###
subtask3
发现要是想要<code>AC</code>这道题，枚举根肯定是没前途的，除非可以确定一个根，然后直接<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>猜答案。</p>
<p>先随便找一个点作为临时的根，然后对于我们枚举到的一个点，我们考虑它作为
LCA的时候的最优答案，显然真正的根有两种情况： - 在当前点为根的子树中。 -
不在他的子树内。
对于这几种情况，我们都算一个最远的那个点离他多远，把最远的那个合法的点作为根就可以。</p>
<p>比如， 右边这个图，当真正的根是
<strong>6</strong>，当前点是<strong>3</strong>的时候，我们就需要知道，他的子树的点集
<strong>T={1,2,3,5,9,8}</strong>这个集合里面是否包含了每种颜色的点。</p>
<p>这是正解的弱化版本，树形<code>DP</code>，
<code>f[i][j]</code>表示在树上结点<code>i</code>，颜色<code>j</code>的数量。</p>
<p>那么我们就可以用 <code>f[1]-f[4]</code>算得 <code>T</code>
中包含的每种颜色的点的个数。 我们对于每个点，枚举根在哪个方向，
算这个方向上最远的点， 复杂度是
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>的。</p>
<p>算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">f[i][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>的总复杂度是
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nm)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">nm</span><span class="mclose">)</span></span></span></span>的，
枚举根方向再算合不合法，复杂度也是
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nm)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">nm</span><span class="mclose">)</span></span></span></span>。所以总复杂度是
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nm)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">nm</span><span class="mclose">)</span></span></span></span>.</p>
<h1 id="subtask4">subtask4</h1>
<p>归纳上一个<code>subtask3</code>发现其实对于每一个点，只需要知道两个信息即可：
- 这个点为根的子树是否包含所有的颜色 -
整棵树抛去这个点为根的子树是否包含所有的颜色（称之为这个点为根的子树的反树）</p>
<p>还是先选一个临时的根，分开考虑两种情况 - 到一个点之后判断 以
这个点为根的子树是否包含所有的颜色。设以某个点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>为根的子树所包含的元素种类数为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">W_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br />
考虑一个点对这个点到根这条链上的贡献，每个点都会使得这个点到根这条链上的点所有点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">W_j + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>。
但是考虑两个相同颜色的点，对答案贡献之后，会使这两个点的<code>LCA</code>到根这条路径上的点都被<strong>加重复</strong>了一次。所以这条路径上的点都需要再<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span>。<br />
树上的路径操作——树上差分即可完成。注意，需要对同一种颜色的点按照<code>DFS</code>序排序，然后两两求<code>LCA</code>可以发现，只有这样做才是对的。<br />
对这个树进行差分，然后能在<code>DFS</code>的过程中求得每个点为根的子树中的颜色种类数量。如果颜色种类数量为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>那就说明这个子树已经包含了所有的颜色，那么这个点就是题目要求的<code>LCA</code>之一，然后用向上最长链（可以预处理出来，其实不是向上的最长链，只要这条链的终点不在当前子树中即可，也就是选取这个链的终点当作真正的根）更新答案。
-
如何判断一个点为根的的子树的反树包含了所有的点。其实可以反过来想，一个反树包含所有的颜色，也就是某一种颜色并没有被当前子树全部包含。求出每种颜色全部点的<code>LCA</code>。显然，选取的能够更新答案的点不是这些<code>LCA</code>的祖先。
预处理每一个种颜色所有点的<code>LCA</code>，然后进行在那个点打标记。最后dfs上传标记即可，设当前点为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>o</mi><mi>w</mi></mrow><annotation encoding="application/x-tex">now</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span>，儿子结点为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>o</mi></mrow><annotation encoding="application/x-tex">to</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span></span></span></span>，那么标记数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">f[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>就等于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">[</mo><mi>n</mi><mi>o</mi><mi>w</mi><mo stretchy="false">]</mo><mi mathvariant="normal">∣</mi><mo>=</mo><mi>f</mi><mo stretchy="false">[</mo><mi>t</mi><mi>o</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">f[now] |= f[to]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">]</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mclose">]</span></span></span></span>。
最后检查每一个没被打过标记的点，用向下最长链（可以预处理，也就是这个点往下和一个最深的叶子结点的距离，也就是选取这个最深的叶子结点当真正的根）更新答案。</p>
<p>这两种情况更新完答案就做完了</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include</span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include</span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include</span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include</span><span class="im">&lt;cmath&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include</span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include</span><span class="im">&lt;vector&gt;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#define _R </span><span class="at">register</span><span class="pp"> </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _N <span class="op">=</span> <span class="fl">1e6</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> _M <span class="op">=</span> <span class="fl">2e6</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">int</span> read<span class="op">()</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> c <span class="op">=</span> getchar<span class="op">();</span> <span class="dt">int</span> sign <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="dt">int</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>c <span class="op">&gt;</span> <span class="ch">&#39;9&#39;</span> <span class="op">||</span> c <span class="op">&lt;</span> <span class="ch">&#39;0&#39;</span><span class="op">)</span> <span class="op">{</span> <span class="cf">if</span><span class="op">(</span>c<span class="op">==</span><span class="ch">&#39;-&#39;</span><span class="op">)</span>sign <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span> c <span class="op">=</span> getchar<span class="op">();</span> <span class="op">}</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span><span class="op">)</span> <span class="op">{</span> x <span class="op">*=</span> <span class="dv">10</span><span class="op">;</span> x <span class="op">+=</span> c <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">;</span> c <span class="op">=</span> getchar<span class="op">();</span> <span class="op">}</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">*</span> sign<span class="op">;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> head<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> edges<span class="op">{</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> node<span class="op">;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> nxt<span class="op">;</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>edge<span class="op">[</span>_M<span class="op">];</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> add<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> v<span class="op">){</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    edge<span class="op">[++</span>tot<span class="op">].</span>nxt <span class="op">=</span> head<span class="op">[</span>u<span class="op">];</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    head<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> tot<span class="op">;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    edge<span class="op">[</span>tot<span class="op">].</span>node <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> m<span class="op">;</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> col<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> root<span class="op">;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> MaxDeep<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> MaxUp<span class="op">[</span>_N<span class="op">];</span> </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs1<span class="op">(</span><span class="dt">int</span> now<span class="op">,</span> <span class="dt">int</span> fa<span class="op">){</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> Maxdp <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span>i<span class="op">;</span>i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> to <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>to <span class="op">==</span> fa<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        dfs1<span class="op">(</span>to<span class="op">,</span> now<span class="op">);</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        Maxdp <span class="op">=</span> max<span class="op">(</span>Maxdp<span class="op">,</span> MaxDeep<span class="op">[</span>to<span class="op">]);</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    MaxDeep<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> Maxdp <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs2<span class="op">(</span><span class="dt">int</span> now<span class="op">,</span> <span class="dt">int</span> fa<span class="op">)</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> MaxVal1 <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span><span class="dt">int</span> MaxNode1<span class="op">;</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> MaxVal2 <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span><span class="dt">int</span> MaxNode2<span class="op">;</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span>i<span class="op">;</span>i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> to <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>to <span class="op">==</span> fa<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>MaxVal1 <span class="op">&lt;</span> MaxDeep<span class="op">[</span>to<span class="op">])</span> <span class="op">{</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>            MaxVal2 <span class="op">=</span> MaxVal1<span class="op">;</span>MaxNode2 <span class="op">=</span> MaxNode1<span class="op">;</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>            MaxVal1 <span class="op">=</span> MaxDeep<span class="op">[</span>to<span class="op">];</span>MaxNode1 <span class="op">=</span> to<span class="op">;</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> MaxVal2 <span class="op">=</span> max<span class="op">(</span>MaxVal2<span class="op">,</span> MaxDeep<span class="op">[</span>to<span class="op">]);</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span>i<span class="op">;</span>i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> to <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>to <span class="op">==</span> fa<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>        MaxUp<span class="op">[</span>to<span class="op">]</span> <span class="op">=</span> max<span class="op">((</span>MaxDeep<span class="op">[</span>to<span class="op">]</span> <span class="op">==</span> MaxVal1 <span class="op">?</span> MaxVal2 <span class="op">+</span> <span class="dv">2</span> <span class="op">:</span> MaxVal1 <span class="op">+</span> <span class="dv">2</span><span class="op">),</span> MaxUp<span class="op">[</span>now<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span>i<span class="op">;</span>i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> to <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>to <span class="op">==</span> fa<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>        dfs2<span class="op">(</span>to<span class="op">,</span> now<span class="op">);</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> LCA<span class="op">{</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="dt">int</span> Log <span class="op">=</span> <span class="dv">20</span><span class="op">;</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> anc<span class="op">[</span>_N<span class="op">][</span>Log <span class="op">+</span> <span class="dv">5</span><span class="op">];</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> deep<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> now<span class="op">,</span> <span class="dt">int</span> fa<span class="op">,</span> <span class="dt">int</span> dp<span class="op">){</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>        anc<span class="op">[</span>now<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> fa<span class="op">;</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>        deep<span class="op">[</span>now<span class="op">]</span> <span class="op">=</span> dp<span class="op">;</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span>i<span class="op">;</span>i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> to <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>to <span class="op">==</span> fa<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>            dfs<span class="op">(</span>to<span class="op">,</span> now<span class="op">,</span> dp <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> work<span class="op">()</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>root<span class="op">,</span> root<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>j <span class="op">&lt;=</span> Log<span class="op">;</span>j<span class="op">++){</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>i <span class="op">&lt;=</span> n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>                anc<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> anc<span class="op">[</span>anc<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">]][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> query<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">){</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>deep<span class="op">[</span>x<span class="op">]</span> <span class="op">&lt;</span> deep<span class="op">[</span>y<span class="op">])</span> swap<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> dis <span class="op">=</span> deep<span class="op">[</span>x<span class="op">]</span> <span class="op">-</span> deep<span class="op">[</span>y<span class="op">];</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> now <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(</span>dis <span class="op">!=</span> <span class="dv">0</span><span class="op">){</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>dis <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> x <span class="op">=</span> anc<span class="op">[</span>x<span class="op">][</span>now<span class="op">];</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>            now <span class="op">++;</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>            dis <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>x <span class="op">==</span> y<span class="op">)</span> <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> Log<span class="op">;</span>i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span>i<span class="op">--){</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>anc<span class="op">[</span>x<span class="op">][</span>i<span class="op">]</span> <span class="op">==</span> anc<span class="op">[</span>y<span class="op">][</span>i<span class="op">])</span><span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> anc<span class="op">[</span>x<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>            y <span class="op">=</span> anc<span class="op">[</span>y<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> anc<span class="op">[</span>x<span class="op">][</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> tar<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> colorLCA<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> Status1<span class="op">{</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> S<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> LCnd<span class="op">[</span>_N<span class="op">];</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> <span class="op">&gt;</span>dfn<span class="op">[</span>_N<span class="op">];</span><span class="co">//DFN Id </span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> dfs_pre<span class="op">(</span><span class="dt">int</span> now<span class="op">,</span> <span class="dt">int</span> fa<span class="op">){</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>        dfn<span class="op">[</span>col<span class="op">[</span>now<span class="op">]].</span>push_back<span class="op">(</span>make_pair<span class="op">(++</span>tot<span class="op">,</span> now<span class="op">));</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span>i<span class="op">;</span>i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> to <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>to <span class="op">==</span> fa<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>            dfs_pre<span class="op">(</span>to<span class="op">,</span> now<span class="op">);</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dfs<span class="op">(</span><span class="dt">int</span> now<span class="op">,</span> <span class="dt">int</span> fa<span class="op">){</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> v <span class="op">=</span> S<span class="op">[</span>now<span class="op">];</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span>i<span class="op">;</span>i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> to <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>to <span class="op">==</span> fa<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>            v <span class="op">+=</span> dfs<span class="op">(</span>to<span class="op">,</span> now<span class="op">);</span></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>v <span class="op">==</span> m<span class="op">)</span> ans <span class="op">=</span> max<span class="op">(</span>ans<span class="op">,</span> MaxUp<span class="op">[</span>now<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> v<span class="op">;</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> work<span class="op">(){</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>        dfs_pre<span class="op">(</span>root<span class="op">,</span> root<span class="op">);</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>i <span class="op">&lt;=</span> m<span class="op">;</span>i<span class="op">++)</span> sort<span class="op">(</span>dfn<span class="op">[</span>i<span class="op">].</span>begin<span class="op">(),</span> dfn<span class="op">[</span>i<span class="op">].</span>end<span class="op">());</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>i <span class="op">&lt;=</span> m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>            S<span class="op">[</span>dfn<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">].</span>second<span class="op">]</span> <span class="op">++;</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>j <span class="op">&lt;</span> dfn<span class="op">[</span>i<span class="op">].</span>size<span class="op">();</span>j<span class="op">++){</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>                S<span class="op">[</span>LCA<span class="op">::</span>query<span class="op">(</span>dfn<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>second<span class="op">,</span> dfn<span class="op">[</span>i<span class="op">][</span>j<span class="op">].</span>second<span class="op">)]</span> <span class="op">--;</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>                S<span class="op">[</span>dfn<span class="op">[</span>i<span class="op">][</span>j<span class="op">].</span>second<span class="op">]</span> <span class="op">++;</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>root<span class="op">,</span> root<span class="op">);</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> Status2<span class="op">{</span></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> now<span class="op">,</span> <span class="dt">int</span> fa<span class="op">){</span></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> head<span class="op">[</span>now<span class="op">];</span>i<span class="op">;</span>i <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>nxt<span class="op">){</span></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> to <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>node<span class="op">;</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>to <span class="op">==</span> fa<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>            dfs<span class="op">(</span>to<span class="op">,</span> now<span class="op">);</span>tar<span class="op">[</span>now<span class="op">]</span> <span class="op">|=</span> tar<span class="op">[</span>to<span class="op">];</span></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> work<span class="op">(){</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>root<span class="op">,</span> root<span class="op">);</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>i <span class="op">&lt;=</span> n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>tar<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">){</span><span class="co">//反树 包含全集； </span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>                ans <span class="op">=</span> max<span class="op">(</span>ans<span class="op">,</span> MaxDeep<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a><span class="dt">signed</span> main<span class="op">()</span></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> read<span class="op">(),</span> m <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> maxx <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>i <span class="op">&lt;=</span> n<span class="op">;</span>i<span class="op">++)</span> col<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> read<span class="op">(),</span> maxx <span class="op">=</span> max<span class="op">(</span>maxx<span class="op">,</span> col<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>i <span class="op">&lt;</span> n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> tmpx <span class="op">=</span> read<span class="op">(),</span> tmpy <span class="op">=</span> read<span class="op">();</span></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>        add<span class="op">(</span>tmpx<span class="op">,</span> tmpy<span class="op">);</span></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>        add<span class="op">(</span>tmpy<span class="op">,</span> tmpx<span class="op">);</span></span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>    dfs1<span class="op">(</span>root<span class="op">,</span> root<span class="op">);</span></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>    dfs2<span class="op">(</span>root<span class="op">,</span> root<span class="op">);</span></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>    LCA<span class="op">::</span>work<span class="op">();</span></span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>i <span class="op">&lt;=</span> n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> <span class="op">&amp;</span>cl <span class="op">=</span> colorLCA<span class="op">[</span>col<span class="op">[</span>i<span class="op">]];</span></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>cl <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> cl <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> cl <span class="op">=</span> LCA<span class="op">::</span>query<span class="op">(</span>cl<span class="op">,</span> i<span class="op">);</span></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span>_R <span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>i <span class="op">&lt;=</span> m<span class="op">;</span>i<span class="op">++)</span> tar<span class="op">[</span>colorLCA<span class="op">[</span>i<span class="op">]]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>    Status1<span class="op">::</span>work<span class="op">();</span></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>    Status2<span class="op">::</span>work<span class="op">();</span></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> ans <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a> <span class="op">}</span> </span></code></pre></div>
                                    </div>

                                    <!-- Article Footer -->
                                    <div class="article-footer">
                                                                            
                                        <section class="post-history">
                                            <div class="history-header">
                                                <h2>📚 Version History</h2>
                                                <span class="history-desc">Source Code Change History</span>
                                            </div>
                                            <div class="version-list">
                                                
                                                    <div class="version-item">
                                                        <div class="version-header">
                                                            <span class="version-badge">v1</span>
                                                            <time class="version-time" datetime="2019-11-10 10:02:00">
                                                                📅 2019-11-10 10:02:00
                                                            </time>
                                                        </div>
                                                        <div class="version-hash-container">
                                                            <span class="hash-label">🔗 Source Hash:</span>
                                                            <code class="version-hash" title="Source Code Hash (0e664ded6d9432a033b617792576751d634e0dc38618dcccebdc111e299c7808)">0e664ded6d9432a033b617792576751d634e0dc38618dcccebdc111e299c7808</code>
                                                        </div>
                                                    </div>
                                                
                                            </div>
                                        </section>
                    

                    
                                            <details class="build-logs">
                                                <summary>Build Logs</summary>
                                                <pre class="logs-content">Build Log - Filtered
================================================

📋 Information:
• Path information has been filtered for privacy protection
• File names are preserved for debugging purposes  
• All build status and error messages are kept intact

🔍 Filter Rules:
• /absolute/path/file.ext → .../file.ext
• /home/username → .../[user]
• /tmp/files → .../[temp]
• /usr/share/packages → .../[system]

================================================

html log:
CMD: ['pandoc', '-s', 'cache/oi-blog_「杂题记录」「CSP2019 校内6连测」Day2_Tree.md', '--filter', 'pandoc-crossref', '--filter', 'pandoc-katex', '--template=cache/pandoc_html_template.html', '-o', 'cache/oi-blog_「杂题记录」「CSP2019 校内6连测」Day2_Tree.md.html', '--metadata', '--verbose', '--highlight-style=tango']
STDOUT: 
STDERR: WARNING: pandoc-crossref was compiled with pandoc 3.6.2 but is being run through 3.6.4. This is not supported. Strange things may (and likely will) happen silently.

====================================================================================================
pdf log:
CMD: ['pandoc', '-s', 'cache.../9e287dd52c.pdf.md', '-o', 'cache/9e287dd52c.pdf', '-H', 'static/pandoc.header.tex', '--pdf-engine=xelatex', '--verbose']
STDOUT: 
STDERR: [INFO] Loaded static.../pandoc.header.tex from static.../pandoc.header.tex
[INFO] Not rendering RawInline (Format "html") "<!-- more -->"
[INFO] [makePDF] Temp dir:
  .../[temp]
[INFO] [makePDF] Command line:
  xelatex "-halt-on-error" "-interaction" "nonstopmode" "-output-directory" ".../[temp] ".../[temp]
[INFO] [makePDF] Relevant environment variables:
  ("TEXINPUTS",".../[temp]
  ("TEXMFOUTPUT",".../[temp]
  ("SHELL","/bin/bash")
  ("PWD",".../[user]/projects/blog")
  ("HOME",".../[user]
  ("LANG","zh_CN.UTF-8")
  ("PATH",".../[user]/.local/bin:.../[user]/.cargo/bin:.../[user]/miniconda3/envs/myblog/bin:.../[user]/miniconda3/condabin:.../[temp]
[INFO] [makePDF] Source:
  % Options for packages loaded elsewhere
  \PassOptionsToPackage{unicode}{hyperref}
  \PassOptionsToPackage{hyphens}{url}
  \PassOptionsToPackage{space}{xeCJK}
  \documentclass[
  ]{article}
  \usepackage{xcolor}
  \usepackage[a4paper,margin=2cm]{geometry}
  \usepackage{amsmath,amssymb}
  \setcounter{secnumdepth}{-\maxdimen} % remove section numbering
  \usepackage{iftex}
  \ifPDFTeX
    \usepackage[T1]{fontenc}
    \usepackage[utf8]{inputenc}
    \usepackage{textcomp} % provide euro and other symbols
  \else % if luatex or xetex
    \usepackage{unicode-math} % this also loads fontspec
    \defaultfontfeatures{Scale=MatchLowercase}
    \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
  \fi
  \usepackage{lmodern}
  \ifPDFTeX\else
    % xetex/luatex font selection
    \setmainfont[]{Latin Modern Roman}
    \ifXeTeX
      \usepackage{xeCJK}
      \setCJKmainfont[]{AR PL UKai CN}
    \fi
    \ifLuaTeX
      \usepackage[]{luatexja-fontspec}
      \setmainjfont[]{AR PL UKai CN}
    \fi
  \fi
  % Use upquote if available, for straight quotes in verbatim environments
  \IfFileExists{upquote.sty}{\usepackage{upquote}}{}
  \IfFileExists{microtype.sty}{% use microtype if available
    \usepackage[]{microtype}
    \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
  }{}
  \usepackage{setspace}
  \makeatletter
  \@ifundefined{KOMAClassName}{% if non-KOMA class
    \IfFileExists{parskip.sty}{%
      \usepackage{parskip}
    }{% else
      \setlength{\parindent}{0pt}
      \setlength{\parskip}{6pt plus 2pt minus 1pt}}
  }{% if KOMA class
    \KOMAoptions{parskip=half}}
  \makeatother
  \usepackage{color}
  \usepackage{fancyvrb}
  \newcommand{\VerbBar}{|}
  \newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
  \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
  % Add ',fontsize=\small' for more characters per line
  \newenvironment{Shaded}{}{}
  \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
  \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
  \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.50,0.00}{#1}}
  \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{#1}}}
  \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
  \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
  \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{#1}}
  \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
  \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
  \newcommand{\ExtensionTok}[1]{#1}
  \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
  \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{#1}}
  \newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.50,0.00}{\textbf{#1}}}
  \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
  \newcommand{\NormalTok}[1]{#1}
  \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
  \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{#1}}
  \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
  \newcommand{\RegionMarkerTok}[1]{#1}
  \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
  \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
  \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
  \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
  \setlength{\emergencystretch}{3em} % prevent overfull lines
  \providecommand{\tightlist}{%
    \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
  % \usepackage{xeCJK}
  % \setCJKmainfont{AR PL UKai CN}
  % \usepackage{unicode-math}
  
  \setmathfont{Latin Modern Math}
  \usepackage{bookmark}
  \IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
  \urlstyle{same}
  \hypersetup{
    pdftitle={「CSP2019 校内6连测」Day2\_Tree},
    pdfauthor={Jiayi Su (ShuYuMo)},
    hidelinks,
    pdfcreator={LaTeX via pandoc}}
  
  \title{「CSP2019 校内6连测」Day2\_Tree}
  \author{Jiayi Su (ShuYuMo)}
  \date{2019-11-10 10:02:00}
  
  \begin{document}
  \maketitle
  
  \setstretch{1.3}
  一道趣题。
  
  \section{校内6连测Day2}\label{ux6821ux51856ux8fdeux6d4bday2}
  
  \subsection{Tree}\label{tree}
  
  面向数据编程：
  
  \subsubsection{subtask1}\label{subtask1}
  
  由于题目没有给定根，所以第一个想法就是枚举根，然后在每个点检查子树是否包含每一个颜色，更新答案。\\
  具体可以状压啊，（暴力统计也能过），需要注意的是状态压缩时，设置状态中\texttt{1\ \textless{}\textless{}\ 50}这样的语句时不可以的。(应该为\texttt{1LL\ \textless{}\textless{}\ 50})；\\
  \#\#\# subtask2 只有一种颜色，找一个最长的链即可，就是树的直径。 \#\#\#
  subtask3
  发现要是想要\texttt{AC}这道题，枚举根肯定是没前途的，除非可以确定一个根，然后直接\(O(1)\)猜答案。
  
  先随便找一个点作为临时的根，然后对于我们枚举到的一个点，我们考虑它作为
  LCA的时候的最优答案，显然真正的根有两种情况： - 在当前点为根的子树中。 -
  不在他的子树内。
  对于这几种情况，我们都算一个最远的那个点离他多远，把最远的那个合法的点作为根就可以。
  
  比如， 右边这个图，当真正的根是
  \textbf{6}，当前点是\textbf{3}的时候，我们就需要知道，他的子树的点集
  \textbf{T=\{1,2,3,5,9,8\}}这个集合里面是否包含了每种颜色的点。
  
  这是正解的弱化版本，树形\texttt{DP}，
  \texttt{f{[}i{]}{[}j{]}}表示在树上结点\texttt{i}，颜色\texttt{j}的数量。
  
  那么我们就可以用 \texttt{f{[}1{]}-f{[}4{]}}算得 \texttt{T}
  中包含的每种颜色的点的个数。 我们对于每个点，枚举根在哪个方向，
  算这个方向上最远的点， 复杂度是 \(O(n)\)的。
  
  算\(f[i][j]\)的总复杂度是 \(O(nm)\)的，
  枚举根方向再算合不合法，复杂度也是 \(O(nm)\)。所以总复杂度是 \(O(nm)\).
  
  \section{subtask4}\label{subtask4}
  
  归纳上一个\texttt{subtask3}发现其实对于每一个点，只需要知道两个信息即可：
  - 这个点为根的子树是否包含所有的颜色 -
  整棵树抛去这个点为根的子树是否包含所有的颜色（称之为这个点为根的子树的反树）
  
  还是先选一个临时的根，分开考虑两种情况 - 到一个点之后判断 以
  这个点为根的子树是否包含所有的颜色。设以某个点\(i\)为根的子树所包含的元素种类数为\(W_i\)\\
  考虑一个点对这个点到根这条链上的贡献，每个点都会使得这个点到根这条链上的点所有点\(j\)的\(W_j + 1\)。
  但是考虑两个相同颜色的点，对答案贡献之后，会使这两个点的\texttt{LCA}到根这条路径上的点都被\textbf{加重复}了一次。所以这条路径上的点都需要再\(-1\)。\\
  树上的路径操作——树上差分即可完成。注意，需要对同一种颜色的点按照\texttt{DFS}序排序，然后两两求\texttt{LCA}可以发现，只有这样做才是对的。\\
  对这个树进行差分，然后能在\texttt{DFS}的过程中求得每个点为根的子树中的颜色种类数量。如果颜色种类数量为\(m\)那就说明这个子树已经包含了所有的颜色，那么这个点就是题目要求的\texttt{LCA}之一，然后用向上最长链（可以预处理出来，其实不是向上的最长链，只要这条链的终点不在当前子树中即可，也就是选取这个链的终点当作真正的根）更新答案。
  -
  如何判断一个点为根的的子树的反树包含了所有的点。其实可以反过来想，一个反树包含所有的颜色，也就是某一种颜色并没有被当前子树全部包含。求出每种颜色全部点的\texttt{LCA}。显然，选取的能够更新答案的点不是这些\texttt{LCA}的祖先。
  预处理每一个种颜色所有点的\texttt{LCA}，然后进行在那个点打标记。最后dfs上传标记即可，设当前点为\(now\)，儿子结点为\(to\)，那么标记数组\(f[i]\)就等于\(f[now] |= f[to]\)。
  最后检查每一个没被打过标记的点，用向下最长链（可以预处理，也就是这个点往下和一个最深的叶子结点的距离，也就是选取这个最深的叶子结点当真正的根）更新答案。
  
  这两种情况更新完答案就做完了
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \PreprocessorTok{\#include}\ImportTok{\textless{}cstdio\textgreater{}}
  \PreprocessorTok{\#include}\ImportTok{\textless{}iostream\textgreater{}}
  \PreprocessorTok{\#include}\ImportTok{\textless{}cstring\textgreater{}}
  \PreprocessorTok{\#include}\ImportTok{\textless{}cmath\textgreater{}}
  \PreprocessorTok{\#include}\ImportTok{\textless{}algorithm\textgreater{}}
  \PreprocessorTok{\#include}\ImportTok{\textless{}vector\textgreater{}}
  \PreprocessorTok{\#define \_R }\AttributeTok{register}\PreprocessorTok{ }
  \KeywordTok{using} \KeywordTok{namespace}\NormalTok{ std}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_N }\OperatorTok{=} \FloatTok{1e6} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
  \AttributeTok{const} \DataTypeTok{int}\NormalTok{ \_M }\OperatorTok{=} \FloatTok{2e6} \OperatorTok{+} \DecValTok{100}\OperatorTok{;}
  \KeywordTok{inline} \DataTypeTok{int}\NormalTok{ read}\OperatorTok{()}
  \OperatorTok{\{}
      \DataTypeTok{char}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();} \DataTypeTok{int}\NormalTok{ sign }\OperatorTok{=} \DecValTok{1}\OperatorTok{;} \DataTypeTok{int}\NormalTok{ x }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{c }\OperatorTok{\textgreater{}} \CharTok{\textquotesingle{}9\textquotesingle{}} \OperatorTok{||}\NormalTok{ c }\OperatorTok{\textless{}} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{)} \OperatorTok{\{} \ControlFlowTok{if}\OperatorTok{(}\NormalTok{c}\OperatorTok{==}\CharTok{\textquotesingle{}{-}\textquotesingle{}}\OperatorTok{)}\NormalTok{sign }\OperatorTok{=} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{;}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();} \OperatorTok{\}}
      \ControlFlowTok{while}\OperatorTok{(}\NormalTok{c }\OperatorTok{\textless{}=} \CharTok{\textquotesingle{}9\textquotesingle{}} \OperatorTok{\&\&}\NormalTok{ c }\OperatorTok{\textgreater{}=} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{)} \OperatorTok{\{}\NormalTok{ x }\OperatorTok{*=} \DecValTok{10}\OperatorTok{;}\NormalTok{ x }\OperatorTok{+=}\NormalTok{ c }\OperatorTok{{-}} \CharTok{\textquotesingle{}0\textquotesingle{}}\OperatorTok{;}\NormalTok{ c }\OperatorTok{=}\NormalTok{ getchar}\OperatorTok{();} \OperatorTok{\}}
      \ControlFlowTok{return}\NormalTok{ x }\OperatorTok{*}\NormalTok{ sign}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ head}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
  \KeywordTok{struct}\NormalTok{ edges}\OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ node}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ nxt}\OperatorTok{;}
  \OperatorTok{\}}\NormalTok{edge}\OperatorTok{[}\NormalTok{\_M}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \DataTypeTok{void}\NormalTok{ add}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ u}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ v}\OperatorTok{)\{}
  \NormalTok{    edge}\OperatorTok{[++}\NormalTok{tot}\OperatorTok{].}\NormalTok{nxt }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{u}\OperatorTok{];}
  \NormalTok{    head}\OperatorTok{[}\NormalTok{u}\OperatorTok{]} \OperatorTok{=}\NormalTok{ tot}\OperatorTok{;}
  \NormalTok{    edge}\OperatorTok{[}\NormalTok{tot}\OperatorTok{].}\NormalTok{node }\OperatorTok{=}\NormalTok{ v}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{int}\NormalTok{ n}\OperatorTok{,}\NormalTok{ m}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ col}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ root}\OperatorTok{;}
  \DataTypeTok{int}\NormalTok{ MaxDeep}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ MaxUp}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];} 
  \DataTypeTok{void}\NormalTok{ dfs1}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ now}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ fa}\OperatorTok{)\{}
      \DataTypeTok{int}\NormalTok{ Maxdp }\OperatorTok{=} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{i}\OperatorTok{;}\NormalTok{i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ to }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{to }\OperatorTok{==}\NormalTok{ fa}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        dfs1}\OperatorTok{(}\NormalTok{to}\OperatorTok{,}\NormalTok{ now}\OperatorTok{);}
  \NormalTok{        Maxdp }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{Maxdp}\OperatorTok{,}\NormalTok{ MaxDeep}\OperatorTok{[}\NormalTok{to}\OperatorTok{]);}
      \OperatorTok{\}}
  \NormalTok{    MaxDeep}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=}\NormalTok{ Maxdp }\OperatorTok{+} \DecValTok{1}\OperatorTok{;}
  \OperatorTok{\}}
  \DataTypeTok{void}\NormalTok{ dfs2}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ now}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ fa}\OperatorTok{)}
  \OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ MaxVal1 }\OperatorTok{=} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{;}\DataTypeTok{int}\NormalTok{ MaxNode1}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ MaxVal2 }\OperatorTok{=} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{;}\DataTypeTok{int}\NormalTok{ MaxNode2}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{i}\OperatorTok{;}\NormalTok{i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ to }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{to }\OperatorTok{==}\NormalTok{ fa}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{MaxVal1 }\OperatorTok{\textless{}}\NormalTok{ MaxDeep}\OperatorTok{[}\NormalTok{to}\OperatorTok{])} \OperatorTok{\{}
  \NormalTok{            MaxVal2 }\OperatorTok{=}\NormalTok{ MaxVal1}\OperatorTok{;}\NormalTok{MaxNode2 }\OperatorTok{=}\NormalTok{ MaxNode1}\OperatorTok{;}
  \NormalTok{            MaxVal1 }\OperatorTok{=}\NormalTok{ MaxDeep}\OperatorTok{[}\NormalTok{to}\OperatorTok{];}\NormalTok{MaxNode1 }\OperatorTok{=}\NormalTok{ to}\OperatorTok{;}
          \OperatorTok{\}} \ControlFlowTok{else}\NormalTok{ MaxVal2 }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{MaxVal2}\OperatorTok{,}\NormalTok{ MaxDeep}\OperatorTok{[}\NormalTok{to}\OperatorTok{]);}
      \OperatorTok{\}}
      \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{i}\OperatorTok{;}\NormalTok{i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ to }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{to }\OperatorTok{==}\NormalTok{ fa}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        MaxUp}\OperatorTok{[}\NormalTok{to}\OperatorTok{]} \OperatorTok{=}\NormalTok{ max}\OperatorTok{((}\NormalTok{MaxDeep}\OperatorTok{[}\NormalTok{to}\OperatorTok{]} \OperatorTok{==}\NormalTok{ MaxVal1 }\OperatorTok{?}\NormalTok{ MaxVal2 }\OperatorTok{+} \DecValTok{2} \OperatorTok{:}\NormalTok{ MaxVal1 }\OperatorTok{+} \DecValTok{2}\OperatorTok{),}\NormalTok{ MaxUp}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{+} \DecValTok{1}\OperatorTok{);}
      \OperatorTok{\}}
      \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{i}\OperatorTok{;}\NormalTok{i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ to }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{to }\OperatorTok{==}\NormalTok{ fa}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{        dfs2}\OperatorTok{(}\NormalTok{to}\OperatorTok{,}\NormalTok{ now}\OperatorTok{);}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \KeywordTok{namespace}\NormalTok{ LCA}\OperatorTok{\{}
      \AttributeTok{const} \DataTypeTok{int}\NormalTok{ Log }\OperatorTok{=} \DecValTok{20}\OperatorTok{;}
      \DataTypeTok{int}\NormalTok{ anc}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{][}\NormalTok{Log }\OperatorTok{+} \DecValTok{5}\OperatorTok{];}
      \DataTypeTok{int}\NormalTok{ deep}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
      \DataTypeTok{void}\NormalTok{ dfs}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ now}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ fa}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ dp}\OperatorTok{)\{}
  \NormalTok{        anc}\OperatorTok{[}\NormalTok{now}\OperatorTok{][}\DecValTok{0}\OperatorTok{]} \OperatorTok{=}\NormalTok{ fa}\OperatorTok{;}
  \NormalTok{        deep}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{=}\NormalTok{ dp}\OperatorTok{;}
          \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{i}\OperatorTok{;}\NormalTok{i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
              \DataTypeTok{int}\NormalTok{ to }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{to }\OperatorTok{==}\NormalTok{ fa}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{            dfs}\OperatorTok{(}\NormalTok{to}\OperatorTok{,}\NormalTok{ now}\OperatorTok{,}\NormalTok{ dp }\OperatorTok{+} \DecValTok{1}\OperatorTok{);}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ work}\OperatorTok{()}
      \OperatorTok{\{}
  \NormalTok{        dfs}\OperatorTok{(}\NormalTok{root}\OperatorTok{,}\NormalTok{ root}\OperatorTok{,} \DecValTok{1}\OperatorTok{);}
          \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{j }\OperatorTok{\textless{}=}\NormalTok{ Log}\OperatorTok{;}\NormalTok{j}\OperatorTok{++)\{}
              \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{i}\OperatorTok{++)\{}
  \NormalTok{                anc}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{]} \OperatorTok{=}\NormalTok{ anc}\OperatorTok{[}\NormalTok{anc}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{]][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{];}
              \OperatorTok{\}}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ query}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ x}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ y}\OperatorTok{)\{}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{deep}\OperatorTok{[}\NormalTok{x}\OperatorTok{]} \OperatorTok{\textless{}}\NormalTok{ deep}\OperatorTok{[}\NormalTok{y}\OperatorTok{])}\NormalTok{ swap}\OperatorTok{(}\NormalTok{x}\OperatorTok{,}\NormalTok{ y}\OperatorTok{);}
          \DataTypeTok{int}\NormalTok{ dis }\OperatorTok{=}\NormalTok{ deep}\OperatorTok{[}\NormalTok{x}\OperatorTok{]} \OperatorTok{{-}}\NormalTok{ deep}\OperatorTok{[}\NormalTok{y}\OperatorTok{];}
          \DataTypeTok{int}\NormalTok{ now }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
          \ControlFlowTok{while}\OperatorTok{(}\NormalTok{dis }\OperatorTok{!=} \DecValTok{0}\OperatorTok{)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{dis }\OperatorTok{\&} \DecValTok{1}\OperatorTok{)}\NormalTok{ x }\OperatorTok{=}\NormalTok{ anc}\OperatorTok{[}\NormalTok{x}\OperatorTok{][}\NormalTok{now}\OperatorTok{];}
  \NormalTok{            now }\OperatorTok{++;}
  \NormalTok{            dis }\OperatorTok{\textgreater{}\textgreater{}=} \DecValTok{1}\OperatorTok{;}
          \OperatorTok{\}}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{x }\OperatorTok{==}\NormalTok{ y}\OperatorTok{)} \ControlFlowTok{return}\NormalTok{ x}\OperatorTok{;}
          \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ Log}\OperatorTok{;}\NormalTok{i }\OperatorTok{\textgreater{}=} \DecValTok{0}\OperatorTok{;}\NormalTok{i}\OperatorTok{{-}{-})\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{anc}\OperatorTok{[}\NormalTok{x}\OperatorTok{][}\NormalTok{i}\OperatorTok{]} \OperatorTok{==}\NormalTok{ anc}\OperatorTok{[}\NormalTok{y}\OperatorTok{][}\NormalTok{i}\OperatorTok{])}\ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{            x }\OperatorTok{=}\NormalTok{ anc}\OperatorTok{[}\NormalTok{x}\OperatorTok{][}\NormalTok{i}\OperatorTok{];}
  \NormalTok{            y }\OperatorTok{=}\NormalTok{ anc}\OperatorTok{[}\NormalTok{y}\OperatorTok{][}\NormalTok{i}\OperatorTok{];}
          \OperatorTok{\}}
          \ControlFlowTok{return}\NormalTok{ anc}\OperatorTok{[}\NormalTok{x}\OperatorTok{][}\DecValTok{0}\OperatorTok{];}
      \OperatorTok{\}}
  \OperatorTok{\}}
  
  \DataTypeTok{int}\NormalTok{ tar}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ colorLCA}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
  \DataTypeTok{int}\NormalTok{ ans }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
  \KeywordTok{namespace}\NormalTok{ Status1}\OperatorTok{\{}
      \DataTypeTok{int}\NormalTok{ S}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
      \DataTypeTok{int}\NormalTok{ LCnd}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}
  \NormalTok{    vector}\OperatorTok{\textless{}}\NormalTok{pair}\OperatorTok{\textless{}}\DataTypeTok{int}\OperatorTok{,} \DataTypeTok{int}\OperatorTok{\textgreater{}} \OperatorTok{\textgreater{}}\NormalTok{dfn}\OperatorTok{[}\NormalTok{\_N}\OperatorTok{];}\CommentTok{//DFN Id }
      \DataTypeTok{int}\NormalTok{ tot }\OperatorTok{=} \DecValTok{0}\OperatorTok{;}
      \DataTypeTok{void}\NormalTok{ dfs\_pre}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ now}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ fa}\OperatorTok{)\{}
  \NormalTok{        dfn}\OperatorTok{[}\NormalTok{col}\OperatorTok{[}\NormalTok{now}\OperatorTok{]].}\NormalTok{push\_back}\OperatorTok{(}\NormalTok{make\_pair}\OperatorTok{(++}\NormalTok{tot}\OperatorTok{,}\NormalTok{ now}\OperatorTok{));}
          \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{i}\OperatorTok{;}\NormalTok{i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
              \DataTypeTok{int}\NormalTok{ to }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{to }\OperatorTok{==}\NormalTok{ fa}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{            dfs\_pre}\OperatorTok{(}\NormalTok{to}\OperatorTok{,}\NormalTok{ now}\OperatorTok{);}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \DataTypeTok{int}\NormalTok{ dfs}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ now}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ fa}\OperatorTok{)\{}
          \DataTypeTok{int}\NormalTok{ v }\OperatorTok{=}\NormalTok{ S}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}
          \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{i}\OperatorTok{;}\NormalTok{i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
              \DataTypeTok{int}\NormalTok{ to }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{to }\OperatorTok{==}\NormalTok{ fa}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{            v }\OperatorTok{+=}\NormalTok{ dfs}\OperatorTok{(}\NormalTok{to}\OperatorTok{,}\NormalTok{ now}\OperatorTok{);}
          \OperatorTok{\}}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{v }\OperatorTok{==}\NormalTok{ m}\OperatorTok{)}\NormalTok{ ans }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ MaxUp}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{+} \DecValTok{1}\OperatorTok{);}
          \ControlFlowTok{return}\NormalTok{ v}\OperatorTok{;}
      \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ work}\OperatorTok{()\{}
  \NormalTok{        dfs\_pre}\OperatorTok{(}\NormalTok{root}\OperatorTok{,}\NormalTok{ root}\OperatorTok{);}
          \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{i }\OperatorTok{\textless{}=}\NormalTok{ m}\OperatorTok{;}\NormalTok{i}\OperatorTok{++)}\NormalTok{ sort}\OperatorTok{(}\NormalTok{dfn}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{begin}\OperatorTok{(),}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{end}\OperatorTok{());}
          \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{i }\OperatorTok{\textless{}=}\NormalTok{ m}\OperatorTok{;}\NormalTok{i}\OperatorTok{++)\{}
  \NormalTok{            S}\OperatorTok{[}\NormalTok{dfn}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\DecValTok{0}\OperatorTok{].}\NormalTok{second}\OperatorTok{]} \OperatorTok{++;}
              \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ j }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{j }\OperatorTok{\textless{}}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{size}\OperatorTok{();}\NormalTok{j}\OperatorTok{++)\{}
  \NormalTok{                S}\OperatorTok{[}\NormalTok{LCA}\OperatorTok{::}\NormalTok{query}\OperatorTok{(}\NormalTok{dfn}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j }\OperatorTok{{-}} \DecValTok{1}\OperatorTok{].}\NormalTok{second}\OperatorTok{,}\NormalTok{ dfn}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{].}\NormalTok{second}\OperatorTok{)]} \OperatorTok{{-}{-};}
  \NormalTok{                S}\OperatorTok{[}\NormalTok{dfn}\OperatorTok{[}\NormalTok{i}\OperatorTok{][}\NormalTok{j}\OperatorTok{].}\NormalTok{second}\OperatorTok{]} \OperatorTok{++;}
              \OperatorTok{\}}
          \OperatorTok{\}}
  \NormalTok{        dfs}\OperatorTok{(}\NormalTok{root}\OperatorTok{,}\NormalTok{ root}\OperatorTok{);}
      \OperatorTok{\}}
  \OperatorTok{\}}
  
  \KeywordTok{namespace}\NormalTok{ Status2}\OperatorTok{\{}
      \DataTypeTok{void}\NormalTok{ dfs}\OperatorTok{(}\DataTypeTok{int}\NormalTok{ now}\OperatorTok{,} \DataTypeTok{int}\NormalTok{ fa}\OperatorTok{)\{}
          \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=}\NormalTok{ head}\OperatorTok{[}\NormalTok{now}\OperatorTok{];}\NormalTok{i}\OperatorTok{;}\NormalTok{i }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{nxt}\OperatorTok{)\{}
              \DataTypeTok{int}\NormalTok{ to }\OperatorTok{=}\NormalTok{ edge}\OperatorTok{[}\NormalTok{i}\OperatorTok{].}\NormalTok{node}\OperatorTok{;}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{to }\OperatorTok{==}\NormalTok{ fa}\OperatorTok{)} \ControlFlowTok{continue}\OperatorTok{;}
  \NormalTok{            dfs}\OperatorTok{(}\NormalTok{to}\OperatorTok{,}\NormalTok{ now}\OperatorTok{);}\NormalTok{tar}\OperatorTok{[}\NormalTok{now}\OperatorTok{]} \OperatorTok{|=}\NormalTok{ tar}\OperatorTok{[}\NormalTok{to}\OperatorTok{];}
          \OperatorTok{\}}
      \OperatorTok{\}}
      \DataTypeTok{void}\NormalTok{ work}\OperatorTok{()\{}
  \NormalTok{        dfs}\OperatorTok{(}\NormalTok{root}\OperatorTok{,}\NormalTok{ root}\OperatorTok{);}
          \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{i}\OperatorTok{++)\{}
              \ControlFlowTok{if}\OperatorTok{(}\NormalTok{tar}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{==} \DecValTok{0}\OperatorTok{)\{}\CommentTok{//反树 包含全集； }
  \NormalTok{                ans }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{ans}\OperatorTok{,}\NormalTok{ MaxDeep}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{+} \DecValTok{2}\OperatorTok{);}
              \OperatorTok{\}}
          \OperatorTok{\}}
      \OperatorTok{\}}
  \OperatorTok{\}}
  \DataTypeTok{signed}\NormalTok{ main}\OperatorTok{()}
  \OperatorTok{\{}
  \NormalTok{    n }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ m }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
      \DataTypeTok{int}\NormalTok{ maxx }\OperatorTok{=} \OperatorTok{{-}}\DecValTok{1}\OperatorTok{;}
      \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{i}\OperatorTok{++)}\NormalTok{ col}\OperatorTok{[}\NormalTok{i}\OperatorTok{]} \OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ maxx }\OperatorTok{=}\NormalTok{ max}\OperatorTok{(}\NormalTok{maxx}\OperatorTok{,}\NormalTok{ col}\OperatorTok{[}\NormalTok{i}\OperatorTok{]);}
      \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{i }\OperatorTok{\textless{}}\NormalTok{ n}\OperatorTok{;}\NormalTok{i}\OperatorTok{++)\{}
          \DataTypeTok{int}\NormalTok{ tmpx }\OperatorTok{=}\NormalTok{ read}\OperatorTok{(),}\NormalTok{ tmpy }\OperatorTok{=}\NormalTok{ read}\OperatorTok{();}
  \NormalTok{        add}\OperatorTok{(}\NormalTok{tmpx}\OperatorTok{,}\NormalTok{ tmpy}\OperatorTok{);}
  \NormalTok{        add}\OperatorTok{(}\NormalTok{tmpy}\OperatorTok{,}\NormalTok{ tmpx}\OperatorTok{);}
      \OperatorTok{\}}
  \NormalTok{    root }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  \NormalTok{    dfs1}\OperatorTok{(}\NormalTok{root}\OperatorTok{,}\NormalTok{ root}\OperatorTok{);}
  \NormalTok{    dfs2}\OperatorTok{(}\NormalTok{root}\OperatorTok{,}\NormalTok{ root}\OperatorTok{);}
  \NormalTok{    LCA}\OperatorTok{::}\NormalTok{work}\OperatorTok{();}
      \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{i }\OperatorTok{\textless{}=}\NormalTok{ n}\OperatorTok{;}\NormalTok{i}\OperatorTok{++)\{}
          \DataTypeTok{int} \OperatorTok{\&}\NormalTok{cl }\OperatorTok{=}\NormalTok{ colorLCA}\OperatorTok{[}\NormalTok{col}\OperatorTok{[}\NormalTok{i}\OperatorTok{]];}
          \ControlFlowTok{if}\OperatorTok{(}\NormalTok{cl }\OperatorTok{==} \DecValTok{0}\OperatorTok{)}\NormalTok{ cl }\OperatorTok{=}\NormalTok{ i}\OperatorTok{;}
          \ControlFlowTok{else}\NormalTok{ cl }\OperatorTok{=}\NormalTok{ LCA}\OperatorTok{::}\NormalTok{query}\OperatorTok{(}\NormalTok{cl}\OperatorTok{,}\NormalTok{ i}\OperatorTok{);}
      \OperatorTok{\}}
      \ControlFlowTok{for}\OperatorTok{(}\NormalTok{\_R }\DataTypeTok{int}\NormalTok{ i }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}\NormalTok{i }\OperatorTok{\textless{}=}\NormalTok{ m}\OperatorTok{;}\NormalTok{i}\OperatorTok{++)}\NormalTok{ tar}\OperatorTok{[}\NormalTok{colorLCA}\OperatorTok{[}\NormalTok{i}\OperatorTok{]]} \OperatorTok{=} \DecValTok{1}\OperatorTok{;}
  
  \NormalTok{    Status1}\OperatorTok{::}\NormalTok{work}\OperatorTok{();}
      
  \NormalTok{    Status2}\OperatorTok{::}\NormalTok{work}\OperatorTok{();}
      
  \NormalTok{    cout }\OperatorTok{\textless{}\textless{}}\NormalTok{ ans }\OperatorTok{\textless{}\textless{}}\NormalTok{ endl}\OperatorTok{;}
      \ControlFlowTok{return} \DecValTok{0}\OperatorTok{;}
   \OperatorTok{\}} 
  \end{Highlighting}
  \end{Shaded}
  
  
  \end{document}
[INFO] [makePDF] LaTeX run number 1
[INFO] [makePDF] LaTeX output
  This is XeTeX, Version 3.141592653-2.6-0.999995 (TeX Live 2023/Debian) (preloaded format=xelatex)
   restricted \write18 enabled.
  entering extended mode
  (.../input.tex
  LaTeX2e <2023-11-01> patch level 1
  L3 programming layer <2024-01-22>
  (.../article.cls
  Document Class: article 2023/05/17 v1.4n Standard LaTeX document class
  (.../[system]
  (.../xcolor.sty
  (.../color.cfg)
  (.../xetex.def)
  (.../[system]
  (.../geometry.sty
  (.../keyval.sty)
  (.../ifvtex.sty
  (.../iftex.sty)))
  (.../amsmath.sty
  For additional information on amsmath, use the `?' option.
  (.../amstext.sty
  (.../amsgen.sty))
  (.../amsbsy.sty)
  (.../amsopn.sty))
  (.../amssymb.sty
  (.../amsfonts.sty))
  (.../unicode-math.sty
  (.../expl3.sty
  (.../l3backend-xetex.def))
  (.../unicode-math-xetex.sty
  (.../xparse.sty)
  (.../l3keys2e.sty)
  (.../fontspec.sty
  (.../fontspec-xetex.sty
  (.../fontenc.sty)
  (.../fontspec.cfg)))
  (.../fix-cm.sty
  (.../ts1enc.def))
  (.../unicode-math-table.tex)))
  (.../lmodern.sty)
  (.../xeCJK.sty
  (.../ctexhook.sty)
  (.../xtemplate.sty)
  (.../xeCJK.cfg))
  (.../upquote.sty
  (.../textcomp.sty))
  (.../microtype.sty
  (.../etoolbox.sty)
  (.../microtype-xetex.def)
  (.../microtype.cfg))
  (.../setspace.sty)
  (.../parskip.sty
  (.../kvoptions.sty
  (.../ltxcmds.sty)
  (.../kvsetkeys.sty)))
  (.../fancyvrb.sty)
  (.../bookmark.sty
  (.../hyperref.sty
  (.../kvdefinekeys.sty)
  (.../pdfescape.sty
  (.../pdftexcmds.sty
  (.../infwarerr.sty)))
  (.../hycolor.sty)
  (.../auxhook.sty)
  (.../nameref.sty
  (.../refcount.sty)
  (.../gettitlestring.sty))
  (.../pd1enc.def)
  (.../intcalc.sty)
  (.../puenc.def)
  (.../url.sty)
  (.../bitset.sty
  (.../bigintcalc.sty))
  (.../atbegshi-ltx.sty))
  (.../hxetex.def
  (.../stringenc.sty)
  (.../rerunfilecheck.sty
  (.../atveryend-ltx.sty)
  (.../uniquecounter.sty)))
  (.../bkm-dvipdfm.def))
  (.../xurl.sty)
  No file input.aux.
  *geometry* driver: auto-detecting
  *geometry* detected driver: xetex
  (.../mt-LatinModernRoman.cfg)
  
  Package hyperref Warning: Rerun to get /PageLabels entry.
  
  (.../omllmm.fd)
  (.../umsa.fd)
  (.../mt-msa.cfg)
  (.../umsb.fd)
  (.../mt-msb.cfg)
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/b/n' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 116.
  
  
  Package xeCJK Warning: Unknown CJK family `\CJKttdefault' is being ignored.
  (xeCJK)                
  (xeCJK)                Try to use `\setCJKmonofont[<...>]{<...>}' to define
  (xeCJK)                it.
  
  [1] [2] [3] [4]
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/m/it' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 328.
  
  [5] [6] (.../input.aux)
  
  LaTeX Font Warning: Some font shapes were not available, defaults substituted.
  
  
  LaTeX Warning: Label(s) may have changed. Rerun to get cross-references right.
  
   )
  Output written on .../input.pdf (6 pages).
  Transcript written on .../input.log.
[INFO] [makePDF] Rerun needed
  Package hyperref Warning: Rerun to get /PageLabels entry.
  LaTeX Warning: Label(s) may have changed. Rerun to get cross-references right.
[INFO] [makePDF] LaTeX run number 2
[INFO] [makePDF] LaTeX output
  This is XeTeX, Version 3.141592653-2.6-0.999995 (TeX Live 2023/Debian) (preloaded format=xelatex)
   restricted \write18 enabled.
  entering extended mode
  (.../input.tex
  LaTeX2e <2023-11-01> patch level 1
  L3 programming layer <2024-01-22>
  (.../article.cls
  Document Class: article 2023/05/17 v1.4n Standard LaTeX document class
  (.../[system]
  (.../xcolor.sty
  (.../color.cfg)
  (.../xetex.def)
  (.../[system]
  (.../geometry.sty
  (.../keyval.sty)
  (.../ifvtex.sty
  (.../iftex.sty)))
  (.../amsmath.sty
  For additional information on amsmath, use the `?' option.
  (.../amstext.sty
  (.../amsgen.sty))
  (.../amsbsy.sty)
  (.../amsopn.sty))
  (.../amssymb.sty
  (.../amsfonts.sty))
  (.../unicode-math.sty
  (.../expl3.sty
  (.../l3backend-xetex.def))
  (.../unicode-math-xetex.sty
  (.../xparse.sty)
  (.../l3keys2e.sty)
  (.../fontspec.sty
  (.../fontspec-xetex.sty
  (.../fontenc.sty)
  (.../fontspec.cfg)))
  (.../fix-cm.sty
  (.../ts1enc.def))
  (.../unicode-math-table.tex)))
  (.../lmodern.sty)
  (.../xeCJK.sty
  (.../ctexhook.sty)
  (.../xtemplate.sty)
  (.../xeCJK.cfg))
  (.../upquote.sty
  (.../textcomp.sty))
  (.../microtype.sty
  (.../etoolbox.sty)
  (.../microtype-xetex.def)
  (.../microtype.cfg))
  (.../setspace.sty)
  (.../parskip.sty
  (.../kvoptions.sty
  (.../ltxcmds.sty)
  (.../kvsetkeys.sty)))
  (.../fancyvrb.sty)
  (.../bookmark.sty
  (.../hyperref.sty
  (.../kvdefinekeys.sty)
  (.../pdfescape.sty
  (.../pdftexcmds.sty
  (.../infwarerr.sty)))
  (.../hycolor.sty)
  (.../auxhook.sty)
  (.../nameref.sty
  (.../refcount.sty)
  (.../gettitlestring.sty))
  (.../pd1enc.def)
  (.../intcalc.sty)
  (.../puenc.def)
  (.../url.sty)
  (.../bitset.sty
  (.../bigintcalc.sty))
  (.../atbegshi-ltx.sty))
  (.../hxetex.def
  (.../stringenc.sty)
  (.../rerunfilecheck.sty
  (.../atveryend-ltx.sty)
  (.../uniquecounter.sty)))
  (.../bkm-dvipdfm.def))
  (.../xurl.sty)
  (.../input.aux)
  *geometry* driver: auto-detecting
  *geometry* detected driver: xetex
  (.../mt-LatinModernRoman.cfg)
  (.../omllmm.fd)
  (.../umsa.fd)
  (.../mt-msa.cfg)
  (.../umsb.fd)
  (.../mt-msb.cfg)
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/b/n' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 116.
  
  
  Package xeCJK Warning: Unknown CJK family `\CJKttdefault' is being ignored.
  (xeCJK)                
  (xeCJK)                Try to use `\setCJKmonofont[<...>]{<...>}' to define
  (xeCJK)                it.
  
  [1] [2] [3] [4]
  
  LaTeX Font Warning: Font shape `TU/ARPLUKaiCN(0)/m/it' undefined
  (Font)              using `TU/ARPLUKaiCN(0)/m/n' instead on input line 328.
  
  [5] [6] (.../input.aux)
  
  LaTeX Font Warning: Some font shapes were not available, defaults substituted.
  
   )
  Output written on .../input.pdf (6 pages).
  Transcript written on .../input.log.
</pre>
                                            </details>
                    
                                    </div>
                                </article>
                

                

                

                

            

                
                        </div>
                    </main>
            </div>

                <!-- Footer -->
                <footer id="footer">
                    <p>© 2025 ShuYuMo's Blog by Jiayi Su. All rights reserved.</p>  Powered by <b>MonoPy</b> - Single-Script Blog Generator in Python.
                </footer>
            </div>
        </div>
        
        <!-- Back to top button -->
        <button id="back-to-top" 
                aria-label="Back to top" 
                title="Back to top"
                style="display: none;">
            ↑
        </button>
        
        <!-- JavaScript -->
        <script>
            // Back to top functionality
            (function() {
                const backToTopButton = document.getElementById('back-to-top');
                const scrollThreshold = 300;
                
                function toggleBackToTop() {
                    if (window.scrollY > scrollThreshold) {
                        backToTopButton.style.display = 'block';
                    } else {
                        backToTopButton.style.display = 'none';
                    }
                }
                
                function scrollToTop() {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                }
                
                window.addEventListener('scroll', toggleBackToTop);
                backToTopButton.addEventListener('click', scrollToTop);
            })();
            
            // Clean up redundant spans in code blocks
            document.querySelectorAll('pre code').forEach(codeBlock => {
                // Find all line spans
                const lineSpans = codeBlock.querySelectorAll('span[id^="cb"]');
                
                lineSpans.forEach(lineSpan => {
                    // Check if this line has nested spans that can be simplified
                    const children = Array.from(lineSpan.childNodes);
                    
                    // Skip the anchor link (first child is usually the line number anchor)
                    let contentStart = 0;
                    if (children[0] && children[0].tagName === 'A') {
                        contentStart = 1;
                    }
                    
                    // If there's only one span child after the anchor, unwrap it
                    const contentChildren = children.slice(contentStart);
                    if (contentChildren.length === 1 && contentChildren[0].tagName === 'SPAN') {
                        const spanChild = contentChildren[0];
                        // Move the span's contents directly to the line span
                        while (spanChild.firstChild) {
                            lineSpan.insertBefore(spanChild.firstChild, spanChild);
                        }
                        // Remove the now-empty span
                        spanChild.remove();
                    }
                });
            });
            
            // Code copy functionality
            document.querySelectorAll('pre code').forEach(block => {
                const button = document.createElement('button');
                button.className = 'copy-button';
                button.textContent = 'Copy';
                button.setAttribute('aria-label', 'Copy code to clipboard');
                
                button.addEventListener('click', function() {
                    navigator.clipboard.writeText(block.textContent).then(() => {
                        button.textContent = 'Copied!';
                        setTimeout(() => button.textContent = 'Copy', 2000);
                    }).catch(() => {
                        // Fallback for older browsers
                        const textArea = document.createElement('textarea');
                        textArea.value = block.textContent;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        button.textContent = 'Copied!';
                        setTimeout(() => button.textContent = 'Copy', 2000);
                    });
                });
                
                const pre = block.parentNode;
                pre.style.position = 'relative';
                pre.appendChild(button);
            });
        </script>
    </body>
</html>