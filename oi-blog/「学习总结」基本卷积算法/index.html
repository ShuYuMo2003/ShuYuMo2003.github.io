<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/oi-blog/images/apple-touch-icon-next.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/oi-blog/images/favicon-32x32-next.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/oi-blog/images/favicon-16x16-next.ico">
  <link rel="mask-icon" href="/oi-blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/oi-blog/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=sans-serif:300,300italic,400,400italic,700,700italic%7CUbuntu:300,300italic,400,400italic,700,700italic%7CRoboto:300,300italic,400,400italic,700,700italic%7C'Open+Sans':300,300italic,400,400italic,700,700italic%7C'Microsoft+YaHei':300,300italic,400,400italic,700,700italic%7Csans-serif;:300,300italic,400,400italic,700,700italic%7CSource+Code+Pro:300,300italic,400,400italic,700,700italic%7Cmonospace:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css">
  <script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js"></script>

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"https:/ShuYuMo2003.github.io","root":"/","images":"/images","scheme":"Mist","version":"8.2.1","exturl":false,"sidebar":{"position":"left","width":250,"display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="「做多项式题就像嗑药，出多项式题就像贩毒。」 —— 某福建知名OI选手 学了学红日bn一年前玩剩下的东西。  倒是扩展了 FWT 的一种思路吧。">
<meta property="og:type" content="article">
<meta property="og:title" content="「学习总结」基本卷积算法">
<meta property="og:url" content="%E3%80%8C%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93%E3%80%8D%E5%9F%BA%E6%9C%AC%E5%8D%B7%E7%A7%AF%E7%AE%97%E6%B3%95/index.html">
<meta property="og:site_name" content="Shu Yu Mo&#39;s blog">
<meta property="og:description" content="「做多项式题就像嗑药，出多项式题就像贩毒。」 —— 某福建知名OI选手 学了学红日bn一年前玩剩下的东西。  倒是扩展了 FWT 的一种思路吧。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-01-17T07:35:06.000Z">
<meta property="article:modified_time" content="2021-08-27T11:42:44.027Z">
<meta property="article:author" content="舒雨墨">
<meta property="article:tag" content="多项式">
<meta property="article:tag" content="FWT">
<meta property="article:tag" content="NTT">
<meta property="article:tag" content="FFT">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="「学习总结」基本卷积算法/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<title>「学习总结」基本卷积算法 | Shu Yu Mo's blog</title>





  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/oi-blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Shu Yu Mo's blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">远行者</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/oi-blog/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/oi-blog/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/oi-blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/oi-blog/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/oi-blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
        <li class="menu-item menu-item-latex-syntax"><a href="/oi-blog/LaTeX-syntax.html" rel="section"><i class="fa fa-heart fa-fw"></i>LaTeX-syntax</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>


  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">


      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">


          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="舒雨墨"
      src="/oi-blog/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">舒雨墨</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/oi-blog/archives/">

          <span class="site-state-item-count">36</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/oi-blog/categories/">

        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/oi-blog/tags/">

        <span class="site-state-item-count">60</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ShuYuMo2003" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ShuYuMo2003" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.luogu.com.cn/user/44615" title="Luogu → https:&#x2F;&#x2F;www.luogu.com.cn&#x2F;user&#x2F;44615" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>Luogu</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:sujiayi2003@gmail.com" title="E-Mail → mailto:sujiayi2003@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/JiaYiSu5" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;JiaYiSu5" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>




          <hr/>
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%8D%B7%E7%A7%AF%E7%AE%97%E6%B3%95"><span class="nav-number">1.</span> <span class="nav-text">基本卷积算法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A0%E6%B3%95%E5%8D%B7%E7%A7%AF"><span class="nav-number">1.1.</span> <span class="nav-text">加法卷积</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2fft"><span class="nav-number">1.1.1.</span> <span class="nav-text">快速傅里叶变换（FFT）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E4%BD%8D%E6%A0%B9"><span class="nav-number">1.1.1.1.</span> <span class="nav-text">单位根</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%9D%B4%E8%9D%B6%E6%93%8D%E4%BD%9C"><span class="nav-number">1.1.1.2.</span> <span class="nav-text">蝴蝶操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%86%E5%8F%98%E6%8D%A2"><span class="nav-number">1.1.1.3.</span> <span class="nav-text">逆变换</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E6%95%B0%E8%AE%BA%E5%8F%98%E6%8D%A2ntt"><span class="nav-number">1.1.2.</span> <span class="nav-text">快速数论变换（NTT）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%8D%E8%BF%90%E7%AE%97%E5%8D%B7%E7%A7%AF"><span class="nav-number">1.2.</span> <span class="nav-text">位运算卷积</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E6%B2%83%E5%B0%94%E4%BB%80%E5%8F%98%E6%8D%A2fwt"><span class="nav-number">1.2.1.</span> <span class="nav-text">快速沃尔什变换（FWT）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%88%96%E8%BF%90%E7%AE%97"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">或运算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8E%E8%BF%90%E7%AE%97"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">与运算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E8%88%AC%E6%96%B9%E6%B3%95"><span class="nav-number">1.2.1.3.</span> <span class="nav-text">一般方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B4%A8%E6%95%B0%E8%A1%A8"><span class="nav-number">1.2.1.3.1.</span> <span class="nav-text">质数表</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div>

        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="舒雨墨"
      src="/oi-blog/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">舒雨墨</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/oi-blog/archives/">

          <span class="site-state-item-count">36</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/oi-blog/categories/">

        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/oi-blog/tags/">

        <span class="site-state-item-count">60</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ShuYuMo2003" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ShuYuMo2003" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.luogu.com.cn/user/44615" title="Luogu → https:&#x2F;&#x2F;www.luogu.com.cn&#x2F;user&#x2F;44615" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>Luogu</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:sujiayi2003@gmail.com" title="E-Mail → mailto:sujiayi2003@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/JiaYiSu5" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;JiaYiSu5" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>


  <div class="back-to-top" role="button">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">





<div class="post-block">



  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="/oi-blog/「学习总结」基本卷积算法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/oi-blog/images/avatar.jpg">
      <meta itemprop="name" content="舒雨墨">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shu Yu Mo's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          「学习总结」基本卷积算法
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-01-17 15:35:06" itemprop="dateCreated datePublished" datetime="2021-01-17T15:35:06+08:00">2021-01-17</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-08-27 19:42:44" itemprop="dateModified" datetime="2021-08-27T19:42:44+08:00">2021-08-27</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/oi-blog/categories/学习总结/" itemprop="url" rel="index"><span itemprop="name">学习总结</span></a>
        </span>
    </span>


    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>




    <div class="post-body" itemprop="articleBody">
          <div class="note warning"><p>「做多项式题就像嗑药，出多项式题就像贩毒。」 —— 某福建知名OI选手</p>
<p>学了学红日bn一年前玩剩下的东西。</p>
</div>
<p>倒是扩展了 FWT 的一种思路吧。</p>
<a id="more"></a>
<h1 id="基本卷积算法">基本卷积算法</h1>
<h2 id="加法卷积">加法卷积</h2>
<p>用于解决形如以下问题： 给出两个序列 <span class="math inline">\(A, B\)</span>。求两个序列的卷积序列 <span class="math inline">\(C\)</span>，其中序列 <span class="math inline">\(C\)</span> 的定义如下 <span class="math display">\[
\begin{equation} \label{QWQ}
C_k = \sum_{i+j=k}A_i \times B_j
\end{equation}
\]</span> 序列可以看作是函数的系数表示法，所以我们可以定义函数 $F(x) = _{i 0} A_i x^i $ 和函数 <span class="math inline">\(G(x)= \sum_{i \ge 0} B_i x^i\)</span> 分别对应序列 <span class="math inline">\(A, B\)</span> 的两个函数。</p>
<p>类似的，还可以定义序列 <span class="math inline">\(C\)</span> 对应函数 <span class="math inline">\(T(x) = \sum_{i \ge 0} C_i x^i\)</span>。</p>
<p>注意到这种定义就是将序列的第 <span class="math inline">\(i\)</span> 个数当作多项式函数的第 <span class="math inline">\(i\)</span> 次系数。</p>
<p>注意到 <span class="math display">\[
\begin{equation} \label{QAQ}
T(x)=F(x) \times G(x)
\end{equation}
\]</span> 这个是后面卷积方法的核心工作原理。本质上是 建立了 <strong>序列运算</strong> 与其对应 <strong>函数（多项式）运算</strong> 的一种联系。</p>
<p>注意到 <span class="math inline">\((\ref{QAQ})\)</span> 也可以理解为对于任意常数 <span class="math inline">\(a\)</span>，总有 <span class="math inline">\(T(a)=F(a) \times G(a)\)</span>。</p>
<p>也就是说，如果我们知道了 <span class="math inline">\(G(x)\)</span> 和 <span class="math inline">\(F(x)\)</span> 在 <span class="math inline">\(a\)</span> 处的函数值，那么他们相乘就能够得到 <span class="math inline">\(T(x)\)</span> 在 <span class="math inline">\(a\)</span> 处的函数值。</p>
<p>考虑如果存在一种变换，能够快速计算 <span class="math inline">\(G(x)\)</span> 和 <span class="math inline">\(F(x)\)</span> 在某些特定自变量 <span class="math inline">\(\\{a_1, a_2, a_3,\cdots a_k\\}\)</span> 处的函数值，那么就能快速算出 <span class="math inline">\(T(x)\)</span> 在这些自变量处的函数值。</p>
<p>如果存在某种逆变换，能够快速将函数在某些自变量处的函数值转换成每一次项的系数，那么就能够求出 <span class="math inline">\(T(x)\)</span> 的系数（即序列 <span class="math inline">\(C\)</span>）了。</p>
<p>总的来说，希望存在一种序列上变换 <span class="math inline">\(\operatorname{FFT}(T)\)</span>，使得 <span class="math display">\[
\begin{equation}
\operatorname{FFT}(C) = \operatorname{FFT}(A \times B) = \operatorname{FFT}(A) \cdot \operatorname{FFT}(B)
\end{equation}
\]</span> 其中 <span class="math inline">\(\times\)</span> 表示序列加法卷积 <span class="math inline">\((\ref{QWQ})\)</span>，<span class="math inline">\(\cdot\)</span> 表示对应位置相乘。</p>
<p>并且这种变换存在逆变换，能够将 <span class="math inline">\(\operatorname{FFT}(C)\)</span> 还原为 <span class="math inline">\(C\)</span> 。</p>
<p>通过上述描述可以发现，对于一个函数 <span class="math inline">\(G(x)\)</span> 来说，其表示成序列的方式有两种：一种是构造序列，使得序列第 <span class="math inline">\(i\)</span> 位为多项式函数 <span class="math inline">\(G(x)\)</span> 的第 <span class="math inline">\(i\)</span> 次项系数。另一种是指定一系列取值<span class="math inline">\(\\{a_1, a_2, a_3,\cdots a_k\\}\)</span> ，分别带入函数中，得到的函数值依次排开，成为一个序列。我们称前者为函数 <span class="math inline">\(G(x)\)</span> 的系数表示法，称后者为其点值表示法。而我们所希望的变换就是能够实现函数的<strong>系数表示法</strong> 与 <strong>点值表示法</strong> 相互转化。</p>
<p>因为 两函数相乘时，其对应的系数表示法的序列就是在做卷积操作，对应了我们希望的运算，但是这个并不能快速计算。而两函数相乘，对于点值表示法，就仅仅是对应位置相乘，这个可以快速计算。所以可以考虑如果能够快速实现 <em>函数的<strong>系数表示法</strong> 与 <strong>点值表示法</strong> 相互转化</em>。就能够解决上述问题。可以先转化为点值表示法，然后对点相乘后，再转换为系数表示法，就相当于对序列做卷积。</p>
<h3 id="快速傅里叶变换fft">快速傅里叶变换（FFT）</h3>
<p><strong>快速傅里叶变换</strong> 就是一种满足上述条件的变换。她可以使得函数在系数表示法与点值表示法之间转换。 时间复杂度为 <span class="math inline">\(\mathcal{O}(n \log n)\)</span>。</p>
<p>考虑上述过程中，并没有限制点值表示法中的点值应该取哪些值，所以可以考虑取一些有丰富性质的数字，利用这些性质加速运算。</p>
<p>对于 FFT 我们取 <strong>n次单位根</strong> 来加速运算。<span class="math inline">\(n\)</span> 为待变换序列长度。</p>
<h4 id="单位根">单位根</h4>
<p><em>n</em> 次单位根记作 <span class="math inline">\(\omega_n\)</span>。其定义为 <span class="math inline">\(\omega_n = \cos{\frac{2\pi}{n}} + \mathrm{i}\sin{\frac{2\pi}{n}}\)</span>，这是一个虚数。虚数可以通过向量来表示，而 <span class="math inline">\(\omega_n\)</span> 就可以考虑为一个模长为 <span class="math inline">\(1\)</span> ，与 <span class="math inline">\(x\)</span> 轴夹角为 <span class="math inline">\(\frac{2\pi}{n}\)</span> 的向量。易知， <span class="math inline">\(\omega_n^k=\cos{\frac{2\pi k}{n}} + \mathrm{i}\sin{\frac{2\pi k}{n}}\)</span>。</p>
<p>他有如下性质</p>
<ul>
<li><span class="math inline">\(\omega_n^k=\omega_{2n}^{2k}\)</span></li>
<li><span class="math inline">\(\omega_n^{k + \frac{n}{2}}=-\omega_{n}^{k}\)</span></li>
<li><span class="math inline">\(\omega_n^0=\omega_n^n=1\)</span></li>
</ul>
<p>这些性质都可以通过其定义得知。</p>
<p>考虑将 <span class="math inline">\(\omega_n^0, \omega_n^1, \omega_n^2, \cdots, \omega_n^{n-1}\)</span> 带入函数，得到点值即可。</p>
<h4 id="蝴蝶操作">蝴蝶操作</h4>
<p>分别抽取函数 <span class="math inline">\(F(x)\)</span> 的奇、偶次项系数构成两个新函数 <span class="math inline">\(G(x), H(x)\)</span>。 易知: <span class="math display">\[
F(x) = G(x^2) + xH(x^2)
\]</span> 即 <span class="math display">\[
\begin{equation}
F(\omega_n^k) = G(\omega_{n/2}^k) + \omega_n^k H(\omega_{n/2}^k)
\end{equation}
\]</span> <span class="math display">\[
\begin{equation}
F(\omega_n^{k + n/2}) = G(\omega_{n/2}^k) - \omega_n^k H(\omega_{n/2}^k)
\end{equation}
\]</span></p>
<p>划分了子问题，分治即可。这里必须保证 <span class="math inline">\(n = 2^k\)</span>，<span class="math inline">\(k \in \mathbb{N}\)</span></p>
<h4 id="逆变换">逆变换</h4>
<p>单位根还有如下性质 <span class="math display">\[
\begin{equation}
\sum_{i=0}^{n-1}\left(\omega_n^k\right)^i=
\begin{cases}
0&amp; {k \not= 0}\\\\
n&amp; {k = 0}
\end{cases}
\end{equation}
\]</span> 第二种情况显然，第一种情况根据等比数列求和公式可以得证。</p>
<p>根据上述性质，我们只需要取单位根为之前的倒数，然后跑一遍 <span class="math inline">\(\operatorname{FFT}\)</span> 对结果除以 <span class="math inline">\(n\)</span> 即可。 不会推QAQ。</p>
<h3 id="快速数论变换ntt">快速数论变换（NTT）</h3>
<p>FFT 需要实数运算，对精度要求较高。且无法解决常见的取模要求。</p>
<p>注意到 <span class="math inline">\(FFT\)</span> 中所依赖的是一个复平面上的单位圆，其实剩余系本身就可以看作一个环。可以考虑在剩余系下寻找具有与单位根性质类似的数字。</p>
<p>设质数 <span class="math inline">\(P\)</span> 的原根为 <span class="math inline">\(g\)</span>。那么 <span class="math inline">\(\forall k \in [0, \varphi(P) - 1],k \in \mathbb{N},g^{k}\)</span>，可以表示 <span class="math inline">\(P\)</span> 的剩余系中除 <span class="math inline">\(0\)</span> 以外的任何数字，显然可表示的数字有 <span class="math inline">\(P-1\)</span> 个。</p>
<div class="note warning"><p>以下关于剩余系类比复平面单位圆的描述由笔者口胡，不保证语言严谨。</p>
</div>
<p>在 <span class="math inline">\(\operatorname{FFT}\)</span> 中取单位根的方式本质上实在均分复平面上单位圆。而 <span class="math inline">\(\operatorname{NTT}\)</span> 中，如果将 <span class="math inline">\(g^k\)</span> 依次排成一个环，即剩余系，我们一样可以通过均分这个环，来取剩余系下的“单位根”，来获得和之前复平面单位根 类似性质的一些数。显然，这里需要保证在我们均分单位圆的过程中，每个值都能取到，也就是 <span class="math inline">\(n | \varphi(P)\)</span>，即 <span class="math inline">\(n | (P-1)\)</span>。</p>
<p>所以这里的剩余系取值有一定要求，变换中所要求的 <span class="math inline">\(n\)</span> 都是 <span class="math inline">\(2\)</span> 的次幂，需要保证 <span class="math inline">\(P-1\)</span> 中 <span class="math inline">\(2\)</span> 的幂次应该足够大。（文末附<a href="./#质数表">质数取值表</a>）</p>
<p>设 <span class="math inline">\(P-1 = q\times n\)</span>。</p>
<p>考虑将 <span class="math inline">\(g_n=g^q\)</span> 当作 <span class="math inline">\(\omega_n\)</span> 即可，根据上面的描述，<span class="math inline">\(\omega_n\)</span> 所具有的性质，<span class="math inline">\(g_{n}\)</span> 显然成立。这里的 <span class="math inline">\(q\)</span> 可以想成等分环时的单位角度。</p>
<p>关于 <strong>蝴蝶操作</strong> 和 <strong>逆变换</strong> 的手法和 <span class="math inline">\(\operatorname{FFT}\)</span> 是一样的。</p>
<h2 id="位运算卷积">位运算卷积</h2>
<p>类似地，定义位运算序列卷积。 给出两个序列 <span class="math inline">\(A, B\)</span>。求两个序列的卷积序列 <span class="math inline">\(C\)</span>，其中序列 <span class="math inline">\(C\)</span> 的定义如下 <span class="math display">\[
\begin{equation} \label{QWQWQ}
C_k = \sum_{i\oplus j=k}A_i \times B_j
\end{equation}
\]</span> 可以仿照上述思路，构造一种作用在序列上的变换 <span class="math inline">\(\operatorname{FWT}\)</span>，使得其满足 <span class="math display">\[
\begin{equation} \label{FWT}
\operatorname{FWT}(C) = \operatorname{FWT}(A \oplus B) = \operatorname{FWT}(A) \cdot \operatorname{FWT}(B)
\end{equation}
\]</span> <span class="math inline">\(A \oplus B\)</span> 中的 <span class="math inline">\(\oplus\)</span> 指某种位运算。指下标的运算方式。即 <span class="math inline">\((\ref{QWQWQ})\)</span> 中的 <span class="math inline">\(i\oplus j=k\)</span>。</p>
<h3 id="快速沃尔什变换fwt">快速沃尔什变换（FWT）</h3>
<p>考虑分治处理，令 <span class="math inline">\(A_0\)</span> 为 <span class="math inline">\(A\)</span> 的前一半， <span class="math inline">\(A_1\)</span> 为 <span class="math inline">\(A\)</span> 的后一半。可以考虑如果已经求出了 <span class="math inline">\(\operatorname{FWT}(A_0)\)</span> 和 <span class="math inline">\(\operatorname{FWT}(A_1)\)</span>，如何求出 <span class="math inline">\(\operatorname{FWT}(A)\)</span>。</p>
<p>顺便定义函数 <span class="math inline">\(\operatorname{merge}(A, B)\)</span> 表示将序列 <span class="math inline">\(A, B\)</span> 直接前后拼接，返回拼接后的大序列。例如 <span class="math inline">\(A = \operatorname{merge}(A_0, A_1)\)</span>。</p>
<h4 id="或运算">或运算</h4>
<p>考虑如何构造 <span class="math inline">\(\operatorname{FWT}\)</span> 的方式，使得： <span class="math display">\[
\begin{equation} \label{FWTORBASE}
\operatorname{FWT}(A | B) = \operatorname{FWT}(A) \cdot \operatorname{FWT}(B)
\end{equation}
\]</span> 对于或运算卷积，直接给出结论。我们定义当前情况下的 <span class="math inline">\(\operatorname{FWT}\)</span> 的运算规则如下。 <span class="math display">\[
\begin{equation} \label{FWTOR}
\operatorname{FWT}(A) = \operatorname{merge}(\operatorname{FWT}(A_0), \operatorname{FWT}(A_0) + \operatorname{FWT}(A_1))
\end{equation}
\]</span> 其中 <span class="math inline">\(+\)</span> 为序列对应位置相加。</p>
<p>现在证明：已知 <span class="math inline">\((\ref{FWTOR})\)</span>， <span class="math inline">\((\ref{FWTORBASE})\)</span> 成立。</p>
<p>将 <span class="math inline">\(\operatorname{FWT}\)</span> 简记为 <span class="math inline">\(\operatorname{F}\)</span>，将 <span class="math inline">\(\operatorname{merge}(A, B)\)</span> 简记为 <span class="math inline">\([A, B]\)</span></p>
<p>首先试图从等式左边开始推导： <span class="math display">\[
\begin{split}
\operatorname{F}(A) \cdot \operatorname{F}(B) &amp;= \left[\ \operatorname{F}(A_0)\ \ ,\ \  \operatorname{F}(A_0) + \operatorname{F}(A_1)\right] \cdot \left[\operatorname{F}(B_0), \operatorname{F}(B_0) + \operatorname{F}(B_1)\ \right] \\\\
&amp;=\left[\ \operatorname{F}(A_0) \cdot\operatorname{F}(B_0)\ \ ,\ \   (\operatorname{F}(A_0) + \operatorname{F}(A_1)) \cdot (\operatorname{F}(B_0) + \operatorname{F}(B_1))\  \right]\\\\
&amp;=\left[\ \operatorname{F}(A_0) \cdot\operatorname{F}(B_0)\ \ ,\ \  \operatorname{F}(A_0)\cdot\operatorname{F}(B_0) + \operatorname{F}(A_0)\cdot\operatorname{F}(B_1) \\\\ + \operatorname{F}(A_1)\cdot\operatorname{F}(B_0) + \operatorname{F}(A_1)\cdot  \operatorname{F}(B_1)\ \right]\\\\
\end{split}
\]</span></p>
<p>再从等式右边开始推导，先假设当序列长度为 <span class="math inline">\(\frac{|A|}{2}\)</span> 时，根据 <span class="math inline">\((\ref{FWTOR})\)</span> 能够使得 <span class="math inline">\((\ref{FWTORBASE})\)</span> 成立。 <span class="math display">\[
\begin{split}
\operatorname{F}(A\ |\ B) &amp;= \operatorname{F}([A_0|B_0, A_0|B_1 + A_1|B_0 + A_1 | B_1]) \\\\
&amp;=[\operatorname{F}(A_0|B_0), \operatorname{F}(A_0|B_1) + \operatorname{F}(A_1|B_0) + \operatorname{F}(A_1 | B_1) + \operatorname{F}(A_0|B_0)]\\\\
&amp;=\left[\ \operatorname{F}(A_0) \cdot\operatorname{F}(B_0)\ \ ,\ \  \operatorname{F}(A_0)\cdot\operatorname{F}(B_0) + \operatorname{F}(A_0)\cdot\operatorname{F}(B_1) \\\\ + \operatorname{F}(A_1)\cdot\operatorname{F}(B_0) + \operatorname{F}(A_1)\cdot  \operatorname{F}(B_1)\ \right]\\\\
\end{split}
\]</span></p>
<p>我们假设结论在 序列长度为 <span class="math inline">\(\frac{|A|}{2}\)</span> 时 成立，能够推出 序列长度为 <span class="math inline">\(|A|\)</span> 时 成立，就能够推出上述结论在任何情况下均适用（数学归纳法）。</p>
<p>考虑如何构造逆变换 <span class="math inline">\(\operatorname{iFWT}\)</span> 的运算规则。 相当于每一步都反向操作。</p>
<p>因为： <span class="math display">\[
\begin{equation}
\operatorname{FWT}(A) = \operatorname{merge}(\operatorname{FWT}(A_0), \operatorname{FWT}(A_0) + \operatorname{FWT}(A_1))
\end{equation}
\]</span> 相当于，现在已经得到了 <span class="math inline">\(A_0&#39; = A_0\)</span> ，<span class="math inline">\(A_1&#39; = A_0 +A_1​\)</span> 那么易知： <span class="math display">\[
A_0 = A_0&#39;
\]</span> <span class="math display">\[
A_1 =  A_1&#39; - A_0&#39;
\]</span></p>
<p>因此，逆变换就是： <span class="math display">\[
\begin{equation}
\operatorname{iFWT}(A)=\operatorname{merge}(\operatorname{iFWT}(A_0), \operatorname{iFWT}(A_1) - \operatorname{iFWT}(A_0))
\end{equation}
\]</span></p>
<p>需要注意的是： <span class="math display">\[
\operatorname{FWT}(A)_i = \sum_{j \subseteq i}A_j
\]</span></p>
<h4 id="与运算">与运算</h4>
<p><span class="math display">\[
\begin{equation}
\operatorname{FWT}(A) = \operatorname{merge}(\operatorname{FWT}(A_0) + \operatorname{FWT}(A_1), \operatorname{FWT}(A_1))
\end{equation}
\]</span> <span class="math display">\[
\begin{equation}
\operatorname{iFWT}(A)=\operatorname{merge}(\operatorname{iFWT}(A_0) - \operatorname{iFWT}(A_1),\operatorname{iFWT}(A_1) )
\end{equation}
\]</span></p>
<p>需要注意的是： <span class="math display">\[
\operatorname{FWT}(A)_i = \sum_{i \subseteq j}A_j
\]</span></p>
<h4 id="一般方法">一般方法</h4>
<p>构造的逆运算为解方程。</p>
<p>考虑如何根据一种位运算，求出一种合法的 $ /  $ 构造方式。这里的<strong>合法</strong>指这种构造方式满足 <span class="math inline">\((\ref{FWT})\)</span></p>
<p>考虑某种位运算 <span class="math inline">\(\oplus\)</span> 的 <span class="math inline">\(\operatorname{FWT}​\)</span> 应该是什么样子。根据上面的两个例子，可以设出如下式子： <span class="math display">\[
\operatorname{F}(A) = \operatorname{merge}(a \cdot\operatorname{F}(A_0) + b \cdot\operatorname{F}(A_1)\ ,c \cdot\operatorname{F}(A_0) + d \cdot\operatorname{F}(A_1) )
\]</span> 这里的 <span class="math inline">\(a, b, c, d\)</span> 为常数，“<span class="math inline">\(\cdot\)</span>” 为普通乘法。</p>
<p>为了方便，设 <span class="math inline">\(U=\operatorname{F}(A_0)\)</span>，<span class="math inline">\(V=\operatorname{F}(A_1)\)</span>， <span class="math inline">\(W=\operatorname{F}(B_0)\)</span>，<span class="math inline">\(X=\operatorname{F}(B_1)\)</span></p>
<p>则： <span class="math display">\[
\begin{equation} \label{FWTCOM}
\begin{split}
\operatorname{F}(A)\cdot\operatorname{F}(B)&amp;=[aU+bV, cU+dV]\cdot[aW+bX, cW+dX]\\\\
&amp;=[a^2UW + 2ab(UX + VW)+b^2VX, c^2UW + 2cd(UX + VW)+d^2VX \ \ ]
\end{split}
\end{equation}
\]</span></p>
<p>这里以<strong>异或</strong>为例，因为序列是中间分成两个序列，不妨设序列长度均为 <span class="math inline">\(2\)</span> 的若干次方，那么分开之后，其下标的最高位一定是前一半为 0 后一半为 1，根据异或的运算规则，哪些元素组合起来能够什么样的最高位即可。</p>
<p>假设上式在 序列长度为 <span class="math inline">\(\frac{|A|}{2}​\)</span> 时是成立的。则： <span class="math display">\[
\begin{split}
\operatorname{F}(A \oplus B)&amp;=\operatorname{F}([A_0\oplus B_0 + A_1\oplus B_1, A_0\oplus B_1+A_1\oplus B_0])\\\\
&amp;=[a\operatorname{F}(A_0\oplus B_0 + A_1\oplus B_1) + b\operatorname{F}(A_0\oplus B_1+A_1\oplus B_0), c\operatorname{F}(A_0\oplus B_0 + A_1\oplus B_1) + d\operatorname{F}(A_0\oplus B_1+A_1\oplus B_0)]\\\\
&amp;=[a\operatorname{F}(A_0\oplus B_0) + a\operatorname{F}(A_1\oplus B_1) + b\operatorname{F}(A_0\oplus B_1)+b\operatorname{F}(A_1\oplus B_0),c\operatorname{F}(A_0\oplus B_0)+ c\operatorname{F}(A_1\oplus B_1) + d\operatorname{F}(A_0\oplus B_1)+d\operatorname{F}(A_1\oplus B_0)]\\\\
&amp;=[a\operatorname{F}(A_0)\operatorname{F}(B_0) + a\operatorname{F}(A_1)\operatorname{F}(B_1) + b\operatorname{F}(A_0)\operatorname{F}(B_1)+b\operatorname{F}(A_1)\operatorname{F}(B_0),c\operatorname{F}(A_0)\operatorname{F}(B_0)+ c\operatorname{F}(A_1)\operatorname{F}(B_1) + d\operatorname{F}(A_0)\operatorname{F}(B_1)+d\operatorname{F}(A_1)\operatorname{F}(B_0)]\\\\
&amp;=[aUW + aVX + bUX+bVW\ ,\ cUW+ cVX + dUX+dVW]
\end{split}
\]</span></p>
<p>和 <span class="math inline">\((\ref{FWTCOM})\)</span> 对齐系数可以得到如下方程组： <span class="math display">\[
\begin{cases}
a=a^2\\\\
a=b^2\\\\
b=2ab\\\\
c=c^2\\\\
c=d^2\\\\
d=2cd
\end{cases}
\]</span> 解上面的方程组即可，显然有许多解。但是考虑到不仅需要 <span class="math inline">\(\operatorname{FWT}\)</span> ，还需要 <span class="math inline">\(\operatorname{iFWT}\)</span>。有些解无法保证 <span class="math inline">\(\operatorname{iFWT}\)</span> 能够存在解。</p>
<p>由： <span class="math display">\[
\operatorname{F}(A) = \operatorname{merge}(a \cdot\operatorname{F}(A_0) + b \cdot\operatorname{F}(A_1)\ ,c \cdot\operatorname{F}(A_0) + d \cdot\operatorname{F}(A_1) )
\]</span></p>
<p>设 <span class="math inline">\(X = a \cdot\operatorname{F}(A_0) + b \cdot\operatorname{F}(A_1)\)</span>，<span class="math inline">\(Y = c \cdot\operatorname{F}(A_0) + d \cdot\operatorname{F}(A_1)\)</span>。问题变成了已知 <span class="math inline">\(X, Y\)</span>，求出 <span class="math inline">\(\operatorname{F}(A_0), \operatorname{F}(A_1)\)</span>，可以解得： <span class="math display">\[
\operatorname{F}(A_1) =\frac{aY - cX}{da-bc}
\]</span> <span class="math display">\[
\operatorname{F}(A_0) =\frac{dX - bY}{da-bc}
\]</span> 因此上述方程组中，解还需要需要保证 <span class="math inline">\(ad \not = bc\)</span>。</p>
<p>可以解出一如下两组解： <span class="math display">\[
\begin{cases}
a=1\\\\
b=-1\\\\
c=1\\\\
d=1
\end{cases}
\]</span> <span class="math display">\[
\begin{cases}
a=1\\\\
b=1\\\\
c=1\\\\
d=-1
\end{cases}
\]</span></p>
<p>上述两组解带入后都可以实现异或卷积。</p>
<h5 id="质数表">质数表</h5>
<details class="note info"><summary><p>质数表</p>
</summary>
<p>来自 <a target="_blank" rel="noopener" href="https://min-25.hatenablog.com/entry/2015/04/07/160154">min_25的博客Orz</a></p>
<table>
<thead>
<tr class="header">
<th>最长周期 <span class="math inline">\(n\)</span></th>
<th>质数</th>
<th>原根</th>
<th><span class="math inline">\(z(z^n = 1)\)</span></th>
<th><span class="math inline">\(p-1\)</span>的因数分解</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(2^{26}\)</span></td>
<td>469762049</td>
<td>3</td>
<td>2187</td>
<td><span class="math inline">\(2^{26} \times 7\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{25}\)</span></td>
<td>167772161</td>
<td>3</td>
<td>243</td>
<td><span class="math inline">\(2^{25} \times 5\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{24}\)</span></td>
<td>754974721</td>
<td>11</td>
<td>739831874</td>
<td><span class="math inline">\(2^{24} \times 3^2 \times 5\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{23}\)</span></td>
<td>377487361</td>
<td>7</td>
<td>48510621</td>
<td><span class="math inline">\(2^{23} \times 3^2 \times 5\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{23}\)</span></td>
<td>595591169</td>
<td>3</td>
<td>361399025</td>
<td><span class="math inline">\(2^{23} \times 71\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{23}\)</span></td>
<td>645922817</td>
<td>3</td>
<td>224270701</td>
<td><span class="math inline">\(2^{23} \times 7 \times 11\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{23}\)</span></td>
<td>880803841</td>
<td>26</td>
<td>273508579</td>
<td><span class="math inline">\(2^{23} \times 3 \times 5 \times 7\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{23}\)</span></td>
<td>897581057</td>
<td>3</td>
<td>872686320</td>
<td><span class="math inline">\(2^{23} \times 107\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{23}\)</span></td>
<td>998244353</td>
<td>3</td>
<td>15311432</td>
<td><span class="math inline">\(2^{23} \times 7 \times 17\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{22}\)</span></td>
<td>104857601</td>
<td>3</td>
<td>39193363</td>
<td><span class="math inline">\(2^{22} \times 5^2\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{22}\)</span></td>
<td>113246209</td>
<td>7</td>
<td>58671006</td>
<td><span class="math inline">\(2^{22} \times 3^3\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{22}\)</span></td>
<td>138412033</td>
<td>5</td>
<td>99040867</td>
<td><span class="math inline">\(2^{22} \times 3 \times 11\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{22}\)</span></td>
<td>155189249</td>
<td>6</td>
<td>14921912</td>
<td><span class="math inline">\(2^{22} \times 37\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{22}\)</span></td>
<td>163577857</td>
<td>23</td>
<td>121532577</td>
<td><span class="math inline">\(2^{22} \times 3 \times 13\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{22}\)</span></td>
<td>230686721</td>
<td>6</td>
<td>71750113</td>
<td><span class="math inline">\(2^{22} \times 5 \times 11\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{22}\)</span></td>
<td>415236097</td>
<td>5</td>
<td>73362476</td>
<td><span class="math inline">\(2^{22} \times 3^2 \times 11\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{22}\)</span></td>
<td>666894337</td>
<td>5</td>
<td>147340140</td>
<td><span class="math inline">\(2^{22} \times 3 \times 53\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{22}\)</span></td>
<td>683671553</td>
<td>3</td>
<td>236932120</td>
<td><span class="math inline">\(2^{22} \times 163\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{22}\)</span></td>
<td>918552577</td>
<td>5</td>
<td>86995699</td>
<td><span class="math inline">\(2^{22} \times 3 \times 73\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{22}\)</span></td>
<td>935329793</td>
<td>3</td>
<td>86363943</td>
<td><span class="math inline">\(2^{22} \times 223\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{22}\)</span></td>
<td>943718401</td>
<td>7</td>
<td>754500478</td>
<td><span class="math inline">\(2^{22} \times 3^2 \times 5^2\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{22}\)</span></td>
<td>985661441</td>
<td>3</td>
<td>79986183</td>
<td><span class="math inline">\(2^{22} \times 5 \times 47\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>111149057</td>
<td>3</td>
<td>60767546</td>
<td><span class="math inline">\(2^{21} \times 53\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>132120577</td>
<td>5</td>
<td>102376994</td>
<td><span class="math inline">\(2^{21} \times 3^2 \times 7\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>136314881</td>
<td>3</td>
<td>2981173</td>
<td><span class="math inline">\(2^{21} \times 5 \times 13\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>169869313</td>
<td>5</td>
<td>143354861</td>
<td><span class="math inline">\(2^{21} \times 3^4\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>186646529</td>
<td>3</td>
<td>88383805</td>
<td><span class="math inline">\(2^{21} \times 89\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>199229441</td>
<td>3</td>
<td>174670364</td>
<td><span class="math inline">\(2^{21} \times 5 \times 19\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>211812353</td>
<td>3</td>
<td>113852926</td>
<td><span class="math inline">\(2^{21} \times 101\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>249561089</td>
<td>3</td>
<td>61724276</td>
<td><span class="math inline">\(2^{21} \times 7 \times 17\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>257949697</td>
<td>5</td>
<td>186470816</td>
<td><span class="math inline">\(2^{21} \times 3 \times 41\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>270532609</td>
<td>22</td>
<td>74891632</td>
<td><span class="math inline">\(2^{21} \times 3 \times 43\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>274726913</td>
<td>3</td>
<td>255478716</td>
<td><span class="math inline">\(2^{21} \times 131\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>383778817</td>
<td>5</td>
<td>324881819</td>
<td><span class="math inline">\(2^{21} \times 3 \times 61\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>387973121</td>
<td>6</td>
<td>124477810</td>
<td><span class="math inline">\(2^{21} \times 5 \times 37\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>459276289</td>
<td>11</td>
<td>238723101</td>
<td><span class="math inline">\(2^{21} \times 3 \times 73\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>463470593</td>
<td>3</td>
<td>428228038</td>
<td><span class="math inline">\(2^{21} \times 13 \times 17\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>576716801</td>
<td>6</td>
<td>153098993</td>
<td><span class="math inline">\(2^{21} \times 5^2 \times 11\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>597688321</td>
<td>11</td>
<td>395834143</td>
<td><span class="math inline">\(2^{21} \times 3 \times 5 \times 19\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>635437057</td>
<td>11</td>
<td>171402456</td>
<td><span class="math inline">\(2^{21} \times 3 \times 101\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>639631361</td>
<td>6</td>
<td>432237000</td>
<td><span class="math inline">\(2^{21} \times 5 \times 61\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>648019969</td>
<td>17</td>
<td>592437138</td>
<td><span class="math inline">\(2^{21} \times 3 \times 103\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>710934529</td>
<td>17</td>
<td>69533131</td>
<td><span class="math inline">\(2^{21} \times 3 \times 113\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>715128833</td>
<td>3</td>
<td>355872337</td>
<td><span class="math inline">\(2^{21} \times 11 \times 31\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>740294657</td>
<td>3</td>
<td>237508734</td>
<td><span class="math inline">\(2^{21} \times 353\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>786432001</td>
<td>7</td>
<td>228383098</td>
<td><span class="math inline">\(2^{21} \times 3 \times 5^3\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>799014913</td>
<td>13</td>
<td>374051146</td>
<td><span class="math inline">\(2^{21} \times 3 \times 127\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>824180737</td>
<td>5</td>
<td>133412682</td>
<td><span class="math inline">\(2^{21} \times 3 \times 131\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>899678209</td>
<td>7</td>
<td>118485495</td>
<td><span class="math inline">\(2^{21} \times 3 \times 11 \times 13\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>924844033</td>
<td>5</td>
<td>44009197</td>
<td><span class="math inline">\(2^{21} \times 3^2 \times 7^2\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>950009857</td>
<td>7</td>
<td>741494216</td>
<td><span class="math inline">\(2^{21} \times 3 \times 151\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>962592769</td>
<td>7</td>
<td>695637473</td>
<td><span class="math inline">\(2^{21} \times 3^3 \times 17\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>975175681</td>
<td>17</td>
<td>518451017</td>
<td><span class="math inline">\(2^{21} \times 3 \times 5 \times 31\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>1004535809</td>
<td>3</td>
<td>702606812</td>
<td><span class="math inline">\(2^{21} \times 479\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{21}\)</span></td>
<td>1012924417</td>
<td>5</td>
<td>673144645</td>
<td><span class="math inline">\(2^{21} \times 3 \times 7 \times 23\)</span></td>
</tr>
</tbody>
</table>

</details>

    </div>





    <footer class="post-footer">
          <div class="post-tags">
              <a href="/oi-blog/tags/多项式/" rel="tag"># 多项式</a>
              <a href="/oi-blog/tags/FWT/" rel="tag"># FWT</a>
              <a href="/oi-blog/tags/NTT/" rel="tag"># NTT</a>
              <a href="/oi-blog/tags/FFT/" rel="tag"># FFT</a>
          </div>



          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/oi-blog/「学习总结」群-置换群/" rel="prev" title="「学习总结」群 置换群">
                  <i class="fa fa-chevron-left"></i> 「学习总结」群 置换群
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/oi-blog/「杂题记录」「WC2020」猜数游戏/" rel="next" title="「杂题记录」「WC2020」猜数游戏">
                  「杂题记录」「WC2020」猜数游戏 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 –
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">舒雨墨</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    </div>
  </footer>


  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
<script src="/oi-blog/js/utils.js"></script><script src="/oi-blog/js/schemes/muse.js"></script><script src="/oi-blog/js/next-boot.js"></script>


<script src="/oi-blog/js/local-search.js"></script>





  <script>
    NProgress.configure({
      showSpinner: true
    });
    NProgress.start();
    document.addEventListener('readystatechange', () => {
      if (document.readyState === 'interactive') {
        NProgress.inc(0.8);
      }
      if (document.readyState === 'complete') {
        NProgress.done();
      }
    });
    document.addEventListener('pjax:send', () => {
      NProgress.start();
    });
    document.addEventListener('pjax:success', () => {
      NProgress.done();
    });
  </script>


  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ShuYuMo2003/gitalk@master/dist/gitalk.css">

<script>
NexT.utils.loadComments('.gitalk-container', () => {
  NexT.utils.getScript('https://cdn.jsdelivr.net/gh/ShuYuMo2003/gitalk@master/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '5d4b0a361ccf7199b58f',
      clientSecret: 'ff21340eedfb4a1c940eaddf8e180f0260c33088',
      repo        : 'ShuYuMo2003.github.io',
      owner       : 'ShuYuMo2003',
      admin       : ['ShuYuMo2003'],
      id          : '331487209bcad35af98f00e295f5a812',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render(document.querySelector('.gitalk-container'));
  }, window.Gitalk);
});
</script>

</body>
</html>
